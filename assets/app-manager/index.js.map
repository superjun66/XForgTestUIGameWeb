{"version":3,"sources":["../file:/D:/XForgTestUIGame/assets/app-builtin/app-manager/api/file:/D:/XForgTestUIGame/assets/app-builtin/app-manager/api/ApiManager.ts","../file:/D:/XForgTestUIGame/assets/app-builtin/app-manager/util/file:/D:/XForgTestUIGame/assets/app-builtin/app-manager/util/UtilManager.ts"],"names":["ccclass","_decorator","property","ApiManager","_dec","_class","_BaseManager","_inheritsLoose","apply","arguments","_proto","prototype","login","Promise","resolve","reject","setTimeout","errno","errmsg","data","token","username","BaseManager","_RF","pop","UtilManager","_class2","onLoad","onInited","onFinished","init","finish","call","InitLayout","designView","view","getDesignResolutionSize","desWidth","_designWidth","width","desHeight","_designHeight","height","halfWidth","halfHeight","_centerOrigin","v2","_centerTop","_centerBottom","_leftTop","_leftCenter","_leftBottom","_rightTop","_rightCenter","_rightBottom","visibleSize","getVisibleSize","_visibleWidth","_visibleHeight","screenSize","screen","windowSize","scrWidth","_screenWidth","scrHeight","_screenHeight","widthScale","_fitRatio","_fitHeight","_isPhoneX","Math","max","min","_isIpad","IsIphoneX","IsIpad","GetScreenWidth","GetScreenHeight","strClamp","nameStr","maxChars","suffix","str","replace","toCodePoint","unicodeSurrogates","r","c","p","i","length","pos","charCodeAt","value","push","v","codeArr","numChar","index","code","add","more","substring","BezierTo","target","duration","c1","c2","to","opts","Object","create","twoBezier","t","p1","cp","p2","x","y","v3","onUpdate","arg","ratio","position","tween","OpenUrl","url","title","back","gameDiv","document","getElementById","navBar","createElement","style","top","left","backgroundColor","color","display","alignItems","justifyContent","fontSize","zIndex","textContent","appendChild","btnBack","backgroundSize","backgroundImage","border","addEventListener","remove","iframeDiv","id","opacity","iframe","src","GetVoiceAnimationAtFrame","volume","totalFrame","volumeRang","perVol","adjust","frame","round","_popToast","_popLoading"],"mappings":"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","file":"all.js","sourcesContent":["import { _decorator } from 'cc';\r\nimport BaseManager from '../../../../extensions/app/assets/base/BaseManager';\r\nconst { ccclass, property } = _decorator;\r\n\r\ninterface ILogin {\r\n    errno: number,\r\n    errmsg: string,\r\n    data: {\r\n        token: string,\r\n        username: string\r\n    }\r\n}\r\n\r\n/**\r\n * 接口管理器\r\n */\r\n@ccclass('ApiManager')\r\nexport class ApiManager extends BaseManager {\r\n    /**\r\n     * 登录\r\n     * @returns \r\n     */\r\n    login() {\r\n        return new Promise<ILogin>((resolve, reject) => {\r\n            // 模拟登录\r\n            setTimeout(() => {\r\n                resolve({\r\n                    errno: 0,\r\n                    errmsg: '',\r\n                    data: {\r\n                        token: '<token>',\r\n                        username: '<username>'\r\n                    }\r\n                });\r\n            }, 3000);\r\n        });\r\n    }\r\n}","import { _decorator } from 'cc';\r\nimport BaseManager from '../../../../extensions/app/assets/base/BaseManager';\r\nimport { v2, Vec2, view, Node, v3, tween, UIOpacity, Tween, Sprite, UITransform, Texture2D, SpriteFrame, ImageAsset, Layers, assetManager, screen, instantiate, isValid, director, Vec3, resources, Material, Label, Color, Font, sp } from 'cc';\r\n\r\nconst { ccclass, property } = _decorator;\r\n@ccclass('UtilManager')\r\nexport class UtilManager extends BaseManager {\r\n    // [无序] 加载完成时触发\r\n    protected onLoad() { }\r\n\r\n    // [无序] 自身初始化完成, init执行完毕后被调用\r\n    protected onInited() { }\r\n\r\n    // [无序] 所有manager初始化完成\r\n    protected onFinished() { }\r\n\r\n    // [无序] 初始化manager，在初始化完成后，调用finish方法\r\n    protected init(finish: Function) {\r\n        super.init(finish);\r\n    }\r\n    /** 初始化布局*/\r\n    private static _screenWidth: number;\r\n    private static _screenHeight: number;\r\n    private static _designWidth: number;\r\n    private static _designHeight: number;\r\n    private static _visibleWidth: number;\r\n    private static _visibleHeight: number;\r\n    private static _fitRatio: number;\r\n    private static _fitHeight: number;\r\n    private static _centerOrigin: Vec2;\r\n    private static _centerTop: Vec2;\r\n    private static _centerBottom: Vec2;\r\n    private static _leftTop: Vec2;\r\n    private static _leftCenter: Vec2;\r\n    private static _leftBottom: Vec2;\r\n    private static _rightTop: Vec2;\r\n    private static _rightCenter: Vec2;\r\n    private static _rightBottom: Vec2;\r\n    private static _isPhoneX: boolean = false;\r\n    private static _isIpad: boolean = false;\r\n    private static _popToast: Node;\r\n    private static _popLoading: Node;\r\n    static InitLayout() {\r\n        let designView = view.getDesignResolutionSize();\r\n        let desWidth = this._designWidth = designView.width;\r\n        let desHeight = this._designHeight = designView.height;\r\n        let halfWidth = desWidth / 2, halfHeight = desHeight / 2;\r\n        this._centerOrigin = v2(0, 0);\r\n        this._centerTop = v2(0, halfHeight);\r\n        this._centerBottom = v2(0, -halfHeight);\r\n        this._leftTop = v2(-halfWidth, halfHeight);\r\n        this._leftCenter = v2(-halfWidth, 0);\r\n        this._leftBottom = v2(-halfWidth, -halfHeight);\r\n        this._rightTop = v2(halfWidth, halfHeight);\r\n        this._rightCenter = v2(halfWidth, 0);\r\n        this._rightBottom = v2(halfWidth, -halfHeight);\r\n\r\n        let visibleSize = view.getVisibleSize();\r\n        this._visibleWidth = visibleSize.width;\r\n        this._visibleHeight = visibleSize.height;\r\n        let screenSize = screen.windowSize;\r\n        let scrWidth = this._screenWidth = screenSize.width;\r\n        let scrHeight = this._screenHeight = screenSize.height;\r\n        //适配宽度，计算出真实高度\r\n        let widthScale = this._fitRatio = desWidth / scrWidth;\r\n        this._fitHeight = scrHeight * widthScale;\r\n\r\n        if ((screenSize.width == 2436 && screenSize.height == 1125) || (screenSize.width == 1125 && screenSize.height == 2436) || (screenSize.height / screenSize.width >= 2))\r\n            this._isPhoneX = true\r\n        else if (Math.max(screenSize.width, screenSize.height) / Math.min(screenSize.width, screenSize.height) <= 1.34) {\r\n            this._isIpad = true\r\n        }\r\n    }\r\n\r\n    static IsIphoneX() {\r\n        return this._isPhoneX;\r\n    }\r\n\r\n    static IsIpad() {\r\n        return this._isIpad;\r\n    }\r\n\r\n    static GetScreenWidth() {\r\n        return this._screenWidth;\r\n    }\r\n\r\n    static GetScreenHeight() {\r\n        return this._screenHeight;\r\n    }\r\n\r\n    //str 需要截断的字符串\r\n    //maxChars 保留的汉字长度\r\n    //suffix 添加的后缀 （注意，如果后缀不为null或者'' ，则要占用一个汉字的位置,具体看下方的示例代码)\r\n    static strClamp(nameStr: string, maxChars: number, suffix?: string) {\r\n        if (!nameStr) {\r\n            return \"\";\r\n        }\r\n        //过滤Emoji表情\r\n        let str = nameStr.replace(/\\uD83C[\\uDF00-\\uDFFF]|\\uD83D[\\uDC00-\\uDE4F]/g, \"\");\r\n        var toCodePoint = function (unicodeSurrogates: string) {\r\n            var r = [], c = 0, p = 0, i = 0;\r\n            while (i < unicodeSurrogates.length) {\r\n                var pos = i;\r\n                c = unicodeSurrogates.charCodeAt(i++);//返回位置的字符的 Unicode 编码 \r\n                if (c == 0xfe0f) {\r\n                    continue;\r\n                }\r\n                if (p) {\r\n                    var value = (0x10000 + ((p - 0xD800) << 10) + (c - 0xDC00));\r\n                    r.push({\r\n                        v: value,\r\n                        pos: pos,\r\n                    }); //计算4字节的unicode\r\n                    p = 0;\r\n                } else if (0xD800 <= c && c <= 0xDBFF) {\r\n                    p = c; //如果unicode编码在oxD800-0xDBff之间，则需要与后一个字符放在一起\r\n                } else {\r\n                    r.push({\r\n                        v: c,\r\n                        pos: pos\r\n                    }); //如果是2字节，直接将码点转为对应的十六进制形式\r\n                }\r\n            }\r\n            return r;\r\n        }\r\n\r\n        suffix = suffix == null ? '...' : suffix;\r\n        maxChars *= 2;\r\n\r\n        var codeArr = toCodePoint(str);\r\n        var numChar = 0;\r\n        var index = 0;\r\n        for (var i = 0; i < codeArr.length; ++i) {\r\n            var code = codeArr[i].v;\r\n            var add = 1;\r\n            if (code >= 128) {\r\n                add = 2;\r\n            }\r\n            //如果超过了限制，则按上一个为准\r\n            if (numChar + add > maxChars) {\r\n                break;\r\n            }\r\n            index = i;\r\n            //累加\r\n            numChar += add;\r\n        }\r\n\r\n        if (codeArr.length - 1 == index) {\r\n            return str;\r\n        }\r\n        var more = suffix ? 1 : 0;\r\n\r\n        return str.substring(0, codeArr[index - more].pos + 1) + suffix;\r\n    }\r\n\r\n    // // 弹窗效果显示\r\n    // static Show_dlg(node: Node, cb?:any) {\r\n    //     Tween.stopAllByTarget(node);\r\n    //     node.setScale(v3(0.1, 0.1, 1));\r\n    //     let opcaity = node.getComponent(UIOpacity)\r\n    //     if (opcaity) {\r\n    //         opcaity.opacity = 255;\r\n    //     }\r\n    //     let scaleBig = tween().to(0.15, { scale: v3(1.03, 1.03, 1) })\r\n    //     let scaleSmall = tween().to(0.08, { scale: v3(0.97, 0.97, 1) });\r\n    //     let scaleNormal = tween().to(0.07, { scale: v3(1, 1, 1) });\r\n    //     tween(node).sequence(scaleBig, scaleSmall, scaleNormal, tween().call(function () {\r\n    //         if (cb) {\r\n    //             cb()\r\n    //         }\r\n    //     })).start();\r\n    // }\r\n    // // 弹窗效果消失\r\n    // static Hide_dlg(node: Node, cb?:any) {\r\n    //     Tween.stopAllByTarget(node);\r\n    //     node.addComponent(UIOpacity);\r\n    //     let scaleBig = tween().to(0.1, { scale: v3(1.04, 1.04, 1) })\r\n    //     let scaleSmall = tween().to(0.2, { scale: v3(0.5, 0.5, 1) });\r\n    //     //let scaleNormal = tween(node).to(0.07, { scale: v3(1, 1, 1) });\r\n    //     tween(node).sequence(scaleBig, scaleSmall, tween().delay(0.15)).start();\r\n    //     let Opacity = node.getComponent(UIOpacity);\r\n    //     tween(Opacity).sequence(tween().delay(0.15), tween().to(0.05, { opacity: 0 }), tween().call(function () {\r\n    //         if (cb) {\r\n    //             cb()\r\n    //         }\r\n    //     })).start();\r\n    // }\r\n\r\n    // static GetHeadNodeByUrl(url, size) {\r\n    //     return new Promise((resolve, reject) => {\r\n    //         let headNode = new Node();\r\n    //         let headUITransForm = headNode.addComponent(UITransform);\r\n    //         let sprite = headNode.addComponent(Sprite);\r\n    //         headNode.layer = Layers.Enum.UI_2D;\r\n    //         resources.load(\"material/headmaterial\", function (err, data:Material) {\r\n    //             // Log(data);\r\n    //             sprite.customMaterial = data;\r\n    //             JMAssetManager.loadUrlImg(url, function (err, data: ImageAsset) {\r\n    //                 if (!err) {\r\n    //                     let sp: SpriteFrame = new SpriteFrame();\r\n    //                     let texture = new Texture2D();\r\n    //                     texture.image = data;\r\n    //                     sp.texture = texture;\r\n    //                     sp.packable = false\r\n    //                     sprite.spriteFrame = sp;\r\n    //                     headUITransForm.contentSize = size;\r\n    //                     resolve(headNode)\r\n    //                 } else {\r\n    //                     reject();\r\n    //                 }\r\n    //             })\r\n    //         })\r\n            \r\n    //     })\r\n    // }\r\n\r\n    // static GetHeadNodeByUserId(userid, size) {\r\n    //     return new Promise((resolve, reject) => {\r\n    //         UserDataMgr.getHeaderThumb(userid).then(function (url) {\r\n    //             UIUtil.GetHeadNodeByUrl(url, size).then(\r\n    //                 function (headNode: Node) {\r\n    //                     resolve(headNode)\r\n    //                 }, function () {\r\n    //                     reject();\r\n    //                 }\r\n    //             )\r\n    //         }, function () {\r\n    //             reject();\r\n    //         });\r\n    //     })\r\n    // }\r\n\r\n    // static ShowToast(msg: string, showTime: number = 2) {\r\n    //     let self = this;\r\n    //     let popToast = this._popToast;\r\n    //     if (popToast && isValid(popToast)) {\r\n    //         popToast.getComponent(Toast).init(msg, showTime);\r\n    //         popToast.parent = director.getScene().getChildByName('Canvas')\r\n    //         popToast.setSiblingIndex(999);\r\n    //     }\r\n    //     else {\r\n    //         assetManager.loadAny({ path: 'prefabs/Toast', bundle: 'resources' }, function (err, prefab) {\r\n    //             if (err) {\r\n    //                 Log(err.message || err);\r\n    //                 self._popToast = null;\r\n    //                 return;\r\n    //             }\r\n    //             let node = self._popToast = instantiate(prefab);\r\n    //             node.getComponent(\"Toast\").init(msg, showTime);\r\n    //             let parent = director.getScene().getChildByName('Canvas');\r\n    //             parent.addChild(node);\r\n    //             node.setSiblingIndex(999);\r\n    //         })\r\n    //     }\r\n    // }\r\n\r\n    // static ShowLoading(msg?:string) {\r\n    //     let self = this;\r\n    //     UIUtil.HideLoading();\r\n    //     return new Promise((resolve, reject) => {\r\n    //         assetManager.loadAny({ path: 'prefabs/Loading', bundle: 'resources' }, function (err, prefab) {\r\n    //             if (err) {\r\n    //                 Log(err.message || err);\r\n    //                 self.HideLoading();\r\n    //                 reject();\r\n    //                 return;\r\n    //             }\r\n\r\n    //             if (isValid(self._popLoading)) {\r\n    //                 self._popLoading.destroy();\r\n    //             }\r\n    //             let node = instantiate(prefab);\r\n    //             self._popLoading = node;\r\n    //             let scr = node.getComponent('Loading')\r\n    //             scr.popDialog(msg)\r\n    //             Jm.UILayerManager.getCurLayer().addChild(node);\r\n    //             resolve(node)\r\n    //         })\r\n    //     })\r\n    // }\r\n\r\n    // static HideLoading() {\r\n    //     let popLoading = this._popLoading;\r\n    //     let _isValid = popLoading && isValid(popLoading);\r\n    //     Log(`HideLoading... ${_isValid} : ${popLoading == null}`);\r\n    //     if (_isValid) {\r\n    //         popLoading.active = false;\r\n    //         popLoading.removeFromParent();\r\n    //         popLoading.destroy();\r\n    //     }\r\n    //     this._popLoading = null;\r\n    // }\r\n\r\n    // private static lastClickTime: number\r\n    // private static CLICK_INTERVAL = 1000\r\n\r\n    // static ShouldPerfomClick(cdTime?) {\r\n    //     if (cdTime)\r\n    //         this.CLICK_INTERVAL = cdTime * 1000\r\n    //     else\r\n    //         this.CLICK_INTERVAL = 1000\r\n    //     if (Date.now() - this.lastClickTime < this.CLICK_INTERVAL) {\r\n    //         console.warn(\"avoid multi-click!!\")\r\n    //         return false\r\n    //     }\r\n    //     this.lastClickTime = Date.now()\r\n    //     return true\r\n    // }\r\n\r\n    // static ActionFromRightToCenter(actionArgs: { target: Node, time?: number, x?: number, y?: number }, cb?) {\r\n    //     let target = actionArgs.target, time = actionArgs.time != null ? actionArgs.time : 0.2;\r\n    //     if (target) {\r\n    //         let x = actionArgs.x != null ? actionArgs.x : (target.position.x - target.getComponent(UITransform).width),\r\n    //             y = actionArgs.y != null ? actionArgs.y : target.position.y;\r\n    //         tween(target).to(time, { position: v3(x, y, 0) }).call(() => { cb && cb(); }).start();\r\n    //     } else {\r\n    //         console.warn('from right to center, target is null!');\r\n    //     }\r\n    // }\r\n\r\n    // static ActionFromCenterToRight(actionArgs: { target: Node, time?: number, x?: number, y?: number }, cb?) {\r\n    //     let target = actionArgs.target, time = actionArgs.time != null ? actionArgs.time : 0.2;\r\n    //     if (target) {\r\n    //         let x = actionArgs.x != null ? actionArgs.x : (target.position.x + target.getComponent(UITransform).width),\r\n    //             y = actionArgs.y != null ? actionArgs.y : target.position.y;\r\n    //         tween(target).to(time, { position: v3(x, y, 0) }).call(() => { cb && cb(); }).start();\r\n    //     } else {\r\n    //         console.warn('from center to right, target is null!');\r\n    //     }\r\n    // }\r\n    \r\n    /**\r\n     *  二阶贝塞尔曲线 运动\r\n     * @param target\r\n     * @param {number} duration\r\n     * @param {} c1 起点坐标\r\n     * @param {} c2 控制点\r\n     * @param {Vec3} to 终点坐标\r\n     * @param opts\r\n     * @returns {any}\r\n     */\r\n    static BezierTo(target: any, duration: number, c1: Vec3, c2: Vec3, to: Vec3, opts: any) {\r\n        opts = opts || Object.create(null);\r\n        /**\r\n         * @desc 二阶贝塞尔\r\n         * @param {number} t 当前百分比\r\n         * @param {} p1 起点坐标\r\n         * @param {} cp 控制点\r\n         * @param {} p2 终点坐标\r\n         * @returns {any}\r\n         */\r\n        let twoBezier = (t: number, p1: Vec3, cp: Vec3, p2: Vec3) => {\r\n            let x = (1 - t) * (1 - t) * p1.x + 2 * t * (1 - t) * cp.x + t * t * p2.x;\r\n            let y = (1 - t) * (1 - t) * p1.y + 2 * t * (1 - t) * cp.y + t * t * p2.y;\r\n            return v3(x, y, 0);\r\n        };\r\n        opts.onUpdate = (arg: Vec3, ratio: number) => {\r\n            target.position = twoBezier(ratio, c1, c2, to);\r\n        };\r\n        return tween(target).to(duration, {}, opts);\r\n    }\r\n\r\n    static OpenUrl(url: string, title?: string, back: boolean = true) {\r\n        const gameDiv = document.getElementById('GameDiv');\r\n    \r\n        // 创建一个新的div元素作为导航栏\r\n        const navBar = document.createElement('div');\r\n        navBar.style.position = \"absolute\";\r\n        navBar.style.top = \"0\";\r\n        navBar.style.left = \"0\";\r\n        navBar.style.width = \"100%\"; // 确保导航栏宽度为100%\r\n        navBar.style.height = \"80px\";\r\n        navBar.style.backgroundColor = '#ffffff';\r\n        navBar.style.color = '#000000';\r\n        navBar.style.display = \"flex\";\r\n        navBar.style.alignItems = \"center\";\r\n        navBar.style.justifyContent = \"center\";\r\n        navBar.style.fontSize = \"20px\";\r\n        navBar.style.zIndex = \"1000\"; //导航栏显示在其他元素上方\r\n        navBar.textContent = title; //设置导航栏的标题\r\n        gameDiv.appendChild(navBar);\r\n    \r\n        if (back) {\r\n            const btnBack = document.createElement(\"button\");\r\n            btnBack.style.position = \"absolute\";\r\n            btnBack.style.top = \"25px\"; //调整按钮的垂直位置使其与导航栏文字对齐\r\n            btnBack.style.left = '10px';\r\n            btnBack.style.width = '30px';\r\n            btnBack.style.height = '30px';\r\n            btnBack.style.backgroundColor = \"rgba(255,255,255,0)\";\r\n            btnBack.style.backgroundSize = \"contain\";\r\n            btnBack.style.backgroundImage = \"url('https://dev-qiniu.lrs-hello.caniculab.com/lrs_hello/material/bt_back.png')\";\r\n            btnBack.style.border = \"none\";\r\n            navBar.appendChild(btnBack);\r\n    \r\n            btnBack.addEventListener(\"click\", () => {\r\n                btnBack.remove();\r\n                iframeDiv.remove();\r\n                navBar.remove(); // 点击返回按钮时，导航栏也应该被移除\r\n            });\r\n        }\r\n    \r\n        const iframeDiv = document.createElement('div');\r\n        iframeDiv.id = \"WrapIframe\";\r\n        iframeDiv.style.position = \"absolute\";\r\n        iframeDiv.style.width = \"100%\";\r\n        iframeDiv.style.height = \"calc(100% - 80px)\"; // 确保高度减去导航栏的高度\r\n        iframeDiv.style.backgroundColor = '#ffffff';\r\n        iframeDiv.style.opacity = '1';\r\n        iframeDiv.style.top = \"80px\"; // 与导航栏底部对齐\r\n        iframeDiv.style.left = \"0\";\r\n        gameDiv.appendChild(iframeDiv);\r\n    \r\n        const iframe = document.createElement('iframe');\r\n        iframe.src = url;\r\n        iframe.style.width = \"100%\";\r\n        iframe.style.height =  \"100%\";\r\n        iframe.style.border = \"none\"; // 移除iframe的边框\r\n        iframe.title = title || '';\r\n        iframeDiv.appendChild(iframe);\r\n    }\r\n    \r\n\r\n    /**\r\n     * 根据音量判断当前语音动画应该处于哪一帧\r\n     * @param volume 当前声音大小\r\n     * @totalFrame 动画总共有多少帧\r\n     * @volumeRang 声音大小范围\r\n     * */\r\n    static GetVoiceAnimationAtFrame(volume: number, totalFrame: number, volumeRang: number = 100) {\r\n        totalFrame--;\r\n        if (volume < 0) {\r\n            volume = 0;\r\n        } else if (volume > volumeRang) {\r\n            volume = volumeRang;\r\n        }\r\n\r\n        let perVol = volume / volumeRang;\r\n        let adjust = perVol * ( perVol * perVol * 2 - perVol * 3 + 2);\r\n        let frame = Math.round(totalFrame * adjust) + 1;\r\n        return frame;\r\n    }\r\n}"]}