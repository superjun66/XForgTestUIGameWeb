{"version":3,"sources":["../file:/D:/XForgTestUIGameUp/assets/app-builtin/app-manager/api/file:/D:/XForgTestUIGameUp/assets/app-builtin/app-manager/api/ApiManager.ts","../file:/D:/XForgTestUIGameUp/assets/app-builtin/app-manager/util/file:/D:/XForgTestUIGameUp/assets/app-builtin/app-manager/util/UtilManager.ts"],"names":["ccclass","_decorator","property","_dec","_class","_BaseManager","ApiManager","apply","arguments","_inheritsLoose","prototype","login","Promise","resolve","reject","setTimeout","errno","errmsg","data","token","username","BaseManager","_RF","pop","_class2","UtilManager","_proto","onLoad","onInited","onFinished","init","finish","call","InitLayout","designView","view","getDesignResolutionSize","desWidth","this","_designWidth","width","halfWidth","halfHeight","_designHeight","height","_centerOrigin","v2","_centerTop","_centerBottom","_leftTop","_leftCenter","_leftBottom","_rightTop","_rightCenter","_rightBottom","visibleSize","getVisibleSize","_visibleWidth","_visibleHeight","screenSize","screen","windowSize","scrWidth","_screenWidth","scrHeight","_screenHeight","widthScale","_fitRatio","_fitHeight","_isPhoneX","Math","max","min","_isIpad","IsIphoneX","IsIpad","GetScreenWidth","GetScreenHeight","strClamp","nameStr","maxChars","suffix","str","replace","codeArr","unicodeSurrogates","r","c","p","i","length","pos","charCodeAt","value","push","v","toCodePoint","numChar","index","add","more","substring","BezierTo","target","duration","c1","c2","to","opts","Object","create","onUpdate","arg","ratio","t","p1","cp","p2","x","y","position","v3","tween","OpenUrl","url","title","back","gameDiv","document","getElementById","navBar","createElement","style","top","left","backgroundColor","color","display","alignItems","justifyContent","fontSize","zIndex","textContent","appendChild","btnBack","backgroundSize","backgroundImage","border","addEventListener","remove","iframeDiv","id","opacity","iframe","src","GetVoiceAnimationAtFrame","volume","totalFrame","volumeRang","perVol","adjust","round","_popToast","_popLoading"],"mappings":"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","file":"all.js","sourcesContent":["import { _decorator } from 'cc';\r\nimport BaseManager from '../../../../extensions/app/assets/base/BaseManager';\r\nconst { ccclass, property } = _decorator;\r\n\r\ninterface ILogin {\r\n    errno: number,\r\n    errmsg: string,\r\n    data: {\r\n        token: string,\r\n        username: string\r\n    }\r\n}\r\n\r\n/**\r\n * 接口管理器\r\n */\r\n@ccclass('ApiManager')\r\nexport class ApiManager extends BaseManager {\r\n    /**\r\n     * 登录\r\n     * @returns \r\n     */\r\n    login() {\r\n        return new Promise<ILogin>((resolve, reject) => {\r\n            // 模拟登录\r\n            setTimeout(() => {\r\n                resolve({\r\n                    errno: 0,\r\n                    errmsg: '',\r\n                    data: {\r\n                        token: '<token>',\r\n                        username: '<username>'\r\n                    }\r\n                });\r\n            }, 3000);\r\n        });\r\n    }\r\n}","import { _decorator } from 'cc';\r\nimport BaseManager from '../../../../extensions/app/assets/base/BaseManager';\r\nimport { v2, Vec2, view, Node, v3, tween, UIOpacity, Tween, Sprite, UITransform, Texture2D, SpriteFrame, ImageAsset, Layers, assetManager, screen, instantiate, isValid, director, Vec3, resources, Material, Label, Color, Font, sp } from 'cc';\r\n\r\nconst { ccclass, property } = _decorator;\r\n@ccclass('UtilManager')\r\nexport class UtilManager extends BaseManager {\r\n    // [无序] 加载完成时触发\r\n    protected onLoad() { }\r\n\r\n    // [无序] 自身初始化完成, init执行完毕后被调用\r\n    protected onInited() { }\r\n\r\n    // [无序] 所有manager初始化完成\r\n    protected onFinished() { }\r\n\r\n    // [无序] 初始化manager，在初始化完成后，调用finish方法\r\n    protected init(finish: Function) {\r\n        super.init(finish);\r\n    }\r\n    /** 初始化布局*/\r\n    private static _screenWidth: number;\r\n    private static _screenHeight: number;\r\n    private static _designWidth: number;\r\n    private static _designHeight: number;\r\n    private static _visibleWidth: number;\r\n    private static _visibleHeight: number;\r\n    private static _fitRatio: number;\r\n    private static _fitHeight: number;\r\n    private static _centerOrigin: Vec2;\r\n    private static _centerTop: Vec2;\r\n    private static _centerBottom: Vec2;\r\n    private static _leftTop: Vec2;\r\n    private static _leftCenter: Vec2;\r\n    private static _leftBottom: Vec2;\r\n    private static _rightTop: Vec2;\r\n    private static _rightCenter: Vec2;\r\n    private static _rightBottom: Vec2;\r\n    private static _isPhoneX: boolean = false;\r\n    private static _isIpad: boolean = false;\r\n    private static _popToast: Node;\r\n    private static _popLoading: Node;\r\n    static InitLayout() {\r\n        let designView = view.getDesignResolutionSize();\r\n        let desWidth = this._designWidth = designView.width;\r\n        let desHeight = this._designHeight = designView.height;\r\n        let halfWidth = desWidth / 2, halfHeight = desHeight / 2;\r\n        this._centerOrigin = v2(0, 0);\r\n        this._centerTop = v2(0, halfHeight);\r\n        this._centerBottom = v2(0, -halfHeight);\r\n        this._leftTop = v2(-halfWidth, halfHeight);\r\n        this._leftCenter = v2(-halfWidth, 0);\r\n        this._leftBottom = v2(-halfWidth, -halfHeight);\r\n        this._rightTop = v2(halfWidth, halfHeight);\r\n        this._rightCenter = v2(halfWidth, 0);\r\n        this._rightBottom = v2(halfWidth, -halfHeight);\r\n\r\n        let visibleSize = view.getVisibleSize();\r\n        this._visibleWidth = visibleSize.width;\r\n        this._visibleHeight = visibleSize.height;\r\n        let screenSize = screen.windowSize;\r\n        let scrWidth = this._screenWidth = screenSize.width;\r\n        let scrHeight = this._screenHeight = screenSize.height;\r\n        //适配宽度，计算出真实高度\r\n        let widthScale = this._fitRatio = desWidth / scrWidth;\r\n        this._fitHeight = scrHeight * widthScale;\r\n\r\n        if ((screenSize.width == 2436 && screenSize.height == 1125) || (screenSize.width == 1125 && screenSize.height == 2436) || (screenSize.height / screenSize.width >= 2))\r\n            this._isPhoneX = true\r\n        else if (Math.max(screenSize.width, screenSize.height) / Math.min(screenSize.width, screenSize.height) <= 1.34) {\r\n            this._isIpad = true\r\n        }\r\n    }\r\n\r\n    static IsIphoneX() {\r\n        return this._isPhoneX;\r\n    }\r\n\r\n    static IsIpad() {\r\n        return this._isIpad;\r\n    }\r\n\r\n    static GetScreenWidth() {\r\n        return this._screenWidth;\r\n    }\r\n\r\n    static GetScreenHeight() {\r\n        return this._screenHeight;\r\n    }\r\n\r\n    //str 需要截断的字符串\r\n    //maxChars 保留的汉字长度\r\n    //suffix 添加的后缀 （注意，如果后缀不为null或者'' ，则要占用一个汉字的位置,具体看下方的示例代码)\r\n    static strClamp(nameStr: string, maxChars: number, suffix?: string) {\r\n        if (!nameStr) {\r\n            return \"\";\r\n        }\r\n        //过滤Emoji表情\r\n        let str = nameStr.replace(/\\uD83C[\\uDF00-\\uDFFF]|\\uD83D[\\uDC00-\\uDE4F]/g, \"\");\r\n        var toCodePoint = function (unicodeSurrogates: string) {\r\n            var r = [], c = 0, p = 0, i = 0;\r\n            while (i < unicodeSurrogates.length) {\r\n                var pos = i;\r\n                c = unicodeSurrogates.charCodeAt(i++);//返回位置的字符的 Unicode 编码 \r\n                if (c == 0xfe0f) {\r\n                    continue;\r\n                }\r\n                if (p) {\r\n                    var value = (0x10000 + ((p - 0xD800) << 10) + (c - 0xDC00));\r\n                    r.push({\r\n                        v: value,\r\n                        pos: pos,\r\n                    }); //计算4字节的unicode\r\n                    p = 0;\r\n                } else if (0xD800 <= c && c <= 0xDBFF) {\r\n                    p = c; //如果unicode编码在oxD800-0xDBff之间，则需要与后一个字符放在一起\r\n                } else {\r\n                    r.push({\r\n                        v: c,\r\n                        pos: pos\r\n                    }); //如果是2字节，直接将码点转为对应的十六进制形式\r\n                }\r\n            }\r\n            return r;\r\n        }\r\n\r\n        suffix = suffix == null ? '...' : suffix;\r\n        maxChars *= 2;\r\n\r\n        var codeArr = toCodePoint(str);\r\n        var numChar = 0;\r\n        var index = 0;\r\n        for (var i = 0; i < codeArr.length; ++i) {\r\n            var code = codeArr[i].v;\r\n            var add = 1;\r\n            if (code >= 128) {\r\n                add = 2;\r\n            }\r\n            //如果超过了限制，则按上一个为准\r\n            if (numChar + add > maxChars) {\r\n                break;\r\n            }\r\n            index = i;\r\n            //累加\r\n            numChar += add;\r\n        }\r\n\r\n        if (codeArr.length - 1 == index) {\r\n            return str;\r\n        }\r\n        var more = suffix ? 1 : 0;\r\n\r\n        return str.substring(0, codeArr[index - more].pos + 1) + suffix;\r\n    }\r\n\r\n    // // 弹窗效果显示\r\n    // static Show_dlg(node: Node, cb?:any) {\r\n    //     Tween.stopAllByTarget(node);\r\n    //     node.setScale(v3(0.1, 0.1, 1));\r\n    //     let opcaity = node.getComponent(UIOpacity)\r\n    //     if (opcaity) {\r\n    //         opcaity.opacity = 255;\r\n    //     }\r\n    //     let scaleBig = tween().to(0.15, { scale: v3(1.03, 1.03, 1) })\r\n    //     let scaleSmall = tween().to(0.08, { scale: v3(0.97, 0.97, 1) });\r\n    //     let scaleNormal = tween().to(0.07, { scale: v3(1, 1, 1) });\r\n    //     tween(node).sequence(scaleBig, scaleSmall, scaleNormal, tween().call(function () {\r\n    //         if (cb) {\r\n    //             cb()\r\n    //         }\r\n    //     })).start();\r\n    // }\r\n    // // 弹窗效果消失\r\n    // static Hide_dlg(node: Node, cb?:any) {\r\n    //     Tween.stopAllByTarget(node);\r\n    //     node.addComponent(UIOpacity);\r\n    //     let scaleBig = tween().to(0.1, { scale: v3(1.04, 1.04, 1) })\r\n    //     let scaleSmall = tween().to(0.2, { scale: v3(0.5, 0.5, 1) });\r\n    //     //let scaleNormal = tween(node).to(0.07, { scale: v3(1, 1, 1) });\r\n    //     tween(node).sequence(scaleBig, scaleSmall, tween().delay(0.15)).start();\r\n    //     let Opacity = node.getComponent(UIOpacity);\r\n    //     tween(Opacity).sequence(tween().delay(0.15), tween().to(0.05, { opacity: 0 }), tween().call(function () {\r\n    //         if (cb) {\r\n    //             cb()\r\n    //         }\r\n    //     })).start();\r\n    // }\r\n\r\n    // static GetHeadNodeByUrl(url, size) {\r\n    //     return new Promise((resolve, reject) => {\r\n    //         let headNode = new Node();\r\n    //         let headUITransForm = headNode.addComponent(UITransform);\r\n    //         let sprite = headNode.addComponent(Sprite);\r\n    //         headNode.layer = Layers.Enum.UI_2D;\r\n    //         resources.load(\"material/headmaterial\", function (err, data:Material) {\r\n    //             // Log(data);\r\n    //             sprite.customMaterial = data;\r\n    //             JMAssetManager.loadUrlImg(url, function (err, data: ImageAsset) {\r\n    //                 if (!err) {\r\n    //                     let sp: SpriteFrame = new SpriteFrame();\r\n    //                     let texture = new Texture2D();\r\n    //                     texture.image = data;\r\n    //                     sp.texture = texture;\r\n    //                     sp.packable = false\r\n    //                     sprite.spriteFrame = sp;\r\n    //                     headUITransForm.contentSize = size;\r\n    //                     resolve(headNode)\r\n    //                 } else {\r\n    //                     reject();\r\n    //                 }\r\n    //             })\r\n    //         })\r\n            \r\n    //     })\r\n    // }\r\n\r\n    // static GetHeadNodeByUserId(userid, size) {\r\n    //     return new Promise((resolve, reject) => {\r\n    //         UserDataMgr.getHeaderThumb(userid).then(function (url) {\r\n    //             UIUtil.GetHeadNodeByUrl(url, size).then(\r\n    //                 function (headNode: Node) {\r\n    //                     resolve(headNode)\r\n    //                 }, function () {\r\n    //                     reject();\r\n    //                 }\r\n    //             )\r\n    //         }, function () {\r\n    //             reject();\r\n    //         });\r\n    //     })\r\n    // }\r\n\r\n    // static ShowToast(msg: string, showTime: number = 2) {\r\n    //     let self = this;\r\n    //     let popToast = this._popToast;\r\n    //     if (popToast && isValid(popToast)) {\r\n    //         popToast.getComponent(Toast).init(msg, showTime);\r\n    //         popToast.parent = director.getScene().getChildByName('Canvas')\r\n    //         popToast.setSiblingIndex(999);\r\n    //     }\r\n    //     else {\r\n    //         assetManager.loadAny({ path: 'prefabs/Toast', bundle: 'resources' }, function (err, prefab) {\r\n    //             if (err) {\r\n    //                 Log(err.message || err);\r\n    //                 self._popToast = null;\r\n    //                 return;\r\n    //             }\r\n    //             let node = self._popToast = instantiate(prefab);\r\n    //             node.getComponent(\"Toast\").init(msg, showTime);\r\n    //             let parent = director.getScene().getChildByName('Canvas');\r\n    //             parent.addChild(node);\r\n    //             node.setSiblingIndex(999);\r\n    //         })\r\n    //     }\r\n    // }\r\n\r\n    // static ShowLoading(msg?:string) {\r\n    //     let self = this;\r\n    //     UIUtil.HideLoading();\r\n    //     return new Promise((resolve, reject) => {\r\n    //         assetManager.loadAny({ path: 'prefabs/Loading', bundle: 'resources' }, function (err, prefab) {\r\n    //             if (err) {\r\n    //                 Log(err.message || err);\r\n    //                 self.HideLoading();\r\n    //                 reject();\r\n    //                 return;\r\n    //             }\r\n\r\n    //             if (isValid(self._popLoading)) {\r\n    //                 self._popLoading.destroy();\r\n    //             }\r\n    //             let node = instantiate(prefab);\r\n    //             self._popLoading = node;\r\n    //             let scr = node.getComponent('Loading')\r\n    //             scr.popDialog(msg)\r\n    //             Jm.UILayerManager.getCurLayer().addChild(node);\r\n    //             resolve(node)\r\n    //         })\r\n    //     })\r\n    // }\r\n\r\n    // static HideLoading() {\r\n    //     let popLoading = this._popLoading;\r\n    //     let _isValid = popLoading && isValid(popLoading);\r\n    //     Log(`HideLoading... ${_isValid} : ${popLoading == null}`);\r\n    //     if (_isValid) {\r\n    //         popLoading.active = false;\r\n    //         popLoading.removeFromParent();\r\n    //         popLoading.destroy();\r\n    //     }\r\n    //     this._popLoading = null;\r\n    // }\r\n\r\n    // private static lastClickTime: number\r\n    // private static CLICK_INTERVAL = 1000\r\n\r\n    // static ShouldPerfomClick(cdTime?) {\r\n    //     if (cdTime)\r\n    //         this.CLICK_INTERVAL = cdTime * 1000\r\n    //     else\r\n    //         this.CLICK_INTERVAL = 1000\r\n    //     if (Date.now() - this.lastClickTime < this.CLICK_INTERVAL) {\r\n    //         console.warn(\"avoid multi-click!!\")\r\n    //         return false\r\n    //     }\r\n    //     this.lastClickTime = Date.now()\r\n    //     return true\r\n    // }\r\n\r\n    // static ActionFromRightToCenter(actionArgs: { target: Node, time?: number, x?: number, y?: number }, cb?) {\r\n    //     let target = actionArgs.target, time = actionArgs.time != null ? actionArgs.time : 0.2;\r\n    //     if (target) {\r\n    //         let x = actionArgs.x != null ? actionArgs.x : (target.position.x - target.getComponent(UITransform).width),\r\n    //             y = actionArgs.y != null ? actionArgs.y : target.position.y;\r\n    //         tween(target).to(time, { position: v3(x, y, 0) }).call(() => { cb && cb(); }).start();\r\n    //     } else {\r\n    //         console.warn('from right to center, target is null!');\r\n    //     }\r\n    // }\r\n\r\n    // static ActionFromCenterToRight(actionArgs: { target: Node, time?: number, x?: number, y?: number }, cb?) {\r\n    //     let target = actionArgs.target, time = actionArgs.time != null ? actionArgs.time : 0.2;\r\n    //     if (target) {\r\n    //         let x = actionArgs.x != null ? actionArgs.x : (target.position.x + target.getComponent(UITransform).width),\r\n    //             y = actionArgs.y != null ? actionArgs.y : target.position.y;\r\n    //         tween(target).to(time, { position: v3(x, y, 0) }).call(() => { cb && cb(); }).start();\r\n    //     } else {\r\n    //         console.warn('from center to right, target is null!');\r\n    //     }\r\n    // }\r\n    \r\n    /**\r\n     *  二阶贝塞尔曲线 运动\r\n     * @param target\r\n     * @param {number} duration\r\n     * @param {} c1 起点坐标\r\n     * @param {} c2 控制点\r\n     * @param {Vec3} to 终点坐标\r\n     * @param opts\r\n     * @returns {any}\r\n     */\r\n    static BezierTo(target: any, duration: number, c1: Vec3, c2: Vec3, to: Vec3, opts: any) {\r\n        opts = opts || Object.create(null);\r\n        /**\r\n         * @desc 二阶贝塞尔\r\n         * @param {number} t 当前百分比\r\n         * @param {} p1 起点坐标\r\n         * @param {} cp 控制点\r\n         * @param {} p2 终点坐标\r\n         * @returns {any}\r\n         */\r\n        let twoBezier = (t: number, p1: Vec3, cp: Vec3, p2: Vec3) => {\r\n            let x = (1 - t) * (1 - t) * p1.x + 2 * t * (1 - t) * cp.x + t * t * p2.x;\r\n            let y = (1 - t) * (1 - t) * p1.y + 2 * t * (1 - t) * cp.y + t * t * p2.y;\r\n            return v3(x, y, 0);\r\n        };\r\n        opts.onUpdate = (arg: Vec3, ratio: number) => {\r\n            target.position = twoBezier(ratio, c1, c2, to);\r\n        };\r\n        return tween(target).to(duration, {}, opts);\r\n    }\r\n\r\n    static OpenUrl(url: string, title?: string, back: boolean = true) {\r\n        const gameDiv = document.getElementById('GameDiv');\r\n    \r\n        // 创建一个新的div元素作为导航栏\r\n        const navBar = document.createElement('div');\r\n        navBar.style.position = \"absolute\";\r\n        navBar.style.top = \"0\";\r\n        navBar.style.left = \"0\";\r\n        navBar.style.width = \"100%\"; // 确保导航栏宽度为100%\r\n        navBar.style.height = \"80px\";\r\n        navBar.style.backgroundColor = '#ffffff';\r\n        navBar.style.color = '#000000';\r\n        navBar.style.display = \"flex\";\r\n        navBar.style.alignItems = \"center\";\r\n        navBar.style.justifyContent = \"center\";\r\n        navBar.style.fontSize = \"20px\";\r\n        navBar.style.zIndex = \"1000\"; //导航栏显示在其他元素上方\r\n        navBar.textContent = title; //设置导航栏的标题\r\n        gameDiv.appendChild(navBar);\r\n    \r\n        if (back) {\r\n            const btnBack = document.createElement(\"button\");\r\n            btnBack.style.position = \"absolute\";\r\n            btnBack.style.top = \"25px\"; //调整按钮的垂直位置使其与导航栏文字对齐\r\n            btnBack.style.left = '10px';\r\n            btnBack.style.width = '30px';\r\n            btnBack.style.height = '30px';\r\n            btnBack.style.backgroundColor = \"rgba(255,255,255,0)\";\r\n            btnBack.style.backgroundSize = \"contain\";\r\n            btnBack.style.backgroundImage = \"url('https://dev-qiniu.lrs-hello.caniculab.com/lrs_hello/material/bt_back.png')\";\r\n            btnBack.style.border = \"none\";\r\n            navBar.appendChild(btnBack);\r\n    \r\n            btnBack.addEventListener(\"click\", () => {\r\n                btnBack.remove();\r\n                iframeDiv.remove();\r\n                navBar.remove(); // 点击返回按钮时，导航栏也应该被移除\r\n            });\r\n        }\r\n    \r\n        const iframeDiv = document.createElement('div');\r\n        iframeDiv.id = \"WrapIframe\";\r\n        iframeDiv.style.position = \"absolute\";\r\n        iframeDiv.style.width = \"100%\";\r\n        iframeDiv.style.height = \"calc(100% - 80px)\"; // 确保高度减去导航栏的高度\r\n        iframeDiv.style.backgroundColor = '#ffffff';\r\n        iframeDiv.style.opacity = '1';\r\n        iframeDiv.style.top = \"80px\"; // 与导航栏底部对齐\r\n        iframeDiv.style.left = \"0\";\r\n        gameDiv.appendChild(iframeDiv);\r\n    \r\n        const iframe = document.createElement('iframe');\r\n        iframe.src = url;\r\n        iframe.style.width = \"100%\";\r\n        iframe.style.height =  \"100%\";\r\n        iframe.style.border = \"none\"; // 移除iframe的边框\r\n        iframe.title = title || '';\r\n        iframeDiv.appendChild(iframe);\r\n    }\r\n    \r\n\r\n    /**\r\n     * 根据音量判断当前语音动画应该处于哪一帧\r\n     * @param volume 当前声音大小\r\n     * @totalFrame 动画总共有多少帧\r\n     * @volumeRang 声音大小范围\r\n     * */\r\n    static GetVoiceAnimationAtFrame(volume: number, totalFrame: number, volumeRang: number = 100) {\r\n        totalFrame--;\r\n        if (volume < 0) {\r\n            volume = 0;\r\n        } else if (volume > volumeRang) {\r\n            volume = volumeRang;\r\n        }\r\n\r\n        let perVol = volume / volumeRang;\r\n        let adjust = perVol * ( perVol * perVol * 2 - perVol * 3 + 2);\r\n        let frame = Math.round(totalFrame * adjust) + 1;\r\n        return frame;\r\n    }\r\n}"]}