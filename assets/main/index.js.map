{"version":3,"sources":["../file:/D:/XForgTestUIGame/assets/app/file:/D:/XForgTestUIGame/assets/app/app.ts","../file:/D:/XForgTestUIGame/assets/app-appinit/view/file:/D:/XForgTestUIGame/assets/app-appinit/view/AppInit.ts","../file:/D:/XForgTestUIGame/extensions/app/assets/manager/sound/file:/D:/XForgTestUIGame/extensions/app/assets/manager/sound/Audio.ts","../file:/D:/XForgTestUIGame/extensions/app/assets/manager/sound/file:/D:/XForgTestUIGame/extensions/app/assets/manager/sound/AudioEngine.ts","../file:/D:/XForgTestUIGame/extensions/app/assets/manager/sound/file:/D:/XForgTestUIGame/extensions/app/assets/manager/sound/AudioManager.ts","../file:/D:/XForgTestUIGame/extensions/app/assets/base/file:/D:/XForgTestUIGame/extensions/app/assets/base/BaseAppInit.ts","../file:/D:/XForgTestUIGame/extensions/app/assets/base/file:/D:/XForgTestUIGame/extensions/app/assets/base/BaseControl.ts","../file:/D:/XForgTestUIGame/extensions/app/assets/base/file:/D:/XForgTestUIGame/extensions/app/assets/base/BaseController.ts","../file:/D:/XForgTestUIGame/assets/res-native/data/file:/D:/XForgTestUIGame/assets/res-native/data/BaseData.ts","../file:/D:/XForgTestUIGame/extensions/app/assets/base/file:/D:/XForgTestUIGame/extensions/app/assets/base/BaseManager.ts","../file:/D:/XForgTestUIGame/extensions/app/assets/base/file:/D:/XForgTestUIGame/extensions/app/assets/base/BaseModel.ts","../file:/D:/XForgTestUIGame/extensions/app/assets/base/file:/D:/XForgTestUIGame/extensions/app/assets/base/BaseView.ts","../file:/D:/XForgTestUIGame/extensions/app/assets/file:/D:/XForgTestUIGame/extensions/app/assets/Core.ts","../file:/D:/CocosDashboard_1.0.9/Creator/Creator/3.8.3/resources/resources/3d/engine/editor/assets/tools/file:/D:/CocosDashboard_1.0.9/Creator/Creator/3.8.3/resources/resources/3d/engine/editor/assets/tools/debug-view-runtime-control.ts","../file:/D:/XForgTestUIGame/extensions/app/assets/lib/debug/file:/D:/XForgTestUIGame/extensions/app/assets/lib/debug/debug.ts","../file:/D:/XForgTestUIGame/extensions/app/assets/manager/event/file:/D:/XForgTestUIGame/extensions/app/assets/manager/event/EventManager.ts","../file:/D:/XForgTestUIGame/assets/app/file:/D:/XForgTestUIGame/assets/app/handle.ts","../file:/D:/XForgTestUIGame/assets/res-native/tool/file:/D:/XForgTestUIGame/assets/res-native/tool/JmClickComponent.ts","../file:/D:/XForgTestUIGame/assets/res-native/tool/file:/D:/XForgTestUIGame/assets/res-native/tool/JmHorizontalListView.ts","../file:/D:/XForgTestUIGame/assets/res-native/tool/file:/D:/XForgTestUIGame/assets/res-native/tool/JmListView.ts","../file:/D:/XForgTestUIGame/assets/res-native/tool/file:/D:/XForgTestUIGame/assets/res-native/tool/JmListViewItem.ts","../file:/D:/XForgTestUIGame/assets/res-native/tool/file:/D:/XForgTestUIGame/assets/res-native/tool/JmNodePoolMgr.ts","../file:/D:/XForgTestUIGame/assets/res-native/tool/file:/D:/XForgTestUIGame/assets/res-native/tool/JmRefreshFooter.ts","../file:/D:/XForgTestUIGame/assets/res-native/tool/file:/D:/XForgTestUIGame/assets/res-native/tool/JmRefreshHeader.ts","../file:/D:/XForgTestUIGame/assets/res-native/data/file:/D:/XForgTestUIGame/assets/res-native/data/JmRoomData.ts","../file:/D:/XForgTestUIGame/assets/res-native/manager/file:/D:/XForgTestUIGame/assets/res-native/manager/JmRoomDataMgr.ts","../file:/D:/XForgTestUIGame/extensions/app/assets/manager/loader/file:/D:/XForgTestUIGame/extensions/app/assets/manager/loader/LoaderManager.ts","../file:/D:/XForgTestUIGame/extensions/app/assets/lib/logger/file:/D:/XForgTestUIGame/extensions/app/assets/lib/logger/logger.ts","../file:/D:/XForgTestUIGame/assets/res-native/tool/file:/D:/XForgTestUIGame/assets/res-native/tool/RefreshOrLoadState.ts","../file:/D:/XForgTestUIGame/assets/app/file:/D:/XForgTestUIGame/assets/app/setting.ts","../file:/D:/XForgTestUIGame/extensions/app/assets/manager/sound/file:/D:/XForgTestUIGame/extensions/app/assets/manager/sound/SoundManager.ts","../file:/D:/XForgTestUIGame/extensions/app/assets/lib/storage/file:/D:/XForgTestUIGame/extensions/app/assets/lib/storage/storage.ts","../file:/D:/XForgTestUIGame/extensions/app/assets/lib/task/file:/D:/XForgTestUIGame/extensions/app/assets/lib/task/task.ts","../file:/D:/XForgTestUIGame/extensions/app/assets/manager/timer/file:/D:/XForgTestUIGame/extensions/app/assets/manager/timer/TimerManager.ts","../file:/D:/XForgTestUIGame/extensions/app/assets/manager/ui/file:/D:/XForgTestUIGame/extensions/app/assets/manager/ui/UIManager.ts","../file:/D:/XForgTestUIGame/extensions/app/assets/manager/ui/comp/file:/D:/XForgTestUIGame/extensions/app/assets/manager/ui/comp/UIMgrLoading.ts","../file:/D:/XForgTestUIGame/extensions/app/assets/manager/ui/comp/file:/D:/XForgTestUIGame/extensions/app/assets/manager/ui/comp/UIMgrShade.ts","../file:/D:/XForgTestUIGame/extensions/app/assets/manager/ui/comp/file:/D:/XForgTestUIGame/extensions/app/assets/manager/ui/comp/UIMgrToast.ts","../file:/D:/XForgTestUIGame/extensions/app/assets/manager/ui/comp/file:/D:/XForgTestUIGame/extensions/app/assets/manager/ui/comp/UIMgrToastCell.ts","../file:/D:/XForgTestUIGame/extensions/app/assets/manager/ui/comp/file:/D:/XForgTestUIGame/extensions/app/assets/manager/ui/comp/UIMgrZOrder.ts"],"names":["App","_Core","call","_inheritsLoose","_createClass","key","get","this","_inst","Core","app","inst","cccInited","game","once","Game","EVENT_ENGINE_INITED","appInited","EventType","EVENT_APPINIT_FINISHED","_RF","pop","ccclass","_decorator","property","_dec","_dec2","Sprite","_descriptor","_applyDecoratedDescriptor","_class2","_BaseAppInit","AppInit","_this","_len","arguments","length","args","Array","_key","apply","concat","_initializerDefineProperty","_assertThisInitialized","_proto","prototype","onLoad","onFinish","BaseAppInit","configurable","enumerable","writable","initializer","_class","Audio","volume","volumeScale","mute","endedCallback","startedCallback","_playing","_paused","audioSource","node","Node","addComponent","AudioSource","on","ENDED","onAudioEnded","STARTED","onAudioStarted","play","clip","onEnded","onStarted","playing","paused","stop","emit","pause","resume","setVolume","scale","getVolume","setVolumeScale","getVolumeScale","setLoop","loop","getLoop","setMute","getMute","clear","destroy","set","value","AudioEngine","audioID","endedCallbackMap","Map","effectMap","music","musicMute","musicVolumeScale","effectMute","effectVolumeScale","playEffect","audioClip","audio","AudioManager","getAudio","putAudio","callback","stopEffect","id","_this$effectMap$get","stopAllEffects","forEach","pauseEffect","_this$effectMap$get2","pauseAllEffects","resumeEffect","_this$effectMap$get3","resumeAllEffects","setEffectMute","_this$effectMap$get4","getEffectMute","_this$effectMap$get5","setEffectVolume","_this$effectMap$get6","getEffectVolume","_this$effectMap$get7","setAllEffectsVolume","setEffectVolumeScale","_this$effectMap$get8","getEffectVolumeScale","_this$effectMap$get9","setGlobalEffectsVolumeScale","getGlobalEffectsVolumeScale","setGlobalEffectsMute","getGlobalEffectsMute","playMusic","stopMusic","pauseMusic","resumeMusic","setMusicVolume","getMusicVolume","setMusicVolumeScale","_this$music","getMusicVolumeScale","setMusicMute","_this$music2","getMusicMute","setEndedCallback","_this$music3","has","pauseAll","resumeAll","stopAll","audioArray","push","AdminBundleName","ModelBundleName","ControlBundleName","ControllerBundleName","ManagerBundleName","_Component","_base_mgr_completed","_base_user_completed","_base_inited","_base_finished","startInit","_this2","projectBundles","settings","querySettings","Settings","Category","ASSETS","lib","task","createAny","add","next","retry","indexOf","assetManager","preloadAny","url","ext","err","loadBundle","start","onProgress","_base_total","BaseManager","init","getBundle","innerNextInit","onUserInit","_base_completed","innerFinished","_this3","Manager","Sound","setting","defaultEffectName","playDefaultEffect","e","target","manager","ui","onceUserInterface","TOUCH_END","event","getComponent","Button","setTimeout","isValid","sound","eventPhase","EventTouch","CAPTURING_PHASE","onEnable","TOUCH_START","onDisable","off","showDefault","defaultMusicName","onTouch","_this4","isMusicPlaying","isMusicPaused","replayMusic","offUserInterface","onUserInterface","playDefaultMusic","nextInit","getUserAssetNum","completed","total","Math","max","getTotalAssetNum","_base_mgr_total","_base_user_total","min","Component","Event","_class5","_SuperBaseControl","BaseControl","_base_inst","SuperBaseControl","CallbackInfo","CallbackList","callbacks","size","index","info","splice","remove","removeByCallback","removeByTarget","EventEmitter","listeners","_proto2","cb","toString","targetOff","Object","hasOwnProperty","t","_proto3","_len2","_key2","_len3","_key3","_len4","_key4","_len5","_key5","_SuperBaseController","BaseController","SuperBaseController","Proxy","_key6","Logger","create","name","console","log","uuid","UUID","Date","now","loadError","_base_event","EventTarget","_base_manager_name","js","getClassName","slice","managerName","constructor","toLocaleLowerCase","resetInEditor","widget","Widget","isAlignBottom","isAlignLeft","isAlignRight","isAlignTop","top","left","right","bottom","alignMode","AlignMode","ON_WINDOW_RESIZE","onInited","onFinished","finish","createUUID","_this$_base_event","data","bundle","count","sysMgrCount","getDirWithPath","Prefab","item","path","endsWith","getUserAssetUrls","pathArr","progress","complete","urls","totalAsset","completeAsset","userMgrList","sysMgrList","timer","loader","initSysMgrTask","createASync","loadUserMgrTask","UserManagerRoot","root","getChildByPath","load","prefab","basename","instantiate","parent","active","EVENT_SYS_MANAGER_INITED","initUserMgrTask","EVENT_USER_MANAGER_INITED","EVENT_MANAGER_INITED","EVENT_MANAGER_FINISHED","window","bind","toLocaleString","warn","error","disallowMultiple","BlockEvents","TOUCH_MOVE","TOUCH_CANCEL","MOUSE_DOWN","MOUSE_MOVE","MOUSE_UP","MOUSE_ENTER","MOUSE_LEAVE","MOUSE_WHEEL","HideEvent","Enum","ViewType","ViewState","Group","displayOrder","Infinity","style","PaperAllToOwner","_dec3","group","type","tooltip","_dec4","_dec5","visible","is3D","_dec6","isPage","_dec7","_class3","BaseView","_base_view_created","_base_view_state","Hid","_base_view_name","_base_touch_enable","_base_show_hide_delays","_base_mini_show","Set","_descriptor2","_descriptor3","_descriptor4","_descriptor5","miniViews","BindControl","Control","_BaseView","BindController","Controller","_class4","_dec8","_BaseView2","isViewValid","Page","isPaper","Paper","isPaperAll","PaperAll","isPop","Pop","isTop","Top","is2D","Scene","viewName","director","getScene","isMiniViewShow","setTouchEnabled","enabled","blockPropagation","blockInput","propagationStopped","stopPropagation","propagationImmediateStopped","onBaseViewCreate","uiTransform","UITransform","hitTest","i","hideAllMiniViews","hide","hideMiniViews","_ref","views","sortUserInterface","showMiniViews","_ref2","onShow","onHide","typeName","createSync","_loop","names","createMixMiniViewsTask","_this5","filter","baseName","aSync","result","scheduleOnce","_this5$_base_mini_sho","show","silent","attr","zIndex","_this5$_base_mini_sho2","owner","onError","code","_this5$_base_mini_sho3","UI","ErrorCode","LoadError","setNodeAttr","setPosition","position","x","y","siblingIndex","setSiblingIndex","beforeShow","_this6","Showed","changeState","BeforeShow","isNextCalled","Showing","refreshShade","shift","BeforeHide","beforeHide","Hiding","hideEvent","release","focus","boo","onFocus","onLostFocus","loadRes","preloadRes","loadResDir","preloadResDir","setFont","onComplete","Font","font","setSpine","sp","SkeletonData","skeletonData","setSprite","SpriteFrame","spriteFrame","onShade","_hideEvent","_singleton","_captureFocus","_Core$inst","_shade","_Core$inst2","_blockInput","singleton","captureFocus","shade","getOwnPropertyDescriptor","Lib","storage","debug","logger","Config","Data","Store","controller","eventTarget","EventMap","Director","EVENT_RESET","config","store","getClassById","setClassAlias","DebugViewRuntimeControl","_single","strSingle","strComposite","strMisc","compositeModeToggleList","singleModeToggleList","miscModeToggleList","textComponentList","labelComponentList","textContentList","hideButtonLabel","_currentColorIndex","strColor","color","Color","WHITE","BLACK","RED","GREEN","BLUE","Canvas","halfScreenWidth","width","halfScreenHeight","height","miscNode","getChildByName","buttonNode","titleNode","newLabel","EnableAllCompositeModeButton","setScale","labelComponent","Label","string","overflow","currentRow","newNode","singleModeToggle","textComponent","getComponentInChildren","RichText","Toggle","TOGGLE","toggleSingleMode","CLICK","enableAllCompositeMode","changeColorButton","changeTextColor","HideButton","hideUI","compositeModeToggle","isChecked","toggleLightingWithAlbedo","toggleCSMColoration","toggleCompositeMode","isTextMatched","textUI","textDescription","tempText","String","findIndex","search","substr","toggle","debugView","singleMode","enableCompositeMode","lightingWithAlbedo","csmLayerColoration","button","toggleComponent","activeValue","update","deltaTime","obj","prop","getter","object","_i","_Object$keys","keys","defineProperty","setter","define","_BaseManager","EventManager","events","rootName","JmClickComponent","performClick","startPos","OnClickTouchEnd","onDestroy","getType","getLocation","pos","subtract","onItemClick","menu","requireComponent","ScrollView","JmHorizontalListView","_descriptor6","_descriptor7","footerController","onPullLeftToLoad","hasMore","scrollView","footer","footerWidth","_touchStartX","_touchStartFromLeft","footerHolderWidth","isUserTouched","loadingState","RefreshOrLoadState","NONE","componentName","showingViews","recycledViews","itemViewDirty","itemViewWidths","_data","_dirty","_sizeDirty","_checkRight","content","anchorX","anchorY","onTouchStart","onTouchEnd","onTouchMove","onTouchCancel","getLocationX","floor","getScrollOffset","getData","setData","setComponentName","updateSize","vertical","horizontal","getNormalContentWidth","getContentWidth","pullLeftToLoadEnabled","getItemPosOffset","getItemCount","leftOffset","rightOffset","sum","getItemWidthWithSpacing","undefined","itemWidth","spacing","getListLeftRightVisiblePos","scrollX","isVisible","_this$getListLeftRigh","leftVisibleX","rightVisibleX","itemLeftX","itemRightX","dt","child","getItemView","component","updateItem","getItemWidth","addChild","recycleChild","checkFooterView","isRight","scrollToOffset","Vec2","getMaxScrollOffset","footerView","JmRefreshFooter","setState","viewBottomY","contentBottomY","footerOffset","removeFromParent","itemView","itemPrefab","onScrollEvent","sender","SCROLLING","startPullLeftLoad","markChildrenDirty","notifyChange","checkRight","notifyItemChange","updateHeight","setPullLeftToLoadListener","listener","REFRESHING","offset","maxOffset","ceil","updateLoadingState","onLoadComplete","COMPLETE","state","onLoadingStateChange","newState","JmListView","_descriptor8","_descriptor9","_descriptor10","headerController","onPullDownToRefresh","_descriptor11","_descriptor12","_descriptor13","onPullUpToLoad","header","headerHeight","footerHeight","_touchStartY","_touchStartFromTop","refreshState","footerHolderHeight","itemViewHeights","_checkBottom","extraData","elastic","bounceDuration","pullDownToRefreshEnabled","cancelInnerEvents","getLocationY","offsetY","checkPullDownRefresh","onScrollOffset","startPullDownRefresh","newHeight","getNormalContentHeight","getContentHeight","pullUpToLoadEnabled","refreshFooterShow","setTopMargin","num","topMargin","bottomMargin","getItemHeightWithSpacing","itemHeight","getListTopBottomVisiblePos","scrollY","halfHeight","bottomVisibleY","_this$getListTopBotto","topVisibleY","itemTopY","itemBottomY","checkHeaderView","isBottom","headerView","JmRefreshHeader","checkPullUpLoad","checkBottom","emptyView","sys","getNetworkType","NetworkType","noNetworkImg","emptyPic","emptyImg","setPullUpToLoadListener","setPullDownToRefreshListener","updateRefreshState","READY_TO_REFRESH","pullDownRefresh","stopAutoScroll","onRefreshComplete","scrollToTop","EMPTY","stopPullDownRefresh","COMPLETING","onRefreshStateChange","setExtraData","getExtraData","handleSuccess","isLoadMore","listView","newData","isArray","handleFailure","loadMore","Orientation","JmListViewItem","itemId","onTouchEvent","dstx","abs","dsty","getItemHeight","JmNodePool","_NodePool","_cellPfb","NodePool","JmNodePoolMgr","InitNodePool","poolKey","cellPfb","poolHandlerComp","DestroyPool","pool","_nodePoolData","GetCell","GetPool","PutCell","put","IdentityCellPool","loading","Skeleton","_state","refreshSpine","_BaseData","JmRoomData","_roomData","initRoomData","roomData","updateRoomData","updateRoomProperty","k","v","getIdentities","getIdentity","getRoomNum","getSeats","BaseData","JmRoomDataMgr","OnReceiveServerData","serverData","InitRoomsData","len","InitRoomData","roomKey","GetRoom","CreateRoom","InitCurrentRoom","CleanRooms","_offset","_roomsData","_roomCfg","_roomsKeys","_gameState","CleanRoom","room","GetOffSet","GetRoomByRoomKey","GetRoomNum","_currentRoomKey","GetRoomIdentities","GetRoomIdentity","GetRoomSeats","InitCurrentRoomProto","_roomCount","_currentRoomData","_joinRoomsList","unshift","JSON","stringify","_isOwner","GetCurrentRoomInfo","GetCurrentRoomKey","SetCurrentNullRoomKey","SetRoomDayOrNight","currentType","GetRoomDayOrNight","delRoomCfg","setRoomCfg","vule","getRoomCfg","getRoomCount","setRoomCount","setGameState","getGameState","setGameDay","bol","_isDay","getGameDay","setOwner","isOwner","getLoadKey","_loadKey","setLoadKey","REGEX","Command","command","cache","Loader","assetMap","loadingMap","preload","params","preloadDir","version","asset","_extends","addRef","decRef","loadAsync","Promise","resolve","loadDir","results","assets","loadDirAsync","loadRemote","loadRemoteAsync","onFail","onSuccess","imageAsset","createWithImage","releaseAll","assetList","LoaderManager","handle","_this7","res","Texture2D","TextureCube","SceneAsset","_this8","_this9","_ref3","_assetManager$getBund","_bundle","Asset","ctor","releaseUnused","_assetManager$getBund2","releaseUnusedAssets","_ref4","loadBundleAsync","_this11","removeBundle","b","reloadBundle","_ref5","_assetManager$cacheMa","_this12","baseUrl","configUrl","test","downloader","remoteServerAddress","cacheManager","removeCache","ab","AssetManager","Bundle","json","base","reloadBundleAsync","_this13","_ref6","_this14","_this15","empty","level","styleColor","title","titleColor","UIManager","defaultUI","autoFit","delay","begin","end","speed","blur","SoundManager","localStorage","setItem","getItem","parse","MusicName","EffectName","BundleName","musicMuteCacheKey","effectMuteCacheKey","musicVolumeScaleCacheKey","effectVolumeScaleCacheKey","defaultMusicVolume","defaultEffectVolume","audioCache","effectInterval","playingMusic","_setting$preload","AudioClip","EVENT_HIDE","EVENT_SHOW","bundleName","Function","_ref7","soundName","onPlay","setButtonEffect","opts","_ref8","_ref8$volume","_ref8$interval","interval","_ref9","_ref9$volume","_ref9$loop","_ref9$interval","isEffectMute","playEffectAsync","_playEffectAsync","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_context","prev","abrupt","_x","_ref10","_ref10$volume","_ref10$force","force","isMusicMute","playMusicAsync","_this$playingMusic$na","split","isCache","_this$playingMusic$na2","chars","getWeekUpdateTime","curDate","a","c","date1","date2","d","date","getFullYear","getMonth","getDate","round","valueOf","getDay","getDayUpdateTime","toLocaleDateString","Storage","_cache","secretKey","text","encrypted","charCode","charCodeAt","fromCharCode","encode","encryptedText","decrypted","decode","removeItem","setWeek","updateTime","getWeek","setDay","Sync","running","list","isRunning","isStop","timeout","ASync","Any","handles","async","execute","fun","retryMax","retryFinish","DailyTimer","time","startMs","endMs","checkDay","_time$split","startSegment","_time$split$","endSegment","_startSegment$split$m","map","part","parseInt","_startSegment$split$m2","startH","_startSegment$split$m3","startM","_startSegment$split$m4","startS","parseTimeToMs","_endSegment$split$map","_endSegment$split$map2","endH","_endSegment$split$map3","endM","_endSegment$split$map4","endS","getDayTimeMs","getHours","getMinutes","getSeconds","getMilliseconds","h","m","s","isInRange","currentMs","dateDay","IntervalTimer","elapsed","Timer","intervalTimer","dailyTimers","register","unregister","unregisterAll","registerDailyTrigger","unregisterDailyTrigger","unregisterAllDailyTrigger","TimerManager","timers","_proto4","UIScene","ViewTypes","ViewName","MiniViewName","stringCaseNegate","str","replace","searchStr","startIndex","UserInterface","toast","defaultData","currScene","currPage","currFocus","prefabCache","sceneCache","touchEnabled","touchMaskMap","showLoadingMap","uiLoadingMap","uiShowingMap","showQueue","getComponentsInChildren","Camera","camera","priority","far","near","addPersistRootNode","createTypeRoot","shadePre","loadingPre","toastPre","designResolution","SCREEN","windowSize","screen","resolutionPolicy","policy","autoFitResolutionPolicy","ResolutionPolicy","FIXED_HEIGHT","view","setResolutionPolicy","FIXED_WIDTH","schedule","equals","d2","layer","Layers","UI_2D","UIMgrZOrder","addTouchMaskListener","removeTouchMaskListener","getBaseView","components","find","getViewInParents","com","getViewInChildren","children","getUIClass","getClassByName","getUIPath","getUIPrefix","getUIParent","prefix","viewType","getUIInScene","multiple","getUIInShowing","_name","getNativeBundleName","uiName","oldBundleName","getResBundleName","initBundle","installUI","uiBundles","isScene","getSceneInfo","uninstallUI","resBundle","naBundle","nameOrCom","isShow","nodes","every","exclude","checkUIValid","View","valid","uiRoots","uiRoot","isCaptureFocus","isNeedShade","shadeSetting","assign","UIMgrShade","z","shadeIndex","getSiblingIndex","nodeIndex","parsingPrefab","_node$getComponent","updateAlignment","parsingScene","scene","addUILoadingUuid","loadingUuid","removeUILoadingUuid","createUI","_this10","showLoading","uiLoadingUuid","isSingleton","hideLoading","showToast","isInQueue","isLoading","putInShowQueue","queue","consumeShowQueue","ret","showUI","_params$top","_params$attr","_params$silent","LogicError","oldCom","runSceneImmediate","autoReleaseAssets","_params$silent2","InvalidError","showAsync","hideAll","_temp","_this16","_this$loading$getComp","_this17","UIMgrLoading","_this$loading$getComp2","addTouchMask","_this18","removeTouchMask","message","UIMgrToast","clearToast","targetOffUserInterface","_this$UserInterface","updateZOrder","screenshot","renderTexture","cameraList","sort","enabledInHierarchy","targetTexture","cameraFilter","cameraList2","pipeline","render","canvas","cameraComponent","ringScale","reverse","angleSpeed","ringSpeed","inited","drawing","timedown","angle","Graphics","onDraw","graphics","centerX","centerY","r","allPI","PI","arc","stroke","Size","UIOpacity","Material","blurFrame","sprite","customMaterial","flipUVY","cameras","EVENT_BEFORE_RENDER","_this2$blurFrame2","_this2$blurFrame","RenderTexture","reset","texture","blurMaterial","setProperty","shadeFrame","opacity","_this$blurFrame","_this$blurFrame2","uiOpacity","_delay","_begin","_end","_speed","lifeTime","outTime","squeezeSpeed","cell","UIMgrToastCell","tween","to","Tween","stopAllByTarget","recovery","zero","curr","lastMaxY","currMinY","addLen","last","currUT","lastUT","getVisibleSize","Overflow","RESIZE_HEIGHT","updateRenderData","unuse","zOrder","tempArr","checkUpdateZOrder","CHILD_ADDED","onChildAdded","CHILD_REMOVED","onChildRemoveed","CHILDREN_ORDER_CHANGED","SIBLING_ORDER_CHANGED","EVENT_AFTER_UPDATE","TRANSFORM_CHANGED"],"mappings":"8YAMaA,mBAAGC,GAOZ,SAAAD,IAAsB,OAClBC,EAAAC,iBAHH,OALWC,EAAAH,EAAAC,GASXG,EAAAJ,SAAAK,WAAAC,IAPD,WAEI,OADKC,KAAKC,QAAOD,KAAKC,MAAQ,IAAIR,GAC3BO,KAAKC,UACfR,GALoBS,IAAZT,EACQQ,MAAa,SAWrBE,UAAMV,EAAIW,MAYnBC,GAAaC,EAAKC,KAAKC,EAAKC,qBAAqB,eACjDC,GAAaP,EAAII,KAAKd,EAAIkB,UAAUC,wBAAwB,iBAC/DC,IAAAC;;6bC7BD,IAAQC,EAAsBC,EAAtBD,QAASE,EAAaD,EAAbC,sBAGGC,EADnBH,EAAQ,WAAUI,EAIdF,EAASG,GAAOF,GAHmBG,EAAAC,GAGnBC,WAAAC,GAAA,SAAAC,IAAA,IAAA,IAAAC,EAAAC,EAAAC,UAAAC,OAAAC,MAAAC,MAAAJ,GAAAK,IAAAA,EAAAL,EAAAK,IAAAF,EAAAE,GAAAJ,UAAAI,GADjB,OACiBN,EAAAF,EAAA7B,KAAAsC,MAAAT,SAAAU,OAAAJ,UADjBK,EAAAT,OAAAL,EAAAe,EAAAV,IAAAA,EACiB9B,EAAA6B,EAAAD,GADjB,IAAAa,EAAAZ,EAAAa,UAuDC,OAjCDD,EAEAE,OAAA,aA0BCF,EAEDG,SAAA,aAGCf,GAzDwBgB,IAAWH,gBAAAnB,IAAAuB,gBAAAC,cAAAC,YAAAC,mBAGnBC,EAHmBvB,KAAAuB,MA0DvCjC,IAAAC;;sTCtCG,SAAAiC,IAAc/C,KAvBNgD,OAAS,EAAChD,KACViD,YAAc,EAACjD,KACfkD,MAAO,EAAKlD,KACZmD,cAA0B,KAAInD,KAC9BoD,gBAA4B,KAAIpD,KAEhCqD,UAAW,EAAKrD,KAQhBsD,SAAU,EAAKtD,KAQfuD,YAA2B,KAE/B,IAAMC,EAAO,IAAIC,EAAK,SACtBzD,KAAKuD,YAAcC,EAAKE,aAAaC,GACrCH,EAAKI,GAAGD,EAAYhD,UAAUkD,MAAO7D,KAAK8D,aAAc9D,MACxDwD,EAAKI,GAAGD,EAAYhD,UAAUoD,QAAS/D,KAAKgE,eAAgBhE,MAC/D,IAAAqC,EAAAU,EAAAT,UARA,OAQAD,EAEOyB,aAAR,WACI,GAAI9D,KAAKmD,cAAe,CACpB,IAAMA,EAAgBnD,KAAKmD,cAC3BnD,KAAKmD,cAAgB,KACrBA,MAEPd,EAEO2B,eAAR,WACI,GAAIhE,KAAKoD,gBAAiB,CACtB,IAAMA,EAAkBpD,KAAKoD,gBAC7BpD,KAAKoD,gBAAkB,KACvBA,MAEPf,EAED4B,KAAA,SAAKC,EAAiBC,EAA0BC,GAO5C,gBAPkBD,IAAAA,EAAoB,eAAMC,IAAAA,EAAsB,MAClEpE,KAAKuD,YAAYW,KAAOA,EACxBlE,KAAKmD,cAAgBgB,EACrBnE,KAAKoD,gBAAkBgB,EACvBpE,KAAKuD,YAAYU,OACjBjE,KAAKqE,SAAU,EACfrE,KAAKsE,QAAS,EACPtE,MACVqC,EAEDkC,KAAA,WAKI,OAJAvE,KAAKqE,SAAU,EACfrE,KAAKsE,QAAS,EACdtE,KAAKuD,YAAYgB,OACjBvE,KAAKuD,YAAYC,KAAKgB,KAAKb,EAAYhD,UAAUkD,OAC1C7D,MACVqC,EAEDoC,MAAA,WACI,OAAKzE,KAAKqE,SAEVrE,KAAKsE,QAAS,EACdtE,KAAKuD,YAAYkB,QACVzE,MAJmBA,MAK7BqC,EAEDqC,OAAA,WACI,OAAK1E,KAAKqE,SACLrE,KAAKsE,QAEVtE,KAAKsE,QAAS,EACdtE,KAAKuD,YAAYU,OACVjE,MALmBA,MAM7BqC,EAEDsC,UAAA,SAAU3B,EAAY4B,GAIlB,gBAJM5B,IAAAA,EAAS,GACfhD,KAAKgD,OAASA,EACO,iBAAV4B,IAAoB5E,KAAKiD,YAAc2B,GAClD5E,KAAKuD,YAAYP,OAASA,EAAShD,KAAKiD,aAAejD,KAAKkD,KAAO,EAAI,GAChElD,MACVqC,EAEDwC,UAAA,WACI,OAAO7E,KAAKgD,QACfX,EAEDyC,eAAA,SAAeF,GAGX,gBAHWA,IAAAA,EAAQ,GACnB5E,KAAKiD,YAAc2B,EACnB5E,KAAKuD,YAAYP,OAAShD,KAAKgD,OAAS4B,GAAS5E,KAAKkD,KAAO,EAAI,GAC1DlD,MACVqC,EAED0C,eAAA,WACI,OAAO/E,KAAKiD,aACfZ,EAED2C,QAAA,SAAQC,GAEJ,OADAjF,KAAKuD,YAAY0B,KAAOA,EACjBjF,MACVqC,EAED6C,QAAA,WACI,OAAOlF,KAAKuD,YAAY0B,MAC3B5C,EAED8C,QAAA,SAAQjC,GAGJ,gBAHIA,IAAAA,GAAO,GACXlD,KAAKkD,KAAOA,EACZlD,KAAK2E,UAAU3E,KAAKgD,QACbhD,MACVqC,EAED+C,QAAA,WACI,OAAOpF,KAAKkD,MACfb,EAED8B,QAAA,SAAQhB,GAEJ,OADAnD,KAAKmD,cAAgBA,EACdnD,MACVqC,EAEDgD,MAAA,WAaI,OAZArF,KAAKgD,OAAS,EACdhD,KAAKiD,YAAc,EACnBjD,KAAKkD,MAAO,EACZlD,KAAKsE,QAAS,EACdtE,KAAKmD,cAAgB,KACrBnD,KAAKoD,gBAAkB,KACnBpD,KAAKuD,cACLvD,KAAKuD,YAAYgB,OACjBvE,KAAKuD,YAAYP,OAAS,EAC1BhD,KAAKuD,YAAYW,KAAO,KACxBlE,KAAKuD,YAAY0B,MAAO,GAErBjF,MACVqC,EAEDiD,QAAA,WACItF,KAAKqF,QACLrF,KAAKuD,YAAY+B,UACjBtF,KAAKuD,YAAYC,KAAK8B,UACtBtF,KAAKuD,YAAc,MACtB1D,EAAAkD,IAAAjD,cAAAC,IA5ID,WACI,OAAOC,KAAKqD,UACfkC,IACD,SAAoBC,GAChBxF,KAAKqD,SAAWmC,KACnB1F,aAAAC,IAGD,WACI,OAAOC,KAAKsD,SACfiC,IACD,SAAmBC,GACfxF,KAAKsD,QAAUkC,MAClBzC,QArBqBlC,IAAAC;;oVCQtB,SAAA2E,IAEAzF,KACQ0F,QAAU,EAAC1F,KACX2F,iBAA0C,IAAIC,IAAK5F,KACnD6F,UAAgC,IAAID,IAAK5F,KACzC8F,MAAe,KAAI9F,KAEnB+F,WAAY,EAAK/F,KACjBgG,iBAAmB,EAAChG,KAEpBiG,YAAa,EAAKjG,KAClBkG,kBAAoB,EAZH,IAAA7D,EAAAoD,EAAAnD,UADxB,OAiBDD,EACA8D,WAAA,SAAWC,EAAsBpD,EAAYiC,EAAcb,EAA4CD,GAA0B,IAAAzC,gBAAhGsB,IAAAA,EAAS,YAAGiC,IAAAA,GAAO,YAAOb,IAAAA,EAAsC,eAAMD,IAAAA,EAAoB,MACnHnE,KAAK0F,QAAU,MAAQ1F,KAAK0F,QAAU,GAE1C,IAAMA,EAAU1F,KAAK0F,UACfW,EAAQC,EAAalG,KAAKmG,WAmBhC,OAlBAvG,KAAK6F,UAAUN,IAAIG,EAASW,GACxBlC,GAASnE,KAAK2F,iBAAiBJ,IAAIG,EAASvB,GAEhDkC,EAAMrB,QAAQC,GACTE,QAAQnF,KAAKiG,YACbtB,UAAU3B,EAAQhD,KAAKkG,mBACvBjC,KAAKmC,GAAW,WACbE,EAAalG,KAAKoG,SAASH,GAC3B3E,EAAKmE,iBAAiBH,GACtB,IAAMe,EAAW/E,EAAKiE,iBAAiB5F,IAAI2F,GACvCe,IACA/E,EAAKiE,wBAAwBD,GAC7Be,QAEL,WACCrC,GAAaA,EAAUsB,MAGxBA,GACVrD,EAEDqE,WAAA,SAAWC,GAAY,IAAAC,EACnB,eAAQA,EAAC5G,KAAK6F,UAAU9F,IAAI4G,MAAnBC,EAAwBrC,SACpClC,EAEDwE,eAAA,WACI7G,KAAK6F,UAAUiB,SAAQ,SAACT,GACpBA,EAAM9B,WAEblC,EAED0E,YAAA,SAAYJ,GAAY,IAAAK,EACpB,eAAQA,EAAChH,KAAK6F,UAAU9F,IAAI4G,MAAnBK,EAAwBvC,UACpCpC,EAED4E,gBAAA,WACIjH,KAAK6F,UAAUiB,SAAQ,SAACT,GACpBA,EAAM5B,YAEbpC,EAED6E,aAAA,SAAaP,GAAY,IAAAQ,EACrB,eAAQA,EAACnH,KAAK6F,UAAU9F,IAAI4G,MAAnBQ,EAAwBzC,WACpCrC,EAED+E,iBAAA,WACIpH,KAAK6F,UAAUiB,SAAQ,SAACT,GACpBA,EAAM3B,aAEbrC,EAEDgF,cAAA,SAAcV,EAAYzD,GAAe,IAAAoE,EACrC,eAAQA,EAACtH,KAAK6F,UAAU9F,IAAI4G,MAAnBW,EAAwBnC,QAAQjC,KAC5Cb,EAEDkF,cAAA,SAAcZ,GAAY,IAAAa,EACtB,eAAQA,EAACxH,KAAK6F,UAAU9F,IAAI4G,MAAnBa,EAAwBpC,YACpC/C,EAEDoF,gBAAA,SAAgBd,EAAY3D,GAAgB,IAAA0E,EACxC,eAAQA,EAAC1H,KAAK6F,UAAU9F,IAAI4G,MAAnBe,EAAwB/C,UAAU3B,KAC9CX,EAEDsF,gBAAA,SAAgBhB,GAAY,IAAAiB,EACxB,cAAOA,OAAK/B,UAAU9F,IAAI4G,WAAnBiB,EAAwB/C,cAAe,GACjDxC,EAEDwF,oBAAA,SAAoB7E,GAChBhD,KAAK6F,UAAUiB,SAAQ,SAACT,GACpBA,EAAM1B,UAAU3B,OAEvBX,EAEDyF,qBAAA,SAAqBnB,EAAY3D,GAAgB,IAAA+E,EAC7C,eAAQA,EAAC/H,KAAK6F,UAAU9F,IAAI4G,MAAnBoB,EAAwBjD,eAAe9B,KACnDX,EAED2F,qBAAA,SAAqBrB,GAAY,IAAAsB,EAC7B,cAAOA,OAAKpC,UAAU9F,IAAI4G,WAAnBsB,EAAwBlD,mBAAoB,GACtD1C,EAED6F,4BAAA,SAA4BtD,GACxB5E,KAAKkG,kBAAoBtB,EACzB5E,KAAK6F,UAAUiB,SAAQ,SAACT,GACpBA,EAAMvB,eAAeF,OAE5BvC,EAED8F,4BAAA,WACI,OAAOnI,KAAKkG,mBACf7D,EAED+F,qBAAA,SAAqBlF,GACjBlD,KAAKiG,WAAa/C,EAClBlD,KAAK6F,UAAUiB,SAAQ,SAACT,GACpBA,EAAMlB,QAAQjC,OAErBb,EAEDgG,qBAAA,WACI,OAAOrI,KAAKiG,YAKhB5D,EACAiG,UAAA,SAAUlC,EAAsBpD,EAAYoB,GAUxC,gBAV4BpB,IAAAA,EAAS,YAAGoB,IAAAA,EAAsB,MAC9DpE,KAAKuI,YAELvI,KAAK8F,MAAQQ,EAAalG,KAAKmG,WAC/BvG,KAAK8F,MACAd,SAAQ,GACRG,QAAQnF,KAAK+F,WACbpB,UAAU3B,EAAQhD,KAAKgG,kBACvB/B,KAAKmC,EAAW,KAAMhC,GAEpB,GACV/B,EAEDkG,UAAA,WACI,QAAKvI,KAAK8F,QACV9F,KAAK8F,MAAMR,UACXtF,KAAK8F,MAAQ,MACN,IACVzD,EAEDmG,WAAA,WACI,QAAKxI,KAAK8F,QACV9F,KAAK8F,MAAMrB,SACJ,IACVpC,EAEDoG,YAAA,WACI,QAAKzI,KAAK8F,QACV9F,KAAK8F,MAAMpB,UACJ,IACVrC,EAEDqG,eAAA,SAAe1F,GACX,QAAKhD,KAAK8F,QACV9F,KAAK8F,MAAMnB,UAAU3B,IACd,IACVX,EAEDsG,eAAA,WACI,OAAK3I,KAAK8F,MACH9F,KAAK8F,MAAMjB,aADO,GAE5BxC,EAEDuG,oBAAA,SAAoBhE,GAAe,IAAAiE,EAG/B,OAFA7I,KAAKgG,iBAAmBpB,SACxBiE,OAAK/C,QAAL+C,EAAY/D,eAAeF,IACpB,GACVvC,EAEDyG,oBAAA,WACI,OAAO9I,KAAKgG,kBACf3D,EAED0G,aAAA,SAAa7F,GAAe,IAAA8F,EAGxB,OAFAhJ,KAAK+F,UAAY7C,SACjB8F,OAAKlD,QAALkD,EAAY7D,QAAQjC,IACb,GACVb,EAED4G,aAAA,WACI,OAAOjJ,KAAK+F,WAKhB1D,EACA6G,iBAAA,SAAiBxD,EAAiBe,GACX,IAAA0C,EAAnB,OAAgB,IAAZzD,WACQyD,EAACnJ,KAAK8F,SAALqD,EAAYhF,QAAQsC,MAEzBzG,KAAK6F,UAAUuD,IAAI1D,KACnB1F,KAAK2F,iBAAiBJ,IAAIG,EAASe,IAC5B,IAIlBpE,EAEDkC,KAAA,SAAKmB,GACD,OAAgB,IAAZA,EACO1F,KAAKuI,YAELvI,KAAK0G,WAAWhB,IAE9BrD,EAEDoC,MAAA,SAAMiB,GACF,OAAgB,IAAZA,EACO1F,KAAKwI,aAELxI,KAAK+G,YAAYrB,IAE/BrD,EAEDqC,OAAA,SAAOgB,GACH,OAAgB,IAAZA,EACO1F,KAAKyI,cAELzI,KAAKkH,aAAaxB,IAEhCrD,EAEDgH,SAAA,WACIrJ,KAAKwI,aACLxI,KAAKiH,mBACR5E,EAEDiH,UAAA,WACItJ,KAAKyI,cACLzI,KAAKoH,oBACR/E,EAEDkH,QAAA,WACIvJ,KAAKuI,YACLvI,KAAK6G,kBACRxE,EAEDsC,UAAA,SAAUe,EAAiB1C,GACvB,OAAgB,IAAZ0C,EACO1F,KAAK0I,eAAe1F,GAEpBhD,KAAKyH,gBAAgB/B,EAAS1C,IAE5CX,EAEDwC,UAAA,SAAUa,GACN,OAAgB,IAAZA,EACO1F,KAAK2I,iBAEL3I,KAAK2H,gBAAgBjC,IAEnCrD,EAEDyC,eAAA,SAAeY,EAAiBd,GAC5B,OAAgB,IAAZc,EACO1F,KAAK4I,oBAAoBhE,GAEzB5E,KAAK8H,qBAAqBpC,EAASd,IAEjDvC,EAED0C,eAAA,SAAeW,GACX,OAAgB,IAAZA,EACO1F,KAAK8I,sBAEL9I,KAAKgI,qBAAqBtC,IAExC7F,EAAA4F,SAAA3F,WAAAC,IAvRD,WAEI,OADKC,KAAKC,QAAOD,KAAKC,MAAQ,IAAIwF,GAC3BzF,KAAKC,UACfwF,MAJcxF,MAAqB,OADRY,IAAAC;;+UCI5B,SAAAwF,IAAsBtG,KAEdwJ,WAAsB,GAFL,IAAAnH,EAAAiE,EAAAhE,UADxB,OACwBD,EAIzBkE,SAAA,WACI,OAAIvG,KAAKwJ,WAAW3H,OACT7B,KAAKwJ,WAAW1I,MAEpB,IAAIiC,GACdV,EAEDmE,SAAA,SAASH,GACLA,EAAMhB,QACNrF,KAAKwJ,WAAWC,KAAKpD,IACxBxG,EAAAyG,SAAAxG,WAAAC,IAlBD,WAEI,OADKC,KAAKC,QAAOD,KAAKC,MAAQ,IAAIqG,GAC3BtG,KAAKC,UACfqG,MAJcrG,MAAsB,OADRY,IAAAC;;sgBCEjC,IAAQC,EAAYC,EAAZD,QAEF2I,EAAkB,YAClBC,EAAkB,YAClBC,EAAoB,cACpBC,EAAuB,iBACvBC,EAAoB,0BAGzB/I,EAAQ,cAAcG,CAAA4B,WAAAiH,GAqBnB,SAAAtH,IAAc,IAAAf,EAQT,OAPDA,EAAAqI,EAAApK,kBAVIqK,oBAAsB,EAACtI,EACvBuI,qBAAuB,EAACvI,EAKxBwI,cAAe,EAAKxI,EACpByI,gBAAiB,EAUpBzI,EA7Bc9B,EAAA6C,EAAAsH,GAgCnB,IAAA1H,EAAAI,EAAAH,UAhBC,OAgBDD,EAGU+H,UAAV,WAAsB,IAAAC,OACZC,EAAiBC,EAASC,cAAcC,EAASC,SAASC,OAAQ,kBACxEzK,EAAKE,KAAKwK,IAAIC,KAAKC,YAEdC,IAAI,CACD,SAACC,EAAMC,GAEH,IAAmD,IAA/CX,EAAeY,QAAQtB,GAA2B,OAAOoB,IAC7DG,EAAaC,WAAW,CAAEC,IAAKzB,GAAqB,CAAE0B,IAAK,UAAY,MAAM,SAACC,GAC1E,GAAIA,EAAK,OAAON,EAAM,IACtBD,QAGR,SAACA,EAAMC,GAEH,IAAsD,IAAlDX,EAAeY,QAAQrB,GAA8B,OAAOmB,IAChEG,EAAaC,WAAW,CAAEC,IAAKxB,GAAwB,CAAEyB,IAAK,UAAY,MAAM,SAACC,GAC7E,GAAIA,EAAK,OAAON,EAAM,IACtBD,QAGR,SAACA,EAAMC,GAEH,IAAiD,IAA7CX,EAAeY,QAAQvB,GAAyB,OAAOqB,IAC3DG,EAAaC,WAAW,CAAEC,IAAK1B,GAAmB,CAAE2B,IAAK,UAAY,MAAM,SAACC,GACxE,GAAIA,EAAK,OAAON,EAAM,IACtBD,QAGR,SAACA,EAAMC,GAEH,IAAiD,IAA7CX,EAAeY,QAAQxB,GAAyB,OAAOsB,IAC3DG,EAAaC,WAAW,CAAEC,IAAK3B,GAAmB,CAAE4B,IAAK,UAAY,MAAM,SAACC,GACxE,GAAIA,EAAK,OAAON,EAAM,IACtBD,QAGR,SAACA,EAAMC,GAEH,IAAmD,IAA/CX,EAAeY,QAAQpB,GAA2B,OAAOkB,IAC7DG,EAAaC,WAAW,CAAEC,IAAKvB,GAAqB,CAAEwB,IAAK,UAAY,MAAM,SAACC,GAC1E,GAAIA,EAAK,OAAON,EAAM,IACtBD,UAKXD,KAAI,SAACC,EAAMC,GACR,IAAmD,IAA/CX,EAAeY,QAAQtB,GAA2B,OAAOoB,IAC7DG,EAAaK,WAAW5B,GAAmB,SAAC2B,GACxC,GAAIA,EAAK,OAAON,EAAM,IACtBD,UAIPD,KAAI,SAACC,EAAMC,GACR,IAAsD,IAAlDX,EAAeY,QAAQrB,GAA8B,OAAOmB,IAChEG,EAAaK,WAAW3B,GAAsB,SAAC0B,GAC3C,GAAIA,EAAK,OAAON,EAAM,IACtBD,UAIPD,KAAI,SAACC,EAAMC,GACR,IAAiD,IAA7CX,EAAeY,QAAQvB,GAAyB,OAAOqB,IAC3DG,EAAaK,WAAW7B,GAAiB,SAAC4B,GACtC,GAAIA,EAAK,OAAON,EAAM,IACtBD,UAIPD,KAAI,SAACC,EAAMC,GACR,IAAiD,IAA7CX,EAAeY,QAAQxB,GAAyB,OAAOsB,IAC3DG,EAAaK,WAAW9B,GAAiB,SAAC6B,GACtC,GAAIA,EAAK,OAAON,EAAM,IACtBD,UAIPD,KAAI,SAACC,EAAMC,GACR,IAAmD,IAA/CX,EAAeY,QAAQpB,GAA2B,OAAOkB,IAC7DG,EAAaK,WAAW1B,GAAmB,SAACyB,GACxC,GAAIA,EAAK,OAAON,EAAM,IACtBD,UAGPS,OAAM,WACHpB,EAAKH,cAAe,EACpBG,EAAKqB,WAAW,EAAGrB,EAAKsB,aAGxBC,EAAYC,KACRV,EAAaW,UAAUhC,IACvB,WACIO,EAAK0B,mBAET,WACI1B,EAAK2B,aACD3B,EAAK4B,gBAAkB5B,EAAKsB,aAEhCtB,EAAK6B,uBAMzB7J,EAGQ6J,cAAR,WAAwB,IAAAC,OACpB,IAAInM,KAAKmK,eAAT,CAIA,GAHAnK,KAAKmK,gBAAiB,EACtBjK,EAAKsE,KAAKtE,EAAKS,UAAUC,wBAErBV,EAAKE,KAAKgM,QAAQC,MAAMC,QAAQC,kBAAmB,CACnD,IAAMC,EAAoB,SAAUC,IAEK,IAAjCA,EAAEC,OAAyB,kBAC/BxM,EAAKE,KAAKuM,QAAQC,GAAGC,kBAAkBpJ,EAAK9C,UAAUmM,WAAW,SAAUC,GAClEA,EAAML,OAAOM,aAAaC,IAC/BC,YAAW,WACFC,EAAQjN,EAAKE,KAAKuM,QAAQS,QAE3BL,EAAMM,aAAeC,EAAWC,iBACpCrN,EAAKE,KAAKuM,QAAQS,MAAMZ,yBAE7B,MAAM,IAEPgB,EAAWP,EAAO3K,UAAUkL,SAClCP,EAAO3K,UAAUkL,SAAW,WACxBA,EAAS7N,KAAKK,MACdA,KAAKwD,KAAKI,GAAGH,EAAK9C,UAAU8M,YAAajB,IAE7C,IAAMkB,EAAYT,EAAO3K,UAAUoL,UACnCT,EAAO3K,UAAUoL,UAAY,WACzB1N,KAAKwD,KAAKmK,IAAIlK,EAAK9C,UAAU8M,YAAajB,GAC1CkB,EAAU/N,KAAKK,OAGvB,OAAOE,EAAKE,KAAKuM,QAAQC,GAAGgB,aAAY,WAIpC,GAFAzB,EAAK3J,WAEDtC,EAAKE,KAAKgM,QAAQC,MAAMC,QAAQuB,iBAAkB,CAClD,IAAMC,EAAU,SAAVA,IAAsB,IAAAC,OACnBZ,EAAQjN,EAAKE,KAAKuM,QAAQS,SAC3BlN,EAAKE,KAAKuM,QAAQS,MAAMY,iBAAmB9N,EAAKE,KAAKuM,QAAQS,MAAMa,cACnE/N,EAAKE,KAAKuM,QAAQS,MAAMc,aAAY,WAChChO,EAAKE,KAAKuM,QAAQC,GAAGuB,iBAAiB1K,EAAK9C,UAAU8M,YAAaK,EAASC,GAAM,MAGrF7N,EAAKE,KAAKuM,QAAQC,GAAGuB,iBAAiB1K,EAAK9C,UAAU8M,YAAaK,EAAS9N,MAAM,KAGzFE,EAAKE,KAAKuM,QAAQC,GAAGwB,gBAAgB3K,EAAK9C,UAAU8M,YAAaK,EAAS3B,GAAM,GAChFjM,EAAKE,KAAKuM,QAAQS,MAAMiB,kBAAiB,WACrCnO,EAAKE,KAAKuM,QAAQC,GAAGuB,iBAAiB1K,EAAK9C,UAAU8M,YAAaK,EAAS3B,GAAM,YAMjG9J,EAGQ0J,cAAR,WAEI/L,KAAKgK,qBAAuB,EAE5BhK,KAAK0L,WAAW1L,KAAKiM,gBAAiBjM,KAAK2L,cAG/CtJ,EAGUiM,SAAV,WACI,IAAItO,KAAKmK,eAAT,CAEA,IAAKnK,KAAKkK,aAKN,OAHAlK,KAAKiK,sBAAwB,OAE7BjK,KAAK0L,WAAW1L,KAAKiM,gBAAiBjM,KAAK2L,aAK/C3L,KAAKiK,sBAAwB,EAE7BjK,KAAK0L,WAAW1L,KAAKiM,gBAAiBjM,KAAK2L,aAGvC3L,KAAKiM,iBAAmBjM,KAAK2L,aAC7B3L,KAAKkM,kBAOb7J,EAGUoJ,MAAV,WAAyBzL,KAAKoK,aAE9B/H,EAGUkM,gBAAV,WAAsC,OAAO,GAE7ClM,EAGU2J,WAAV,WAA8B,OAAO,GAErC3J,EAKUqJ,WAAV,SAAqB8C,EAAmBC,GAAsB,OAAOD,EAAYC,GAEjFpM,EAGUG,SAAV,aAAwB3C,EAAA4C,IAAA3C,sBAAAC,IAlQxB,WACI,OAAO2O,KAAKC,IAAI,EAAG/C,EAAYgD,iBAAiBzD,EAAaW,UAAUhC,QAC1EhK,uBAAAC,IACD,WACI,OAAO2O,KAAKC,IAAI,EAAG3O,KAAKuO,sBAC3BzO,kBAAAC,IACD,WACI,OAAOC,KAAK6O,gBAAkB7O,KAAK8O,oBACtChP,sBAAAC,IAID,WACI,OAAOC,KAAKgK,oBAAsB0E,KAAKK,IAAI/O,KAAK8O,iBAAkB9O,KAAKiK,0BAC1ExH,GAf6CuM,KAASlM,KAAlBjC,IAAAC;;iPCwJ1B,SAA0FmO,GAAW,IAAAC,EAChH,OAAAA,WAAAC,GAAA,SAAAC,IAAA,OAAAD,EAAAlN,WAAAL,iBASK,OATLhC,EAAAwP,EAAAD,GAAAtP,EAAAuP,SAAAtP,WAAAC,IAII,WAII,OAHwB,OAApBC,KAAKqP,aACLrP,KAAKqP,WAAa,IAAIrP,MAEnBA,KAAKqP,eACfD,GAT4BE,IACfL,MAAQA,EAAKC,EAEZG,WAA0B,KAAIH,uEA1K/CK,EAKF,SAAmB9I,EAAoBiG,EAAwBnM,YAAxBmM,IAAAA,EAAkB,eAAMnM,IAAAA,GAAgB,GAAKP,KAJ7EyG,SAAqB,KAAIzG,KACzB0M,OAAkB,KAAI1M,KACtBO,MAAO,EAGVP,KAAKyG,SAAWA,EAChBzG,KAAK0M,OAASA,EACd1M,KAAKO,KAAOA,GAOdiP,aAAY,SAAAA,IAAAxP,KACNyP,UAA4B,GAAE,IAAApN,EAAAmN,EAAAlN,UAyDrC,OAzDqCD,EAE/BqN,KAAP,WACI,OAAO1P,KAAKyP,UAAU5N,QACzBQ,EAEM0I,IAAP,SAAWtE,EAAoBiG,EAAwBnM,YAAxBmM,IAAAA,EAAkB,eAAMnM,IAAAA,GAAgB,GACnEP,KAAKyP,UAAUhG,KAAK,IAAI8F,EAAa9I,EAAUiG,EAAQnM,KAC1D8B,EAEMmC,KAAP,SAAY1C,GACR,IAAK,IAAI6N,EAAQ,EAAGA,EAAQ3P,KAAKyP,UAAU5N,OAAQ8N,IAAS,CACxD,IAAMC,EAAO5P,KAAKyP,UAAUE,GAExBC,EAAKrP,OACLP,KAAKyP,UAAUI,OAAOF,EAAO,KAC3BA,GAEFC,EAAKnJ,UACLmJ,EAAKnJ,SAASxE,MAAM2N,EAAKlD,OAAQ5K,KAG5CO,EAEM1C,KAAP,SAAYmC,GACR,GAA8B,IAA1B9B,KAAKyP,UAAU5N,OAAnB,CACA,IAAM+N,EAAO5P,KAAKyP,UAAU,GAI5B,GADIG,EAAKrP,MAAMP,KAAKyP,UAAUI,OAAO,EAAG,GACnCD,EAAKnJ,SAEV,OAAOmJ,EAAKnJ,SAASxE,MAAM2N,EAAKlD,OAAQ5K,KAC3CO,EAEMyN,OAAP,SAAcrJ,EAAoBiG,YAAAA,IAAAA,EAAkB,MAChD,IAAK,IAAIiD,EAAQ3P,KAAKyP,UAAU5N,OAAS,EAAG8N,GAAS,EAAGA,IAAS,CAC7D,IAAMC,EAAO5P,KAAKyP,UAAUE,GACxBC,EAAKnJ,WAAaA,GAAYmJ,EAAKlD,SAAWA,GAClD1M,KAAKyP,UAAUI,OAAOF,EAAO,KAEpCtN,EAEM0N,iBAAP,SAAwBtJ,GACpB,IAAK,IAAIkJ,EAAQ3P,KAAKyP,UAAU5N,OAAS,EAAG8N,GAAS,EAAGA,IAAS,CAChD3P,KAAKyP,UAAUE,GACnBlJ,WAAaA,GACtBzG,KAAKyP,UAAUI,OAAOF,EAAO,KAEpCtN,EAEM2N,eAAP,SAAsBtD,GAClB,IAAK,IAAIiD,EAAQ3P,KAAKyP,UAAU5N,OAAS,EAAG8N,GAAS,EAAGA,IAAS,CAChD3P,KAAKyP,UAAUE,GACnBjD,SAAWA,GACpB1M,KAAKyP,UAAUI,OAAOF,EAAO,KAEpCH,KAGCS,aAAY,SAAAA,IAAAjQ,KACNkQ,UAA+C,GAAE,IAAAC,EAAAF,EAAA3N,UA0CxD,OA1CwD6N,EAElDvM,GAAP,SAAUmJ,EAAwBqD,EAA8B1D,GACvDK,EAAMsD,YAAeD,IACrBpQ,KAAKkQ,UAAUnD,KAAQ/M,KAAKkQ,UAAUnD,GAAS,IAAIyC,GACxDxP,KAAKkQ,UAAUnD,GAAOhC,IAAIqF,EAAI1D,KACjCyD,EAEM5P,KAAP,SAAYwM,EAAwBqD,EAA8B1D,GACzDK,EAAMsD,YAAeD,IACrBpQ,KAAKkQ,UAAUnD,KAAQ/M,KAAKkQ,UAAUnD,GAAS,IAAIyC,GACxDxP,KAAKkQ,UAAUnD,GAAOhC,IAAIqF,EAAI1D,GAAQ,KACzCyD,EAEMxC,IAAP,SAAWZ,EAAwBqD,EAA8B1D,GACxDK,EAAMsD,YAAeD,GACrBpQ,KAAKkQ,UAAUnD,IAEpB/M,KAAKkQ,UAAUnD,GAAO+C,OAAOM,EAAI1D,IACpCyD,EAEMG,UAAP,SAAiB5D,GACb,GAAKA,EAEL,IAAK,IAAM5M,KAAOE,KAAKkQ,UAAW,CAC9B,GAAIK,OAAOjO,UAAUkO,eAAe7Q,KAAKK,KAAKkQ,UAAWpQ,GACrCE,KAAKkQ,UAAUpQ,GACvBkQ,eAAetD,KAGlCyD,EAEM3L,KAAP,SAAYuI,EAAwBjL,GAC3BiL,EAAMsD,YACNrQ,KAAKkQ,UAAUnD,IACpB/M,KAAKkQ,UAAUnD,GAAOvI,KAAK1C,IAC9BqO,EAEMxQ,KAAP,SAAYoN,EAAwBjL,GAChC,GAAKiL,EAAMsD,YACNrQ,KAAKkQ,UAAUnD,GACpB,OAAO/M,KAAKkQ,UAAUnD,GAAOpN,KAAKmC,IACrCmO,KAWCX,aAAgB,SAAAA,IAClBtP,KACQyM,SAAKzM,KACLyQ,SACRzQ,KAEQ+M,MAAQ,IAAIkD,EAAc,IAAAS,EAAApB,EAAAhN,UAwBjC,OAxBiCoO,EAExB/Q,KAAV,SAA4CG,GAAwD,QAAA6B,EAAAC,UAAAC,OAA1CC,MAAIC,MAAAJ,IAAAA,OAAAK,IAAAA,EAAAL,EAAAK,IAAJF,EAAIE,KAAAJ,UAAAI,GAC1D,OAAOhC,KAAK+M,MAAMpN,KAAKA,KAAKK,KAAK+M,MAAOjN,EAAKgC,IAChD4O,EAESlM,KAAV,SAA4C1E,GAA4C,QAAA6Q,EAAA/O,UAAAC,OAA9BC,MAAIC,MAAA4O,IAAAA,OAAAC,IAAAA,EAAAD,EAAAC,IAAJ9O,EAAI8O,KAAAhP,UAAAgP,GAC1D,OAAO5Q,KAAK+M,MAAMvI,KAAK7E,KAAKK,KAAK+M,MAAOjN,EAAKgC,IAChD4O,EAEO9M,GAAR,WAAiC,QAAAiN,EAAAjP,UAAAC,OAAnBC,MAAIC,MAAA8O,GAAAC,IAAAA,EAAAD,EAAAC,IAAJhP,EAAIgP,GAAAlP,UAAAkP,GACd,OAAO9Q,KAAK+M,MAAMnJ,GAAG3B,MAAMjC,KAAK+M,MAAOjL,IAC1C4O,EAEOnQ,KAAR,WAAmC,QAAAwQ,EAAAnP,UAAAC,OAAnBC,MAAIC,MAAAgP,GAAAC,IAAAA,EAAAD,EAAAC,IAAJlP,EAAIkP,GAAApP,UAAAoP,GAChB,OAAOhR,KAAK+M,MAAMxM,KAAK0B,MAAMjC,KAAK+M,MAAOjL,IAC5C4O,EAEO/C,IAAR,WAAkC,QAAAsD,EAAArP,UAAAC,OAAnBC,MAAIC,MAAAkP,GAAAC,IAAAA,EAAAD,EAAAC,IAAJpP,EAAIoP,GAAAtP,UAAAsP,GACf,OAAOlR,KAAK+M,MAAMY,IAAI1L,MAAMjC,KAAK+M,MAAOjL,IAC3C4O,EAEOJ,UAAR,SAAkB5D,GACd,OAAO1M,KAAK+M,MAAMuD,UAAU3Q,KAAKK,KAAK+M,MAAOL,IAChD4C,OAkBJzO,IAAAC;;wTCKc,WAA4E,IAAAoO,EACvF,OAAAA,WAAAiC,GAqBI,SAAAC,IAAc,IAAA1P,EAE8B,OADxCA,EAAAyP,EAAAxR,iBACAyR,EAAe/B,WAAUjN,EAAAV,GAAeA,EAJ3C,OAnBL9B,EAAAwR,EAAAD,GAwBKtR,EAAAuR,SAAAtR,WAAAC,IAPD,WACI,OAAOC,KAAKqP,eACf+B,GAnB+BC,IAIlBpC,MAAmC,IAAIqC,MAAM,GAAW,CAClEvR,IAAK,SAAU2M,EAAQ5M,GACnB,OAAI4M,EAAO5M,GAAa4M,EAAO5M,IAC/B4M,EAAO5M,GAAOA,EACPA,MAEboP,EAEaG,WAA2B,KAAIH,sEAlMR,IAExCK,EAKF,SAAmB9I,EAAoBiG,EAAwBnM,YAAxBmM,IAAAA,EAAkB,eAAMnM,IAAAA,GAAgB,GAAKP,KAJ7EyG,SAAqB,KAAIzG,KACzB0M,OAAkB,KAAI1M,KACtBO,MAAO,EAGVP,KAAKyG,SAAWA,EAChBzG,KAAK0M,OAASA,EACd1M,KAAKO,KAAOA,GAOdiP,aAAY,SAAAA,IAAAxP,KACNyP,UAA4B,GAAE,IAAApN,EAAAmN,EAAAlN,UAyDrC,OAzDqCD,EAE/BqN,KAAP,WACI,OAAO1P,KAAKyP,UAAU5N,QACzBQ,EAEM0I,IAAP,SAAWtE,EAAoBiG,EAAwBnM,YAAxBmM,IAAAA,EAAkB,eAAMnM,IAAAA,GAAgB,GACnEP,KAAKyP,UAAUhG,KAAK,IAAI8F,EAAa9I,EAAUiG,EAAQnM,KAC1D8B,EAEMmC,KAAP,SAAY1C,GACR,IAAK,IAAI6N,EAAQ,EAAGA,EAAQ3P,KAAKyP,UAAU5N,OAAQ8N,IAAS,CACxD,IAAMC,EAAO5P,KAAKyP,UAAUE,GAExBC,EAAKrP,OACLP,KAAKyP,UAAUI,OAAOF,EAAO,KAC3BA,GAEFC,EAAKnJ,UACLmJ,EAAKnJ,SAASxE,MAAM2N,EAAKlD,OAAQ5K,KAG5CO,EAEM1C,KAAP,SAAYmC,GACR,GAA8B,IAA1B9B,KAAKyP,UAAU5N,OAAnB,CACA,IAAM+N,EAAO5P,KAAKyP,UAAU,GAI5B,GADIG,EAAKrP,MAAMP,KAAKyP,UAAUI,OAAO,EAAG,GACnCD,EAAKnJ,SAEV,OAAOmJ,EAAKnJ,SAASxE,MAAM2N,EAAKlD,OAAQ5K,KAC3CO,EAEMyN,OAAP,SAAcrJ,EAAoBiG,YAAAA,IAAAA,EAAkB,MAChD,IAAK,IAAIiD,EAAQ3P,KAAKyP,UAAU5N,OAAS,EAAG8N,GAAS,EAAGA,IAAS,CAC7D,IAAMC,EAAO5P,KAAKyP,UAAUE,GACxBC,EAAKnJ,WAAaA,GAAYmJ,EAAKlD,SAAWA,GAClD1M,KAAKyP,UAAUI,OAAOF,EAAO,KAEpCtN,EAEM0N,iBAAP,SAAwBtJ,GACpB,IAAK,IAAIkJ,EAAQ3P,KAAKyP,UAAU5N,OAAS,EAAG8N,GAAS,EAAGA,IAAS,CAChD3P,KAAKyP,UAAUE,GACnBlJ,WAAaA,GACtBzG,KAAKyP,UAAUI,OAAOF,EAAO,KAEpCtN,EAEM2N,eAAP,SAAsBtD,GAClB,IAAK,IAAIiD,EAAQ3P,KAAKyP,UAAU5N,OAAS,EAAG8N,GAAS,EAAGA,IAAS,CAChD3P,KAAKyP,UAAUE,GACnBjD,SAAWA,GACpB1M,KAAKyP,UAAUI,OAAOF,EAAO,KAEpCH,KAGCS,aAAY,SAAAA,IAAAjQ,KACNkQ,UAA+C,GAAE,IAAAC,EAAAF,EAAA3N,UA0CxD,OA1CwD6N,EAElDvM,GAAP,SAAUmJ,EAAwBqD,EAA8B1D,GACvDK,EAAMsD,YAAeD,IACrBpQ,KAAKkQ,UAAUnD,KAAQ/M,KAAKkQ,UAAUnD,GAAS,IAAIyC,GACxDxP,KAAKkQ,UAAUnD,GAAOhC,IAAIqF,EAAI1D,KACjCyD,EAEM5P,KAAP,SAAYwM,EAAwBqD,EAA8B1D,GACzDK,EAAMsD,YAAeD,IACrBpQ,KAAKkQ,UAAUnD,KAAQ/M,KAAKkQ,UAAUnD,GAAS,IAAIyC,GACxDxP,KAAKkQ,UAAUnD,GAAOhC,IAAIqF,EAAI1D,GAAQ,KACzCyD,EAEMxC,IAAP,SAAWZ,EAAwBqD,EAA8B1D,GACxDK,EAAMsD,YAAeD,GACrBpQ,KAAKkQ,UAAUnD,IAEpB/M,KAAKkQ,UAAUnD,GAAO+C,OAAOM,EAAI1D,IACpCyD,EAEMG,UAAP,SAAiB5D,GACb,GAAKA,EAEL,IAAK,IAAM5M,KAAOE,KAAKkQ,UAAW,CAC9B,GAAIK,OAAOjO,UAAUkO,eAAe7Q,KAAKK,KAAKkQ,UAAWpQ,GACrCE,KAAKkQ,UAAUpQ,GACvBkQ,eAAetD,KAGlCyD,EAEM3L,KAAP,SAAYuI,EAAwBjL,GAC3BiL,EAAMsD,YACNrQ,KAAKkQ,UAAUnD,IACpB/M,KAAKkQ,UAAUnD,GAAOvI,KAAK1C,IAC9BqO,EAEMxQ,KAAP,SAAYoN,EAAwBjL,GAChC,GAAKiL,EAAMsD,YACNrQ,KAAKkQ,UAAUnD,GACpB,OAAO/M,KAAKkQ,UAAUnD,GAAOpN,KAAKmC,IACrCmO,KAWCoB,aAAmB,SAAAA,IACrBrR,KACQyQ,SACRzQ,KAEQ+M,MAAQ,IAAIkD,EAAc,IAAAS,EAAAW,EAAA/O,UAyCjC,OAvCDoO,EACU/Q,KAAV,SAAkCG,GAAqD,QAAA6B,EAAAC,UAAAC,OAA1CC,MAAIC,MAAAJ,IAAAA,OAAAiP,IAAAA,EAAAjP,EAAAiP,IAAJ9O,EAAI8O,KAAAhP,UAAAgP,GAC7C,OAAO5Q,KAAK+M,MAAMpN,KAAKA,KAAKK,KAAK+M,MAAOjN,EAAKgC,IAGjD4O,EACUlM,KAAV,SAAkC1E,GAAyC,QAAA6Q,EAAA/O,UAAAC,OAA9BC,MAAIC,MAAA4O,IAAAA,OAAAG,IAAAA,EAAAH,EAAAG,IAAJhP,EAAIgP,KAAAlP,UAAAkP,GAC7C,OAAO9Q,KAAK+M,MAAMvI,KAAK7E,KAAKK,KAAK+M,MAAOjN,EAAKgC,IAChD4O,EAEO9M,GAAR,WAAiC,QAAAiN,EAAAjP,UAAAC,OAAnBC,MAAIC,MAAA8O,GAAAG,IAAAA,EAAAH,EAAAG,IAAJlP,EAAIkP,GAAApP,UAAAoP,GACd,OAAOhR,KAAK+M,MAAMnJ,GAAG3B,MAAMjC,KAAK+M,MAAOjL,IAC1C4O,EAEOnQ,KAAR,WAAmC,QAAAwQ,EAAAnP,UAAAC,OAAnBC,MAAIC,MAAAgP,GAAAG,IAAAA,EAAAH,EAAAG,IAAJpP,EAAIoP,GAAAtP,UAAAsP,GAChB,OAAOlR,KAAK+M,MAAMxM,KAAK0B,MAAMjC,KAAK+M,MAAOjL,IAC5C4O,EAEO/C,IAAR,WAAkC,QAAAsD,EAAArP,UAAAC,OAAnBC,MAAIC,MAAAkP,GAAAM,IAAAA,EAAAN,EAAAM,IAAJzP,EAAIyP,GAAA3P,UAAA2P,GACf,OAAOvR,KAAK+M,MAAMY,IAAI1L,MAAMjC,KAAK+M,MAAOjL,IAC3C4O,EAEOJ,UAAR,SAAkB5D,GACd,OAAO1M,KAAK+M,MAAMuD,UAAU3Q,KAAKK,KAAK+M,MAAOL,IAGjD7M,EAAAwR,IAAAvR,UAAAC,IACA,WACI,OAAOyR,EAAOC,OAAO,MAAO,cAA2DzR,KAAkB,YAAE0R,mBAG/G5R,WAAAC,IACA,WACI,OAAOyR,EAAOC,OAAO,OAAQ,cAA4DzR,KAAkB,YAAE0R,oBAGjH5R,YAAAC,IACA,WACI,OAAOyR,EAAOC,OAAO,QAAS,cAA6DzR,KAAkB,YAAE0R,sBAClHL,OA8BJxQ,IAAAC;;iNC7MG,WACI6Q,QAAQC,IAAI,sBAFS/Q,IAAAC;;sgBCC7B,IAAQC,EAAYC,EAAZD,QAKF8Q,EAAO,eAAA,SAAAC,IAAA9R,KACD2P,MAAQ,EAOf,OAPgBmC,EAAAxP,UAEVmP,OAAP,WAII,OAHIzR,KAAK2P,QAAU,MACf3P,KAAK2P,MAAQ,GAEPoC,KAAKC,UAAShS,KAAK2P,OAChCmC,MAOCG,GAJYT,EAAOC,OAAO,MAAO,UAAwC,wBAE5DD,EAAOC,OAAO,MAAO,UAAwC,wBAE9DD,EAAOC,OAAO,MAAO,UAAwC,yBAE7DD,EAAOC,OAAO,MAAO,UAAyC,yBAE7DD,EAAOC,OAAO,MAAO,UAAyC,qCAEhF1Q,EAAQ,cAAcG,CAAAK,WAAAwI,GAWnB,SAAA6B,IAAc,IAAAlK,EAWV,IAVAA,EAAAqI,EAAApK,kBATIuS,YAA2B,IAAIC,EAEvCzQ,EACQ0Q,mBAA6BC,EAAGC,aAAYlQ,EAAAV,IAgBhB,YAA5BA,EAAK0Q,oBAA0E,YAAtC1Q,EAAK0Q,mBAAmBG,OAAO,GAAkB,CAC1F,IAAMC,EAAc9Q,EAAK0Q,mBAAmBG,MAAM,GAAK,GACvDrS,EAAKE,KAAKgM,QAAQoG,GAAe9Q,EAAK+Q,YACtCvS,EAAKE,KAAKuM,QAAQ6F,EAAYE,qBAAoBtQ,EAAAV,GAKrD,OAAAA,EA9Bc9B,EAAAgM,EAAA7B,GAiCnB,IAAAoG,EAAAvE,EAAAtJ,UA6HC,OA7HD6N,EACAwC,cAAA,WACI,IAAMC,EAAS5S,KAAKwD,KAAKwJ,aAAa6F,IAAW7S,KAAKwD,KAAKE,aAAamP,GACxED,EAAOE,eAAgB,EACvBF,EAAOG,aAAc,EACrBH,EAAOI,cAAe,EACtBJ,EAAOK,YAAa,EACpBL,EAAOM,IAAM,EACbN,EAAOO,KAAO,EACdP,EAAOQ,MAAQ,EACfR,EAAOS,OAAS,EAChBT,EAAOU,UAAYT,EAAOU,UAAUC,kBAGxCrD,EAGUsD,SAAV,aAGAtD,EAGUuD,WAAV,aAGAvD,EAIUtE,KAAV,SAAe8H,GACXA,GAAUA,KACbxD,EAESyD,WAAV,WACI,OAAO/B,EAAKJ,UAgDhBtB,EAGO3L,KAAP,SAAYuI,GAAwC,IAAA,IAAA8G,EAAAlS,EAAAC,UAAAC,OAAbiS,MAAI/R,MAAAJ,IAAAA,OAAAK,IAAAA,EAAAL,EAAAK,IAAJ8R,EAAI9R,KAAAJ,UAAAI,IACvC6R,OAAK3B,aAAY1N,KAAIvC,MAAA4R,GAAC9G,GAAK7K,OAAY4R,KAG3C3D,EAGOvM,GAAP,SAAUmJ,EAAwBqD,EAA6B1D,GAC3D1M,KAAKkS,YAAYtO,GAAGmJ,EAAcqD,EAAI1D,IAG1CyD,EAGO5P,KAAP,SAAYwM,EAAwBqD,EAA6B1D,GAC7D1M,KAAKkS,YAAY3R,KAAKwM,EAAcqD,EAAI1D,IAG5CyD,EAGOxC,IAAP,SAAWZ,EAAwBqD,EAA8B1D,GAC7D1M,KAAKkS,YAAYvE,IAAIZ,EAAcqD,EAAI1D,IAG3CyD,EAGOG,UAAP,SAAiB5D,GACb1M,KAAKkS,YAAY5B,UAAU5D,IAY/Bd,EAIcgD,iBAAd,SAA+BmF,GAC3B,IAAIC,EAAQhU,KAAKiU,YAEjB,OAAKF,GAESA,EAAOG,eAAe,IAAKC,GAEnCrN,SAAQ,SAAUsN,GAChBA,EAAKC,KAAKC,SAAS,YACnBN,OAIDA,GAVaA,GAaxBpI,EAIc2I,iBAAd,SAA+BR,GAC3B,IAAMS,EAAoB,GAE1B,OAAKT,GAESA,EAAOG,eAAe,IAAKC,GAEnCrN,SAAQ,SAAUsN,GAChBA,EAAKC,KAAKC,SAAS,YACnBE,EAAQ/K,KAAK2K,EAAKC,SAInBG,GAVaA,GAaxB5I,EAIcC,KAAd,SACIkI,EACAU,EACAC,GACA,IAAMC,EAAO3U,KAAKuU,iBAAiBR,GAE7Ba,EAAaD,EAAK9S,OAAS7B,KAAKiU,YAClCY,EAAgB,EAEdnJ,EAAa,SAAUV,EAAgB2B,GAczC,OAAO,WACHA,EAAQ8G,WACRgB,GAAYA,IAAWI,EAAeD,GACtC5J,MAKF8J,EAA6B,GAE7BC,EAA4B,CAAC7U,EAAKE,KAAKuM,QAAQI,MAAO7M,EAAKE,KAAKuM,QAAQqI,MAAO9U,EAAKE,KAAKuM,QAAQsI,OAAQ/U,EAAKE,KAAKuM,QAAQC,GAAI1M,EAAKE,KAAKuM,QAAQS,OAGjJ8H,EAAiBhV,EAAKE,KAAKwK,IAAIC,KAAKsK,cAC1CJ,EAAWjO,SAAQ,SAAU6F,GACzBuI,EAAenK,KAAI,SAAUC,GACzB2B,EAAQd,KAAKH,EAAWV,EAAM2B,UAKtC,IAAMyI,EAAkBlV,EAAKE,KAAKwK,IAAIC,KAAKsK,cACrCE,EAAkBnV,EAAKE,KAAKuM,QAAQC,GAAG0I,KAAKC,eAjRlC,eAkRhBZ,EAAK7N,SAAQ,SAAUuE,GACnB+J,EAAgBrK,KAAI,SAAUC,EAAMC,GAqBhC8I,EAAOyB,KAAKnK,EAAK8I,GAAQ,SAAU5I,EAAKkK,GACpC,GAAIlK,IAAQkK,EACRxD,EAAUoC,EAAKqB,SAASrK,GAAM,SAC9BJ,EAAM,OACH,CACH,IAAMzH,EAAOmS,EAAYF,GACzBjS,EAAKoS,OAASP,EACd7R,EAAKqS,QAAS,EACdf,EAAYrL,KAAKjG,EAAKwJ,aAAapB,IACnCZ,cAMhB9K,EAAKE,KAAKwK,IAAIC,KAAKC,YACdC,IAAI,CACD,SAAAC,GAAI,OAAIkK,EAAezJ,MAAMT,IAC7B,SAAAA,GAAI,OAAIoK,EAAgB3J,MAAMT,MAEjCD,KAAI,SAAUC,GACX9K,EAAKsE,KAAKtE,EAAKS,UAAUmV,0BACzB9K,OAEHD,KAAI,SAAUC,GAEX,IAAM+K,EAAkB7V,EAAKE,KAAKwK,IAAIC,KAAKsK,cAC3CL,EAAYhO,SAAQ,SAAA6F,GAChBoJ,EAAgBhL,KAAI,SAAUC,GAC1B2B,EAAQd,KAAKH,EAAWV,EAAM2B,UAGtCoJ,EAAgBtK,MAAMT,MAEzBD,KAAI,SAAUC,GACX9K,EAAKsE,KAAKtE,EAAKS,UAAUqV,2BACzB9V,EAAKsE,KAAKtE,EAAKS,UAAUsV,sBACzBjL,OAEHD,KAAI,SAAUC,GAEX+J,EAAWjO,SAAQ,SAAU6F,GACzBA,EAAQ+G,gBAEZoB,EAAYhO,SAAQ,SAAU6F,GAC1BA,EAAQ+G,gBAEZ1I,OAEHS,OAAM,WACHvL,EAAKsE,KAAKtE,EAAKS,UAAUuV,wBACzBxB,GAAYA,EAASE,OAEhC/U,EAAA+L,IAAA9L,kBAAAC,IA9TD,WACI,OAAOC,KAAKoS,sBACftS,UAAAC,IA+DD,WASI,OAAOoW,OAAOxE,QAAQC,IAAIwE,KAAKD,OAAOxE,YAC9B3R,KAAKoS,gCAA8B,IAAIL,MAAOsE,yBAI1DvW,WAAAC,IACA,WASI,OAAOoW,OAAOxE,QAAQ2E,KAAKF,KAAKD,OAAOxE,YAC/B3R,KAAKoS,iCAA+B,IAAIL,MAAOsE,yBAI3DvW,YAAAC,IACA,WASI,OAAOoW,OAAOxE,QAAQ4E,MAAMH,KAAKD,OAAOxE,YAChC3R,KAAKoS,kCAAgC,IAAIL,MAAOsE,2BAE3DvW,kBAAAC,IA0CD,WACI,OAAO,MACV6L,GA7JoCoD,KAASzN,KAAlBV,IAAAC;;uMCMhCD,IAAAC;;yoBC9BA,IAAQC,EAAwCC,EAAxCD,QAASE,EAA+BD,EAA/BC,SAAUuV,EAAqBxV,EAArBwV,iBAErBC,EAAc,CAChBhT,EAAK9C,UAAU8M,YAAahK,EAAK9C,UAAU+V,WAAYjT,EAAK9C,UAAUmM,UAAWrJ,EAAK9C,UAAUgW,aAChGlT,EAAK9C,UAAUiW,WAAYnT,EAAK9C,UAAUkW,WAAYpT,EAAK9C,UAAUmW,SACrErT,EAAK9C,UAAUoW,YAAatT,EAAK9C,UAAUqW,YAAavT,EAAK9C,UAAUsW,aAGrEC,EAAYC,EAAK,CACnB7R,QAAS,EACTuQ,OAAQ,IA8CAuB,wBAAAA,GAAQ,OAARA,cAAAA,gBAAAA,sBAAAA,YAAAA,YAAAA,QA2CPC,WAAAA,GAAS,OAATA,EAAAA,6BAAAA,EAAAA,uBAAAA,EAAAA,qBAAAA,EAAAA,6BAAAA,EAAAA,qBAAAA,EAAAA,eAAAA,GAAAA,OASCC,EAAQ,CAAE3Q,GAAI,WAAY+K,KAAM,WAAY6F,cAAeC,EAAAA,EAAUC,MAAO,WAG5EC,EAA8C,IAAI9R,iBAI3B1E,EAF5BH,EAAQ,YAAWI,EACnBqV,IAAkBmB,EA4Gd1W,EAAS,CACN2W,MAAON,EACPO,KAAMX,EACNY,QAAS,kEACXC,EAgBD9W,EAAS,CACN2W,MAAON,EACPQ,QAAS,gEACXE,EAuBD/W,EAAS,CACN2W,MAAON,EACPQ,QAAS,2EACTG,mBACI,OAAIjY,KAAKkY,UAGfC,EAqBDlX,EAAS,CACN2W,MAAON,EACPQ,QAAS,WACTG,mBACI,OAAIjY,KAAKkY,SACLlY,KAAKoY,YAGfC,EA4BDpX,EAAS,CACN2W,MAAON,EACPQ,QAAS,gBACTG,mBACI,OAAIjY,KAAKkY,UAGfhX,EAAA4B,EAAA3B,IAAAmX,WAAAvO,GAAA,SAAAwO,IAAA,IAAA,IAAA7W,EAAAC,EAAAC,UAAAC,OAAAC,MAAAC,MAAAJ,GAAAK,IAAAA,EAAAL,EAAAK,IAAAF,EAAAE,GAAAJ,UAAAI,GAgBsC,OAhBtCN,EAAAqI,EAAApK,KAAAsC,MAAA8H,SAAA7H,OAAAJ,WAnKM0W,oBAAqB,EAC7B9W,EACQ+W,iBAAmBpB,EAAUqB,IACrChX,EACQiX,gBAA6CtG,EAAGC,aAAYlQ,EAAAV,IACpEA,EACQkX,oBAAqB,EAC7BlX,EACQmX,uBAAqC,GAC7CnX,EACQoX,gBAAsC,IAAIC,IAAK5W,EAAAT,eAAAL,EAAAe,EAAAV,IAAAS,EAAAT,eAAAsX,EAAA5W,EAAAV,IAAAS,EAAAT,kBAAAuX,EAAA7W,EAAAV,IAAAS,EAAAT,WAAAwX,EAAA9W,EAAAV,IAAAS,EAAAT,gBAAAyX,EAAA/W,EAAAV,IAsKvDA,EAGU0X,UAA4B,GAAE1X,EAhBtC9B,EAAA2Y,EAAAxO,GA/NFwO,EAGOc,YAAP,SAA+DC,GAC3D,gBAAAC,GAAA,SAAAF,IAAA,OAAAE,EAAAtX,WAAAL,iBAUK,OAVLhC,EAAAyZ,EAAAE,GAAA1Z,EAAAwZ,IAAAvZ,cAAAC,IACI,WAQI,OAAOuZ,EAAUA,EAAQlZ,KAAc,SAC1CiZ,GAV4Bd,IAcrCA,EAGOiB,eAAP,SAA6DC,GAAmC,IAAAC,EAEtFF,EADLhD,GAAkBmD,CAAAD,WAAAE,GAAA,SAAAJ,IAAA,OAAAI,EAAA3X,WAAAL,iBAId,OAJchC,EAAA4Z,EAAAI,GAAA/Z,EAAA2Z,IAAA1Z,iBAAAC,IAEf,WACI,OAAO0Z,EAAaA,EAAWrZ,KAAc,SAChDoZ,GAHwBjB,KAAQmB,EAKrC,OAAOF,GAGXjB,EAGcsB,YAAd,SAA0B7O,EAAgC8I,GAEtD9I,GAAQA,GAAK,IAChBuN,EAEaH,OAAd,SAAqB1G,GACjB,OAAuC,IAAhCA,EAAKxG,QAAQkM,EAAS0C,OAChCvB,EAEawB,QAAd,SAAsBrI,GAClB,OAAwC,IAAjCA,EAAKxG,QAAQkM,EAAS4C,QAChCzB,EAEa0B,WAAd,SAAyBvI,GACrB,OAA2C,IAApCA,EAAKxG,QAAQkM,EAAS8C,WAChC3B,EAEa4B,MAAd,SAAoBzI,GAChB,OAAsC,IAA/BA,EAAKxG,QAAQkM,EAASgD,MAChC7B,EAEa8B,MAAd,SAAoB3I,GAChB,OAAsC,IAA/BA,EAAKxG,QAAQkM,EAASkD,MAChC,IAAAjY,EAAAkW,EAAAjW,UAmvBA,OAnvBAD,EAeS+V,OAAV,WACI,OAAOG,EAASH,OAAOpY,KAAK2Y,kBAC/BtW,EAES0X,QAAV,WACI,OAAOxB,EAASwB,QAAQ/Z,KAAK2Y,kBAChCtW,EAES4X,WAAV,WACI,OAAO1B,EAAS0B,WAAWja,KAAK2Y,kBACnCtW,EAES8X,MAAV,WACI,OAAO5B,EAAS4B,MAAMna,KAAK2Y,kBAC9BtW,EAESgY,MAAV,WACI,OAAO9B,EAAS8B,MAAMra,KAAK2Y,kBAC9BtW,EAESkY,KAAV,WACI,OAAQva,KAAKkY,QAChB7V,EAES6V,KAAV,WACI,OAAIlY,KAAKwD,KAAKoS,kBAAkB4E,EACrBxa,KAAKwD,KAAKoS,OAAOlE,OAAS1R,KAAKya,SAE5BC,EAASC,WACVjJ,OAAS1R,KAAKya,UAgM/BpY,EAGUuY,eAAV,SAAyBlJ,GACrB,OAAO1R,KAAK8Y,gBAAgB1P,IAAIsI,IAGpCrP,EACAsQ,cAAA,aA6BAtQ,EAGUwY,gBAAV,SAA0BC,YAAAA,IAAAA,GAAmB,GACzC9a,KAAK4Y,qBAAuBkC,GAC/BzY,EAEO0Y,iBAAR,SAAyBhO,GACjB/M,KAAKgb,aACLjO,EAAMkO,oBAAqB,EACvBlO,EAAM8K,OAASpU,EAAK9C,UAAU8M,aAC9BzN,KAAK4R,IAAI,eAGpBvP,EAEO6Y,gBAAR,SAAwBnO,GACf/M,KAAK4Y,qBACN7L,EAAMkO,oBAAqB,EAC3BlO,EAAMoO,6BAA8B,EAChCpO,EAAM8K,OAASpU,EAAK9C,UAAU8M,aAC9BzN,KAAK4R,IAAI,UAGpBvP,EAEO+Y,iBAAR,WAAgC,IAAA/Q,OAC5B,IAAIrK,KAAKkY,OAAT,CACA,IAAMmD,EAAcrb,KAAKgN,aAAasO,GAClCD,IAAaA,EAAYE,QAAU,WACnC,GAAIlR,EAAK2Q,WAAY,CAAA,QAAArK,EAAA/O,UAAAC,OADkBC,MAAIC,MAAA4O,GAAAC,IAAAA,EAAAD,EAAAC,IAAJ9O,EAAI8O,GAAAhP,UAAAgP,GAEvC,OAAO0K,EAAYhZ,UAAUiZ,QAAQtZ,MAAMoZ,EAAavZ,GAE5D,OAAO,IAGX,IAAK,IAAI0Z,EAAI,EAAGA,EAAI/E,EAAY5U,OAAQ2Z,IACpCxb,KAAKwD,KAAKI,GAAG6S,EAAY+E,GAAIxb,KAAK+a,iBAAkB/a,MACpDA,KAAKwD,KAAKI,GAAG6S,EAAY+E,GAAIxb,KAAKkb,gBAAiBlb,MAAM,KAIjEqC,EAGUoZ,iBAAV,SAA2B3H,GACvB9T,KAAK8Y,gBAAgBhS,SAAQ,SAAC4K,GAC1BxR,EAAKE,KAAKuM,QAAQC,GAAG8O,KAAK,CAAEhK,KAAAA,EAAMoC,KAAAA,OAEtC9T,KAAK8Y,gBAAgBzT,SAGzBhD,EAGUsZ,cAAV,SAAAC,GAAgF,IAAAzP,OAAtD2H,EAAI8H,EAAJ9H,KAAM+H,EAAKD,EAALC,MACE,IAA1B7b,KAAKoZ,UAAUvX,QACE,IAAjBga,EAAMha,SAEVga,EAAM/U,SAAQ,SAAA4K,IAC4B,IAAlCvF,EAAKiN,UAAUlO,QAAQwG,GAMtBvF,EAAK2M,gBAAgB1P,IAAIsI,IAE9BxR,EAAKE,KAAKuM,QAAQC,GAAG8O,KAAK,CAAEhK,KAAAA,EAAMoC,KAAAA,IAP9B3H,EAAKmK,KAAK,gBAAoB5E,0BAUtCxR,EAAKE,KAAKuM,QAAQC,GAAGkP,kBAAkB,WAG3CzZ,EAGU0Z,cAAV,SAAAC,GAWG,IAAAjO,OAXuB+F,EAAIkI,EAAJlI,KAAM+H,EAAKG,EAALH,MAAOI,EAAMD,EAANC,OAAQC,EAAMF,EAANE,OAAQ1Z,EAAQwZ,EAARxZ,SAYnD,GAAqB,IAAjBqZ,EAAMha,OAAc,OAAO,EAC/B,GAAI7B,KAAKmc,WAAa/E,EAAS0C,KAE3B,OADA9Z,KAAKsW,KAAK,gBAAiB,cACpB,EAKX,IAFA,IAAMzL,EAAO3K,EAAKE,KAAKwK,IAAIC,KAAKuR,aAAaC,aAGzC,IAAMC,EAAQT,EAAMlM,GAChB2M,aAAiBva,MACjB8I,EAAKE,KAAI,SAAAC,GACL+C,EAAKwO,uBAAuBD,EAAOxI,EAAMmI,EAAQC,GAAQzQ,MAAMT,MAGnEH,EAAKE,KAAI,SAAAC,GACL+C,EAAKwO,uBAAuB,CAACD,GAAQxI,EAAMmI,EAAQC,GAAQzQ,MAAMT,OARpE2E,EAAQ,EAAGA,EAAQkM,EAAMha,OAAQ8N,IAAO0M,IAiBjD,OAJAxR,EAAKY,MAAMjJ,GAAY,WACnBA,OAGG,GAGXH,EAGQka,uBAAR,SAA+BV,EAA4B/H,EAAYmI,EAAsBC,GAAsB,IAAAM,gBAApFX,IAAAA,EAAwB,IACnD,IAAMhR,EAAO3K,EAAKE,KAAKwK,IAAIC,KAAKuR,aAEhC,OAAIpc,KAAKmc,WAAa/E,EAAS0C,MAC3B9Z,KAAKsW,KAAK,gBAAiB,aACpBzL,IAyBU,KAtBrBgR,EAAQA,EAAMY,QAAO,SAAA/K,GACjB,OAAKA,EAID8K,EAAK1D,gBAAgB1P,IAAIsI,IACzB8K,EAAKlG,KAAK,uBAAwB5E,YAC3B,IAE2B,IAAlC8K,EAAKpD,UAAUlO,QAAQwG,IACvB8K,EAAKlG,KAAK,gBAAoB5E,wBACvB,GAEPA,EAAKxG,QAAQsR,EAAKE,YAActF,EAAS4C,MAAMnY,QAA8C,IAApC6P,EAAKxG,QAAQkM,EAAS8C,WAC/EsC,EAAKlG,KAAK,gBAAoB5E,qBACvB,IAGX8K,EAAK1D,gBAAgB/N,IAAI2G,IAClB,IAjBH8K,EAAKlG,KAAK,gBAAiB,aACpB,OAmBLzU,SAGVgJ,EAAKE,KAAI,SAACC,GACN,IAAM2R,EAAQzc,EAAKE,KAAKwK,IAAIC,KAAKsK,cACjC0G,EAAM/U,SAAQ,SAAA4K,GACViL,EAAM5R,KAAI,SAACC,EAAMC,GACbuR,EAAK5K,cAAcF,GACnBxR,EAAKE,KAAKuM,QAAQC,GAAG4I,KAAK9D,GAAa,SAAAkL,GACnCA,EAAS5R,IAASwR,EAAKK,aAAa5R,EAAO,aAIvD0R,EAAMlR,MAAMT,MAIhBH,EAAKE,KAAI,SAACC,GACN,IAAM2R,EAAQzc,EAAKE,KAAKwK,IAAIC,KAAKsK,cACjC0G,EAAM/U,SAAQ,SAAA4K,GACViL,EAAM5R,KAAI,SAACC,GAAS,IAAA8R,EAChB,UAAIA,EAACN,EAAK1D,mBAALgE,EAAsB1T,IAAIsI,GAAO,OAAO1G,IAE7CwR,EAAK5K,cAAcF,GAEf6G,EAAS0B,WAAWvI,IACpBgG,EAAgBnS,IAAImM,EAAM8K,EAAK3K,MAEnC3R,EAAKE,KAAKuM,QAAQC,GAAGmQ,KAAK,CACtBrL,KAAAA,EAAMoC,KAAAA,EACNkJ,QAAQ,EACRC,KAAM,CAAEC,OAAQV,EAAKpD,UAAUlO,QAAQwG,IACvCuK,OAAQ,SAACW,GACDX,GAAQA,EAAOvK,EAAMkL,GACzB5R,KAEJkR,OAAQ,SAACU,GAAW,IAAAO,EAChB,GAAI5E,EAAS0B,WAAWvI,GAAO,CAE3B,IAAM0L,EAAQ1F,EAAgB3X,IAAI2R,GAC9B0L,GAASA,IAAUZ,EAAK3K,MACxB6F,SAAuBhG,UAG/ByL,EAAAX,EAAK1D,kBAALqE,SAA6BzL,GACzBwK,GAAQA,EAAOxK,EAAMkL,IAE7BS,QAAS,SAACT,EAAQU,GAAS,IAAAC,EACvB,GAAID,IAASpd,EAAKE,KAAKgM,QAAQoR,GAAGC,UAAUC,UAAW,OAAO,EAC9D,GAAInF,EAAS0B,WAAWvI,GAAO,CAE3B,IAAM0L,EAAQ1F,EAAgB3X,IAAI2R,GAC9B0L,GAASA,IAAUZ,EAAK3K,OACxB6F,SAAuBhG,GACvBxR,EAAKE,KAAKuM,QAAQC,GAAG8O,KAAK,CAAEhK,KAAAA,YAGpC6L,EAAAf,EAAK1D,kBAALyE,SAA6B7L,GAC7B8K,EAAKlG,KAAK,QAAS5E,EAAMkL,GACzB5R,aAKhB2R,EAAMlR,OAAM,WAERvL,EAAKE,KAAKuM,QAAQC,GAAGkP,kBAAkB,SACvC9Q,WAnEuBH,IA0EnCxI,EAGQsb,YAAR,SAAoBV,GACXA,IACsB,iBAAhBA,EAAKC,QAEZld,KAAKwD,KAAKoa,YAAY5d,KAAKwD,KAAKqa,SAASC,EAAG9d,KAAKwD,KAAKqa,SAASE,EAAGd,EAAKC,QAG1C,iBAAtBD,EAAKe,cACZhe,KAAKwD,KAAKya,gBAAgBhB,EAAKe,gBAEtC3b,EAEO0a,KAAR,SAAajJ,EAAYmJ,EAAuBhB,EAA2BC,EAA2BgC,GAAmC,IAAAC,OAErI,GAAIne,KAAKyY,mBAAqBpB,EAAU+G,QACpCpe,KAAKyY,mBAAqBpB,EAAUqB,IADxC,CASA,IAAM2F,EAAcre,KAAKyY,mBAAqBpB,EAAUqB,IACpD2F,IAAare,KAAKyY,iBAAmBpB,EAAUiH,YAwDnDte,KAAK4R,IAAI,cACT,IAAI2M,GAAe,EACnBve,KAAKke,YAAW,SAAC3H,GACb,GAAIgI,EAAc,OAAOJ,EAAK5H,MAAM,aAAc,aAClDgI,GAAe,EA3DN,SAAChI,GAOV,GANKA,GAGG4H,EAAKlE,cAAckE,EAAK3a,KAAKgB,KAAK,UAE1C0Z,GAAcA,EAAW3H,GACpBA,EAwCG8H,IAAaF,EAAK1F,iBAAmBpB,EAAUqB,SAxC3C,CAEJ2F,IAAaF,EAAK1F,iBAAmBpB,EAAUmH,SACnDtC,GAAUiC,EAAK3a,KAAKjD,KAAK,SAAU2b,IAGH,IAA5BiC,EAAK3F,qBACL2F,EAAK3F,oBAAqB,EAC1B2F,EAAK/C,oBAIT+C,EAAKR,YAAYV,IAGQ,IAArBkB,EAAK3a,KAAKqS,SAAmBsI,EAAK3a,KAAKqS,QAAS,GAEpDsI,EAAKvM,IAAI,UACT,IAAIgL,EAAS,KACb,IACIA,EAASuB,EAAKlC,OAAOnI,GACvB,MAAOvI,GACL4S,EAAKd,UACL1L,QAAQ4E,MAAMhL,GAIlBrL,EAAKE,KAAKuM,QAAQC,GAAG6R,eAErB,IACIxC,GAAUA,EAAOW,GACjBuB,EAAK3a,KAAKgB,KAAK,SAAUoY,GACzB1c,EAAKE,KAAKuM,QAAQC,GAAGpI,KAAK2Z,EAAKxF,gBAAiB,CAAE5L,MAAO,SAAU6P,OAAQA,IAC3E1c,EAAKE,KAAKuM,QAAQC,GAAGpI,KAAK,SAAU,CAAEkN,KAAMyM,EAAKxF,gBAAiBiE,OAAQA,IAC5E,MAAOrR,GACLoG,QAAQ4E,MAAMhL,GAGd8S,IAAaF,EAAK1F,iBAAmBpB,EAAU+G,QAKnDD,EAAKtF,uBAAuBhX,OAAS,GACrCsc,EAAKtF,uBAAuB6F,OAA5BP,GASJnT,CAAKuL,GAAS,QACfzC,QAtEC9T,KAAK6Y,uBAAuBpP,KACxBzJ,KAAK+c,KAAK3G,KAAKpW,KAAM8T,EAAMmJ,EAAMhB,EAAQC,EAAQgC,KAsE5D7b,EAESqZ,KAAV,SAEI5H,EACAoI,GAGA,GAAIlc,KAAKyY,mBAAqBpB,EAAUqB,KACpC1Y,KAAKyY,mBAAqBpB,EAAU+G,OADxC,CASA,IAGM7H,EAHA8H,EAAcre,KAAKyY,mBAAqBpB,EAAU+G,OAIxD,GAHIC,IAAare,KAAKyY,iBAAmBpB,EAAUsH,YACnD3e,KAAK4R,IAAI,cACK5R,KAAK4e,WAAW9K,GA4BtBuK,IAAare,KAAKyY,iBAAmBpB,EAAU+G,YA3B3C,CACRpe,KAAK4R,IAAI,UACLyM,IAAare,KAAKyY,iBAAmBpB,EAAUwH,QACnD7e,KAAKyb,iBAAiB3H,GAEtB,IAAI8I,EAAS,KACb,IACIA,EAAS5c,KAAKkc,OAAOpI,GACvB,MAAOyC,GACL5E,QAAQ4E,MAAMA,GAGlB,IACI2F,GAAUA,EAAOU,GACjB5c,KAAKwD,KAAKgB,KAAK,SAAUoY,GACzB1c,EAAKE,KAAKuM,QAAQC,GAAGpI,KAAKxE,KAAK2Y,gBAAiB,CAAE5L,MAAO,SAAU6P,OAAQA,IAC3E1c,EAAKE,KAAKuM,QAAQC,GAAGpI,KAAK,SAAU,CAAEkN,KAAM1R,KAAK2Y,gBAAiBiE,OAAQA,IAC5E,MAAOrG,GACL5E,QAAQ4E,MAAMA,GAGd8H,IAAare,KAAKyY,iBAAmBpB,EAAUqB,KAE/C1Y,KAAK8e,YAAc5H,EAAUrB,OAAU7V,KAAKwD,KAAKqS,QAAS,EACrD7V,KAAK8e,YAAc5H,EAAU5R,SAAWpF,EAAKE,KAAKuM,QAAQC,GAAGmS,QAAQ/e,MAC9EE,EAAKE,KAAKuM,QAAQC,GAAG6R,eAKrBze,KAAK6Y,uBAAuBhX,OAAS,GACrC7B,KAAK6Y,uBAAuB6F,OAA5B1e,QA1CAA,KAAK6Y,uBAAuBpP,KACxBzJ,KAAK0b,KAAKtF,KAAKpW,KAAM8T,EAAMoI,KA2CtC7Z,EAEO2c,MAAR,SAAcC,GACV,IAAIrC,EAAS,KACT7P,EAAQ,GACRkS,GACArC,EAAS5c,KAAKkf,UACdnS,EAAQ,YAER6P,EAAS5c,KAAKmf,cACdpS,EAAQ,eAGZ/M,KAAKwD,KAAKgB,KAAKuI,EAAO6P,GACtB1c,EAAKE,KAAKuM,QAAQC,GAAGpI,KAAKxE,KAAK2Y,gBAAiB,CAAE5L,MAAOA,EAAO6P,OAAQA,IACxE1c,EAAKE,KAAKuM,QAAQC,GAAGpI,KAAKuI,EAAO,CAAE2E,KAAM1R,KAAK2Y,gBAAiBiE,OAAQA,KAG3Eva,EAMU+c,QAAV,SAA0C/K,EAAcwD,EAASpR,GAC7DvG,EAAKE,KAAKuM,QAAQC,GAAGwS,QAAQpf,KAAMqU,EAAMwD,EAAMpR,IAGnDpE,EAKUgd,WAAV,SAA6ChL,EAAcwD,GACvD3X,EAAKE,KAAKuM,QAAQC,GAAGyS,WAAWrf,KAAMqU,EAAMwD,IAGhDxV,EAMUid,WAAV,SAA6CjL,EAAcwD,EAASpR,GAChEvG,EAAKE,KAAKuM,QAAQC,GAAG0S,WAAWtf,KAAMqU,EAAMwD,EAAMpR,IAGtDpE,EAKUkd,cAAV,SAAgDlL,EAAcwD,GAC1D3X,EAAKE,KAAKuM,QAAQC,GAAG2S,cAAcvf,KAAMqU,EAAMwD,IAGnDxV,EAIUmd,QAAV,SAAkB9S,EAAe2H,EAAcoL,GAC3Czf,KAAKof,QAAQ/K,EAAMqL,GAAM,SAACC,GACtB,IAAKA,IAASxS,EAAQT,GAClB,OAAO+S,GAAcA,GAAW,GAEpC/S,EAAOiT,KAAOA,EACdF,GAAcA,GAAW,OAIjCpd,EAIUud,SAAV,SAAmBlT,EAAqB2H,EAAcoL,GAClDzf,KAAKof,QAAQ/K,EAAMwL,EAAGC,cAAc,SAACC,GACjC,IAAKA,IAAiB5S,EAAQT,GAC1B,OAAO+S,GAAcA,GAAW,GAEpC/S,EAAOqT,aAAeA,EACtBN,GAAcA,GAAW,OAIjCpd,EAOU2d,UAAV,SAAoBtT,EAAgB2H,EAAcoL,GAC9Czf,KAAKof,QAAQ/K,EAAM4L,GAAa,SAACC,GAC7B,IAAKA,IAAgB/S,EAAQT,GACzB,OAAO+S,GAAcA,GAAW,GAEpC/S,EAAOwT,YAAcA,EACrBT,GAAcA,GAAW,OAoBjCpd,EAKU4Z,OAAV,SAAiBnI,GACb,OAAOA,GAGXzR,EAKU6Z,OAAV,SAAiBpI,GACb,OAAOA,GAGXzR,EAIU8c,YAAV,WACI,OAAO,GAGX9c,EAIU6c,QAAV,WACI,OAAO,GAGX7c,EAKU6b,WAAV,SAAqBlT,EAAgC8I,GACjD9I,EAAK,OAGT3I,EAKUuc,WAAV,SAAqB9K,GACjB,OAAO,MAGXzR,EAGUgb,QAAV,aAIAhb,EAGU8d,QAAV,WACI,MAAO,IACVtgB,EAAA0Y,IAAAzY,gBAAAC,IArwBD,WAMI,OAAIC,KAAKkY,OAAehB,EAAU5R,QAC3BtF,KAAKogB,YACf7a,IACD,SAAqBC,GACbxF,KAAKkY,QAAU1S,IAAU0R,EAAU5R,QACnCtF,KAAK4R,IAAI,qBAGb5R,KAAKogB,WAAa5a,KACrB1F,gBAAAC,IAKD,WAKI,QAAIC,KAAKoY,aACLpY,KAAKia,iBACLja,KAAK+Z,WACF/Z,KAAKqgB,YAAgCrgB,KAAKyS,YAAa4N,cACjE9a,IACD,SAAwBC,GACpB,IAAKA,EAAO,CACR,GAAIxF,KAAKoY,SAEL,YADApY,KAAK4R,IAAI,eAGb,GAAI5R,KAAK+Z,UAEL,YADA/Z,KAAK4R,IAAI,gBAIjB5R,KAAKqgB,WAA+BrgB,KAAKyS,YAAa4N,aAAe7a,KACxE1F,mBAAAC,IAID,WASI,OAAIC,KAAKkY,QACFlY,KAAKsgB,eACf/a,IACD,SAA2BC,GAMsB,IAAA+a,EALzC/a,GAASxF,KAAKkY,OACdlY,KAAK4R,IAAI,kBAIE5R,KAAKsgB,gBAAkB9a,GAClCxF,KAAKsgB,cAAgB9a,SACrB+a,EAAArgB,EAAKE,cAAImgB,EAATA,EAAW5T,iBAAO4T,EAAlBA,EAAoB3T,KAApB2T,EAAwB9B,gBAExBze,KAAKsgB,cAAgB9a,KAE5B1F,YAAAC,IAID,WAUI,OAAIC,KAAKkY,UACLlY,KAAKoY,UACFpY,KAAKwgB,SACfjb,IACD,SAAoBC,GAChB,GAAIA,EAAO,CACP,GAAIxF,KAAKkY,OAEL,YADAlY,KAAK4R,IAAI,oBAGb,GAAI5R,KAAKoY,SAEL,YADApY,KAAK4R,IAAI,iBAKqB,IAAA6O,EAAvBzgB,KAAKwgB,SAAWhb,GAC3BxF,KAAKwgB,OAAShb,SACdib,EAAAvgB,EAAKE,cAAIqgB,EAATA,EAAW9T,iBAAO8T,EAAlBA,EAAoB7T,KAApB6T,EAAwBhC,gBAExBze,KAAKwgB,OAAShb,KAErB1F,iBAAAC,IAID,WASI,OAAIC,KAAKkY,QACFlY,KAAK0gB,aACfnb,IACD,SAAyBC,GACjBA,GAASxF,KAAKkY,OACdlY,KAAK4R,IAAI,sBAGb5R,KAAK0gB,YAAclb,KACtB1F,eAAAC,IAUD,WACI,OAAOC,KAAK2Y,mBAGhB7Y,eAAAC,IAGA,WACI,OAAOC,KAAK2Y,gBAAgBpG,MAAMvS,KAAKmc,SAASta,WAGpD/B,eAAAC,IAGA,WACI,OAAqD,IAAjDC,KAAK2Y,gBAAgBzN,QAAQkM,EAAS4C,OAAqB5C,EAAS4C,MACrB,IAA/Cha,KAAK2Y,gBAAgBzN,QAAQkM,EAASgD,KAAmBhD,EAASgD,IACnB,IAA/Cpa,KAAK2Y,gBAAgBzN,QAAQkM,EAASkD,KAAmBlD,EAASkD,IAC/DlD,EAAS0C,QAGpBha,kBAAAC,IAGA,WACI,OAAOC,KAAK2gB,aAGhB7gB,qBAAAC,IAGA,WACI,OAAOC,KAAK4gB,gBAGhB9gB,kBAAAC,IAGA,WACI,OAAOC,KAAK6gB,SAGhB/gB,aAAAC,IAGA,WACI,OAAOC,KAAKyY,kBAAoBpB,EAAUqB,OAC7C5Y,UAAAC,IA6fD,WACI,OAAOyR,EAAOC,OAAO,MAAO,cAAuDzR,KAAK2Y,8BAG5F7Y,WAAAC,IACA,WACI,OAAOyR,EAAOC,OAAO,OAAQ,cAAwDzR,KAAK2Y,+BAG9F7Y,YAAAC,IACA,WACI,OAAOyR,EAAOC,OAAO,QAAS,cAAyDzR,KAAK2Y,iCAC/FJ,GA7yBiCvJ,IA8HnBqR,YAAa,EAAIhf,EAAAC,GAkG9BC,EAlG8B+W,GAAAhW,wBArB/BrB,IAAQyB,gBAAAC,cAAAC,YAAAC,uBAAA,OACYqU,EAAU5R,WAAOhE,EAAAC,EAAAe,uBAAAqV,GAAApH,OAAAuQ,yBAAAvf,EAAAe,uBAAAf,EAAAe,WAAA0W,EAAA1X,EAAAC,EAAAe,wBAkBrCrB,IAAQyB,gBAAAC,cAAAC,YAAAC,uBAAA,OACY,KAAIvB,EAAAC,EAAAe,uBAAAyV,GAAAxH,OAAAuQ,yBAAAvf,EAAAe,uBAAAf,EAAAe,WAAA2W,EAAA3X,EAAAC,EAAAe,2BA0BxBrB,IAAQyB,gBAAAC,cAAAC,YAAAC,uBAAA,OACe,KAAIvB,EAAAC,EAAAe,0BAAA0V,GAAAzH,OAAAuQ,yBAAAvf,EAAAe,0BAAAf,EAAAe,WAAA4W,EAAA5X,EAAAC,EAAAe,oBA2B3BrB,IAAQyB,gBAAAC,cAAAC,YAAAC,uBAAA,OACQ,KAAIvB,EAAAC,EAAAe,mBAAA6V,GAAA5H,OAAAuQ,yBAAAvf,EAAAe,mBAAAf,EAAAe,WAAA6W,EAAA7X,EAAAC,EAAAe,yBAmCpBrB,IAAQyB,gBAAAC,cAAAC,YAAAC,uBAAA,OACa,KAAIvB,EAAAC,EAAAe,wBAAA+V,GAAA9H,OAAAuQ,yBAAAvf,EAAAe,wBAAAf,EAAAe,WAQxBQ,EARwBvB,KAAAuB,IAAAA,MAxNDjC,IAAAC;;mdCtHM,IAO9BH,WAAAA,GAAS,OAATA,kDAAAA,sDAAAA,wDAAAA,8CAAAA,kDAAAA,GAAAA,OA4CCogB,EAAM,CAAElW,KAAAA,EAAMmW,QAAAA,EAASC,MAAAA,EAAOC,OAAAA,GAC9BC,EAAS,GACTC,EAAO,GACPC,EAAQ,GACRC,EAAa,GACb7H,EAAa,GACbrN,EAAU,GACVO,EAAU,GAEV4U,EAAc,IAAIpP,EACpBqP,EAAW,GAEf9G,EAAS9W,GAAG6d,EAASC,aAAa,WAC9BrP,EAAGhN,MAAM8b,GACT9O,EAAGhN,MAAM+b,GACT/O,EAAGhN,MAAMgc,GACThP,EAAGhN,MAAMic,GACTjP,EAAGhN,MAAMoU,GACTpH,EAAGhN,MAAM+G,GACTiG,EAAGhN,MAAMsH,GAET6U,EAAW,UAGMthB,yBAkBjB,SAAAA,IAAcF,KATd4K,IAAMmW,EAAG/gB,KACT2hB,OAAsB,KAAI3hB,KAC1B8T,KAAkB,KAAI9T,KACtB4hB,MAAoB,KAAI5hB,KACxByZ,WAA8B,KAAIzZ,KAClCshB,WAA8B,KAAIthB,KAClCoM,QAAwB,KAAIpM,KAC5B2M,QAAwB,KAGpB3M,KAAK2hB,OAASR,EACdnhB,KAAK8T,KAAOsN,EACZphB,KAAK4hB,MAAQP,EACbrhB,KAAKyZ,WAAaA,EAClBzZ,KAAKshB,WAAaA,EAClBthB,KAAKoM,QAAUA,EACfpM,KAAK2M,QAAUA,EAEP3M,KAAKyS,cAAgBvS,GAASmS,EAAGwP,aAAa,QAC9CxP,EAAGyP,cAAc9hB,KAAKyS,YAAoB,OAGrD,IAAApQ,EAAAnC,EAAAoC,UAxBA,OAwBAD,EAEDuB,GAAA,SAAGmJ,EAA+BtG,EAAmCiG,GAC7D8U,EAASzU,IAAQtG,EAAS9G,KAAK+M,GACnC6U,EAAY3d,GAAGmJ,EAAOtG,EAAUiG,IACnCrK,EAED9B,KAAA,SAAKwM,EAA+BtG,EAAoBiG,GAChD8U,EAASzU,GACTtG,EAAS9G,KAAK+M,GAEd6U,EAAYhhB,KAAKwM,EAAOtG,EAAiBiG,IAEhDrK,EAEDsL,IAAA,SAAIZ,EAA+BtG,EAAmCiG,GAClE6U,EAAY5T,IAAIZ,EAAOtG,EAAUiG,IACpCrK,EAEDiO,UAAA,SAAU5D,GACN6U,EAAYjR,UAAU5D,IAG1BxM,EAGOsE,KAAP,SAAYuI,GACRyU,EAASzU,IAAS,EAAK,QAAApL,EAAAC,UAAAC,OADmBC,MAAIC,MAAAJ,IAAAA,OAAAK,IAAAA,EAAAL,EAAAK,IAAJF,EAAIE,KAAAJ,UAAAI,GAE9Cuf,EAAY/c,KAAIvC,MAAhBsf,GAAiBxU,GAAK7K,OAAKJ,KAC9BjC,EAAAK,SAAAJ,WAAAC,IAxDD,WAEI,OADKC,KAAKC,QAAOD,KAAKC,MAAQ,IAAIC,GAC3BF,KAAKC,UACfC,MAPgBA,EACVS,UAAYA,EADFT,EAGAD,eAHIY,IAAAC;;4kBC/EzB,IAAQC,EAAsBC,EAAtBD,QAASE,EAAaD,EAAbC,sCAGmBC,EADnCH,EAAQ,oCAAmCI,EAEvCF,EAASwC,GAAKkU,EAEd1W,EAASwC,GAAKsU,EAEd9W,EAASwC,GAAKvC,GALmCG,EAAAC,GAKnCC,WAAAwI,GAAA,SAAAgY,IAAA,IAAA,IAAArgB,EAAAC,EAAAC,UAAAC,OAAAC,MAAAC,MAAAJ,GAAAK,IAAAA,EAAAL,EAAAK,IAAAF,EAAAE,GAAAJ,UAAAI,GAkSd,OAlScN,EAAAqI,EAAApK,KAAAsC,MAAA8H,SAAA7H,OAAAJ,UAAAK,EAAAT,wBAAAL,EAAAe,EAAAV,IAAAS,EAAAT,qBAAAsX,EAAA5W,EAAAV,IAAAS,EAAAT,iCAAAuX,EAAA7W,EAAAV,IAAAA,EAElBsgB,QAAkB,EAACtgB,EAERugB,UAAsB,CAC1B,kBACA,eACA,gBACA,iBACA,iBACA,gBACA,YACA,MACA,MACA,cACA,gBACA,eAEA,kBACA,mBACA,oBACA,aACA,gBACA,iBACA,eACA,WACA,YACA,qBACA,MAEA,iBACA,kBACA,aACA,cACA,eACA,UACA,WACA,YACA,SACA,KAEA,UACA,0BACA,2BACA,uBACA,wBACA,eACA,2BACA,wBACA,eAEA,OACHvgB,EACOwgB,aAAyB,CAC7B,iBACA,kBACA,cACA,eACA,WACA,YACA,SACA,KAEA,aACA,MAEA,eACA,mBAEA,UACA,mBACA,oBACA,oBACA,MACHxgB,EACOygB,QAAoB,CACxB,uBACA,wBACHzgB,EAEO0gB,wBAAkC,GAAE1gB,EACpC2gB,qBAA+B,GAAE3gB,EACjC4gB,mBAA6B,GAAE5gB,EAC/B6gB,kBAAgC,GAAE7gB,EAClC8gB,mBAA8B,GAAE9gB,EAChC+gB,gBAA4B,GAAE/gB,EAC9BghB,uBAAehhB,EA8LfihB,mBAAqB,EAACjhB,EACtBkhB,SAAqB,CACzB,kBACA,kBACA,kBACA,kBACA,mBACHlhB,EACOmhB,MAAiB,CACrBC,EAAMC,MACND,EAAME,MACNF,EAAMG,IACNH,EAAMI,MACNJ,EAAMK,MACTzhB,EAlSc9B,EAAAmiB,EAAAhY,GAkSd,IAAA1H,EAAA0f,EAAAzf,UAiBA,OAjBAD,EA3MDoJ,MAAA,WAGI,GADezL,KAAKwD,KAAKoS,OAAO5I,aAAaoW,GAC7C,CAKA,IAAM/H,EAAcrb,KAAKwD,KAAKoS,OAAO5I,aAAasO,GAC5C+H,EAAsC,GAApBhI,EAAYiI,MAC9BC,EAAwC,GAArBlI,EAAYmI,OAEjC1F,EAAyC,GAAlBuF,EAAlBA,EAAyCtF,EAAIwF,EAAsC,GAAnBA,EAInEE,EAAWzjB,KAAKwD,KAAKkgB,eAAe,YACpCC,EAAahO,EAAY8N,GAC/BE,EAAW/N,OAAS5V,KAAKwD,KACzBmgB,EAAWjS,KAAO,UAClB,IAAMkS,EAAYjO,EAAY8N,GAC9BG,EAAUhO,OAAS5V,KAAKwD,KACxBogB,EAAUlS,KAAO,SAGjB,IAAK,IAAI8J,EAAI,EAAGA,EAAI,EAAGA,IAAK,CACxB,IAAMqI,EAAWlO,EAAY3V,KAAK8jB,6BAA6BJ,eAAe,UAC9EG,EAASjG,YAAYE,GAAKtC,EAAI,EAAI,IAAiB,KAAMuC,EAAG,GAC5D8F,EAASE,SAAS,IAAM,IAAM,KAC9BF,EAASjO,OAASgO,EAClB,IAAMI,EAAiBH,EAAS7W,aAAaiX,GAC7CD,EAAeE,OAAS1I,EAAI,qCAAuC,kCACnEwI,EAAenB,MAAQC,EAAMC,MAC7BiB,EAAeG,SAAW,EAC1BnkB,KAAKwiB,mBAAmBxiB,KAAKwiB,mBAAmB3gB,QAAUmiB,EAG9DjG,GAxB4B,GA2B5B,IADA,IAAIqG,EAAa,EACR5I,EAAI,EAAGA,EAAIxb,KAAKiiB,UAAUpgB,OAAQ2Z,IAAK4I,IAAc,CACtD5I,IAAMxb,KAAKiiB,UAAUpgB,QAAU,IAC/Bic,GA7BM,IA8BNsG,EAAa,GAEjB,IAAMC,EAAU7I,EAAI7F,EAAY3V,KAAKskB,kBAAoBtkB,KAAKskB,iBAC9DD,EAAQzG,YAAYE,EAAGC,EAjCC,GAiCYqG,EAAY,GAChDC,EAAQN,SAAS,GAAK,GAAK,IAC3BM,EAAQzO,OAAS5V,KAAKskB,iBAAiB1O,OAEvC,IAAM2O,EAAgBF,EAAQG,uBAAuBC,GACrDF,EAAcL,OAASlkB,KAAKiiB,UAAUzG,GACtCxb,KAAKuiB,kBAAkBviB,KAAKuiB,kBAAkB1gB,QAAU0iB,EACxDvkB,KAAKyiB,gBAAgBziB,KAAKyiB,gBAAgB5gB,QAAU0iB,EAAcL,OAElEG,EAAQzgB,GAAG8gB,EAAO/jB,UAAUgkB,OAAQ3kB,KAAK4kB,iBAAkB5kB,MAE3DA,KAAKqiB,qBAAqB7G,GAAK6I,EAGnCvG,GA/Cc,IAiDd9d,KAAK8jB,6BAA6BlG,YAAYE,EAAI,GAAIC,EAAG,GACzD/d,KAAK8jB,6BAA6BC,SAAS,GAAK,GAAK,IACrD/jB,KAAK8jB,6BAA6BlgB,GAAGqJ,EAAOtM,UAAUkkB,MAAO7kB,KAAK8kB,uBAAwB9kB,MAC1FA,KAAK8jB,6BAA6BlO,OAAS+N,EAC3C,IAAIK,EAAiBhkB,KAAK8jB,6BAA6BU,uBAAuBP,GAC9EjkB,KAAKwiB,mBAAmBxiB,KAAKwiB,mBAAmB3gB,QAAUmiB,EAE1D,IAAMe,EAAoBpP,EAAY3V,KAAK8jB,8BAC3CiB,EAAkBnH,YAAYE,EAAI,GAAIC,EAAG,GACzCgH,EAAkBhB,SAAS,GAAK,GAAK,IACrCgB,EAAkBnhB,GAAGqJ,EAAOtM,UAAUkkB,MAAO7kB,KAAKglB,gBAAiBhlB,MACnE+kB,EAAkBnP,OAAS+N,GAC3BK,EAAiBe,EAAkBP,uBAAuBP,IAC3CC,OAAS,YACxBlkB,KAAKwiB,mBAAmBxiB,KAAKwiB,mBAAmB3gB,QAAUmiB,EAE1D,IAAMiB,EAAatP,EAAY3V,KAAK8jB,8BACpCmB,EAAWrH,YAAYE,EAAI,IAAKC,EAAG,GACnCkH,EAAWlB,SAAS,GAAK,GAAK,IAC9BkB,EAAWrhB,GAAGqJ,EAAOtM,UAAUkkB,MAAO7kB,KAAKklB,OAAQllB,MACnDilB,EAAWrP,OAAS5V,KAAKwD,KAAKoS,QAC9BoO,EAAiBiB,EAAWT,uBAAuBP,IACpCC,OAAS,UACxBlkB,KAAKwiB,mBAAmBxiB,KAAKwiB,mBAAmB3gB,QAAUmiB,EAC1DhkB,KAAK0iB,gBAAkBsB,EAGvBjG,GAAK,GACL,IAAK,IAAIvC,EAAI,EAAGA,EAAIxb,KAAKmiB,QAAQtgB,OAAQ2Z,IAAK,CAC1C,IAAM6I,EAAU1O,EAAY3V,KAAKmlB,qBACjCd,EAAQzG,YAAYE,EAAGC,EA/EC,GA+EYvC,EAAG,GACvC6I,EAAQN,SAAS,GAAK,GAAK,IAC3BM,EAAQzO,OAAS6N,EAEjB,IAAMc,EAAgBF,EAAQG,uBAAuBC,GACrDF,EAAcL,OAASlkB,KAAKmiB,QAAQ3G,GACpCxb,KAAKuiB,kBAAkBviB,KAAKuiB,kBAAkB1gB,QAAU0iB,EACxDvkB,KAAKyiB,gBAAgBziB,KAAKyiB,gBAAgB5gB,QAAU0iB,EAAcL,OAE1CG,EAAQrX,aAAa0X,GAC7BU,YAAY5J,EAC5B6I,EAAQzgB,GAAG8gB,EAAO/jB,UAAUgkB,OAAQnJ,EAAIxb,KAAKqlB,yBAA2BrlB,KAAKslB,oBAAqBtlB,MAClGA,KAAKsiB,mBAAmB9G,GAAK6I,EAIjCtG,GAAK,IACL,IAAK,IAAIvC,EAAI,EAAGA,EAAIxb,KAAKkiB,aAAargB,OAAQ2Z,IAAK,CAC/C,IAAM6I,EAAU7I,EAAI7F,EAAY3V,KAAKmlB,qBAAuBnlB,KAAKmlB,oBACjEd,EAAQzG,YAAYE,EAAGC,EAlGC,GAkGYvC,EAAG,GACvC6I,EAAQN,SAAS,GAAK,GAAK,IAC3BM,EAAQzO,OAAS5V,KAAKmlB,oBAAoBvP,OAE1C,IAAM2O,EAAgBF,EAAQG,uBAAuBC,GACrDF,EAAcL,OAASlkB,KAAKkiB,aAAa1G,GACzCxb,KAAKuiB,kBAAkBviB,KAAKuiB,kBAAkB1gB,QAAU0iB,EACxDvkB,KAAKyiB,gBAAgBziB,KAAKyiB,gBAAgB5gB,QAAU0iB,EAAcL,OAElEG,EAAQzgB,GAAG8gB,EAAO/jB,UAAUgkB,OAAQ3kB,KAAKulB,oBAAqBvlB,MAE9DA,KAAKoiB,wBAAwB5G,GAAK6I,QAtHlC1S,QAAQ4E,MAAM,yDAwHrBlU,EAEDmjB,cAAA,SAAcC,EAAQC,GAClB,IAAIC,EAAW,IAAIC,OAAOH,GACpBI,EAAYF,EAASG,OAAO,KAClC,OAAmB,IAAfD,EACOJ,IAAWC,GAGlBC,GADAA,EAAWA,EAASI,OAAOF,EAAY,IACnBE,OAAO,EAAGJ,EAASG,OAAO,SAC1BJ,GAE3BrjB,EACDuiB,iBAAA,SAAiBoB,GAGb,IAFA,IAAMC,EAAYvL,EAASpF,KAAM2Q,UAC3B1B,EAAgByB,EAAOxB,uBAAuBC,GAC3CjJ,EAAI,EAAGA,EAAIxb,KAAKiiB,UAAUpgB,OAAQ2Z,IACnCxb,KAAKwlB,cAAcjB,EAAcL,OAAQlkB,KAAKiiB,UAAUzG,MACxDyK,EAAUC,WAAa1K,IAGlCnZ,EACDkjB,oBAAA,SAAoBS,GAGhB,IAFA,IAAMC,EAAYvL,EAASpF,KAAM2Q,UAC3B1B,EAAgByB,EAAOxB,uBAAuBC,GAC3CjJ,EAAI,EAAGA,EAAIxb,KAAKkiB,aAAargB,OAAQ2Z,IACtCxb,KAAKwlB,cAAcjB,EAAcL,OAAQlkB,KAAKkiB,aAAa1G,KAC3DyK,EAAUE,oBAAoB3K,EAAGwK,EAAOZ,YAGnD/iB,EACDgjB,yBAAA,SAAyBW,GACHtL,EAASpF,KAAM2Q,UACvBG,mBAAqBJ,EAAOZ,WACzC/iB,EACDijB,oBAAA,SAAoBU,GACEtL,EAASpF,KAAM2Q,UACvBI,mBAAqBL,EAAOZ,WACzC/iB,EACDyiB,uBAAA,SAAuBwB,GACnB,IAAML,EAAYvL,EAASpF,KAAM2Q,UACjCA,EAAUnB,wBAAuB,GACjC,IAAK,IAAItJ,EAAI,EAAGA,EAAIxb,KAAKoiB,wBAAwBvgB,OAAQ2Z,IAAK,CAClCxb,KAAKoiB,wBAAwB5G,GAAGxO,aAAa0X,GACrDU,WAAY,EAGhC,IAAImB,EAAkBvmB,KAAKsiB,mBAAmB,GAAGtV,aAAa0X,GAC9D6B,EAAgBnB,WAAY,EAC5Ba,EAAUI,oBAAqB,GAC/BE,EAAkBvmB,KAAKsiB,mBAAmB,GAAGtV,aAAa0X,IAC1CU,WAAY,EAC5Ba,EAAUG,oBAAqB,GAClC/jB,EACD6iB,OAAA,SAAOoB,GACH,IAAM1C,EAAY5jB,KAAKwD,KAAKkgB,eAAe,UACrC8C,GAAe5C,EAAU/N,OAC/B7V,KAAKqiB,qBAAqB,GAAGzM,OAAOC,OAAS2Q,EAC7CxmB,KAAKsiB,mBAAmB,GAAG1M,OAAOC,OAAS2Q,EAC3CxmB,KAAKoiB,wBAAwB,GAAGxM,OAAOC,OAAS2Q,EAChDxmB,KAAK8jB,6BAA6BlO,OAAOC,OAAS2Q,EAClD5C,EAAU/N,OAAS2Q,EACnBxmB,KAAK0iB,gBAAgBwB,OAASsC,EAAc,UAAY,WAC3DnkB,EAiBD2iB,gBAAA,SAAgBsB,GACZtmB,KAAK2iB,qBACD3iB,KAAK2iB,oBAAsB3iB,KAAK4iB,SAAS/gB,SACzC7B,KAAK2iB,mBAAqB,GAE9B,IAAK,IAAInH,EAAI,EAAGA,EAAIxb,KAAKuiB,kBAAkB1gB,OAAQ2Z,IAC/Cxb,KAAKuiB,kBAAkB/G,GAAG0I,OAASlkB,KAAK4iB,SAAS5iB,KAAK2iB,oBAAsB3iB,KAAKyiB,gBAAgBjH,GAAK,WAE1G,IAAK,IAAIA,EAAI,EAAGA,EAAIxb,KAAKwiB,mBAAmB3gB,OAAQ2Z,IAChDxb,KAAKwiB,mBAAmBhH,GAAGqH,MAAQ7iB,KAAK6iB,MAAM7iB,KAAK2iB,qBAE1DtgB,EAEDE,OAAA,aACCF,EACDokB,OAAA,SAAOC,KACN3E,GAxTwC/S,IAAS1M,iCAAAnB,IAAAuB,gBAAAC,cAAAC,YAAAC,uBAAA,OAEf,QAAImW,EAAA1X,EAAAC,EAAAe,8BAAAqV,IAAAjV,gBAAAC,cAAAC,YAAAC,uBAAA,OAEP,QAAIoW,EAAA3X,EAAAC,EAAAe,0CAAAyV,IAAArV,gBAAAC,cAAAC,YAAAC,uBAAA,OAEQ,QAD7BC,EACiCvB,KAAAuB,MAmTnDjC,IAAAC;;wJCvSM,SAAsBsc,EAAgB3W,GAEzC,IAAK2W,EAAO,QACZ,WAQI,IA/BUuJ,EAgCGvJ,EAhCWwJ,EAgCJ,eAhCkBC,EAwBtC,WACQpgB,EACAA,IAlBhB,SAAeqgB,GACX,GAAKA,EACL,QAAAC,IAAAC,EAAkBzW,OAAO0W,KAAKH,GAAOC,EAAAC,EAAAnlB,OAAAklB,WAC1BD,EADGE,EAAAD,IAkBF1hB,CAAM+X,IAI+BhH,KAAK,KAAM,YA/B5D7F,OAAO2W,eAAeP,EAAKC,EAAM,CAC7B7mB,IAAK8mB,EACLthB,IAAK4hB,EACLxkB,YAAY,EACZD,cAAc,IA6Bd,MAAO+J,IAlCf,IAAkBka,EAAcC,EAAcC,EAAkBM,EAoC5DC,gEACHvmB,IAAAC;;yWCrCD,IAAQC,EAAYC,EAAZD,oBAEPA,EAAQ,eAAeG,CAAA4B,WAAAukB,GAAA,SAAAC,IAAA,IAAA,IAAA5lB,EAAAC,EAAAC,UAAAC,OAAAC,MAAAC,MAAAJ,GAAAK,IAAAA,EAAAL,EAAAK,IAAAF,EAAAE,GAAAJ,UAAAI,GAEyC,OAFzCN,EAAA2lB,EAAA1nB,KAAAsC,MAAAolB,SAAAnlB,OAAAJ,WAEZylB,OAA4C,IAAI3hB,IAAKlE,EAFzC9B,EAAA0nB,EAAAD,GAEyC,IAAAhlB,EAAAilB,EAAAhlB,UAmB5D,OAnB4DD,EAE7DgD,MAAA,WACI,OAAOrF,KAAKunB,OAAOliB,SACtBhD,SAED,SAAOmlB,GACH,OAAOxnB,KAAKunB,cAAcC,IAC7BnlB,EAEDtC,IAAA,SAAIynB,GACA,GAAIxnB,KAAKunB,OAAOne,IAAIoe,GAChB,OAAOxnB,KAAKunB,OAAOxnB,IAAIynB,GAG3B,IAAMza,EAAQ,IAAIoF,EAGlB,OAFAnS,KAAKunB,OAAOhiB,IAAIiiB,EAAUza,GAEnBA,GACVua,GApBqC1b,KAAW9I,KAApBjC,IAAAC;;oJCqB1B,SAAmBX,cAPnB,SAAkBA,eAPlB,SAAmBA,cAPnB,SAAkBA,kEAuBxBU,IAAAC;;4UC1BD,IAAQC,EAAsBC,EAAtBD,QAAsBC,EAAbC,8BAChBF,EAAO+B,WAAAiH,GAAA,SAAA0d,IAAA,IAAA,IAAA/lB,EAAAC,EAAAC,UAAAC,OAAAC,MAAAC,MAAAJ,GAAAK,IAAAA,EAAAL,EAAAK,IAAAF,EAAAE,GAAAJ,UAAAI,GAGY,OAHZN,EAAAqI,EAAApK,KAAAsC,MAAA8H,SAAA7H,OAAAJ,WAEI4lB,cAAe,EAAKhmB,EACpBimB,gBAAQjmB,EAHZ9B,EAAA6nB,EAAA1d,GAGY,IAAA1H,EAAAolB,EAAAnlB,UA6Cf,OA7CqBD,EAEtBmL,SAAA,WACIzD,EAAAzH,UAAMkL,UAAQzD,EAAAzH,UAAUkL,SAAQ7N,WAChCK,KAAKwD,KAAKI,GAAGH,EAAK9C,UAAU8M,YAAazN,KAAK4nB,gBAAiB5nB,MAC/DA,KAAKwD,KAAKI,GAAGH,EAAK9C,UAAU+V,WAAY1W,KAAK4nB,gBAAiB5nB,MAC9DA,KAAKwD,KAAKI,GAAGH,EAAK9C,UAAUmM,UAAW9M,KAAK4nB,gBAAiB5nB,OAChEqC,EAEDqL,UAAA,WACI3D,EAAAzH,UAAMoL,WAAS3D,EAAAzH,UAAUoL,UAAS/N,WAClCK,KAAKwD,KAAKmK,IAAIlK,EAAK9C,UAAU8M,YAAazN,KAAK4nB,gBAAiB5nB,MAChEA,KAAKwD,KAAKmK,IAAIlK,EAAK9C,UAAU+V,WAAY1W,KAAK4nB,gBAAiB5nB,MAC/DA,KAAKwD,KAAKmK,IAAIlK,EAAK9C,UAAUmM,UAAW9M,KAAK4nB,gBAAiB5nB,OACjEqC,EAEDwlB,UAAA,WACI9d,EAAAzH,UAAMulB,WAAS9d,EAAAzH,UAAUulB,UAASloB,YACrC0C,EAEDulB,gBAAA,SAAgB7a,GACZ,OAAQA,EAAM+a,WACV,KAAKrkB,EAAK9C,UAAU8M,YAEhBzN,KAAK0nB,cAAe,EACpB1nB,KAAK2nB,SAAW5a,EAAMgb,cACtB,MACJ,KAAKtkB,EAAK9C,UAAU+V,WAEhB,IAAIsR,EAAMjb,EAAMgb,cACA/nB,KAAK2nB,SAASM,SAASD,GAC/BnmB,SAAW,IACf7B,KAAK0nB,cAAe,GAExB,MACJ,KAAKjkB,EAAK9C,UAAUmM,UACZ9M,KAAK0nB,cACL1nB,KAAKkoB,YAAYloB,MAErBA,KAAK0nB,cAAe,IAG/BrlB,EAES6lB,YAAV,SAAsBxb,KACrB+a,GA/CiCzY,KAASlM,KAiD9CjC,IAAAC;;soBChDD,IAAQC,EAA8CC,EAA9CD,QAASE,EAAqCD,EAArCC,SAAUknB,EAA2BnnB,EAA3BmnB,KAAMC,EAAqBpnB,EAArBonB,8BAIQlnB,EAHxCH,IAASI,EACTinB,EAAiBC,GAAW1Q,EAC5BwQ,EAAK,8BAA6BpQ,EAE9B9W,EAASkT,GAAOjT,EAAA4B,EAAA3B,EAAA2B,EAAA6U,GADsCtW,EAAAC,GACtCC,WAAAwI,GAAA,SAAAue,IAAA,IAAA,IAAA5mB,EAAAC,EAAAC,UAAAC,OAAAC,MAAAC,MAAAJ,GAAAK,IAAAA,EAAAL,EAAAK,IAAAF,EAAAE,GAAAJ,UAAAI,GA4CU,OA5CVN,EAAAqI,EAAApK,KAAAsC,MAAA8H,SAAA7H,OAAAJ,UAAAK,EAAAT,eAAAL,EAAAe,EAAAV,IAAAS,EAAAT,cAAAsX,EAAA5W,EAAAV,IAAAS,EAAAT,YAAAuX,EAAA7W,EAAAV,IAAAS,EAAAT,eAAAwX,EAAA9W,EAAAV,IAAAS,EAAAT,gBAAAyX,EAAA/W,EAAAV,IAAAS,EAAAT,0BAAA6mB,EAAAnmB,EAAAV,IAAAS,EAAAT,iBAAA8mB,EAAApmB,EAAAV,IAAAA,EAiBT+mB,wBAAgB/mB,EAChBgnB,wBAAgBhnB,EAChBinB,SAAmB,EAAIjnB,EAE/BknB,kBAAUlnB,EACVmnB,cAAMnnB,EACNonB,YAAc,IAAGpnB,EAETqnB,aAAe,EAACrnB,EAChBsnB,qBAAsB,EAAKtnB,EAE3BunB,kBAAoB,EAAEvnB,EAEtBwnB,eAAgB,EAAKxnB,EACrBynB,aAAmCC,EAAmBC,KAAI3nB,EAE1D4nB,cAAwB,iBAAgB5nB,EAExC6nB,aAAe,IAAI3jB,IAAkBlE,EACrC8nB,cAAgB,IAAIznB,MAAYL,EAChC+nB,cAAgB,IAAI7jB,IAAsBlE,EAC1CgoB,eAAiB,IAAI3nB,MAAeL,EAEpCioB,MAAQ,IAAI5nB,MAAYL,EAExBkoB,QAAS,EAAKloB,EACdmoB,YAAa,EAAKnoB,EAClBooB,aAAc,EAAKpoB,EA5CV9B,EAAA0oB,EAAAve,GA4CU,IAAA1H,EAAAimB,EAAAhmB,UAkX1B,OAlX0BD,EAGjBE,OAAV,WACIvC,KAAK4oB,WAAa5oB,KAAKwD,KAAKwJ,aAAaqb,GAEzCroB,KAAK4oB,WAAWmB,QAAQ/c,aAAasO,GAAa0O,QAAU,EAC5DhqB,KAAK4oB,WAAWmB,QAAQ/c,aAAasO,GAAa2O,QAAU,IAe/D5nB,EAESmL,SAAV,WACIxN,KAAK4oB,WAAWplB,KAAKI,GAAGH,EAAK9C,UAAU8M,YAAazN,KAAKkqB,aAAclqB,MACvEA,KAAK4oB,WAAWplB,KAAKI,GAAGH,EAAK9C,UAAUmM,UAAW9M,KAAKmqB,WAAYnqB,MACnEA,KAAK4oB,WAAWplB,KAAKI,GAAGH,EAAK9C,UAAU+V,WAAY1W,KAAKoqB,YAAapqB,MACrEA,KAAK4oB,WAAWplB,KAAKI,GAAGH,EAAK9C,UAAUgW,aAAc3W,KAAKqqB,cAAerqB,OAC5EqC,EAESqL,UAAV,WACI1N,KAAK4oB,WAAWplB,KAAKmK,IAAIlK,EAAK9C,UAAU8M,YAAazN,KAAKkqB,aAAclqB,MACxEA,KAAK4oB,WAAWplB,KAAKmK,IAAIlK,EAAK9C,UAAUmM,UAAW9M,KAAKmqB,WAAYnqB,MACpEA,KAAK4oB,WAAWplB,KAAKmK,IAAIlK,EAAK9C,UAAU+V,WAAY1W,KAAKoqB,YAAapqB,MACtEA,KAAK4oB,WAAWplB,KAAKmK,IAAIlK,EAAK9C,UAAUgW,aAAc3W,KAAKqqB,cAAerqB,OAC7EqC,EAED6nB,aAAA,SAAand,GAET/M,KAAKkpB,eAAgB,EACrBlpB,KAAK+oB,aAAehc,EAAMud,eAC1BtqB,KAAKgpB,oBAAsBta,KAAK6b,MAAMvqB,KAAK4oB,WAAW4B,kBAAkB1M,IAAM,GAEjFzb,EAED+nB,YAAA,SAAYrd,KAMX1K,EAED8nB,WAAA,WAGInqB,KAAKkpB,eAAgB,GACxB7mB,EAEDgoB,cAAA,WAGIrqB,KAAKkpB,eAAgB,GACxB7mB,EAEDooB,QAAA,WACI,OAAOzqB,KAAK2pB,OACftnB,EAEDqoB,QAAA,SAAQ5W,GACJ9T,KAAK2pB,MAAQ7V,GAChBzR,EAEDsoB,iBAAA,SAAiBjZ,GACb1R,KAAKspB,cAAgB5X,GACxBrP,EAEOuoB,WAAR,YACQ5qB,KAAK4oB,WAAWiC,UAAa7qB,KAAK4oB,WAAWkC,WAQjD9qB,KAAK4oB,WAAWmB,QAAQ/c,aAAasO,GAAagI,MAAQtjB,KAAK+qB,wBAP3DpZ,QAAQC,IAAI,sDAQnBvP,EACD0oB,sBAAA,WACI,IAAIzH,EAAQtjB,KAAKgrB,kBAQjB,OAPIhrB,KAAKirB,wBACL3H,GAAStjB,KAAK8oB,aAEdxF,EAAQtjB,KAAK4oB,WAAWplB,KAAKwJ,aAAasO,GAAagI,QACvDtjB,KAAKipB,kBAAoBjpB,KAAK4oB,WAAWplB,KAAKwJ,aAAasO,GAAagI,MAAQA,EAChFA,EAAQtjB,KAAK4oB,WAAWplB,KAAKwJ,aAAasO,GAAagI,OAEpDA,GACVjhB,EAEO2oB,gBAAR,WACI,OAAOhrB,KAAKkrB,iBAAiBlrB,KAAKmrB,gBAAkBnrB,KAAKorB,WAAaprB,KAAKqrB,aAC9EhpB,EAEO6oB,iBAAR,SAAyBvb,GAErB,IADA,IAAI2b,EAAM,EACD9P,EAAI,EAAGA,EAAI7L,EAAO6L,IACvB8P,GAAOtrB,KAAKurB,wBAAwB/P,GAExC,OAAO8P,GACVjpB,EAEOkpB,wBAAR,SAAgC5b,GAC5B,OAAa6b,MAAT7b,GACQ3P,KAAK0pB,eAAe/Z,IAAU3P,KAAKyrB,WAAazrB,KAAK0rB,QAE1D1rB,KAAKyrB,UAAYzrB,KAAK0rB,SAChCrpB,EAEOspB,2BAAR,WAEI,IAAIC,GAAW5rB,KAAK4oB,WAAW4B,kBAAkB1M,EAIjD,MAAO,CAFY8N,EACCA,EAFR5rB,KAAK4oB,WAAWplB,KAAKwJ,aAAasO,GAAagI,QAM/DjhB,EAKQwpB,UAAR,SAAkBlc,GACd,IAAAmc,EAAoC9rB,KAAK2rB,6BAApCI,EAAYD,KAAEE,EAAaF,KAE5BG,EAAYjsB,KAAKkrB,iBAAiBvb,GAClCuc,EAAaD,EAAYjsB,KAAKurB,wBAAwB5b,GAG1D,OAAQsc,GAAaF,GAAgBE,GAAaD,GAC1CE,GAAcH,GAAgBG,GAAcF,GAE5CC,GAAaF,GAAgBG,GAAcF,GACtD3pB,EAESokB,OAAV,SAAiB0F,GAAY,IAAA9hB,OACzB,GAAIrK,KAAK4pB,OAAQ,CAEb,IADA,IAAI9V,EAAO9T,KAAK2pB,MACPnO,EAAI,EAAGA,EAAIxb,KAAKmrB,iBAAkB3P,EACvC,GAAIxb,KAAK6rB,UAAUrQ,IACXxb,KAAKypB,cAAc1pB,IAAIyb,GAAI,CAC3B,IAAI4Q,EAAQpsB,KAAKqsB,YAAY7Q,GACzB8Q,EAAYF,EAAMpf,aAAahN,KAAKspB,eACxC,GAAiB,MAAbgD,EACA,KAAM,mCAAqCtsB,KAAKspB,cAAgB,eAEpEgD,EAAUC,WAAW/Q,EAAG1H,EAAK0H,GAAIxb,MAEHwrB,MAA1BxrB,KAAK0pB,eAAelO,KACpBxb,KAAK0pB,eAAelO,GAAK8Q,EAAUE,gBAAkBxsB,KAAKyrB,WAE9D,IAAI3N,EAAI9d,KAAKkrB,iBAAiB1P,GAAKxb,KAAKurB,wBAAwB/P,GAAK4Q,EAAMpC,QAAUhqB,KAAKorB,WAE1FgB,EAAMxO,YAAYE,EAAG,GACrB9d,KAAK6pB,YAAa,EAElB7pB,KAAKypB,cAAclkB,IAAIiW,GAAG,GAEN,MAAhB4Q,EAAMxW,QACN5V,KAAK4oB,WAAWmB,QAAQ0C,SAASL,GAMjDpsB,KAAKupB,aAAaziB,SAAQ,SAACslB,EAAazc,GAC/BtF,EAAKwhB,UAAUlc,IAAwB,MAAdtF,EAAKsf,OAAsC,MAArBtf,EAAKsf,MAAMha,IAE9C,MAATyc,GACA/hB,EAAKqiB,aAAa/c,EAAOyc,MAKrCpsB,KAAK2sB,kBAEL3sB,KAAK4pB,QAAS,EAElB,GAAI5pB,KAAK6pB,WAAY,CAEjB,IAAI+C,GAAU,EACV5sB,KAAK8pB,cACL8C,EAAU5sB,KAAK4sB,WAEnB5sB,KAAK4qB,aACDgC,IACA5sB,KAAK4oB,WAAWiE,eAAe,IAAIC,EAAK9sB,KAAK4oB,WAAWmE,qBAAqBjP,EAAG,IAChF9d,KAAK4pB,QAAS,GAElB5pB,KAAK6pB,YAAa,IAI1BxnB,EACQsqB,gBAAR,WACI,GAA6B,MAAzB3sB,KAAKyoB,kBACc,MAAfzoB,KAAK6oB,QAAkB7oB,KAAKirB,sBAAuB,CAEnD,IAAI+B,EAAarX,EAAY3V,KAAK6oB,QAC9ByD,EAAYU,EAAWhgB,aAA8BigB,GACzDjtB,KAAKyoB,iBAAmB6D,EACxBtsB,KAAK4oB,WAAWmB,QAAQ0C,SAASO,GACjCV,EAAUY,SAAS9D,EAAmBC,MAG9C,GAA6B,MAAzBrpB,KAAKyoB,iBAA0B,CAC/B,IAAI0E,GAAentB,KAAKgrB,kBAAoBhrB,KAAK8oB,YAAc,EAC3DsE,GAAkBptB,KAAK4oB,WAAWmB,QAAQ/c,aAAasO,GAAagI,MAAQtjB,KAAK8oB,YAAc,EAAI9oB,KAAKqtB,aAC5GrtB,KAAKyoB,iBAAiBjlB,KAAKoa,YAAYlP,KAAKK,IAAIoe,EAAaC,GAAiB,KAErF/qB,EAEOqqB,aAAR,SAAqB/c,EAAeyc,GAChCA,EAAMkB,mBACNttB,KAAKupB,oBAAoB5Z,GACzB3P,KAAKwpB,cAAc/f,KAAK2iB,GACxBpsB,KAAKypB,cAAclkB,IAAIoK,GAAO,IACjCtN,EAEO8oB,aAAR,WACI,OAAOnrB,KAAK2pB,MAAQ3pB,KAAK2pB,MAAM9nB,OAAS,GAC3CQ,EAEOgqB,YAAR,SAAoB1c,GAChB,IAAI4d,EAAWvtB,KAAKupB,aAAaxpB,IAAI4P,GAYrC,OAXgB,MAAZ4d,GACAvtB,KAAKypB,cAAclkB,IAAIoK,GAAO,GAElB,MAAZ4d,IACAA,EAAWvtB,KAAKwpB,cAAc1oB,OAElB,MAAZysB,IACAvtB,KAAKypB,cAAclkB,IAAIoK,GAAO,GAC9B4d,EAAW5X,EAAY3V,KAAKwtB,aAEhCxtB,KAAKupB,aAAahkB,IAAIoK,EAAO4d,GACtBA,GACVlrB,EAGDorB,cAAA,SAAcC,EAAa3gB,GACvB,OAAQA,GACJ,KAAKsb,EAAW1nB,UAAUgtB,UACtB3tB,KAAK4tB,oBACL5tB,KAAK4pB,QAAS,IAQ1BvnB,EAGQwrB,kBAAR,WACI,IAAK,IAAIrS,EAAI,EAAGA,EAAIxb,KAAKmrB,eAAgB3P,IACrCxb,KAAKypB,cAAclkB,IAAIiW,GAAG,IAEjCnZ,EAEOuqB,QAAR,WACI,OAAO5sB,KAAK4oB,WAAW4B,kBAAkB1M,GAAK9d,KAAK4oB,WAAWmE,qBAAqBjP,GAGvFzb,EAMAyrB,aAAA,SAAaC,GAcT/tB,KAAK6pB,YAAa,EAClB7pB,KAAK8pB,YAAciE,EACnB/tB,KAAK6tB,oBAEL7tB,KAAK4pB,QAAS,GAGlBvnB,EAGA2rB,iBAAA,SAAiBre,GACb3P,KAAKypB,cAAclkB,IAAIoK,GAAO,GAC9B3P,KAAK4pB,QAAS,GACjBvnB,EAED4rB,aAAA,SAAate,EAAe6T,GACxBxjB,KAAK0pB,eAAe/Z,GAAS6T,EAC7BxjB,KAAK8tB,gBAGTzrB,EAGA6rB,0BAAA,SAA0BC,GACtBnuB,KAAK0oB,iBAAmByF,GAC3B9rB,EAEOurB,kBAAR,WAEI,GAAI5tB,KAAKirB,uBAAyBjrB,KAAK2oB,SAAW3oB,KAAKmpB,cAAgBC,EAAmBgF,aAAepuB,KAAKkpB,cAAe,CACzH,IAAAtN,EAA0B,CAAC5b,KAAK4oB,WAAW4B,kBAAkBzM,EAAG/d,KAAK4oB,WAAWmE,qBAAqBhP,GAAhGsQ,EAAMzS,KAAE0S,EAAS1S,KAElBlN,KAAK6f,KAAKF,IAAW3f,KAAK6b,MAAM+D,KAEhCtuB,KAAKwuB,mBAAmBpF,EAAmBgF,YACvCpuB,KAAK0oB,kBACL1oB,KAAK0oB,sBAcpBrmB,EAEDosB,eAAA,SAAe9F,YAAAA,IAAAA,GAAmB,GAC9B3oB,KAAK2oB,QAAUA,EACXA,EACA3oB,KAAKwuB,mBAAmBpF,EAAmBC,MAE3CrpB,KAAKwuB,mBAAmBpF,EAAmBsF,UAG/C1uB,KAAK8tB,gBACRzrB,EAEOmsB,mBAAR,SAA2BG,GACnB3uB,KAAKmpB,cAAgBwF,IACrB3uB,KAAKmpB,aAAewF,EACpB3uB,KAAK4uB,qBAAqBD,KAEjCtsB,EAEOusB,qBAAR,SAA6BC,GAEzB7uB,KAAKyoB,kBAAoBzoB,KAAKyoB,iBAAiByE,SAAS2B,IAC3DvG,GA/Z6CtZ,IAAS1M,wBAAAyV,IAAArV,gBAAAC,cAAAC,YAAAC,uBAAA,OAElC,QAAImW,EAAA1X,EAAAC,EAAAe,uBAExBrB,IAAQyB,gBAAAC,cAAAC,YAAAC,uBAAA,OACW,KAACoW,EAAA3X,EAAAC,EAAAe,qBAEpBrB,IAAQyB,gBAAAC,cAAAC,YAAAC,uBAAA,OACC,KAACqW,EAAA5X,EAAAC,EAAAe,wBACVrB,IAAQyB,gBAAAC,cAAAC,YAAAC,uBAAA,OACI,KAACsW,EAAA7X,EAAAC,EAAAe,yBACbrB,IAAQyB,gBAAAC,cAAAC,YAAAC,uBAAA,OACK,KAAC0lB,EAAAjnB,EAAAC,EAAAe,mCAEdrB,IAAQyB,gBAAAC,cAAAC,YAAAC,uBAAA,OACe,KAAK2lB,EAAAlnB,EAAAC,EAAAe,0BAC5BrB,IAAQyB,gBAAAC,cAAAC,YAAAC,uBAAA,OACM,KAhBEC,EAgBDvB,KAAAuB,IAAAA,IAAAA,MAjBqBjC,IAAAC;;wvBCFzC,IAAQC,EAAsBC,EAAtBD,QAASE,EAAaD,EAAbC,sBAMcC,EAH9BH,EAAQ,cAAaI,EAIjBF,EAASkT,GAAOwD,EAKhB1W,EAASwC,GAAKsU,EAEd9W,EAASG,GAAO4W,EAEhB/W,EAASgf,GAAY9H,EAErBlX,EAASgf,GAAY/e,GAZsBG,EAAAC,GAYtBC,WAAAgY,GAAA,SAAAuV,IAAA,IAAA,IAAAptB,EAAAC,EAAAC,UAAAC,OAAAC,MAAAC,MAAAJ,GAAAK,IAAAA,EAAAL,EAAAK,IAAAF,EAAAE,GAAAJ,UAAAI,GAsDK,OAtDLN,EAAA6X,EAAA5Z,KAAAsC,MAAAsX,SAAArX,OAAAJ,UAAAK,EAAAT,eAAAL,EAAAe,EAAAV,IAAAS,EAAAT,eAAAsX,EAAA5W,EAAAV,IAAAS,EAAAT,cAAAuX,EAAA7W,EAAAV,IAAAS,EAAAT,aAAAwX,EAAA9W,EAAAV,IAAAS,EAAAT,iBAAAyX,EAAA/W,EAAAV,IAAAS,EAAAT,aAAA6mB,EAAAnmB,EAAAV,IAAAS,EAAAT,YAAA8mB,EAAApmB,EAAAV,IAAAS,EAAAT,cAAAqtB,EAAA3sB,EAAAV,IAAAS,EAAAT,iBAAAstB,EAAA5sB,EAAAV,IAAAS,EAAAT,6BAAAutB,EAAA7sB,EAAAV,IAAAA,EAYdwtB,wBAAgBxtB,EAChBytB,2BAAmBhtB,EAAAT,wBAAA0tB,EAAAhtB,EAAAV,IAAAS,EAAAT,iBAAA2tB,EAAAjtB,EAAAV,IAAAS,EAAAT,sBAAA4tB,EAAAltB,EAAAV,IAAAA,EAQnB+mB,wBAAgB/mB,EAChB6tB,sBAAc7tB,EACdinB,SAAmB,EAAIjnB,EAE/BknB,kBAAUlnB,EACV8tB,cAAM9tB,EACN+tB,aAAe,IAAG/tB,EAClBmnB,cAAMnnB,EACNguB,aAAe,IAAGhuB,EAEViuB,aAAe,EAACjuB,EAChBkuB,oBAAqB,EAE7BluB,EACQwnB,eAAgB,EAAKxnB,EACrBmuB,aAAmCzG,EAAmBC,KAAI3nB,EAC1DynB,aAAmCC,EAAmBC,KAAI3nB,EAE1D4nB,cAAwB,iBAAgB5nB,EAExCouB,mBAAqB,EAAEpuB,EAEvB6nB,aAAe,IAAI3jB,IAAkBlE,EACrC8nB,cAAgB,IAAIznB,MAAYL,EAChC+nB,cAAgB,IAAI7jB,IAAsBlE,EAC1CquB,gBAAkB,IAAIhuB,MAAeL,EAErCioB,MAAQ,IAAI5nB,MAAYL,EAExBkoB,QAAS,EAAKloB,EACdmoB,YAAa,EAAKnoB,EAClBsuB,cAAe,EAAKtuB,EAEpBuuB,UAAiB,GAAEvuB,EAtDL9B,EAAAkvB,EAAAvV,GAsDK,IAAAlX,EAAAysB,EAAAxsB,UAwjB1B,OAxjB0BD,EAEjBE,OAAV,WACIvC,KAAK4oB,WAAa5oB,KAAKwD,KAAKwJ,aAAaqb,IAqBpCroB,KAAK4oB,WAAWsH,SAAWlwB,KAAK4oB,WAAWuH,eAAiB,GAAKnwB,KAAKowB,0BAGvEze,QAAQC,IAAI,0DAEZ5R,KAAK4oB,WAAWyH,oBAGhBrwB,KAAK4oB,WAAWyH,mBAAoB,IAE3ChuB,EAESmL,SAAV,WACIxN,KAAK4oB,WAAWplB,KAAKI,GAAGH,EAAK9C,UAAU8M,YAAazN,KAAKkqB,aAAclqB,MACvEA,KAAK4oB,WAAWplB,KAAKI,GAAGH,EAAK9C,UAAU+V,WAAY1W,KAAKoqB,YAAapqB,MACrEA,KAAK4oB,WAAWplB,KAAKI,GAAGH,EAAK9C,UAAUmM,UAAW9M,KAAKmqB,WAAYnqB,MACnEA,KAAK4oB,WAAWplB,KAAKI,GAAGH,EAAK9C,UAAUgW,aAAc3W,KAAKqqB,cAAerqB,OAC5EqC,EAESqL,UAAV,WACI1N,KAAK4oB,WAAWplB,KAAKmK,IAAIlK,EAAK9C,UAAU8M,YAAazN,KAAKkqB,aAAclqB,MACxEA,KAAK4oB,WAAWplB,KAAKmK,IAAIlK,EAAK9C,UAAU+V,WAAY1W,KAAKoqB,YAAapqB,MACtEA,KAAK4oB,WAAWplB,KAAKmK,IAAIlK,EAAK9C,UAAUmM,UAAW9M,KAAKmqB,WAAYnqB,MACpEA,KAAK4oB,WAAWplB,KAAKmK,IAAIlK,EAAK9C,UAAUgW,aAAc3W,KAAKqqB,cAAerqB,OAC7EqC,EAEDwlB,UAAA,aAECxlB,EAED6nB,aAAA,SAAand,GAET/M,KAAKkpB,eAAgB,EACrBlpB,KAAK2vB,aAAe5iB,EAAMujB,eAC1BtwB,KAAK4vB,mBAAqBlhB,KAAK6b,MAAMvqB,KAAK4oB,WAAW4B,kBAAkBzM,IAAM,GAGhF1b,EAED+nB,YAAA,SAAYrd,GACR,GAAK/M,KAAKowB,yBAAV,CACA,IAAIG,EAAUxjB,EAAMujB,eAAiBtwB,KAAK2vB,aAEtC3vB,KAAKkpB,gBACLlpB,KAAKwwB,qBAAqBD,GAC1BvwB,KAAKkvB,kBAAoBlvB,KAAKkvB,iBAAiBuB,eAAeF,MAErEluB,EAED8nB,WAAA,WAEInqB,KAAK0wB,uBACL1wB,KAAKkpB,eAAgB,GACxB7mB,EAEDgoB,cAAA,WAEIrqB,KAAK0wB,uBACL1wB,KAAKkpB,eAAgB,GACxB7mB,EAEDooB,QAAA,WACI,OAAOzqB,KAAK2pB,OAAS,IACxBtnB,EAEDqoB,QAAA,SAAQ5W,GACJ9T,KAAK2pB,MAAQ7V,GAChBzR,EAEOuoB,WAAR,WACI,IAAI5qB,KAAK4oB,WAAWkC,YAAe9qB,KAAK4oB,WAAWiC,SAAnD,CAQA,IAAIrH,EAASxjB,KAAK4oB,WAAWmB,QAAQ/c,aAAasO,GAAakI,OAC3DmN,EAAY3wB,KAAK4wB,yBACrB5wB,KAAK4oB,WAAWmB,QAAQ/c,aAAasO,GAAakI,OAASmN,EACvDnN,EAASmN,GACT3wB,KAAK8tB,oBAXLnc,QAAQC,IAAI,sDAanBvP,EAEDuuB,uBAAA,WACI,IAAIpN,EAASxjB,KAAK6wB,mBAUlB,OARI7wB,KAAK8wB,qBAAuB9wB,KAAK+wB,oBACjCvN,GAAkBxjB,KAAK0vB,cAEvBlM,EAASxjB,KAAK4oB,WAAWplB,KAAKwJ,aAAasO,GAAakI,SACxDxjB,KAAK8vB,mBAAqB9vB,KAAK4oB,WAAWplB,KAAKwJ,aAAasO,GAAakI,OAASA,EAElFA,EAASxjB,KAAK4oB,WAAWplB,KAAKwJ,aAAasO,GAAakI,QAErDA,GAGXnhB,EAGAsoB,iBAAA,SAAiBjZ,GACb1R,KAAKspB,cAAgB5X,GACxBrP,EAED2uB,aAAA,SAAaC,GACTjxB,KAAKkxB,UAAYD,GACpB5uB,EAEDwuB,iBAAA,WACI,OAAO7wB,KAAKkrB,iBAAiBlrB,KAAKmrB,gBAAkBnrB,KAAKkxB,UAAYlxB,KAAKmxB,cAC7E9uB,EAEO6oB,iBAAR,SAAyBvb,GAErB,IADA,IAAI2b,EAAM,EACD9P,EAAI,EAAGA,EAAI7L,EAAO6L,IACvB8P,GAAOtrB,KAAKoxB,yBAAyB5V,GAEzC,OAAO8P,GAGXjpB,EAGQ+uB,yBAAR,SAAiCzhB,GAC7B,OAAa6b,MAAT7b,GACQ3P,KAAK+vB,gBAAgBpgB,IAAU3P,KAAKqxB,YAAcrxB,KAAK0rB,QAE5D1rB,KAAKqxB,WAAarxB,KAAK0rB,SACjCrpB,EAEOivB,2BAAR,WAEI,IAAIC,EAAUvxB,KAAK4oB,WAAWmB,QAAQlM,SAASE,EAC3CyT,EAAaxxB,KAAK4oB,WAAWplB,KAAKwJ,aAAasO,GAAakI,OAAS,EAErEiO,EAAiBF,EAAUC,EAE/B,MAAO,CAHWD,EAAUC,EAE5BC,GAAkBzxB,KAAKyvB,eAI3BptB,EAKQwpB,UAAR,SAAkBlc,GACd,IAAA+hB,EAAoC1xB,KAAKsxB,6BAApCK,EAAWD,KAAED,EAAcC,KAE5BE,EAAW5xB,KAAKkrB,iBAAiBvb,GAAS3P,KAAKkxB,UAC/CW,EAAcD,EAAW5xB,KAAKoxB,yBAAyBzhB,GAG3D,OAAQiiB,GAAYD,GAAeC,GAAYH,GACvCI,GAAeF,GAAeE,GAAeJ,GAE7CG,GAAYD,GAAeE,GAAeJ,GACrDpvB,EAESokB,OAAV,SAAiB0F,GAAY,IAAA9hB,OAKzB,GAJIrK,KAAKowB,0BAA4BpwB,KAAK6vB,cAAgBzG,EAAmBgF,YAEzEpuB,KAAK4oB,WAAWmB,QAAQnM,YAAY5d,KAAK4oB,WAAWplB,KAAKwJ,aAAasO,GAAagI,MAAQ,EAAGtjB,KAAK4oB,WAAWplB,KAAKwJ,aAAasO,GAAakI,OAAS,EAAIxjB,KAAKyvB,cAE/JzvB,KAAK4pB,OAAQ,CAEb,IADA,IAAI9V,EAAO9T,KAAK2pB,MACPnO,EAAI,EAAGA,EAAIxb,KAAKmrB,iBAAkB3P,EACvC,GAAIxb,KAAK6rB,UAAUrQ,IACXxb,KAAKypB,cAAc1pB,IAAIyb,GAAI,CAC3B,IAAI4Q,EAAQpsB,KAAKqsB,YAAY7Q,GAC7B,GAAa,MAAT4Q,EAEA,YADAza,QAAQC,iCAAiC5R,KAAKspB,eAGlD,IAAIgD,EAAYF,EAAMpf,aAAahN,KAAKspB,eACxC,GAAiB,MAAbgD,EACA,KAAM,mCAAqCtsB,KAAKspB,cAAgB,eAEpEgD,EAAUC,WAAW/Q,EAAG1H,EAAK0H,GAAIxb,MAEFwrB,MAA3BxrB,KAAK+vB,gBAAgBvU,KACrBxb,KAAK+vB,gBAAgBvU,GAAKxb,KAAKqxB,YAEnC,IAAItT,GAAK/d,KAAKkrB,iBAAiB1P,GAAKxb,KAAKoxB,yBAAyB5V,IAAM,EAAI4Q,EAAMpf,aAAasO,GAAa2O,SAAWjqB,KAAKkxB,UAE5H9E,EAAMxO,YAAY,EAAGG,GACrB/d,KAAK6pB,YAAa,EAElB7pB,KAAKypB,cAAclkB,IAAIiW,GAAG,GAEN,MAAhB4Q,EAAMxW,QACN5V,KAAK4oB,WAAWmB,QAAQ0C,SAASL,GAMjDpsB,KAAKupB,aAAaziB,SAAQ,SAACslB,EAAazc,KAC/BtF,EAAKwhB,UAAUlc,IAAwB,MAAdtF,EAAKsf,OAAkBtf,EAAKsf,MAAM9nB,OAAS,EAAK8N,IAE7D,MAATyc,GACA/hB,EAAKqiB,aAAa/c,EAAOyc,MAKrCpsB,KAAK8xB,kBACL9xB,KAAK2sB,kBAEL3sB,KAAK4pB,QAAS,EAElB,GAAI5pB,KAAK6pB,WAAY,CAEjB,IAAIkI,GAAW,EACX/xB,KAAKgwB,eACL+B,EAAW/xB,KAAK+xB,YAEpB/xB,KAAK4qB,aACDmH,IACA/xB,KAAK4oB,WAAWiE,eAAe,IAAIC,EAAK,EAAG9sB,KAAK4oB,WAAWmE,qBAAqBhP,IAChF/d,KAAK4pB,QAAS,GAElB5pB,KAAK6pB,YAAa,IAI1BxnB,EACQyvB,gBAAR,WACI,GAA6B,MAAzB9xB,KAAKkvB,kBACc,MAAflvB,KAAKwvB,QAAkBxvB,KAAKowB,yBAA0B,CAEtD,IAAI4B,EAAarc,EAAY3V,KAAKwvB,QAClCwC,EAAWpU,YAAY,EAAG5d,KAAKyvB,aAAe,EAAIzvB,KAAKkxB,WACvDlxB,KAAK4oB,WAAWmB,QAAQ0C,SAASuF,GACjC,IAAI1F,EAAY0F,EAAWhlB,aAA8BilB,GACzD3F,EAAUY,SAASltB,KAAK6vB,cACxB7vB,KAAKkvB,iBAAmB5C,IAKpCjqB,EACQsqB,gBAAR,WACI,GAA6B,MAAzB3sB,KAAKyoB,kBACc,MAAfzoB,KAAK6oB,QAAkB7oB,KAAK8wB,oBAAqB,CAEjD,IAAI9D,EAAarX,EAAY3V,KAAK6oB,QAClC7oB,KAAK4oB,WAAWmB,QAAQ0C,SAASO,GACjC,IAAIV,EAAYU,EAAWhgB,aAA8BigB,GACzDX,EAAUY,SAAS9D,EAAmBC,MACtCrpB,KAAKyoB,iBAAmB6D,EAGhC,GAA6B,MAAzBtsB,KAAKyoB,iBAA0B,CAC/B,IAAI0E,GAAentB,KAAK6wB,mBAAqB7wB,KAAK0vB,aAAe,EAC7DtC,GAAkBptB,KAAK4oB,WAAWmB,QAAQ/c,aAAasO,GAAakI,OAASxjB,KAAK0vB,aAAe,EAAI1vB,KAAKqtB,aAC9GrtB,KAAKyoB,iBAAiBjlB,KAAKoa,YAAY,EAAGlP,KAAKK,IAAIoe,EAAaC,GAAkBptB,KAAKmxB,gBAE9F9uB,EAEOqqB,aAAR,SAAqB/c,EAAeyc,GAChCA,EAAMkB,mBACNttB,KAAKupB,oBAAoB5Z,GACzB3P,KAAKwpB,cAAc/f,KAAK2iB,GACxBpsB,KAAKypB,cAAclkB,IAAIoK,GAAO,IACjCtN,EAEO8oB,aAAR,WACI,OAAOnrB,KAAK2pB,MAAQ3pB,KAAK2pB,MAAM9nB,OAAS,GAC3CQ,EAEOgqB,YAAR,SAAoB1c,GAChB,IAAI4d,EAAWvtB,KAAKupB,aAAaxpB,IAAI4P,GAerC,OAdgB,MAAZ4d,GAIAvtB,KAAKypB,cAAclkB,IAAIoK,GAAO,GAElB,MAAZ4d,IACAA,EAAWvtB,KAAKwpB,cAAc1oB,OAElB,MAAZysB,IACAA,EAAW5X,EAAY3V,KAAKwtB,YAC5BxtB,KAAKypB,cAAclkB,IAAIoK,GAAO,IAElC3P,KAAKupB,aAAahkB,IAAIoK,EAAO4d,GACtBA,GACVlrB,EACDorB,cAAA,SAAcC,EAAa3gB,GAEV,GAATA,IACI/M,KAAK8wB,qBACL9wB,KAAKkyB,kBAETlyB,KAAK4pB,QAAS,IAItBvnB,EAGQwrB,kBAAR,WACI,IAAK,IAAIrS,EAAI,EAAGA,EAAIxb,KAAKmrB,eAAgB3P,IACrCxb,KAAKypB,cAAclkB,IAAIiW,GAAG,IAEjCnZ,EAEO0vB,SAAR,WACI,OAAO/xB,KAAK4oB,WAAW4B,kBAAkBzM,GAAK/d,KAAK4oB,WAAWmE,qBAAqBhP,GAGvF1b,EAMAyrB,aAAA,SAAaqE,GACkB,GAAvBnyB,KAAKmrB,eACDnrB,KAAKoyB,YACLpyB,KAAKoyB,UAAUvc,QAAS,EACpBwc,EAAIC,kBAAoBD,EAAIE,YAAYlJ,MAAQrpB,KAAKwyB,aACrDxyB,KAAKyyB,SAASvS,YAAclgB,KAAKwyB,aAC1BxyB,KAAK0yB,WACZ1yB,KAAKyyB,SAASvS,YAAclgB,KAAK0yB,UAErC1yB,KAAKwuB,mBAAmBpF,EAAmBC,QAG3CrpB,KAAKoyB,YACLpyB,KAAKoyB,UAAUvc,QAAS,GAE5B7V,KAAK6pB,YAAa,EAClB7pB,KAAKgwB,aAAemC,EACpBnyB,KAAK6tB,qBAET7tB,KAAK4pB,QAAS,GAGlBvnB,EAGA2rB,iBAAA,SAAiBre,GACb3P,KAAKypB,cAAclkB,IAAIoK,GAAO,GAC9B3P,KAAK4pB,QAAS,GACjBvnB,EAED4rB,aAAA,SAAate,EAAe6T,GACxBxjB,KAAK+vB,gBAAgBpgB,GAAS6T,EAC9BxjB,KAAK8tB,gBAGTzrB,EAGAswB,wBAAA,SAAwBxE,GACpBnuB,KAAKuvB,eAAiBpB,GAG1B9rB,EAGAuwB,6BAAA,SAA6BzE,GACzBnuB,KAAKmvB,oBAAsBhB,GAC9B9rB,EAEOmuB,qBAAR,SAA6BD,GACrBvwB,KAAKowB,0BAA4BpwB,KAAK6vB,cAAgBzG,EAAmBgF,YAAcpuB,KAAKmpB,cAAgBC,EAAmBgF,aAC3HpuB,KAAK4vB,oBAAsBW,EAA+B,KAApBvwB,KAAKyvB,aAC3CzvB,KAAK6yB,mBAAmBzJ,EAAmB0J,kBAE3C9yB,KAAK6yB,mBAAmBzJ,EAAmBC,QAGtDhnB,EAEO6vB,gBAAR,WAEI,GAAIlyB,KAAK8wB,qBAAuB9wB,KAAK2oB,SAAW3oB,KAAKmpB,cAAgBC,EAAmBgF,YAAcpuB,KAAK6vB,cAAgBzG,EAAmBgF,aAAepuB,KAAKkpB,cAAe,CAC7K,IAAAtN,EAA0B,CAAC5b,KAAK4oB,WAAW4B,kBAAkBzM,EAAG/d,KAAK4oB,WAAWmE,qBAAqBhP,GAAhGsQ,EAAMzS,KAAE0S,EAAS1S,KAElBlN,KAAK6f,KAAKF,IAAW3f,KAAK6b,MAAM+D,KAEhCtuB,KAAKwuB,mBAAmBpF,EAAmBgF,YACvCpuB,KAAKuvB,gBACLvvB,KAAKuvB,oBAgBrBltB,EAGA0wB,gBAAA,WAAkB,IAAA5mB,OACdnM,KAAK4oB,WAAWoK,iBAEhBhzB,KAAK4oB,WAAWmB,QAAQnM,YAAY5d,KAAK4oB,WAAWplB,KAAKwJ,aAAasO,GAAagI,MAAQ,EAAGtjB,KAAK4oB,WAAWplB,KAAKwJ,aAAasO,GAAakI,OAAS,EAAIxjB,KAAKyvB,cAC/JzvB,KAAK4pB,QAAS,EACd5pB,KAAK6yB,mBAAmBzJ,EAAmBgF,YAC3CpuB,KAAK6c,cAAa,WACkB,MAA5B1Q,EAAKgjB,qBACLhjB,EAAKgjB,wBAEV,MACN9sB,EAEOquB,qBAAR,WAA+B,IAAA3iB,OAEvB/N,KAAKowB,0BAA4BpwB,KAAK6vB,cAAgBzG,EAAmB0J,kBAAoB9yB,KAAKmpB,cAAgBC,EAAmBgF,YACrIpuB,KAAK6yB,mBAAmBzJ,EAAmBgF,YAC3CpuB,KAAK6c,cAAa,WACkB,MAA5B9O,EAAKohB,qBACLphB,EAAKohB,wBAEV,MAMHnvB,KAAKkvB,kBAAoBlvB,KAAKkvB,iBAAiBuB,eAAe,IAErEpuB,EAED4wB,kBAAA,SAAkBC,YAAAA,IAAAA,GAAc,IAEdlzB,KAAK2oB,QAAU3oB,KAAKmrB,eAAiB,GAE/CnrB,KAAKwuB,mBAAmBpF,EAAmBC,MAE3CrpB,KAAKwuB,mBAAmBpF,EAAmB+J,OAG3CD,GAWAlzB,KAAK6yB,mBAAmBzJ,EAAmBC,MAG/CrpB,KAAK8tB,gBACRzrB,EAED+wB,oBAAA,WACIpzB,KAAK6yB,mBAAmBzJ,EAAmBiK,YAE3CrzB,KAAKkvB,kBAAoBlvB,KAAKkvB,iBAAiBuB,eAAe,GAE9DzwB,KAAK4oB,WAAWmB,QAAQnM,YAAY5d,KAAK4oB,WAAWplB,KAAKwJ,aAAasO,GAAagI,MAAQ,EAAGtjB,KAAK4oB,WAAWplB,KAAKwJ,aAAasO,GAAakI,OAAS,IACzJnhB,EAEDosB,eAAA,SAAe9F,YAAAA,IAAAA,GAAmB,GAC9B3oB,KAAK2oB,QAAUA,EACXA,EACA3oB,KAAKwuB,mBAAmBpF,EAAmBC,MAE3CrpB,KAAKwuB,mBAAmBpF,EAAmBsF,UAG/C1uB,KAAK8tB,gBACRzrB,EAEOwwB,mBAAR,SAA2BlE,GACnB3uB,KAAK6vB,cAAgBlB,IAErB3uB,KAAK6vB,aAAelB,EACpB3uB,KAAKszB,qBAAqB3E,KAEjCtsB,EAEOixB,qBAAR,SAA6BzE,GAEzB7uB,KAAKkvB,kBAAoBlvB,KAAKkvB,iBAAiBhC,SAAS2B,IAC3DxsB,EAEOmsB,mBAAR,SAA2BG,GACnB3uB,KAAKmpB,cAAgBwF,IACrB3uB,KAAKmpB,aAAewF,EACpB3uB,KAAK4uB,qBAAqBD,KAEjCtsB,EAEOusB,qBAAR,SAA6BC,GAEzB7uB,KAAKyoB,kBAAoBzoB,KAAKyoB,iBAAiByE,SAAS2B,IAC3DxsB,EAEDkxB,aAAA,SAAazzB,EAAa0F,GACtBxF,KAAKiwB,UAAUnwB,GAAO0F,GACzBnD,EAEDmxB,aAAA,SAAa1zB,GACT,OAAOE,KAAKiwB,UAAUnwB,IAG1BgvB,EAIO2E,cAAP,SAAqB7W,EAAoB8W,EAAqBC,EAAsBhL,EAAmBuK,GACnG,YADmGA,IAAAA,GAAc,GAC5GS,EAASnwB,KAAK2J,QAAnB,CACA,IACIymB,EADA9f,EAAO6f,EAASlJ,UAEhBiJ,EACAE,EAAU9f,EAAK5R,OAAO0a,GACf7a,MAAM8xB,QAAQjX,KACrBgX,EAAUhX,GAEd+W,EAASjJ,QAAQkJ,GACbF,EACAC,EAASlF,eAA0BjD,MAAX7C,EAAuB/L,EAAO/a,OAAS,EAAI8mB,GAEnEgL,EAASV,kBAAkBC,KAElCpE,EAEMgF,cAAP,SAAqBH,EAAsBI,EAAmBb,YAAAA,IAAAA,GAAc,GACnES,EAASnwB,KAAK2J,UACf4mB,EACAJ,EAASlF,gBAAe,GAExBkF,EAASV,kBAAkBC,KAElCpE,GA1nBmCvW,IAAQjW,wBAAAnB,IAAAuB,gBAAAC,cAAAC,YAAAC,uBAAA,OAEvB,QAAImW,EAAA1X,EAAAC,EAAAe,wBAExBrB,IAAQyB,gBAAAC,cAAAC,YAAAC,uBAAA,OACY,KAACoW,EAAA3X,EAAAC,EAAAe,uBAAAqV,IAAAjV,gBAAAC,cAAAC,YAAAC,uBAAA,OAEJ,QAAIqW,EAAA5X,EAAAC,EAAAe,sBAAAyV,IAAArV,gBAAAC,cAAAC,YAAAC,uBAAA,OAEH,QAAIsW,EAAA7X,EAAAC,EAAAe,0BAAA0V,IAAAtV,gBAAAC,cAAAC,YAAAC,uBAAA,OAEK,QAAI0lB,EAAAjnB,EAAAC,EAAAe,sBAAA6V,IAAAzV,gBAAAC,cAAAC,YAAAC,uBAAA,OAER,QAAI2lB,EAAAlnB,EAAAC,EAAAe,qBAE3BrB,IAAQyB,gBAAAC,cAAAC,YAAAC,uBAAA,OACC,KAACksB,EAAAztB,EAAAC,EAAAe,uBACVrB,IAAQyB,gBAAAC,cAAAC,YAAAC,uBAAA,OACG,KAACmsB,EAAA1tB,EAAAC,EAAAe,0BACZrB,IAAQyB,gBAAAC,cAAAC,YAAAC,uBAAA,OACM,KAACosB,EAAA3tB,EAAAC,EAAAe,sCAEfrB,IAAQyB,gBAAAC,cAAAC,YAAAC,uBAAA,OACkB,KAAKusB,EAAA9tB,EAAAC,EAAAe,iCAI/BrB,IAAQyB,gBAAAC,cAAAC,YAAAC,uBAAA,OACa,KAAKwsB,EAAA/tB,EAAAC,EAAAe,0BAC1BrB,IAAQyB,gBAAAC,cAAAC,YAAAC,uBAAA,OACM,KAACysB,EAAAhuB,EAAAC,EAAAe,+BACfrB,IAAQyB,gBAAAC,cAAAC,YAAAC,uBAAA,OACW,KApBEC,EAoBEvB,KAAAuB,6BA8lBhBkxB,GAAW,OAAXA,EAAAA,6BAAAA,EAAAA,yBAAAA,UAGXnzB,IAAAC;;mWCzoBD,IAAQC,EAAYC,EAAZD,oBAEPA,EAAO+B,WAAAyW,GAAA,SAAA0a,IAAA,IAAA,IAAAvyB,EAAAC,EAAAC,UAAAC,OAAAC,MAAAC,MAAAJ,GAAAK,IAAAA,EAAAL,EAAAK,IAAAF,EAAAE,GAAAJ,UAAAI,GAKY,OALZN,EAAA6X,EAAA5Z,KAAAsC,MAAAsX,SAAArX,OAAAJ,WAEMoyB,cAAMxyB,EACNiyB,gBAAQjyB,EACRgmB,cAAe,EAAKhmB,EACtBimB,gBAAQjmB,EALZ9B,EAAAq0B,EAAA1a,GAKY,IAAAlX,EAAA4xB,EAAA3xB,UAgEf,OAhEqBD,EAEZE,OAAV,WACIgX,EAAAjX,UAAMC,QAAMgX,EAAAjX,UAAUC,OAAM5C,YAC/B0C,EAESmL,SAAV,WACIxN,KAAKwD,KAAKI,GAAGH,EAAK9C,UAAU8M,YAAazN,KAAKm0B,aAAcn0B,MAC5DA,KAAKwD,KAAKI,GAAGH,EAAK9C,UAAU+V,WAAY1W,KAAKm0B,aAAcn0B,MAC3DA,KAAKwD,KAAKI,GAAGH,EAAK9C,UAAUmM,UAAW9M,KAAKm0B,aAAcn0B,OAC7DqC,EAESqL,UAAV,WACI1N,KAAKwD,KAAKmK,IAAIlK,EAAK9C,UAAU8M,YAAazN,KAAKm0B,aAAcn0B,MAC7DA,KAAKwD,KAAKmK,IAAIlK,EAAK9C,UAAU+V,WAAY1W,KAAKm0B,aAAcn0B,MAC5DA,KAAKwD,KAAKmK,IAAIlK,EAAK9C,UAAUmM,UAAW9M,KAAKm0B,aAAcn0B,OAC9DqC,EAED8xB,aAAA,SAAapnB,GACT,OAAQA,EAAM+a,WACV,KAAKrkB,EAAK9C,UAAU8M,YAEhBzN,KAAK0nB,cAAe,EACpB1nB,KAAK2nB,SAAW5a,EAAMgb,cACtB,MACJ,KAAKtkB,EAAK9C,UAAU+V,WAEhB,IAAIsR,EAAMjb,EAAMgb,cACZqM,EAAO1lB,KAAK2lB,IAAIr0B,KAAK2nB,SAAS7J,EAAIkK,EAAIlK,GACtCwW,EAAO5lB,KAAK2lB,IAAIr0B,KAAK2nB,SAAS5J,EAAIiK,EAAIjK,IACtCqW,EAAO,GAAKE,EAAO,KACnBt0B,KAAK0nB,cAAe,GAOxB,MACJ,KAAKjkB,EAAK9C,UAAUmM,UACZ9M,KAAK0nB,cACL1nB,KAAKkoB,YAAYnb,GAErB/M,KAAK0nB,cAAe,IAG/BrlB,EAED6lB,YAAA,SAAYnb,KAEX1K,EAEDkqB,WAAA,SAAW5lB,EAAYmN,EAAW6f,GAC9B3zB,KAAKk0B,OAASvtB,EACd3G,KAAK2zB,SAAWA,GAEnBtxB,EAEDkyB,cAAA,aAEClyB,EAEDmqB,aAAA,aAECyH,GApEuC1b,KAAQzV,KAAjBjC,IAAAC;;yVCNtB0zB,0BAAUC,GAAA,SAAAD,IAAA,IAAA,IAAA9yB,EAAAC,EAAAC,UAAAC,OAAAC,MAAAC,MAAAJ,GAAAK,IAAAA,EAAAL,EAAAK,IAAAF,EAAAE,GAAAJ,UAAAI,GACH,OADGN,EAAA+yB,EAAA90B,KAAAsC,MAAAwyB,SAAAvyB,OAAAJ,WACX4yB,gBAAQhzB,EAOf,OARkB9B,EAAA40B,EAAAC,GACH50B,EAAA20B,IAAA10B,cAAAC,IAChB,WACI,OAAOC,KAAK00B,UACfnvB,IAED,SAAYC,GACRxF,KAAK00B,SAAWlvB,MACnBgvB,GAR2BG,IAWXC,yBAAa,SAAAA,KA2D7B,OAtDDA,EAEOC,aAAP,SAAoBC,EAAiBC,EAAiBC,GAClDh1B,KAAKi1B,YAAYH,GAEjB,IAAII,EAAO,IAAIV,EAAWQ,GAC1BE,EAAKH,QAAUA,EACf/0B,KAAKm1B,cAAc5vB,IAAIuvB,EAASI,IACnCN,EAEMQ,QAAP,SAAeN,GACX,IAEQtxB,EAFJ0xB,EAAOl1B,KAAKq1B,QAAQP,GACxB,GAAII,EAQA,OALI1xB,EADA0xB,EAAKxlB,OACEwlB,EAAKn1B,MAEL4V,EAAYuf,EAAKH,UAEvBlf,QAAS,EACPrS,GAEdoxB,EAEMU,QAAP,SAAeR,EAAiBtxB,GAC5B,IAAI0xB,EAAOl1B,KAAKq1B,QAAQP,GACpBI,IACA1xB,EAAKqS,QAAS,EACdqf,EAAKK,IAAI/xB,KAEhBoxB,EAEMK,YAAP,SAAmBH,GACf,IAAII,EAAOl1B,KAAKm1B,cAAcp1B,IAAI+0B,GAClC,GAAII,EAAM,CACN,IAAK,IAAI1Z,EAAI,EAAGA,EAAI0Z,EAAKxlB,OAAQ8L,IAAK,CAClC,IAAIhY,EAAO0xB,EAAKn1B,MACZoN,EAAQ3J,GAAM,KACdA,EAAKqS,QAAS,EACdrS,EAAK8B,WAGb4vB,EAAK7vB,QACLrF,KAAKm1B,qBAAqBL,KAEjCF,EAEMS,QAAP,SAAeP,GACX,IAAII,EAAOl1B,KAAKm1B,cAAcp1B,IAAI+0B,GAClC,GAAII,EACA,OAAOA,EAEPvjB,QAAQC,mEAAmEkjB,IAElFF,MA3DgBA,EACFO,cAAyC,IAAIvvB,IAD3CgvB,EAGVY,iBAA2B,uBAHJ30B,IAAAC;;6fCXlC,IAAQC,EAAsBC,EAAtBD,QAASE,EAAaD,EAAbC,sBAGmBC,EAE/BD,EAASgjB,GAAM9iB,EAEfF,EAASG,GALbL,GACqDM,EAAAC,GAD9CC,WAAAwI,GAAA,SAAAkjB,IAAA,IAAA,IAAAvrB,EAAAC,EAAAC,UAAAC,OAAAC,MAAAC,MAAAJ,GAAAK,IAAAA,EAAAL,EAAAK,IAAAF,EAAAE,GAAAJ,UAAAI,GAAA,OAAAN,EAAAqI,EAAApK,KAAAsC,MAAA8H,SAAA7H,OAAAJ,UAAAK,EAAAT,YAAAL,EAAAe,EAAAV,IAAAS,EAAAT,aAAAsX,EAAA5W,EAAAV,IAAAA,EAAA9B,EAAAqtB,EAAAljB,GAAA,IAAA1H,EAAA4qB,EAAA3qB,UA+BH,OA/BGD,EAQJ6qB,SAAA,SAASyB,GACL,OAAQA,GACJ,KAAKvF,EAAmBC,KACxB,KAAKD,EAAmB+J,MACpBnzB,KAAKy1B,QAAQjyB,KAAKqS,QAAS,EAC3B7V,KAAK0yB,SAASlvB,KAAKqS,QAAS,EAC5B,MACJ,KAAKuT,EAAmB0J,iBACpB,MACJ,KAAK1J,EAAmBgF,WACpBpuB,KAAKy1B,QAAQjyB,KAAKqS,QAAS,EAC3B7V,KAAKy1B,QAAQvR,OAAS,QACtBlkB,KAAK0yB,SAASlvB,KAAKqS,QAAS,EAC5B,MACJ,KAAKuT,EAAmBsF,SACpB1uB,KAAK0yB,SAASlvB,KAAKqS,QAAS,EAC5B7V,KAAKy1B,QAAQjyB,KAAKqS,QAAS,IAGtCxT,EAEDoJ,MAAA,aAECwhB,GA9BwCje,IAAS1M,qBAAApB,IAAAwB,gBAAAC,cAAAC,YAAAC,uBAAA,OAGjC,QAAImW,EAAA1X,EAAAC,EAAAe,sBAAAnB,IAAAuB,gBAAAC,cAAAC,YAAAC,uBAAA,OAEF,QANfC,EAMmBvB,KAAAuB,MALSjC,IAAAC;;+eCFpC,IAAQC,EAAsBC,EAAtBD,QAASE,EAAaD,EAAbC,sBAGmBC,EAC/BD,EAASy0B,GAFb30B,GACqDM,EAAAC,GAD9CC,WAAAwI,GAAA,SAAAkoB,IAAA,IAAA,IAAAvwB,EAAAC,EAAAC,UAAAC,OAAAC,MAAAC,MAAAJ,GAAAK,IAAAA,EAAAL,EAAAK,IAAAF,EAAAE,GAAAJ,UAAAI,GAKoC,OALpCN,EAAAqI,EAAApK,KAAAsC,MAAA8H,SAAA7H,OAAAJ,UAAAK,EAAAT,iBAAAL,EAAAe,EAAAV,IAAAA,EAKIi0B,OAASvM,EAAmBC,KAAI3nB,EALpC9B,EAAAqyB,EAAAloB,GAKoC,IAAA1H,EAAA4vB,EAAA3vB,UA0BvC,OA1BuCD,EAExCoJ,MAAA,aAECpJ,EAEDouB,eAAA,SAAeF,GACPA,GAAW,KACXA,GAAW,IAEfvwB,KAAK41B,aAAapyB,KAAKua,EAAIwS,EAAU,IACxCluB,EAED6qB,SAAA,SAASyB,GACL3uB,KAAK21B,OAAShH,GAYjBsD,GA9BwCjjB,IAAS1M,0BAAApB,IAAAwB,gBAAAC,cAAAC,YAAAC,uBAAA,OAEzB,QAHrBC,EAGyBvB,KAAAuB,MAFGjC,IAAAC;;8UCDL+0B,GAE3B,SAAAC,IAAc,IAAAp0B,EAEU,OADpBA,EAAAm0B,EAAAl2B,kBAFIo2B,iBAGJr0B,EAAKq0B,UAAY,GAAGr0B,EAJG9B,EAAAk2B,EAAAD,GAK1B,IAAAxzB,EAAAyzB,EAAAxzB,UAgCA,OAhCAD,EAED2zB,aAAA,SAAaC,GACTj2B,KAAKk2B,eAAeD,IACvB5zB,EAED8zB,mBAAA,SAAmBC,EAAWC,GAC1Br2B,KAAK+1B,UAAUK,GAAKC,GACvBh0B,EAED6zB,eAAA,SAAeD,GAIX,IAAK,IAAIG,KAHa,MAAlBp2B,KAAK+1B,YACL/1B,KAAK+1B,UAAY,IAEPE,EACVj2B,KAAKm2B,mBAAmBC,EAAGH,EAASG,KAE3C/zB,EAEDi0B,cAAA,WACI,OAAOt2B,KAAK+1B,UAAsB,YACrC1zB,EACDk0B,YAAA,WACI,OAAOv2B,KAAK+1B,UAAoB,UACnC1zB,EAEDm0B,WAAA,WACI,OAAOx2B,KAAK+1B,UAAmB,SAClC1zB,EAEDo0B,SAAA,WACI,OAAOz2B,KAAK+1B,UAAiB,OAChCD,GArCmCY,MAAT71B,IAAAC;;+PCDV61B,yBAAa,SAAAA,KAuL7B,OAzKDA,EAEOC,oBAAP,SAA2BC,GACvB72B,KAAK82B,cAAcD,IACtBF,EAEMG,cAAP,SAAqBhjB,GACjB,IAAK,IAAI0H,EAAI,EAAGub,EAAMjjB,EAAKjS,OAAQ2Z,EAAIub,EAAKvb,IACxCxb,KAAKg3B,aAAaljB,EAAK0H,KAE9Bmb,EAEMK,aAAP,SAAoBljB,GAChB,IAAImjB,EAAUnjB,EAAe,SACzBmjB,GACWj3B,KAAKk3B,QAAQD,GACnBjB,aAAaliB,IAEzB6iB,EAEMQ,WAAP,SAAkBlB,GACdj2B,KAAKo3B,gBAAgBnB,IACxBU,EAEMU,WAAP,WACIr3B,KAAKs3B,QAAU,EACft3B,KAAKu3B,WAAWlyB,QAChBrF,KAAKw3B,SAASnyB,QACdrF,KAAKy3B,WAAa,GAClBz3B,KAAK03B,WAAa,GACrBf,EAEMgB,UAAP,SAAiBV,GACb,IAAIW,EAAO53B,KAAKu3B,WAAWx3B,IAAIk3B,GAC3BW,IACAA,EAAO,KACP53B,KAAKu3B,kBAAkBN,KAE9BN,EAEMkB,UAAP,WACI,OAAO73B,KAAKs3B,SAAW,GAC1BX,EAEMmB,iBAAP,SAAwBb,GACpB,IAAIW,EAAO53B,KAAKu3B,WAAWx3B,IAAIk3B,GAC/B,OAAIW,GAGG,MACVjB,EAEMoB,WAAP,WAEI,OADe/3B,KAAK83B,iBAAiB93B,KAAKg4B,iBAC1BxB,cACnBG,EAEMsB,kBAAP,WAEI,OADej4B,KAAK83B,iBAAiB93B,KAAKg4B,iBAC1B1B,iBACnBK,EAEMuB,gBAAP,WAEI,OADel4B,KAAK83B,iBAAiB93B,KAAKg4B,iBAC1BzB,eACnBI,EAEMwB,aAAP,WAEI,OADen4B,KAAK83B,iBAAiB93B,KAAKg4B,iBAC1BvB,YACnBE,EAEMyB,qBAAP,SAA4BnC,GACxB,IAAIgB,EAAUhB,EAAmB,SACjCj2B,KAAKq4B,WAAapC,EAAkB,QACzBj2B,KAAKk3B,QAAQD,GACnBjB,aAAaC,GAClBj2B,KAAK03B,WAAazB,EAAiB,OACnCj2B,KAAKs4B,iBAAmBrC,EACxBj2B,KAAKg4B,gBAAkBf,EACvBj3B,KAAKu4B,eAAeC,QAAQvC,EAAkB,UAGlDU,EACOS,gBAAP,SAAuBnB,GACnBtkB,QAAQC,qCAAqC6mB,KAAKC,UAAUzC,IAE5D,IAAIgB,EAAUhB,EAAmB,SACjCj2B,KAAK24B,SAAW1C,EAAgB,MAChCj2B,KAAKq4B,WAAapC,EAAkB,QACzBj2B,KAAKk3B,QAAQD,GACnBjB,aAAaC,GAClBj2B,KAAK03B,WAAazB,EAAiB,OACnCj2B,KAAKs4B,iBAAmBrC,EACxBj2B,KAAKg4B,gBAAkBf,EACvBj3B,KAAKu4B,eAAeC,QAAQvC,EAAkB,UACjDU,EAEMO,QAAP,SAAeD,GACX,IAAIW,EAAO53B,KAAKu3B,WAAWx3B,IAAIk3B,GAM/B,OALKW,IACDA,EAAO,IAAI9B,EACX91B,KAAKu3B,WAAWhyB,IAAI0xB,EAASW,GAC7B53B,KAAKy3B,WAAWhuB,KAAKwtB,IAElBW,GACVjB,EAEMiC,mBAAP,WACI,OAAO54B,KAAKs4B,kBACf3B,EAEMkC,kBAAP,WACI,OAAO74B,KAAKg4B,iBAAmB,GAClCrB,EAGMmC,sBAAP,WACI94B,KAAKg4B,gBAAkB,MAC1BrB,EAEMoC,kBAAP,SAAyBC,GACrBh5B,KAAKg5B,YAAcA,GACtBrC,EACMsC,kBAAP,WACI,OAAOj5B,KAAKg5B,aACfrC,EACMuC,WAAP,SAAkBp5B,GACdE,KAAKw3B,gBAAgB13B,IACxB62B,EACMwC,WAAP,SAAkBr5B,EAASs5B,GACvBp5B,KAAKw3B,SAASjyB,IAAIzF,EAAKs5B,IAC1BzC,EACM0C,WAAP,WACI,OAAOr5B,KAAKw3B,UACfb,EAEM2C,aAAP,WACI,OAAOt5B,KAAKq4B,YACf1B,EACM4C,aAAP,SAAoBvlB,GAChBhU,KAAKq4B,WAAarkB,GACrB2iB,EAEM6C,aAAP,SAAoB7K,GAChB3uB,KAAK03B,WAAa/I,GACrBgI,EACM8C,aAAP,WACI,OAAOz5B,KAAK03B,YACff,EAEM+C,WAAP,SAAkBC,GACd35B,KAAK45B,OAASD,GACjBhD,EACMkD,WAAP,WACI,OAAO75B,KAAK45B,QACfjD,EAEMmD,SAAP,SAAgBH,GACZ35B,KAAK24B,SAAWgB,GACnBhD,EACMoD,QAAP,WACI,OAAO/5B,KAAK24B,UACfhC,EACMqD,WAAP,WACI,OAAOh6B,KAAKi6B,UACftD,EACMuD,WAAP,SAAkBP,GACd35B,KAAKi6B,SAAWN,GACnBhD,MAvLgBA,EACFY,WAAsC,IAAI3xB,IADxC+wB,EAEFc,WAA4B,GAF1Bd,EAGF4B,eAAgC,GAH9B5B,EAIFW,QAAkB,EAJhBX,EAKF2B,wBALE3B,EAMFqB,uBANErB,EAOFqC,YAAsB,EAPpBrC,EAQFa,SAAgC,IAAI5xB,IARlC+wB,EASF0B,WAAqB,EATnB1B,EAUFe,WAAqB,EAVnBf,EAWFiD,QAAkB,EAXhBjD,EAYFgC,UAAoB,EAZlBhC,EAaFsD,UAAoB,IAbLp5B,IAAAC;;ojBCAlC,IAAQC,EAAYC,EAAZD,QACFo5B,EAAQ,iBAERC,aAmBF,SAAAA,IAAsBp6B,KAHtB0L,WAA6F,GAAE1L,KAC/Fyf,WAA8C,GAErB,OAnBhB2a,EAGF3oB,OAAP,SAAcgO,EAAsC/T,YAAAA,IAAAA,EAAsF,MACtI,IAAM2uB,EAAUD,EAAQE,MAAMx5B,OAAS,IAAIs5B,EAG3C,OAFA1uB,GAAc2uB,EAAQ3uB,WAAWjC,KAAKiC,GACtC+T,GAAc4a,EAAQ5a,WAAWhW,KAAKgW,GAC/B4a,GACVD,EAEM7E,IAAP,SAAW8E,GACPA,EAAQ3uB,WAAW7J,OAAS,EAC5Bw4B,EAAQ5a,WAAW5d,OAAS,EAC5Bu4B,EAAQE,MAAM7wB,KAAK4wB,IAMED,KAnBvBA,EACaE,MAAmB,GAAE,IAqBlCC,aAAM,SAAAA,IAAAv6B,KACAw6B,SAAW,IAAI50B,IAAoB5F,KACnCy6B,WAAa,IAAI70B,IAAsB,IAAAvD,EAAAk4B,EAAAj4B,UAqX9C,OAnXDD,EAKOq4B,QAAP,SAAeC,GACX,OAAOz6B,EAAKE,KAAKuM,QAAQsI,OAAOylB,QAAQC,IAG5Ct4B,EAKOu4B,WAAP,SAAkBD,GACd,OAAOz6B,EAAKE,KAAKuM,QAAQsI,OAAO2lB,WAAWD,IAG/Ct4B,EAOOmT,KAAP,SAAoCmlB,GAAkN,IAAAj5B,OAC5O5B,GAAS66B,EAAO5mB,QAAU,iBAAe4mB,EAAO9iB,KAAKnG,SAAQipB,EAAOtmB,UAAQsmB,EAAOE,SAAW,IAEpG,GAAI76B,KAAKy6B,WAAWrxB,IAAItJ,GAAM,CAC1B,IAAMu6B,EAAUr6B,KAAKy6B,WAAW16B,IAAID,GAGpC,OAFA66B,EAAOjvB,YAAc2uB,EAAQ3uB,WAAWjC,KAAKkxB,EAAOjvB,iBACpDivB,EAAOlb,YAAc4a,EAAQ5a,WAAWhW,KAAKkxB,EAAOlb,aAKxD,IAAM4a,EAAUD,EAAQ3oB,OAAOkpB,EAAOlb,WAAYkb,EAAOjvB,YAIzD,GAHA1L,KAAKy6B,WAAWl1B,IAAIzF,EAAKu6B,GAGrBr6B,KAAKw6B,SAASpxB,IAAItJ,GAAtB,CACI,IAAMg7B,EAAQ96B,KAAKw6B,SAASz6B,IAAID,GAEhCoN,YAAW,WAEFxL,EAAK+4B,WAAWrxB,IAAItJ,KACzB4B,EAAK+4B,kBAAkB36B,GACvBu6B,EAAQ5a,WAAW3Y,SAAQ,SAAAsJ,GAAE,OAAIA,EAAG0qB,MACpCV,EAAQ7E,IAAI8E,MACb,QAIPn6B,EAAKE,KAAKuM,QAAQsI,OAAOO,KAAIulB,KACtBJ,GACHjvB,WAAY,SAACiI,EAAQlF,EAAO2F,GACnB1S,EAAK+4B,WAAWrxB,IAAItJ,IACzBu6B,EAAQ3uB,WAAW5E,SAAQ,SAAAsJ,GAAE,OAAIA,EAAGuD,EAAQlF,EAAO2F,OAEvDqL,WAAY,SAACqb,GAET,IAAKp5B,EAAK+4B,WAAWrxB,IAAItJ,GAGrB,OAFAg7B,EAAME,cACNF,EAAMG,SAGVv5B,EAAK+4B,kBAAkB36B,GACnBg7B,IACAA,EAAME,SACNt5B,EAAK84B,SAASj1B,IAAIzF,EAAKg7B,IAE3BT,EAAQ5a,WAAW3Y,SAAQ,SAAAsJ,GAAE,OAAIA,EAAG0qB,MACpCV,EAAQ7E,IAAI8E,QAKxBh4B,EAOO64B,UAAP,SAAyCP,GAA8L,IAAAtwB,OACnO,OAAO,IAAI8wB,SAAQ,SAACC,GAChB/wB,EAAKmL,KAAIulB,KACFJ,GACHlb,WAAY2b,SAKxB/4B,EAOOg5B,QAAP,SAAuCV,GAAqN,IAAAxuB,OAClPrM,GAAS66B,EAAO5mB,QAAU,iBAAe4mB,EAAO9iB,KAAKnG,SAAQipB,EAAOtmB,UAAQsmB,EAAOE,SAAW,QAEpG,GAAI76B,KAAKy6B,WAAWrxB,IAAItJ,GAAM,CAC1B,IAAMu6B,EAAUr6B,KAAKy6B,WAAW16B,IAAID,GAGpC,OAFA66B,EAAOjvB,YAAc2uB,EAAQ3uB,WAAWjC,KAAKkxB,EAAOjvB,iBACpDivB,EAAOlb,YAAc4a,EAAQ5a,WAAWhW,KAAKkxB,EAAOlb,aAKxD,IAAM4a,EAAUD,EAAQ3oB,OAAOkpB,EAAOlb,WAAYkb,EAAOjvB,YACzD1L,KAAKy6B,WAAWl1B,IAAIzF,EAAKu6B,GAEzB,IAAMiB,EAAU,GAChBt7B,KAAKw6B,SAAS1zB,SAAQ,SAACg0B,EAAOzmB,GACA,IAAtBA,EAAKnJ,QAAQpL,IACbw7B,EAAQ7xB,KAAKqxB,MAKjBQ,EAAQz5B,OAERqL,YAAW,WAEFf,EAAKsuB,WAAWrxB,IAAItJ,KACzBqM,EAAKsuB,kBAAkB36B,GACvBu6B,EAAQ5a,WAAW3Y,SAAQ,SAAAsJ,GAAE,OAAIA,EAAGkrB,MACpClB,EAAQ7E,IAAI8E,MACb,GAIPn6B,EAAKE,KAAKuM,QAAQsI,OAAOomB,QAAON,KACzBJ,GACHjvB,WAAY,SAACiI,EAAQlF,EAAO2F,GACnBjI,EAAKsuB,WAAWrxB,IAAItJ,IACzBu6B,EAAQ3uB,WAAW5E,SAAQ,SAAAsJ,GAAE,OAAIA,EAAGuD,EAAQlF,EAAO2F,OAEvDqL,WAAY,SAAC8b,GAEJpvB,EAAKsuB,WAAWrxB,IAAItJ,IAOzBqM,EAAKsuB,kBAAkB36B,SACvBy7B,GAAAA,EAAQz0B,SAAQ,SAACg0B,GACbA,EAAME,SACN7uB,EAAKquB,SAASj1B,IAAIzF,EAAMg7B,EAAMjpB,KAAMipB,MAExCT,EAAQ5a,WAAW3Y,SAAQ,SAAAsJ,GAAE,OAAIA,EAAGkrB,MACpClB,EAAQ7E,IAAI8E,UAZRkB,GAAAA,EAAQz0B,SAAQ,SAACg0B,GACbA,EAAME,SACNF,EAAMG,iBAe1B54B,EAOOm5B,aAAP,SAA4Cb,GAAgM,IAAA5sB,OACxO,OAAO,IAAIotB,SAAQ,SAACC,GAChBrtB,EAAKstB,QAAON,KACLJ,GACHlb,WAAY2b,SAKxB/4B,EAKOo5B,WAAP,SAAA7f,GAAwH,IAAAY,OAApGnR,EAAGuQ,EAAHvQ,IAAKC,EAAGsQ,EAAHtQ,IAAKmU,EAAU7D,EAAV6D,WAC1B,GAAIzf,KAAKy6B,WAAWrxB,IAAIiC,GAAxB,CACI,IAAMgvB,EAAUr6B,KAAKy6B,WAAW16B,IAAIsL,GACpCoU,GAAc4a,EAAQ5a,WAAWhW,KAAKgW,OAF1C,CAOA,IAAM4a,EAAUD,EAAQ3oB,OAAOgO,GAI/B,GAHAzf,KAAKy6B,WAAWl1B,IAAI8F,EAAKgvB,GAGrBr6B,KAAKw6B,SAASpxB,IAAIiC,GAAtB,CACI,IAAMyvB,EAAQ96B,KAAKw6B,SAASz6B,IAAIsL,GAEhC6B,YAAW,WAEFsP,EAAKie,WAAWrxB,IAAIiC,KACzBmR,EAAKie,kBAAkBpvB,GACvBgvB,EAAQ5a,WAAW3Y,SAAQ,SAAAsJ,GAAE,OAAIA,EAAG0qB,MACpCV,EAAQ7E,IAAI8E,MACb,QAIPn6B,EAAKE,KAAKuM,QAAQsI,OAAOwmB,WAAW,CAChCpwB,IAAAA,EAAKC,IAAAA,EACLmU,WAAY,SAACqb,GAET,IAAKte,EAAKie,WAAWrxB,IAAIiC,GAGrB,OAFAyvB,EAAME,cACNF,EAAMG,SAGVze,EAAKie,kBAAkBpvB,GACnByvB,IACAA,EAAME,SACNxe,EAAKge,SAASj1B,IAAI8F,EAAKyvB,IAE3BT,EAAQ5a,WAAW3Y,SAAQ,SAAAsJ,GAAE,OAAIA,EAAG0qB,MACpCV,EAAQ7E,IAAI8E,QAKxBh4B,EAKOq5B,gBAAP,SAAuBf,GAA8D,IAAAxc,OACjF,OAAO,IAAIgd,SAAQ,SAACC,GAChBjd,EAAKsd,WAAUV,KACRJ,GACHlb,WAAY2b,SAKxB/4B,EAWOmd,QAAP,SAAemb,GACPA,EAAOtvB,IACPrL,KAAKy7B,WAAW,CACZpwB,IAAKsvB,EAAOtvB,IACZC,IAAKqvB,EAAOrvB,IACZmU,WAAY,SAACE,GACT,IAAKA,IAASxS,EAAQwtB,EAAOjuB,QAGzB,OAFAiuB,EAAOgB,QAAUhB,EAAOgB,cACxBhB,EAAOlb,YAAckb,EAAOlb,YAAW,IAG3Ckb,EAAOjuB,OAAOiT,KAAOA,EACrBgb,EAAOiB,WAAajB,EAAOiB,YAC3BjB,EAAOlb,YAAckb,EAAOlb,YAAW,MAI/Czf,KAAKwV,KAAK,CACNnB,KAAMsmB,EAAOtmB,KACbN,OAAQ4mB,EAAO5mB,OACf8D,KAAM6H,EACND,WAAY,SAACE,GACT,IAAKA,IAASxS,EAAQwtB,EAAOjuB,QAGzB,OAFAiuB,EAAOgB,QAAUhB,EAAOgB,cACxBhB,EAAOlb,YAAckb,EAAOlb,YAAW,IAG3Ckb,EAAOjuB,OAAOiT,KAAOA,EACrBgb,EAAOiB,WAAajB,EAAOiB,YAC3BjB,EAAOlb,YAAckb,EAAOlb,YAAW,OAMvDpd,EAQOud,SAAP,SAAgB+a,GACZ36B,KAAKwV,KAAK,CACNnB,KAAMsmB,EAAOtmB,KACbN,OAAQ4mB,EAAO5mB,OACf8D,KAAMgI,EAAGC,aACTL,WAAY,SAACM,GACT,IAAKA,IAAiB5S,EAAQwtB,EAAOjuB,QAGjC,OAFAiuB,EAAOgB,QAAUhB,EAAOgB,cACxBhB,EAAOlb,YAAckb,EAAOlb,YAAW,IAG3Ckb,EAAOjuB,OAAOqT,aAAeA,EAC7B4a,EAAOiB,WAAajB,EAAOiB,YAC3BjB,EAAOlb,YAAckb,EAAOlb,YAAW,OAKnDpd,EAWO2d,UAAP,SAAiB2a,GACTA,EAAOtvB,IACPrL,KAAKy7B,WAAW,CACZpwB,IAAKsvB,EAAOtvB,IACZC,IAAKqvB,EAAOrvB,IACZmU,WAAY,SAACoc,GACT,IAAKA,IAAe1uB,EAAQwtB,EAAOjuB,QAG/B,OAFAiuB,EAAOgB,QAAUhB,EAAOgB,cACxBhB,EAAOlb,YAAckb,EAAOlb,YAAW,IAG3C,IAAMS,EAAcD,EAAY6b,gBAAgBD,GAChDlB,EAAOjuB,OAAOwT,YAAcA,EAC5Bya,EAAOiB,WAAajB,EAAOiB,YAC3BjB,EAAOlb,YAAckb,EAAOlb,YAAW,MAI/Czf,KAAKwV,KAAK,CACNnB,KAAMsmB,EAAOtmB,KACbN,OAAQ4mB,EAAO5mB,OACf8D,KAAMoI,EACNR,WAAY,SAACS,GACT,IAAKA,IAAgB/S,EAAQwtB,EAAOjuB,QAGhC,OAFAiuB,EAAOgB,QAAUhB,EAAOgB,cACxBhB,EAAOlb,YAAckb,EAAOlb,YAAW,IAG3Ckb,EAAOjuB,OAAOwT,YAAcA,EAC5Bya,EAAOiB,WAAajB,EAAOiB,YAC3BjB,EAAOlb,YAAckb,EAAOlb,YAAW,OAMvDpd,EAGO05B,WAAP,WACI,IAAMC,EAAqB,GAC3Bh8B,KAAKw6B,SAAS1zB,SAAQ,SAAAg0B,GAAK,OAAIkB,EAAUvyB,KAAKqxB,MAC9C96B,KAAKw6B,SAASn1B,QACdrF,KAAKy6B,WAAWp1B,QAEhB6H,YAAW,WACP8uB,EAAUl1B,SAAQ,SAAAg0B,GAAK,OAAIA,EAAMG,cAClC,MACNV,iBAGJx5B,EAAQ,gBAAgBG,GAAAwY,WAAA2N,GAAA,SAAA4U,IAAA,OAAA5U,EAAAplB,WAAAL,iBAAAhC,EAAAq8B,EAAA5U,GAAA,IAAAlX,EAAA8rB,EAAA35B,UA4cpB,OA5coB6N,EAgBb+rB,OAAR,SAAeA,EAAclgB,GAA0Q,IAAAmgB,OAAtQpoB,EAAMiI,EAANjI,OAAQ8mB,EAAO7e,EAAP6e,QAASxmB,EAAI2H,EAAJ3H,KAAMwD,EAAImE,EAAJnE,KAAMnM,EAAUsQ,EAAVtQ,WAAY+T,EAAUzD,EAAVyD,WACtE,IAAKyc,EAED,OADAl8B,KAAKuW,MAAM,mBACJkJ,GAAcA,EAAW,MAEpC,IAAKpL,EAED,OADArU,KAAKuW,MAAS2lB,0BACPzc,GAAcA,EAAW,MAE/B1L,IAAQA,EAAS,aAEtB,IAAMjS,EAAc,CAACuS,GACjBwD,GAAM/V,EAAK2H,KAAKoO,GAChBnM,GAAY5J,EAAK2H,KAAKiC,GAC1B5J,EAAK2H,MAAK,SAAC8B,EAAa6wB,GAChB7wB,GACA4wB,EAAK5lB,MAAS2lB,OAAW7nB,WAAc9I,GACnCsM,IAASoI,GAAmC,iBAApB5L,EAAK9B,OAAO,IACpC4pB,EAAK7lB,uDAAuDjC,WAAaA,mBAClEwD,IAASwkB,GAAgC,aAAnBhoB,EAAK9B,OAAO,GACzC4pB,EAAK7lB,iDAAiDjC,WAAaA,eAC5DwD,IAASykB,GAAmC,iBAApBjoB,EAAK9B,OAAO,KAC3C4pB,EAAK7lB,uDAAuDjC,WAAaA,mBAE7EoL,GAAcA,EAAW,OAEzBA,GAAcA,EAAW2c,MAIjCp8B,KAAKwL,WAAW,CACZuI,OAAAA,EAAQ8mB,QAAAA,EACRpb,oBAAW1L,GACP,IAAKA,EAAQ,OAAO0L,GAAcA,EAAW,MAC7C1L,EAAOmoB,GAAQp6B,EAAK,GAAIA,EAAK,GAAIA,EAAK,GAAIA,EAAK,QAK3DqO,EAKOuqB,QAAP,SAAeC,GACP4B,IAAe5B,EAAO9iB,KACtB7X,KAAKk8B,OAAO,eAAgB,CAAE7nB,KAAMsmB,EAAOtmB,KAAMN,OAAQ4mB,EAAO5mB,OAAQ8mB,QAASF,EAAOE,QAASnvB,WAAYivB,EAAOjvB,WAAY+T,WAAYkb,EAAOlb,aAEnJzf,KAAKk8B,OAAO,UAAWvB,IAI/BxqB,EAKOyqB,WAAP,SAAkBD,GACd36B,KAAKk8B,OAAO,aAAcvB,IAG9BxqB,EAOOqF,KAAP,SAAoCmlB,GAC5B4B,IAAe5B,EAAO9iB,KACtB7X,KAAKk8B,OAAO,YAAa,CAAE7nB,KAAMsmB,EAAOtmB,KAAMN,OAAQ4mB,EAAO5mB,OAAQ8mB,QAASF,EAAOE,QAASnvB,WAAYivB,EAAOjvB,WAAY+T,WAAYkb,EAAOlb,aAEhJzf,KAAKk8B,OAAO,OAAQvB,IAI5BxqB,EAOO+qB,UAAP,SAAyCP,GAA8L,IAAA6B,OACnO,OAAO,IAAIrB,SAAQ,SAACC,GAChBoB,EAAKhnB,KAAIulB,KACFJ,GACHlb,WAAY2b,SAKxBjrB,EAOOkrB,QAAP,SAAuCV,GACnC36B,KAAKk8B,OAAO,UAAWvB,IAG3BxqB,EAOOqrB,aAAP,SAA4Cb,GAAgM,IAAA8B,OACxO,OAAO,IAAItB,SAAQ,SAACC,GAChBqB,EAAKpB,QAAON,KACLJ,GACHlb,WAAY2b,SAKxBjrB,EAMO4O,QAAP,SAAA2d,GAA+F,IAAAC,EAA9EtoB,EAAIqoB,EAAJroB,KAAMN,EAAM2oB,EAAN3oB,OAAQ8D,EAAI6kB,EAAJ7kB,KACtB9D,IAAQA,EAAS,oBACtB4oB,EAAAxxB,EAAaW,UAAUiI,KAAvB4oB,EAAgC5d,QAAQ1K,EAAMwD,IAGlD1H,EAIO4rB,WAAP,SAAkBhoB,GACTA,IAAQA,EAAS,aACtB,IAAM6oB,EAAUzxB,EAAaW,UAAUiI,GAClC6oB,GAELA,EAAQ1oB,eAAe,IAAK2oB,GAAO/1B,SAAQ,SAACg0B,GACxC8B,EAAQ7d,QAAQ+b,EAAMzmB,KAAMymB,EAAMgC,UAM1C3sB,EAIO4sB,cAAP,SAAqBhpB,GAAiB,IAAAipB,EAC7BjpB,IAAQA,EAAS,oBAEtBipB,EAAA7xB,EAAaW,UAAUiI,KAAvBipB,EAAgCC,uBAGpC9sB,EAKO3E,WAAP,SAAA0xB,GAAoJ,IAAhInpB,EAAMmpB,EAANnpB,OAAQ8mB,EAAOqC,EAAPrC,QAASpb,EAAUyd,EAAVzd,WAC5B1L,IAAQA,EAAS,aAwBlB8mB,EACA1vB,EAAaK,WAAWuI,EAAQ,CAAE8mB,QAAAA,IAAW,SAACtvB,EAAYwI,GACtD0L,GAAcA,EAAWlU,EAAM,KAAOwI,MAG1C5I,EAAaK,WAAWuI,GAAQ,SAACxI,EAAYwI,GACzC0L,GAAcA,EAAWlU,EAAM,KAAOwI,OAKlD5D,EAKOgtB,gBAAP,SAAuBxC,GAAoF,IAAAyC,OACvG,OAAO,IAAIjC,SAAQ,SAACC,GAChBgC,EAAK5xB,WAAUuvB,KACRJ,GACHlb,WAAY2b,SAKxBjrB,EAIOrE,UAAP,SAAiBiI,GAEb,OADKA,IAAQA,EAAS,aACf5I,EAAaW,UAAUiI,IAGlC5D,EAIOktB,aAAP,SAAoBtpB,GACXA,IAAQA,EAAS,aACtB,IAAMupB,EAAInyB,EAAaW,UAAUiI,GAC7BupB,GAAGnyB,EAAakyB,aAAaC,IAGrCntB,EAMOotB,aAAP,SAAAC,GAAsJ,IAAAC,EAAAC,OAAhI3pB,EAAMypB,EAANzpB,OAAQ8mB,EAAO2C,EAAP3C,QAASpb,EAAU+d,EAAV/d,WAC9B1L,IAAQA,EAAS,aAEtB,IAAI4pB,EAAU,GACVC,EAAY,GAEZzD,EAAM0D,KAAK9pB,GAGX6pB,GAFAD,EAAU5pB,cACK8mB,EAAaA,MAAa,YAIzC8C,EAAaxyB,EAAa2yB,WAAWC,8BAA6BhqB,MAElE6pB,EAAeD,aADA9C,EAAaA,MAAa,mBAK7C4C,EAAAtyB,EAAa6yB,eAAbP,EAA2BQ,YAAYL,GACvCzyB,EAAaswB,WAAWmC,GAAW,SAACryB,EAAYuI,GAC5C,GAAIvI,EAGA,OAFAmyB,EAAKnnB,uBAAuBqnB,cAC5Bne,GAAAA,EAAa,OAIjBie,EAAK3B,WAAW1nB,EAAKqB,SAAS3B,IAC9B2pB,EAAKL,aAAahpB,EAAKqB,SAAS3B,IAEhC,IAAMmqB,EAAK,IAAIC,EAAaC,OACtBzc,EAAS7N,EAAKuqB,KACpB1c,EAAO2c,KAAOX,EACdO,EAAGryB,KAAK8V,SACRlC,GAAAA,EAAaye,OAIrB/tB,EAMOouB,kBAAP,SAAyB5D,GAAoF,IAAA6D,OACzG,OAAO,IAAIrD,SAAQ,SAACC,GAChBoD,EAAKjB,aAAYxC,KACVJ,GACHlb,WAAY2b,SAKxBjrB,EAKOsrB,WAAP,SAAAgD,GAAwH,IAAAC,OAApGrzB,EAAGozB,EAAHpzB,IAAKC,EAAGmzB,EAAHnzB,IAAKmU,EAAUgf,EAAVhf,WACtBnU,EACAH,EAAaswB,WAAWpwB,EAAK,CAAEC,IAAAA,IAAO,SAACiL,EAAO6lB,GAC1C,GAAI7lB,EAEA,OADAmoB,EAAKnoB,oBAAoBlL,WAClBoU,GAAcA,EAAW,MAEpCA,GAAcA,EAAW2c,MAG7BjxB,EAAaswB,WAAWpwB,GAAK,SAACkL,EAAO6lB,GACjC,GAAI7lB,EAEA,OADAmoB,EAAKnoB,oBAAoBlL,WAClBoU,GAAcA,EAAW,MAEpCA,GAAcA,EAAW2c,OAKrCjsB,EAKOurB,gBAAP,SAAuBf,GAA8D,IAAAgE,OACjF,OAAO,IAAIxD,SAAQ,SAACC,GAChBuD,EAAKlD,WAAUV,KACRJ,GACHlb,WAAY2b,SAKxBjrB,EAWOqP,QAAP,SAAemb,GACPA,EAAOtvB,IACPrL,KAAKy7B,WAAW,CACZpwB,IAAKsvB,EAAOtvB,IACZC,IAAKqvB,EAAOrvB,IACZmU,WAAY,SAACE,GACT,IAAKA,IAASxS,EAAQwtB,EAAOjuB,QAGzB,OAFAiuB,EAAOgB,QAAUhB,EAAOgB,cACxBhB,EAAOlb,YAAckb,EAAOlb,YAAW,IAG3Ckb,EAAOjuB,OAAOiT,KAAOA,EACrBgb,EAAOiB,WAAajB,EAAOiB,YAC3BjB,EAAOlb,YAAckb,EAAOlb,YAAW,MAI/Czf,KAAKwV,KAAK,CACNnB,KAAMsmB,EAAOtmB,KACbN,OAAQ4mB,EAAO5mB,OACf8D,KAAM6H,EACND,WAAY,SAACE,GACT,IAAKA,IAASxS,EAAQwtB,EAAOjuB,QAGzB,OAFAiuB,EAAOgB,QAAUhB,EAAOgB,cACxBhB,EAAOlb,YAAckb,EAAOlb,YAAW,IAG3Ckb,EAAOjuB,OAAOiT,KAAOA,EACrBgb,EAAOiB,WAAajB,EAAOiB,YAC3BjB,EAAOlb,YAAckb,EAAOlb,YAAW,OAMvDtP,EAQOyP,SAAP,SAAgB+a,GACZ36B,KAAKwV,KAAK,CACNnB,KAAMsmB,EAAOtmB,KACbN,OAAQ4mB,EAAO5mB,OACf8D,KAAMgI,EAAGC,aACTL,WAAY,SAACM,GACT,IAAKA,IAAiB5S,EAAQwtB,EAAOjuB,QAGjC,OAFAiuB,EAAOgB,QAAUhB,EAAOgB,cACxBhB,EAAOlb,YAAckb,EAAOlb,YAAW,IAG3Ckb,EAAOjuB,OAAOqT,aAAeA,EAC7B4a,EAAOiB,WAAajB,EAAOiB,YAC3BjB,EAAOlb,YAAckb,EAAOlb,YAAW,OAKnDtP,EAWO6P,UAAP,SAAiB2a,GACTA,EAAOtvB,IACPrL,KAAKy7B,WAAW,CACZpwB,IAAKsvB,EAAOtvB,IACZC,IAAKqvB,EAAOrvB,IACZmU,WAAY,SAACoc,GACT,IAAKA,IAAe1uB,EAAQwtB,EAAOjuB,QAG/B,OAFAiuB,EAAOgB,QAAUhB,EAAOgB,cACxBhB,EAAOlb,YAAckb,EAAOlb,YAAW,IAG3C,IAAMS,EAAcD,EAAY6b,gBAAgBD,GAChDlB,EAAOjuB,OAAOwT,YAAcA,EAC5Bya,EAAOiB,WAAajB,EAAOiB,YAC3BjB,EAAOlb,YAAckb,EAAOlb,YAAW,MAI/Czf,KAAKwV,KAAK,CACNnB,KAAMsmB,EAAOtmB,KACbN,OAAQ4mB,EAAO5mB,OACf8D,KAAMoI,EACNR,WAAY,SAACS,GACT,IAAKA,IAAgB/S,EAAQwtB,EAAOjuB,QAGhC,OAFAiuB,EAAOgB,QAAUhB,EAAOgB,cACxBhB,EAAOlb,YAAckb,EAAOlb,YAAW,IAG3Ckb,EAAOjuB,OAAOwT,YAAcA,EAC5Bya,EAAOiB,WAAajB,EAAOiB,YAC3BjB,EAAOlb,YAAckb,EAAOlb,YAAW,OAItDwc,GA3csCrwB,IAahC2uB,OAASA,EAdKjiB,EAcCoB,KAAApB,KAbQzX,IAAAC;;2MClZlC,SAAS89B,kEAKIptB,wBAAM,SAAAA,KA8Dd,OAvDDA,EAGOC,OAAP,SAAcotB,EAAiCC,EAAoBC,EAAeC,GAC9E,OAA2C,GAAvCh/B,KAAKsM,QAAQmQ,OAAOvR,QAAQ2zB,GACrBD,EAWJzoB,OAAOxE,QAAQktB,GAAOzoB,KAAKD,OAAOxE,QAClCotB,QAAU,IAAIhtB,MAAOsE,uBAIhCxW,EAAA2R,IAAA1R,UAAAC,IAGA,WACI,OAAOyR,EAAOC,OAAO,MAAO,UAAW,QAAS,WAGpD3R,WAAAC,IAIA,WACI,OAAOyR,EAAOC,OAAO,OAAQ,UAAW,SAAU,WAGtD3R,YAAAC,IAGA,WACI,OAAOyR,EAAOC,OAAO,QAAS,UAAW,UAAW,WAGxD3R,YAAAC,IAGA,WACI,OAAOyR,EAAOC,OAAO,MAAO,UAAW,UAAW,WAGtD3R,cAAAC,IAGA,WACI,OAAOyR,EAAOC,OAAO,MAAO,UAAW,SAAU,YACpDD,MA9DQA,EACFlF,QAEH,CACImQ,OAAQ,CAAC,QAAS,MAAO,qBA6DtB,IAAIjL,KAAS3Q,IAAAC;;;;wPC5EhBsoB,GAAkB,OAAlBA,EAAAA,iBAAAA,EAAAA,yCAAAA,EAAAA,6BAAAA,EAAAA,yBAAAA,EAAAA,6BAAAA,EAAAA,mBAAAA,UAOXvoB,IAAAC;;4RCHDm+B,EAAU3yB,QAAQouB,QAAU,CAAC,YAE7BuE,EAAU3yB,QAAQ4yB,UAAY,WAE9BD,EAAU3yB,QAAQ6yB,SAAU,EAE5BF,EAAU3yB,QAAQuU,MAAQ,CACtBue,MAAO,EACPC,MAAO,IACPC,IAAK,IACLC,MAAO,IACPC,MAAM,GAIVC,EAAanzB,QAAQouB,QAAU,GAE/B+E,EAAanzB,QAAQuB,iBAAmB,GAExC4xB,EAAanzB,QAAQC,kBAAoB,kBAAgB1L,IAAAC;;ykBClBzD,IAAQC,EAAYC,EAAZD,QAYFigB,WACElhB,EAAa0F,GACb6sB,EAAIqN,aAAaC,QAAQ7/B,EAAK24B,KAAKC,UAAUlzB,KAF/Cwb,WAIElhB,GACA,IAAMgU,EAAOue,EAAIqN,aAAaE,QAAQ9/B,GACtC,GAAIgU,GAAwB,iBAATA,EACf,OAAO2kB,KAAKoH,MAAM/rB,IASxBgsB,EAA0C,IAAIxuB,MAAM,GAAW,CACjEvR,IAAK,SAAU2M,EAAQ5M,GACnB,OAAI4M,EAAO5M,GAAa4M,EAAO5M,IAC/B4M,EAAO5M,GAAOA,EACPA,MAOTigC,EAA4C,IAAIzuB,MAAM,GAAW,CACnEvR,IAAK,SAAU2M,EAAQ5M,GACnB,OAAI4M,EAAO5M,GAAa4M,EAAO5M,IAC/B4M,EAAO5M,GAAOA,EACPA,MAITkgC,EAAa,wBAClBj/B,EAAQ,eAAeG,GAAAK,WAAA8lB,GAAA,SAAAoY,IAAA,IAAA,IAAA/9B,EAAAC,EAAAC,UAAAC,OAAAC,MAAAC,MAAAJ,GAAAK,IAAAA,EAAAL,EAAAK,IAAAF,EAAAE,GAAAJ,UAAAI,GAmC2E,OAnC3EN,EAAA2lB,EAAA1nB,KAAAsC,MAAAolB,SAAAnlB,OAAAJ,WAuBZm+B,kBAAoB,yBAAwBv+B,EAC5Cw+B,mBAAqB,0BAAyBx+B,EAC9Cy+B,yBAA2B,gCAA+Bz+B,EAC1D0+B,0BAA4B,iCAAgC1+B,EAE5DmM,iBAAmB,GAAEnM,EACrB2+B,mBAAqB,EAAC3+B,EACtB6K,kBAAoB,GAAE7K,EACtB4+B,oBAAsB,EAAC5+B,EAEvB6+B,WAAa,GAAE7+B,EACf8+B,eAA8C,GAAE9+B,EAChD++B,aAAe,CAAE5uB,KAAM,GAAIlL,IAAK,EAAG+K,KAAM,GAAI1O,OAAQ,EAAGqB,SAAS,EAAOC,QAAQ,GAAO5C,EAnC3E9B,EAAA6/B,EAAApY,GAmC2E,IAAAhlB,EAAAo9B,EAAAn9B,UAmnB9F,OAnnB8FD,EAErFwJ,KAAV,SAAe8H,GAAkB,IAAA+sB,EACvBp0B,EAAUmzB,EAAanzB,QAU7B,GAPIA,EAAQuB,mBAAkB7N,KAAK6N,iBAAmBvB,EAAQuB,kBACpB,iBAA/BvB,EAAQ+zB,qBAAiCrgC,KAAKqgC,mBAAqB/zB,EAAQ+zB,oBAGlF/zB,EAAQC,oBAAmBvM,KAAKuM,kBAAoBD,EAAQC,mBACrB,iBAAhCD,EAAQg0B,sBAAkCtgC,KAAKsgC,oBAAsBh0B,EAAQg0B,qBAEpFtgC,KAAKigC,kBAAmB,CACxB,IAAMl6B,GAAoD,IAAxCib,EAAYhhB,KAAKigC,mBACnCx6B,EAAYrF,KAAK2I,aAAahD,QAE9B/F,KAAKsW,KAAK,yBAEd,GAAItW,KAAKkgC,mBAAoB,CACzB,IAAMj6B,GAAsD,IAAzC+a,EAAYhhB,KAAKkgC,oBACpCz6B,EAAYrF,KAAKgI,qBAAqBnC,QAEtCjG,KAAKsW,KAAK,0BAEd,GAAItW,KAAKmgC,yBAA0B,CAC/B,IAAMn6B,EAAmBgb,EAAYhhB,KAAKmgC,0BACV,iBAArBn6B,GAA+BP,EAAYrF,KAAKwI,oBAAoB5C,QAE/EhG,KAAKsW,KAAK,gCAEd,GAAItW,KAAKogC,0BAA2B,CAChC,IAAMl6B,EAAoB8a,EAAYhhB,KAAKogC,2BACV,iBAAtBl6B,GAAgCT,EAAYrF,KAAK8H,4BAA4BhC,QAExFlG,KAAKsW,KAAK,iCAGd+Q,EAAA/kB,UAAMuJ,KAAIlM,UAACgU,UAGX+sB,EAAAp0B,EAAQouB,UAARgG,EAAiB55B,SAAQ,SAACuN,GACtBnU,EAAKE,KAAKuM,QAAQsI,OAAOylB,QAAQ,CAC7B3mB,OAAQisB,EACRnoB,KAAM8oB,EACNtsB,KAAMA,QAGjBhS,EAESE,OAAV,WACIjC,EAAKsD,GAAGpD,EAAKogC,YAAY,WACrBn7B,EAAYrF,KAAKiJ,cAErB/I,EAAKsD,GAAGpD,EAAKqgC,YAAY,WACrBp7B,EAAYrF,KAAKkJ,gBAIzBjH,EAOOq4B,QAAP,SAAehpB,GAA8B,IAAAkK,EAAAI,EACnC8kB,GAAcl/B,UAAAC,YAAAD,UAAAC,WAAe,GACR,iBAAnBD,UAAAC,eAAA2pB,EAAA5pB,gBACDA,UAAAC,eAAA2pB,EAAA5pB,eACDo+B,EAEAtrB,GAAY9S,UAAAC,YAAAD,UAAAC,WAAe,KACzB+Z,GAAKha,UAAAC,YAAAD,UAAAC,UAAc,QAACD,UAAAC,QAAA+Z,OAAA4P,EAAA5pB,UAAAga,cAAamlB,UAAS/kB,GACvCpa,UAAAC,YAAAD,UAAAC,UAAc,QAACD,UAAAC,QAAAma,OAAAwP,EAAA5pB,UAAAoa,GACpB,KAGN,OAAKtK,EAS0B,IAA3BA,EAAKxG,QAAQ,WAA6C,IAA1BwG,EAAKxG,QAAQ,UAC7ClL,KAAKuW,MAAM,UAAW,OAAQ7E,QAC9BgD,GAAYxH,YAAW,WACdC,EAAQnN,OACb0U,EAAS,gBAMjBxU,EAAKE,KAAKuM,QAAQsI,OAAOylB,QAAQ,CAC7B3mB,OAAQ+sB,EACRzsB,KAAM3C,EACNmG,KAAM8oB,EACNlhB,WAAY/K,KAtBZ1U,KAAKuW,MAAM,UAAW,aACtB7B,GAAYxH,YAAW,WACdC,EAAQnN,OACb0U,EAAS,YAuBrBrS,EAaOmT,KAAP,SAAY9D,GAAoC,IAAAgrB,EAAAQ,EAAAM,EAAAiB,EAAAuC,EAAA32B,OACtCy2B,GAAcl/B,UAAAC,YAAAD,UAAAC,WAAe,GACR,iBAAnBD,UAAAC,eAAA2pB,EAAA5pB,gBACDA,UAAAC,eAAA2pB,EAAA5pB,eACDo+B,EAEAvrB,GAAY7S,UAAAC,YAAAD,UAAAC,WAAe,KACzB66B,GAAK96B,UAAAC,YAAAD,UAAAC,UAAc,QAACD,UAAAC,QAAA66B,OAAAlR,EAAA5pB,UAAA86B,cAAaqE,YACjC7D,GAAKt7B,UAAAC,YAAAD,UAAAC,UAAc,QAACD,UAAAC,QAAAq7B,OAAA1R,EAAA5pB,UAAAs7B,cAAa6D,UAASvD,GACvC57B,UAAAC,YAAAD,UAAAC,UAAc,QAACD,UAAAC,QAAA27B,OAAAhS,EAAA5pB,UAAA47B,GACpB,KAEA9oB,GAAY9S,UAAAC,YAAAD,UAAAC,WAAe,KACzB48B,GAAK78B,UAAAC,YAAAD,UAAAC,UAAc,QAACD,UAAAC,QAAA48B,OAAAjT,EAAA5pB,UAAA68B,cAAasC,UAASC,GACvCp/B,UAAAC,YAAAD,UAAAC,UAAc,QAACD,UAAAC,QAAAm/B,OAAAxV,EAAA5pB,UAAAo/B,GACpB,KAGN,IAAKtvB,EAMD,OALA1R,KAAKuW,MAAM,OAAQ,aACnB7B,GAAYxH,YAAW,WACdC,EAAQ9C,IACbqK,EAAS,UAKjB,IAAMusB,EAAeH,QAAgBpvB,EAG/BrL,EAAQrG,KAAKugC,WAAWU,GAC1B56B,EACAqO,GAAYxH,YAAW,WACdC,EAAQ9C,IACbqK,EAASrO,MAMjBnG,EAAKE,KAAKuM,QAAQsI,OAAOO,KAAK,CAC1BnB,KAAM3C,EACNqC,OAAQ+sB,EACRjpB,KAAM8oB,EACNj1B,WAAY+I,EACZgL,WAAY,SAACrZ,GACJ+G,EAAQ9C,KACTjE,GACAiE,EAAKk2B,WAAWU,GAAa76B,EAC7BsO,GAAYA,EAAStO,IAErBsO,GAAYA,EAAS,WAMrCrS,EAOO0c,QAAP,SAAerN,EAAcqC,GACzB,IAAM+sB,EAAa/sB,GAAUisB,EACvBiB,EAAeH,QAAgBpvB,SAE9B1R,KAAKugC,WAAWU,GACvB/gC,EAAKE,KAAKuM,QAAQsI,OAAO8J,QAAQ,CAAEhL,OAAQ+sB,EAAYzsB,KAAM3C,EAAMmG,KAAM8oB,KAG7Et+B,EAGOgM,iBAAP,SAAwB6yB,GAChBlhC,KAAK6N,iBACL7N,KAAKsI,UAAU,CAAEoJ,KAAS1R,KAAK6N,iBAAkB7K,OAAQhD,KAAKqgC,mBAAoBa,OAAAA,IAElFlhC,KAAKsW,KAAK,yBAIlBjU,EAGOmK,kBAAP,SAAyB00B,GACjBlhC,KAAKuM,kBACLvM,KAAKmG,WAAW,CAAEuL,KAAS1R,KAAKuM,kBAAmBvJ,OAAQhD,KAAKsgC,oBAAqBY,OAAAA,IAErFlhC,KAAKsW,KAAK,0BAIlBjU,EAMO8+B,gBAAP,SAAuBz0B,EAAgBgF,EAAU0vB,GAI7C,GAAI1vB,EAAM,CACN,IAAA2vB,EAAqCD,GAAQ,GAAEE,EAAAD,EAAvCr+B,OAAAA,WAAMs+B,EAAG,EAACA,EAAAC,EAAAF,EAAEG,SAAAA,WAAQD,EAAG,EAACA,EAEhC70B,EAAOlJ,KAAuB,kBAAI,EAClCkJ,EAAOlJ,KAAK8M,UAAUtQ,MACtB0M,EAAOlJ,KAAKI,GAAGqJ,EAAOtM,UAAUkkB,OAAO,WACnC7kB,KAAKmG,WAAW,CAAEuL,KAAAA,EAAM1O,OAAAA,EAAQw+B,SAAAA,MACjCxhC,WAGH0M,EAAOlJ,KAAuB,kBAAI,EAClCkJ,EAAOlJ,KAAK8M,UAAUtQ,OAI9BqC,EAUO8D,WAAP,SAAAs7B,GAAsG,IAAAt1B,OAAlFuF,EAAI+vB,EAAJ/vB,KAAMqC,EAAM0tB,EAAN1tB,OAAM2tB,EAAAD,EAAEz+B,OAAAA,WAAM0+B,EAAG,EAACA,EAAAC,EAAAF,EAAEx8B,KAAAA,WAAI08B,GAAQA,EAAAC,EAAAH,EAAED,SAAAA,WAAQI,EAAG,EAACA,EAAEz9B,EAAOs9B,EAAPt9B,QAAS+8B,EAAMO,EAANP,OAAQ7jB,EAAOokB,EAAPpkB,QACvF,GAAK3L,EAAL,CAKA,IAAMovB,EAAa/sB,GAAUisB,EACvBiB,EAAeH,QAAgBpvB,EAGjC1R,KAAK6hC,cAKL7hC,KAAKwgC,eAAeS,IAAclvB,KAAKC,MAAQhS,KAAKwgC,eAAeS,GAJnE5jB,GAAWA,IAUfrd,KAAKwV,KAAK9D,EAAMovB,GAAY,SAAC16B,GACzB,GAAK+G,EAAQhB,GAKb,GAAIA,EAAK01B,aACLxkB,GAAWA,SAIf,GAAIlR,EAAKq0B,eAAeS,IAAclvB,KAAKC,MAAQ7F,EAAKq0B,eAAeS,GACnE5jB,GAAWA,QADf,CAIA,IAAKjX,EAGD,OAFA+F,EAAKoK,oBAAoB7E,oBACzB2L,GAAWA,KAIXmkB,EAAW,IACXr1B,EAAKq0B,eAAeS,GAAalvB,KAAKC,MAAmB,IAAXwvB,GAGlD/7B,EAAYrF,KAAK+F,WAAWC,EAAWpD,EAAQiC,EAAMi8B,EAAQ/8B,QAvBzDkZ,GAAWA,YArBfA,GAAWA,KAgDnBhb,EAWay/B,2BAAe,IAAAC,EAAAC,EAAAC,IAAAC,MAA5B,SAAAC,EAA6BxH,GAAW,IAAA5sB,OAAA,OAAAk0B,IAAAG,eAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAr3B,MAAA,OAAA,OAAAq3B,EAAAE,gBAC7B,IAAIpH,SAAQ,SAACC,GAChBrtB,EAAK5H,WAAU40B,KACRJ,GACHuG,OAAQ,SAACx7B,GACL01B,EAAQ11B,IAEZ2X,QAAS,WACL+d,EAAQ,cAGlB,OAAA,UAAA,OAAAiH,EAAA99B,UAAA49B,OACL,OAAA,SAAAK,GAAA,OAAAT,EAAA9/B,WAAAL,eAEDS,EAKO0E,YAAP,SAAmBJ,GACf,OAAOlB,EAAYrF,KAAK2G,YAAYJ,IAGxCtE,EAIO4E,gBAAP,WACI,OAAOxB,EAAYrF,KAAK6G,mBAG5B5E,EAKO6E,aAAP,SAAoBP,GAChB,OAAOlB,EAAYrF,KAAK8G,aAAaP,IAGzCtE,EAIO+E,iBAAP,WACI,OAAO3B,EAAYrF,KAAKgH,oBAG5B/E,EAKOqE,WAAP,SAAkBC,GACd,OAAOlB,EAAYrF,KAAKsG,WAAWC,IAGvCtE,EAIOwE,eAAP,WACI,OAAOpB,EAAYrF,KAAKyG,kBAG5BxE,EAQOiG,UAAP,SAAAm6B,GAAqF,IAAAjmB,OAAlE9K,EAAI+wB,EAAJ/wB,KAAMqC,EAAM0uB,EAAN1uB,OAAM2uB,EAAAD,EAAEz/B,OAAAA,WAAM0/B,EAAG,EAACA,EAAAC,EAAAF,EAAEG,MAAAA,WAAKD,GAAQA,EAAEzB,EAAMuB,EAANvB,OAAQ7jB,EAAOolB,EAAPplB,QAChE,GAAK3L,EAAL,CAKA,IAAMovB,EAAa/sB,GAAUisB,EACvBiB,EAAeH,QAAgBpvB,EAGrC,IAAKkxB,IAAmC,IAA1B5iC,KAAKygC,aAAa95B,IAAa3G,KAAKygC,aAAa/uB,OAASuvB,EAGpE,OAFAx7B,EAAYrF,KAAKsI,eAAe1F,QAChCk+B,GAAUA,KAKdlhC,KAAKuI,YAGL,IAAMsJ,EAAO7R,KAAK4T,aAClB5T,KAAKygC,aAAa5uB,KAAOA,EAEzB7R,KAAKygC,aAAa/uB,KAAOuvB,EAEzBjhC,KAAKygC,aAAaz9B,OAASA,EAE3BhD,KAAKygC,aAAap8B,SAAU,EAC5BrE,KAAKygC,aAAan8B,QAAS,EAGvBtE,KAAK6iC,YACL3B,GAAUA,IAKdlhC,KAAKwV,KAAK9D,EAAMovB,GAAY,SAAC16B,GACzB,GAAK+G,EAAQqP,GAKb,IAA8B,IAA1BA,EAAKikB,aAAa95B,GAItB,GAAI6V,EAAKikB,aAAa/uB,OAASuvB,EAA/B,CAIA,GAAIzkB,EAAKikB,aAAa5uB,MAAS2K,EAAKikB,aAAa5uB,KAKjD,OAAKzL,OAMDoW,EAAKqmB,YACL3B,GAAUA,IAId1kB,EAAKikB,aAAa95B,GAAKlB,EAAYrF,KAAKkI,UAAUlC,EAAWpD,EAAQk+B,KAVjE1kB,EAAKjG,mBAAmB7E,oBACxB2L,GAAWA,MANXA,GAAWA,SAJXA,GAAWA,SAJXA,GAAWA,SALXA,GAAWA,YArCfA,GAAWA,KAqEnBhb,EASOygC,eAAP,SAAsBnI,GAA+B,IAAAxc,OACjD,OAAO,IAAIgd,SAAQ,SAACC,GAChBjd,EAAK7V,UAASyyB,KACPJ,GACHuG,OAAQ,WACJ9F,GAAQ,IAEZ/d,QAAS,WACL+d,GAAQ,WAMxB/4B,EAGO6L,YAAP,SAAmBgzB,GACf,GAAKlhC,KAAKygC,aAAap8B,SAClBrE,KAAKygC,aAAa/uB,KACvB,GAAI1R,KAAKygC,aAAa/uB,KAAKxG,QAAQ,OAAS,EAAG,CAC3C,IAAA63B,EAAuB/iC,KAAKygC,aAAa/uB,KAAKsxB,MAAM,OAA7CjvB,EAAMgvB,KAAErxB,EAAIqxB,KACnB/iC,KAAKsI,UAAU,CACXoJ,KAAAA,EACAqC,OAAAA,EACA/Q,OAAQhD,KAAKygC,aAAaz9B,OAC1B4/B,OAAO,EACP1B,OAAAA,SAGJlhC,KAAKsI,UAAU,CACXoJ,KAAM1R,KAAKygC,aAAa/uB,KACxB1O,OAAQhD,KAAKygC,aAAaz9B,OAC1B4/B,OAAO,EACP1B,OAAAA,KAKZ7+B,EAGOmG,WAAP,WACI,QAAKxI,KAAKygC,aAAap8B,UACvBrE,KAAKygC,aAAan8B,QAAS,EACpBmB,EAAYrF,KAAKoI,eAG5BnG,EAGOoG,YAAP,WACI,QAAKzI,KAAKygC,aAAap8B,UACvBrE,KAAKygC,aAAan8B,QAAS,EACpBmB,EAAYrF,KAAKqI,gBAG5BpG,EAGOkG,UAAP,WAOI,OANAvI,KAAKygC,aAAap8B,SAAU,EAC5BrE,KAAKygC,aAAan8B,QAAS,EAC3BtE,KAAKygC,aAAaz9B,OAAS,EAC3BhD,KAAKygC,aAAa/uB,KAAO,GACzB1R,KAAKygC,aAAa5uB,KAAO,GACzB7R,KAAKygC,aAAa95B,IAAM,EACjBlB,EAAYrF,KAAKmI,aAG5BlG,EAKO0G,aAAP,SAAoB7F,EAAe+/B,GAG/B,YAH+BA,IAAAA,GAAU,GACzCA,GAAWjiB,EAAYhhB,KAAKigC,kBAAmB/8B,GAC/CuC,EAAYrF,KAAK2I,aAAa7F,IACzBA,GAAQlD,KAAKygC,aAAa/uB,KAC3B,GAAI1R,KAAKygC,aAAa/uB,KAAKxG,QAAQ,OAAS,EAAG,CAC3C,IAAAg4B,EAAuBljC,KAAKygC,aAAa/uB,KAAKsxB,MAAM,OAA7CjvB,EAAMmvB,KAAExxB,EAAIwxB,KACnBljC,KAAKsI,UAAU,CACXoJ,KAAAA,EACAqC,OAAAA,EACA/Q,OAAQhD,KAAKygC,aAAaz9B,cAI9BhD,KAAKsI,UAAU,CACXoJ,KAAM1R,KAAKygC,aAAa/uB,KACxB1O,OAAQhD,KAAKygC,aAAaz9B,UA2B1CX,EAKOgF,cAAP,SAAqBnE,EAAe+/B,YAAAA,IAAAA,GAAU,GAC1Cx9B,EAAYrF,KAAKgI,qBAAqBlF,GACtC+/B,GAAWjiB,EAAYhhB,KAAKkgC,mBAAoBh9B,IAUpDb,EAKOuG,oBAAP,SAA2BhE,EAAeq+B,YAAAA,IAAAA,GAAU,GAChDx9B,EAAYrF,KAAKwI,oBAAoBhE,GACrCq+B,GAAWjiB,EAAYhhB,KAAKmgC,yBAA0Bv7B,IAU1DvC,EAKOyF,qBAAP,SAA4BlD,EAAeq+B,YAAAA,IAAAA,GAAU,GACjDx9B,EAAYrF,KAAK8H,4BAA4BtD,GAC7Cq+B,GAAWjiB,EAAYhhB,KAAKogC,0BAA2Bx7B,IAG3D/E,EAAA4/B,IAAA3/B,qBAAAC,IA9DA,WACI,OAAOC,KAAKygC,aAAap8B,WAG7BvE,oBAAAC,IAGA,WACI,OAAOC,KAAKygC,aAAan8B,UAG7BxE,kBAAAC,IAGA,WACI,OAAO0F,EAAYrF,KAAK6I,kBAC3BnJ,mBAAAC,IAeD,WACI,OAAO0F,EAAYrF,KAAKiI,0BAC3BvI,uBAAAC,IAeD,WACI,OAAO0F,EAAYrF,KAAK0I,yBAC3BhJ,wBAAAC,IAeD,WACI,OAAO0F,EAAYrF,KAAK+H,kCAC3Bs3B,GArpByE7zB,IAEnEU,QAaH,GAAE/K,EAGCu+B,UAAYA,EAASv+B,EAErBw+B,WAAaA,EArBAj9B,EAqBUvB,KAAAuB,KApBDjC,IAAAC;;2OCpDjC,IAAMqiC,EAAQ,oEAsBd,IAmBMC,EAAoB,WACtB,IApByBC,EAQrBC,EACAhG,EACAiG,EAEAC,EAA+BC,EAC/BC,EAOEC,EAAO,IAAI5xB,KAGjB,OAFa4xB,EAAKC,cAEJ,IAfVN,GADJD,GAPyBA,EAsBDM,IAfH,IAAI5xB,MACT6xB,cACZtG,EAAI+F,EAAQQ,WAAa,EACzBN,EAAIF,EAAQS,UAEZN,EAAQ,IAAIzxB,KAAKuxB,EAAGhG,EAAI,EAAGiG,GAAIE,EAAQ,IAAI1xB,KAAKuxB,EAAG,EAAG,GACtDI,EAAIh1B,KAAKq1B,OAAOP,EAAMQ,UAAYP,EAAMO,WAAa,OAClDt1B,KAAK6f,MACPmV,GAAMD,EAAMQ,SAAW,EAAK,IAAM,KAWrCC,EAAmB,SAAUb,GAE/B,OADAA,EAAUA,GAAW,IAAItxB,MACVoyB,sBAGNC,yBAAO,SAAAA,IAAApkC,KAWRqkC,OAAS,GAAE,IAAAhiC,EAAA+hC,EAAA9hC,UAsKlB,OApKDD,EAGAkD,IAAA,SAAIzF,EAAa0F,GACb,GAAmB,iBAAR1F,QAAqC,IAAV0F,EAClC,IACI,IAAMsO,EAAO2kB,KAAKC,UAAUlzB,GAQ5B,OAPI4+B,EAAQ93B,QAAQg4B,UAChBjS,EAAIqN,aAAaC,QAAQ7/B,EAxE7C,SAAgBykC,EAAczkC,GAC1BA,EAAMA,GAAOqjC,EAEb,IADA,IAAIqB,EAAY,GACPhpB,EAAI,EAAGA,EAAI+oB,EAAK1iC,OAAQ2Z,IAAK,CAClC,IAAMipB,EAAWF,EAAKG,WAAWlpB,GAAK1b,EAAI4kC,WAAWlpB,EAAI1b,EAAI+B,QAC7D2iC,GAAa5e,OAAO+e,aAAaF,GAErC,OAAOD,EAiEuCI,CAAO9wB,EAAMswB,EAAQ93B,QAAQg4B,YAE3DjS,EAAIqN,aAAaC,QAAQ7/B,EAAKgU,GAGlC9T,KAAKqkC,OAAOvkC,GAAOgU,GACZ,EACT,MAAOvI,GAAOqG,EAAIrG,QAEpBgL,EAAM,qBAEV,OAAO,GAGXlU,EAGAtC,IAAA,SAAID,GAEA,QAAgC,IAArBE,KAAKqkC,OAAOvkC,GACnB,OAAO24B,KAAKoH,MAAM7/B,KAAKqkC,OAAOvkC,IAGlC,IAAI8c,EAAS,KACb,IACI,IAAI9I,EAAOue,EAAIqN,aAAaE,QAAQ9/B,GAChCgU,GAAwB,iBAATA,GACXswB,EAAQ93B,QAAQg4B,YAAWxwB,EAzF/C,SAAgB+wB,EAAuB/kC,GACnCA,EAAMA,GAAOqjC,EAEb,IADA,IAAI2B,EAAY,GACPtpB,EAAI,EAAGA,EAAIqpB,EAAchjC,OAAQ2Z,IAAK,CAC3C,IAAMipB,EAAWI,EAAcH,WAAWlpB,GAAK1b,EAAI4kC,WAAWlpB,EAAI1b,EAAI+B,QACtEijC,GAAalf,OAAO+e,aAAaF,GAErC,OAAOK,EAkF2CC,CAAOjxB,EAAMswB,EAAQ93B,QAAQg4B,YAEnEtkC,KAAKqkC,OAAOvkC,GAAOgU,EACnB8I,EAAS6b,KAAKoH,MAAM/rB,IACJ,KAATA,GAAwB,OAATA,IACtB8I,OAAS4O,GAEf,MAAO/e,GACLmQ,OAAS4O,EAEb,OAAO5O,GAGXva,EAGA0I,IAAA,SAAIjL,EAAa0F,YAAAA,IAAAA,EAAgB,GAC7B,IAAIoX,EAAS5c,KAAKD,IAAID,GACtB,aAAe0rB,IAAX5O,IACAA,EAASA,GAAU,EACnBA,GAAUpX,GACNxF,KAAKuF,IAAIzF,EAAK8c,MACPA,GAMnBva,EAGAyN,OAAA,SAAOhQ,GACH,IAGI,OAFAuyB,EAAIqN,aAAasF,WAAWllC,UACrBE,KAAKqkC,OAAOvkC,IACZ,EACT,MAAOyL,GACL,OAAO,IAIflJ,EAGAgD,MAAA,WACI,IAGI,OAFAgtB,EAAIqN,aAAar6B,QACjBgN,EAAGhN,MAAMrF,KAAKqkC,SACP,EACT,MAAO94B,GACL,OAAO,IAIflJ,EAIA4iC,QAAA,SAAQnlC,EAAa0F,EAAgB4K,GACjC,IAAM80B,EAAa9B,IAEnB,IAAIhzB,EAWA,OAAOpQ,KAAKuF,IAAIzF,EAAK,CACjBgU,KAAMtO,EACN0/B,WAAYA,IAZhB,IAAMpxB,EAAO9T,KAAKmlC,QAAQrlC,GAC1B,aAAa0rB,IAAT1X,GACa,OAATA,IAAiB1D,EAAG0D,EAAMtO,KACnBxF,KAAKuF,IAAIzF,EAAK,CACjBgU,KAAMtO,EACN0/B,WAAYA,KAchC7iC,EAGA8iC,QAAA,SAAQrlC,GACJ,IAAMgU,EAAO9T,KAAKD,IAAID,GACtB,OAAIgU,GAAQA,EAAKoxB,YAAc9B,IACpBtvB,EAAKA,KAETA,GAAQ,MAGnBzR,EAIA+iC,OAAA,SAAOtlC,EAAa0F,EAAgB4K,GAChC,IAAM80B,EAAahB,IAEnB,IAAI9zB,EAWA,OAAOpQ,KAAKuF,IAAIzF,EAAK,CACjBgU,KAAMtO,EACN0/B,WAAYA,IAZhB,IAAMpxB,EAAO9T,KAAKikC,OAAOnkC,GACzB,aAAa0rB,IAAT1X,GACa,OAATA,IAAiB1D,EAAG0D,EAAMtO,KACnBxF,KAAKuF,IAAIzF,EAAK,CACjBgU,KAAMtO,EACN0/B,WAAYA,KAchC7iC,EAIA4hC,OAAA,SAAOnkC,GACH,IAAMgU,EAAO9T,KAAKD,IAAID,GACtB,OAAIgU,GAAQA,EAAKoxB,YAAchB,IACpBpwB,EAAKA,KAETA,GAAQ,MAClBswB,MAjLQA,EACF93B,QAMH,CACIg4B,UAAW,gBA4KR,IAAIF,KAAUvjC,IAAAC;;oQCvNhBukC,sBAAI,SAAAA,IAAArlC,KACLslC,SAAU,EAAKtlC,KACf2P,OAAiB,EAAC3P,KAClBulC,KAAkB,GAAEvlC,KACpB2T,OAAgC,KAExC3T,KAGOs7B,QAAa,GAAE,IAAAj5B,EAAAgjC,EAAA/iC,UAuIrB,OArIDD,EAIOqN,KAAP,WACI,OAAO1P,KAAKulC,KAAK1jC,QAGrBQ,EAKO0I,IAAP,SAAWmxB,GAGP,OAFAl8B,KAAKulC,KAAK97B,KAAKyyB,GACfl8B,KAAKs7B,QAAQ7xB,UAAK+hB,GACXxrB,MAGXqC,EAKOoJ,MAAP,SAAakI,GACT,OAAI3T,KAAKslC,UAITtlC,KAAKslC,SAAU,EACftlC,KAAK2P,OAAS,EACd3P,KAAK2T,OAASA,EAEd3T,KAAKgL,KAAKhL,KAAK2P,QAPJ3P,MAYfqC,EAIOkC,KAAP,WACI,QAAKvE,KAAKslC,UAIVtlC,KAAKslC,SAAU,EACXtlC,KAAK2T,QACL3T,KAAK2T,OAAO3T,KAAKs7B,SAAS,IAGvB,IAGXj5B,EAIOmjC,UAAP,WACI,OAAOxlC,KAAKslC,SAGhBjjC,EAIOojC,OAAP,WACI,OAAQzlC,KAAKslC,SAChBjjC,EAEOi9B,IAAR,SAAYxrB,GACR,QAAK9T,KAAKslC,eAIU,IAATxxB,IACP9T,KAAKs7B,QAAQt7B,KAAK2P,OAASmE,GAG/B9T,KAAKslC,SAAU,EACXtlC,KAAK2T,QACL3T,KAAK2T,OAAO3T,KAAKs7B,SAAS,IAGvB,IACVj5B,EAEO2I,KAAR,SAAa2E,EAAemE,GACxB,QAAK9T,KAAKslC,UAIN31B,IAAU3P,KAAK2P,aAEC,IAATmE,IACP9T,KAAKs7B,QAAQt7B,KAAK2P,OAASmE,KAGzB9T,KAAK2P,MAAQ3P,KAAKulC,KAAK1jC,OACzB7B,KAAKiL,MAAMjL,KAAK2P,OAEhB3P,KAAKs/B,OAGF,KACVj9B,EAEO4I,MAAR,SAAc0E,GAAwB,IAAAjO,OAClC,IAAK1B,KAAKslC,QACN,OAAO,EAGX,GAAI31B,IAAU3P,KAAK2P,MAAO,OAAO,EAEjC,IAAMusB,EAASl8B,KAAKulC,KAAK51B,GAiBzB,OAhBAusB,GAAUA,GACN,SAACpoB,GAAU,OAAKpS,EAAKsJ,KAAK2E,EAAOmE,MACjC,SAAC4xB,GACG,gBADHA,IAAAA,EAAU,GACA,IAAIvK,SAAQ,SAAAC,GACXsK,EAAU,EACVx4B,YAAW,WACPkuB,EAAQ15B,EAAKuJ,MAAM0E,MACV,IAAV+1B,GAEHtK,EAAQ15B,EAAKuJ,MAAM0E,UAI/B,SAACmE,GAAU,OAAKpS,EAAK49B,IAAIxrB,OAGtB,GACVuxB,MAMQM,uBAAK,SAAAA,IAAA3lC,KACNslC,SAAU,EAAKtlC,KACfgU,MAAgB,EAAChU,KACjBulC,KAAkB,GAAEvlC,KACpB2T,OAAgC,KAExC3T,KAGOs7B,QAAa,GAAE,IAAAnrB,EAAAw1B,EAAArjC,UA4IrB,OA1ID6N,EAIOT,KAAP,WACI,OAAO1P,KAAKulC,KAAK1jC,QAGrBsO,EAKOpF,IAAP,SAAWmxB,GAOP,OANAl8B,KAAKulC,KAAK97B,KAAKyyB,GACfl8B,KAAKs7B,QAAQ7xB,UAAK+hB,GAEdxrB,KAAKslC,SACLtlC,KAAKiL,MAAMjL,KAAKulC,KAAK1jC,OAAS,GAE3B7B,MAGXmQ,EAKO1E,MAAP,SAAakI,GACT,GAAI3T,KAAKslC,QACL,OAAOtlC,KAOX,GAJAA,KAAKslC,SAAU,EACftlC,KAAKgU,MAAQ,EACbhU,KAAK2T,OAASA,EAEV3T,KAAKulC,KAAK1jC,OACV,IAAK,IAAI8N,EAAQ,EAAGA,EAAQ3P,KAAKulC,KAAK1jC,OAAQ8N,IAC1C3P,KAAKiL,MAAM0E,QAGf3P,KAAKs/B,KAAOt/B,KAAKs/B,IAAIt/B,KAAKgU,OAG9B,OAAOhU,MAGXmQ,EAIO5L,KAAP,WACI,QAAKvE,KAAKslC,UAGVtlC,KAAKslC,SAAU,EACXtlC,KAAK2T,QACL3T,KAAK2T,OAAO3T,KAAKs7B,SAAS,IAGvB,IAGXnrB,EAIOq1B,UAAP,WACI,OAAOxlC,KAAKslC,SAGhBn1B,EAIOs1B,OAAP,WACI,OAAQzlC,KAAKslC,SAChBn1B,EAEOmvB,IAAR,SAAY3vB,EAAemE,GACvB,IAAK9T,KAAKslC,QACN,OAAO,EAGX,GAAI31B,GAAS,GAAKA,EAAQ3P,KAAKs7B,QAAQz5B,OAAQ,CAC3C,GAAI7B,KAAKs7B,QAAQ3rB,IAAkC,OAAxB3P,KAAKs7B,QAAQ3rB,GAAiB,OAAO,EAChE3P,KAAKs7B,QAAQ3rB,QAAyB,IAATmE,EAAuBA,EAAO,KAQ/D,OALA9T,KAAKslC,SAAU,EACXtlC,KAAK2T,QACL3T,KAAK2T,OAAO3T,KAAKs7B,SAAS,IAGvB,GACVnrB,EAEOnF,KAAR,SAAa2E,EAAemE,GACxB,IAAK9T,KAAKslC,QACN,OAAO,EAGX,GAAI31B,GAAS,GAAKA,EAAQ3P,KAAKs7B,QAAQz5B,OAAQ,CAC3C,GAAI7B,KAAKs7B,QAAQ3rB,IAAkC,OAAxB3P,KAAKs7B,QAAQ3rB,GAAiB,OAAO,EAChE3P,KAAKs7B,QAAQ3rB,QAAyB,IAATmE,EAAuBA,EAAO,KAO/D,QAJM9T,KAAKgU,QAAUhU,KAAKulC,KAAK1jC,QAC3B7B,KAAKs/B,KAAOt/B,KAAKs/B,IAAIt/B,KAAKgU,QAGvB,GACV7D,EAEOlF,MAAR,SAAc0E,GAAwB,IAAAtF,OAClC,IAAKrK,KAAKslC,QACN,OAAO,EAGX,IAAMpJ,EAASl8B,KAAKulC,KAAK51B,GAiBzB,OAhBAusB,GAAUA,GACN,SAACpoB,GAAU,OAAKzJ,EAAKW,KAAK2E,EAAOmE,MACjC,SAAC4xB,GACG,gBADHA,IAAAA,EAAU,GACA,IAAIvK,SAAQ,SAAAC,GACXsK,EAAU,EACVx4B,YAAW,WACPkuB,EAAQ/wB,EAAKY,MAAM0E,MACV,IAAV+1B,GAEHtK,EAAQ/wB,EAAKY,MAAM0E,UAI/B,SAACmE,GAAU,OAAKzJ,EAAKi1B,IAAI3vB,EAAOmE,OAG7B,GACV6xB,MAGQC,qBAAG,SAAAA,IAAA5lC,KACJ6K,KAAO,IAAIw6B,EAAM,IAAA30B,EAAAk1B,EAAAtjC,UAOxB,OAEDoO,EAIOhB,KAAP,WACI,OAAO1P,KAAK6K,KAAK6E,QAGrBgB,EAKO3F,IAAP,SAAW86B,GACP,GAAIA,aAAmB9jC,MAAO,CAC1B,IAAM+jC,EAAQ,IAAIH,EAClBE,EAAQ/+B,SAAQ,SAAAo1B,GAAM,OAAI4J,EAAM/6B,IAAImxB,MACpCl8B,KAAK6K,KAAKE,IAAI+6B,EAAMr6B,MAAM2K,KAAK0vB,SAE/B9lC,KAAK6K,KAAKE,IAAI86B,GAElB,OAAO7lC,MAGX0Q,EAKOjF,MAAP,SAAakI,GAET,OADA3T,KAAK6K,KAAKY,MAAMkI,GACT3T,MAGX0Q,EAIOnM,KAAP,WACI,OAAOvE,KAAK6K,KAAKtG,QAGrBmM,EAIO80B,UAAP,WACI,OAAOxlC,KAAK6K,KAAK26B,aAGrB90B,EAIO+0B,OAAP,WACI,OAAOzlC,KAAK6K,KAAK46B,UACpB5lC,EAAA+lC,IAAA9lC,cAAAC,IA5DD,WACI,OAAOC,KAAK6K,KAAKywB,YACpBsK,MAiEC/6B,cAAO,CAITuR,sBACI,OAAO,IAAIipB,GAMflwB,uBACI,OAAO,IAAIwwB,GAYf76B,qBACI,OAAO,IAAI86B,GAMfG,iBAAQC,EAAuBC,EAAeC,YAAfD,IAAAA,GAAY,GACvCD,GAAI,SAAeN,GACf,YADeA,IAAAA,EAAU,GACR,IAAbO,EAAgB,OAAOC,GAAeA,IAC1CD,EAAWA,EAAW,EAAIA,EAAW,EAAIA,EACrCP,EAAU,EACVx4B,YAAW,WAAA,OAAMrC,EAAKk7B,QAAQC,EAAKC,EAAUC,KAAwB,IAAVR,GAE3D76B,EAAKk7B,QAAQC,EAAKC,EAAUC,WAMxBrlC,IAAAC;;uVCrbpB,IAAQC,EAAYC,EAAZD,QAIFolC,aAqBF,SAAAA,EACIC,EACgB3/B,EACAiG,EACAnM,YAAAA,IAAAA,GAAgB,GAAKP,KAVxBqmC,eAAkBrmC,KAClBsmC,aAEjBtmC,KACQumC,SAAW,EAACvmC,KAIAyG,SAAAA,EAAmBzG,KACnB0M,OAAAA,EAAgB1M,KAChBO,KAAAA,EAGhB,IAAAimC,EAAkDJ,EAAKpD,MAAM,KAAtDyD,EAAYD,KAAAE,EAAAF,KAAEG,WAAUD,EAAGD,EAAYC,EAG9CE,EAA6CH,EAAazD,MAAM,KAAK6D,KACjE,SAAAC,GAAI,OAAIp4B,KAAKC,IAAI,EAAGo4B,SAASD,EAAM,KAAO,MAC7CE,EAAAJ,KAFMK,WAAMD,EAAG,EAACA,EAAAE,EAAAN,KAAEO,WAAMD,EAAG,EAACA,EAAAE,EAAAR,KAAES,WAAMD,EAAG,EAACA,EAGzCpnC,KAAKqmC,QAAUF,EAAWmB,cAAcL,EAAQE,EAAQE,GAGxD,IAAAE,EAAuCZ,EAAW3D,MAAM,KAAK6D,KACzD,SAAAC,GAAI,OAAIp4B,KAAKC,IAAI,EAAGo4B,SAASD,EAAM,KAAO,MAC7CU,EAAAD,KAFME,WAAID,EAAG,EAACA,EAAAE,EAAAH,KAAEI,WAAID,EAAG,EAACA,EAAAE,EAAAL,KAAEM,WAAID,EAAG,EAACA,EAGnC5nC,KAAKsmC,MAAQH,EAAWmB,cAAcG,EAAME,EAAME,GAE9C7nC,KAAKsmC,QAAUtmC,KAAKqmC,UAEhBrmC,KAAKsmC,MADM,IAAXa,GAA2B,IAAXE,EACHlB,EAAWmB,cAAcL,EAAS,EAAGE,EAAQE,GACxC,IAAXA,EACMlB,EAAWmB,cAAcL,EAAQE,EAAS,EAAGE,GAE7ClB,EAAWmB,cAAcL,EAAQE,EAAQE,EAAS,IA/C3ElB,EACe2B,aAAf,SAA4BnE,GACxB,OAII,KAHkB,KAAlBA,EAAKoE,WACe,GAApBpE,EAAKqE,aACLrE,EAAKsE,cACEtE,EAAKuE,mBAGpB/B,EACemB,cAAf,SAA6Ba,EAAWC,EAAWC,GAC/C,OAAkC,KAArB,KAAJF,EAAe,GAAJC,EAASC,GAAa,OAyC9C,IAAAhmC,EAAA8jC,EAAA7jC,UAoBC,OApBDD,EACQimC,UAAR,SAAkBt2B,GACd,IAAMu2B,EAAYpC,EAAW2B,aAAa91B,GAG1C,OAAOhS,KAAKqmC,SAAWrmC,KAAKsmC,MACtBiC,GAAavoC,KAAKqmC,SAAWkC,EAAYvoC,KAAKsmC,MAC9CiC,GAAavoC,KAAKqmC,SAAWkC,EAAYvoC,KAAKsmC,OACvDjkC,EAEDokB,OAAA,SAAOzU,GACH,IAAMw2B,EAAUx2B,EAAIiyB,SAEpB,OAAIjkC,KAAKumC,WAAaiC,MACjBxoC,KAAKsoC,UAAUt2B,KAEpBhS,KAAKumC,SAAWiC,EAChBxoC,KAAKyG,SAAS9G,KAAKK,KAAK0M,QAEjB1M,KAAKO,QACf4lC,KAGCsC,aAGF,SAAAA,EACoBjH,EACA/6B,EACAiG,EACAnM,YAAAA,IAAAA,GAAgB,GAAKP,KANjC0oC,QAAkB,EAAC1oC,KAGPwhC,SAAAA,EAAgBxhC,KAChByG,SAAAA,EAAmBzG,KACnB0M,OAAAA,EAAgB1M,KAChBO,KAAAA,EAmBnB,OAlBIkoC,EAAAnmC,UAELmkB,OAAA,SAAO0F,GACHnsB,KAAK0oC,SAAWvc,EAIhB,IAHA,IAAI3d,GAAY,EAGTxO,KAAK0oC,SAAW1oC,KAAKwhC,UAIxB,GAHAxhC,KAAKyG,SAAS9G,KAAKK,KAAK0M,QACxB1M,KAAK0oC,SAAW1oC,KAAKwhC,SAEjBxhC,KAAKO,KAAM,CACXiO,GAAY,EACZ,MAIR,OAAOA,GACVi6B,KAGCE,aAAK,SAAAA,IAAA3oC,KAKC4oC,cAAiC,GAAE5oC,KA2CnC6oC,YAA4B,GAAEF,EA/C/BliB,OAAP,SAAczR,EAAcmX,GACxB,OAAOnX,EAAMyR,OAAO0F,IACvB,IAAAzb,EAAAi4B,EAAArmC,UAiHA,OA7GDoO,EAOAo4B,SAAA,SACItH,EACA/6B,EACAiG,EACAnM,GAEA,IAAMyU,EAAQ,IAAIyzB,EAAcjH,EAAU/6B,EAAUiG,EAAQnM,IAAQ,GACpEP,KAAK4oC,cAAcn/B,KAAKuL,IAG5BtE,EAKAq4B,WAAA,SAAWtiC,EAAqBiG,GAExB1M,KAAK4oC,mBADa,IAAXl8B,EACc1M,KAAK4oC,cAAcnsB,QACpC,SAAAzH,GAAK,OAAIA,EAAMvO,WAAaA,KAGXzG,KAAK4oC,cAAcnsB,QACpC,SAAAzH,GAAK,QAAMA,EAAMvO,WAAaA,GAAYuO,EAAMtI,SAAWA,OAKvEgE,EAGAs4B,cAAA,WACIhpC,KAAK4oC,cAAgB,IAKzBl4B,EASAu4B,qBAAA,SACI7C,EACA3/B,EACAiG,EACAnM,GAEA,IAAMyU,EAAQ,IAAImxB,EAAWC,EAAM3/B,EAAUiG,EAAQnM,IAAQ,GAC7DP,KAAK6oC,YAAYp/B,KAAKuL,IAG1BtE,EAGAw4B,uBAAA,SAAuBziC,EAAqBiG,GAEpC1M,KAAK6oC,iBADa,IAAXn8B,EACY1M,KAAK6oC,YAAYpsB,QAChC,SAAAzH,GAAK,OAAIA,EAAMvO,WAAaA,KAGbzG,KAAK6oC,YAAYpsB,QAChC,SAAAzH,GAAK,QAAMA,EAAMvO,WAAaA,GAAYuO,EAAMtI,SAAWA,OAKvEgE,EAGAy4B,0BAAA,WACInpC,KAAK6oC,YAAc,IAGvBn4B,EAGArL,MAAA,WACIrF,KAAK4oC,cAAgB,GACrB5oC,KAAK6oC,YAAc,IACtBn4B,EAES+V,OAAV,SAAiB0F,GACb,IAAK,IAAIxc,EAAQ,EAAGA,EAAQ3P,KAAK4oC,cAAc/mC,OAAQ8N,IAAS,CAC9C3P,KAAK4oC,cAAcj5B,GACvB8W,OAAO0F,KACbnsB,KAAK4oC,cAAc/4B,OAAOF,EAAO,GACjCA,KAKR,IADA,IAAMg0B,EAAO,IAAI5xB,KACRpC,EAAQ,EAAGA,EAAQ3P,KAAK6oC,YAAYhnC,OAAQ8N,IAAS,CAC5C3P,KAAK6oC,YAAYl5B,GACrB8W,OAAOkd,KACb3jC,KAAK6oC,YAAYh5B,OAAOF,EAAO,GAC/BA,OAGXg5B,iBAGJ5nC,EAAQ,eAAeG,CAAAwY,WAAA2N,GAAA,SAAA+hB,IAAA,IAAA,IAAA1nC,EAAAC,EAAAC,UAAAC,OAAAC,MAAAC,MAAAJ,GAAAK,IAAAA,EAAAL,EAAAK,IAAAF,EAAAE,GAAAJ,UAAAI,GAEmC,OAFnCN,EAAA2lB,EAAA1nB,KAAAsC,MAAAolB,SAAAnlB,OAAAJ,WAEZunC,OAAsC,IAAIzjC,IAAKlE,EAFnC9B,EAAAwpC,EAAA/hB,GAEmC,IAAAiiB,EAAAF,EAAA9mC,UA0CtD,OAxCDgnC,EAGAjkC,MAAA,WACIrF,KAAKqpC,OAAOviC,SAAQ,SAACkO,GACjBA,EAAM3P,WAEVrF,KAAKqpC,OAAOhkC,SAGhBikC,SAIA,SAAOxpC,GACH,IAAMkV,EAAQhV,KAAKqpC,OAAOtpC,IAAID,GACzBkV,IAELhV,KAAKqpC,cAAcvpC,GACnBkV,EAAM3P,UAGVikC,EAIAvpC,IAAA,SAAID,GACA,GAAIE,KAAKqpC,OAAOjgC,IAAItJ,GAChB,OAAOE,KAAKqpC,OAAOtpC,IAAID,GAG3B,IAAMkV,EAAQ,IAAI2zB,EAElB,OADA3oC,KAAKqpC,OAAO9jC,IAAIzF,EAAKkV,GACdA,GACVs0B,EAES7iB,OAAV,SAAiB0F,GACbnsB,KAAKqpC,OAAOviC,SAAQ,SAACkO,GACjB2zB,EAAMliB,OAAOzR,EAAOmX,OAE3Bid,GA3CqCx9B,KAAW8N,KAApB7Y,IAAAC;;igCC5NjC,IAAQC,EAAsBC,EAAtBD,QAASE,EAAaD,EAAbC,SA0EXsoC,EAAU,UAEVC,EAAY,CAACpyB,EAAS0C,KAAM1C,EAAS4C,MAAO5C,EAASgD,IAAKhD,EAASkD,KAEnE7D,EAAc,CAChBhT,EAAK9C,UAAU8M,YAAahK,EAAK9C,UAAU+V,WAAYjT,EAAK9C,UAAUmM,UAAWrJ,EAAK9C,UAAUgW,aAChGlT,EAAK9C,UAAUiW,WAAYnT,EAAK9C,UAAUkW,WAAYpT,EAAK9C,UAAUmW,SACrErT,EAAK9C,UAAUoW,YAAatT,EAAK9C,UAAUqW,YAAavT,EAAK9C,UAAUsW,aAMtEwG,WAAAA,GAAS,OAATA,EAAAA,2BAAAA,EAAAA,6BAAAA,EAAAA,iCAAAA,GAAAA,OAYCgsB,EAAwC,IAAIn4B,MAAM,GAAW,CAC/DvR,IAAK,SAAU2M,EAAQ5M,GACnB,OAAI4M,EAAO5M,GAAa4M,EAAO5M,IAC/B4M,EAAO5M,GAAOA,EACPA,MAOT4pC,EAAgD,IAAIp4B,MAAM,GAAW,CACvEvR,IAAK,SAAU2M,EAAQ5M,GACnB,OAAI4M,EAAO5M,GAAa4M,EAAO5M,IAC/B4M,EAAO5M,GAAOA,EACPA,MA2Bf,SAAS6pC,GAAiBC,GACtB,OAAOA,EAAIC,QAAQ,UAAU,SAACC,EAAWC,GACrC,OAAmB,IAAfA,EACOD,EAAUp3B,oBAEV,IAAMo3B,EAAUp3B,oCAMLxR,EAD7BH,EAAQ,aAAYI,EA8BhBF,EAAS,CACN4W,KAAM1D,EACN2D,QAAS,6CACXH,EAGD1W,EAAS,CACN4W,KAAM1D,EACN2D,QAAS,2CACXC,EAGD9W,EAAS,CACN4W,KAAM1D,EACN2D,QAAS,2CACX5W,IAAAoX,WAAA+O,GAAA,SAAA4X,IAAA,IAAA,IAAAv9B,EAAAC,EAAAC,UAAAC,OAAAC,MAAAC,MAAAJ,GAAAK,IAAAA,EAAAL,EAAAK,IAAAF,EAAAE,GAAAJ,UAAAI,GAmC2C,OAnC3CN,EAAA2lB,EAAA1nB,KAAAsC,MAAAolB,SAAAnlB,OAAAJ,UAAAK,EAAAT,eAAAL,EAAAe,EAAAV,IAAAS,EAAAT,aAAAsX,EAAA5W,EAAAV,IAAAS,EAAAT,aAAAuX,EAAA7W,EAAAV,IAGFA,EACQsoC,cAAsB,KAE9BtoC,EACQ+zB,QAAgB,KAAI/zB,EACpBmf,MAAc,KAAInf,EAClBuoC,MAAc,KAAIvoC,EAElBw9B,UAAoB,KAAIx9B,EACxBwoC,YAAsB,GAAExoC,EAExByoC,UAAoB,GAAEzoC,EACtB0oC,SAAqB,KAAI1oC,EACzB2oC,UAAsB,KAE9B3oC,EACQ4oC,YAA4C,GAAE5oC,EAC9C6oC,WAA+C,GAEvD7oC,EACQ8oC,cAAwB,EAEhC9oC,EACQ+oC,aAAe,IAAI7kC,IAC3BlE,EACQgpC,eAAiB,IAAI9kC,IAE7BlE,EACQipC,aAAsC,IAAI/kC,IAClDlE,EACQkpC,aAAsC,IAAIhlC,IAAKlE,EAE/CmpC,UAAmC,GAAEnpC,EAnC3C9B,EAAAq/B,EAAA5X,GAmC2C,IAAAhlB,EAAA48B,EAAA38B,UAe5C,OAf4CD,EAiBnCwJ,KAAV,SAAe8H,GAAkB,IAAA+sB,EAAAr2B,OACvBiC,EAAU2yB,EAAU3yB,QAQ1B,GANAtM,KAAKk/B,UAAY5yB,EAAQ4yB,UACzBl/B,KAAKkqC,YAAc59B,EAAQ49B,YAE3B7iB,EAAA/kB,UAAMuJ,KAAIlM,UAACgU,UAGX+sB,EAAIp0B,EAAQouB,UAARgG,EAAiB7+B,OAAQ,CACzB,IAAMgJ,EAAO3K,EAAKE,KAAKwK,IAAIC,KAAKC,YAChCwB,EAAQouB,QAAQ5zB,SAAQ,SAAC4zB,GACjBA,aAAmB34B,MACnB8I,EAAKE,IAAI2vB,EAAQmM,KAAI,SAAAn1B,GACjB,OAAO,SAAA1G,GAAI,OAAIX,EAAKqwB,QAAQhpB,EAAa1G,QAG7CH,EAAKE,KAAI,SAAAC,GAAI,OAAIX,EAAKqwB,QAAQA,EAAgB1vB,SAGtDH,EAAKY,UAEZpJ,EAESE,OAAV,WA6BI,GA5BAvC,KAAKgqC,cAAgBhqC,KAAKsV,KAAKoO,eAtMb,iBAwMlB1jB,KAAKsV,KAAKw1B,wBAAwBC,GAAQjkC,SAAQ,SAAAkkC,GAE1CA,EAAOC,SAAW,IAAGD,EAAOC,SAAW,GAEvCD,EAAOE,KAAOF,EAAOG,OAAMH,EAAOE,IAAMF,EAAOG,KAAO,MAE9DzwB,EAAS0wB,mBAAmBprC,KAAKsV,MAEjCtV,KAAKqrC,iBAELrrC,KAAK6gB,MAAQlL,EAAY3V,KAAKsrC,UAC9BtrC,KAAK6gB,MAAMjL,OAAS5V,KAAKgqC,cACzBhqC,KAAK6gB,MAAMhL,QAAS,EACpB7V,KAAK6gB,MAAM7T,aAAa6F,GAAQnG,OAAS1M,KAAKsV,KAE9CtV,KAAKy1B,QAAU9f,EAAY3V,KAAKurC,YAChCvrC,KAAKy1B,QAAQ7f,OAAS5V,KAAKwD,KAC3BxD,KAAKy1B,QAAQ5f,QAAS,EAGlB7V,KAAKwrC,WACLxrC,KAAKiqC,MAAQt0B,EAAY3V,KAAKwrC,UAC9BxrC,KAAKiqC,MAAMr0B,OAAS5V,KAAKwD,MAIzBy7B,EAAU3yB,QAAQ6yB,QAAS,CAC3B,IAAMsM,EAAmBlhC,EAASC,cAAcC,EAASC,SAASghC,OAAQ,oBACpEC,EAAaj8B,EAAKk8B,EAAOD,YAC3BE,EAAmBJ,EAAiBK,OAClCC,EAA0B,WAC5B,GAAIJ,EAAWroB,MAAQqoB,EAAWnoB,OAASioB,EAAiBnoB,MAAQmoB,EAAiBjoB,OAAQ,CACzF,GAAIqoB,IAAqBG,EAAiBC,aAAc,OACxDC,EAAKC,oBAAoBH,EAAiBC,cAC1CJ,EAAmBG,EAAiBC,iBACjC,CACH,GAAIJ,IAAqBG,EAAiBI,YAAa,OACvDF,EAAKC,oBAAoBH,EAAiBI,aAC1CP,EAAmBG,EAAiBI,cAG5CL,IACA/rC,KAAKqsC,UAAS,WACNV,EAAWW,OAAOV,EAAOD,cAC7BA,EAAWpmC,IAAIqmC,EAAOD,YACtBI,OACD,MAEV1pC,EAEOgpC,eAAR,WAAyB,IAAAl/B,OACrBq9B,EAAU1iC,SAAQ,SAAC+Q,GACf,IAAM00B,EAAK,IAAI9oC,EAAKoU,GACpB00B,EAAGC,MAAQC,EAAOt1B,KAAKu1B,MACvBH,EAAG7oC,aAAaipC,GAChBJ,EAAG32B,OAASzJ,EAAK69B,cACjBuC,EAAG7oC,aAAa4X,GAChB,IAAM1I,EAAS25B,EAAG7oC,aAAamP,GAC/BD,EAAOE,eAAgB,EACvBF,EAAOG,aAAc,EACrBH,EAAOI,cAAe,EACtBJ,EAAOK,YAAa,EACpBL,EAAOM,IAAM,EACbN,EAAOO,KAAO,EACdP,EAAOQ,MAAQ,EACfR,EAAOS,OAAS,EAChBT,EAAOU,UAAYT,EAAOU,UAAUC,qBAW3CnR,EAEOuqC,qBAAR,WACI,GAAK5sC,KAAKwqC,gBACNxqC,KAAKyqC,aAAa/6B,KAAO,GAE7B,IAAK,IAAI8L,EAAI,EAAGA,EAAI/E,EAAY5U,OAAQ2Z,IACpCxb,KAAKsV,KAAK1R,GAAG6S,EAAY+E,GAAIxb,KAAKkb,gBAAiBlb,MAAM,IAEhEqC,EAEOwqC,wBAAR,WACI,GAAK7sC,KAAKwqC,gBACNxqC,KAAKyqC,aAAa/6B,KAAO,GAE7B,IAAK,IAAI8L,EAAI,EAAGA,EAAI/E,EAAY5U,OAAQ2Z,IACpCxb,KAAKsV,KAAK3H,IAAI8I,EAAY+E,GAAIxb,KAAKkb,gBAAiBlb,MAAM,IAEjEqC,EAEO6Y,gBAAR,SAAwBnO,KACf/M,KAAKwqC,cAAgBxqC,KAAKyqC,aAAa/6B,KAAO,KAC/C3C,EAAMkO,oBAAqB,EACvBlO,EAAM8K,OAASpU,EAAK9C,UAAUkW,YAC9B7W,KAAK4R,IAAI,UAKrBvP,EAGQyqC,YAAR,SAAoBtpC,GAChB,OAAKA,EACEA,EAAKupC,WAAWC,MAAK,SAAA1gB,GAAS,OAAIA,aAAqB/T,KAD5C,MAItBlW,EAKQ4qC,iBAAR,SAAyBvgC,GAIrB,IAHA,IAAIlJ,EAAOkJ,EACPwgC,EAAgB,KAEb1pC,EAAKoS,UAAYpS,EAAKoS,kBAAkB4E,MAC3C0yB,EAAMltC,KAAK8sC,YAAYtpC,EAAKoS,UAExBpS,EAAOA,EAAKoS,OAKpB,OAAOs3B,GAGX7qC,EAKQ8qC,kBAAR,SAA0BzgC,GACtB,IAAK,IAAIiD,EAAQ,EAAGA,EAAQjD,EAAO0gC,SAASvrC,OAAQ8N,IAAS,CACzD,IAAMnM,EAAOkJ,EAAO0gC,SAASz9B,GACvBu9B,EAAMltC,KAAK8sC,YAAYtpC,GAC7B,GAAI0pC,EAAK,OAAOA,EAEpB,OAAO,MAGX7qC,EAGQgrC,WAAR,SAAmB37B,GACf,OAAOW,EAAGi7B,eAAe57B,IAG7BrP,EAKQkrC,UAAR,SAAkB77B,GACd,OAAOA,GAGXrP,EAIQmrC,YAAR,SAAoB97B,GAChB,IAAK,IAAI/B,EAAQ,EAAGA,EAAQ65B,EAAU3nC,OAAQ8N,IAAS,CACnD,IAAMwM,EAAWqtB,EAAU75B,GAC3B,GAA+B,IAA3B+B,EAAKxG,QAAQiR,GACb,OAAOA,EAGfnc,KAAKuW,MAAM,iBAAkB7E,IAGjCrP,EAIQorC,YAAR,SAAoB/7B,GAChB,GAAI1R,KAAKmqC,YAAcz4B,EACnB,OAAOgJ,EAASC,WAIpB,IADA,IAAM+yB,EAAS1tC,KAAKwtC,YAAY97B,GACvB/B,EAAQ,EAAGA,EAAQ65B,EAAU3nC,OAAQ8N,IAAS,CACnD,IAAMg+B,EAAWnE,EAAU75B,GAC3B,GAAIg+B,IAAaD,EACb,OAAO1tC,KAAKgqC,cAActmB,eAAeiqB,GAKjD,OADA3tC,KAAKuW,MAAM,oBAAqB7E,eACzB,MAGXrP,EAOQurC,aAAR,SAAqBl8B,EAAcm8B,YAAAA,IAAAA,GAAW,GAC1C,IAAMj4B,EAAS5V,KAAKytC,YAAY/7B,GAEhC,GAAIm8B,EAAU,CACV,IAAMjxB,EAAShH,EAAOw3B,SAAS3wB,QAAO,SAAAjZ,GAAI,OAAIA,EAAKkO,OAASA,KAC5D,GAAIkL,EAAO/a,OAAQ,OAAO+a,EAAOH,QAAO,SAAAjZ,GAAI,OAAI2J,EAAQ3J,GAAM,UAC3D,CACH,IAAMoZ,EAAShH,EAAOw3B,SAASJ,MAAK,SAAAxpC,GAAI,OAAIA,EAAKkO,OAASA,KAC1D,GAAIkL,EAAQ,OAAOzP,EAAQyP,GAAQ,GAAQA,EAAS,KAGxD,OAAOixB,EAAW,GAAK,MAG3BxrC,EAOQyrC,eAAR,SAAuBp8B,EAAcm8B,GACjC,YADiCA,IAAAA,GAAW,GACxCA,EAAU,CACV,IAAMjxB,EAAiB,GAIvB,OAHA5c,KAAK4qC,aAAa9jC,SAAQ,SAACinC,EAAOb,GAC1Ba,IAAUr8B,GAAMkL,EAAOnT,KAAKyjC,EAAI1pC,SAEjCoZ,EAEP,IAAIA,EAAe,KAInB,OAHA5c,KAAK4qC,aAAa9jC,SAAQ,SAACinC,EAAOb,GACzBtwB,GAAUmxB,IAAUr8B,IAAMkL,EAASswB,EAAI1pC,SAEzCoZ,GAIfva,EAIO2rC,oBAAP,SAA2BC,GAEvB,IAAMC,cAA4BD,EAC5B3jC,EAAiBC,EAASC,cAAcC,EAASC,SAASC,OAAQ,kBACxE,OAAIL,GAAkBA,EAAeY,QAAQgjC,IAAkB,EACpDA,EAGJvE,GAAiBsE,IAG5B5rC,EAIO8rC,iBAAP,SAAwBF,GAEpB,IAAMC,cAA4BD,SAC5B3jC,EAAiBC,EAASC,cAAcC,EAASC,SAASC,OAAQ,kBACxE,OAAIL,GAAkBA,EAAeY,QAAQgjC,IAAkB,EACpDA,EAGDvE,GAAiBsE,WAG/B5rC,EAGQ+rC,WAAR,SAAmB18B,EAAyBlP,GAAuE,IAAAuL,OAC/G7N,EAAKE,KAAKwK,IAAIC,KAAKsK,cACdpK,KAAI,SAACC,GACF9K,EAAKE,KAAKuM,QAAQsI,OAAOzJ,WAAW,CAChCuI,OAAQhG,EAAKigC,oBAAoBt8B,GACjC+N,WAAYzU,OAGnBD,KAAI,SAACC,GACF9K,EAAKE,KAAKuM,QAAQsI,OAAOzJ,WAAW,CAChCuI,OAAQhG,EAAKogC,iBAAiBz8B,GAC9B+N,WAAYzU,OAGnBS,MAAMjJ,IAGfH,EAGQgsC,UAAR,SAAkB38B,EAAyBgD,EAAwDD,GAAoF,IAAA+H,OACnL,GAAIxc,KAAKuqC,WAAW74B,GAChBgD,GAAYxH,YAAW,WACdC,EAAQqP,IACb9H,EAAS8H,EAAK+tB,WAAW74B,YAG1B,GAAI1R,KAAKsqC,YAAY54B,GACxBgD,GAAYxH,YAAW,WACdC,EAAQqP,IACb9H,EAAS8H,EAAK8tB,YAAY54B,YAKlC,IAAM7G,EAAO3K,EAAKE,KAAKwK,IAAIC,KAAKuR,aAC3BrR,KAAI,SAAAC,GACDwR,EAAK4xB,WAAW18B,EAAM1G,MAEzBD,KAAI,SAACC,GAEF,IAAMsjC,EAAYzjC,EAAKywB,QAAQ,GAC/B,IAAKgT,IAAcA,EAAU,KAAOA,EAAU,GAAI,OAAOtjC,EAAK,MAE9D,IAAMujC,EAAUD,EAAU,GAAGE,aAAa98B,GAC1CxR,EAAKE,KAAKuM,QAAQsI,OAAOO,KAAK,CAC1BzB,OAAQyI,EAAKwxB,oBAAoBt8B,GACjC2C,KAAMmI,EAAK+wB,UAAU77B,GACrBmG,KAAM02B,EAAUhS,EAAapoB,EAC7BzI,WAAY+I,EACZgL,WAAYzU,OAGnBS,OAAM,SAAC6vB,GACJ,GAAKnuB,EAAQqP,GAAb,CAEA,IAAM8d,EAAQ9d,EAAK+tB,WAAW74B,IAAS8K,EAAK8tB,YAAY54B,GACxD,GAAI4oB,EACA,OAAO5lB,GAAYA,EAAS4lB,GAGhC,IAAMQ,EAAQQ,EAAQ,GACtB,OAAKR,GAILA,EAAME,SAEFF,aAAiB3mB,EACjBqI,EAAK8tB,YAAY54B,GAAQopB,EAEzBte,EAAK+tB,WAAW74B,GAAQopB,EAE5Bte,EAAK5K,WAAWF,GACTgD,GAAYA,EAASomB,IAXjBpmB,GAAYA,EAAS,WAe5CrS,EAGQosC,YAAR,SAAoB/8B,GACZ1R,KAAKuqC,WAAW74B,IAEhB1R,KAAKuqC,WAAW74B,GAAMupB,gBAEfj7B,KAAKuqC,WAAW74B,IAChB1R,KAAKsqC,YAAY54B,KAExB1R,KAAKsqC,YAAY54B,GAAMupB,gBAEhBj7B,KAAKsqC,YAAY54B,IAG5B,IAAMg9B,EAAY1uC,KAAKmuC,iBAAiBz8B,GAClCi9B,EAAW3uC,KAAKguC,oBAAoBt8B,GAC1CxR,EAAKE,KAAKuM,QAAQsI,OAAO8mB,WAAW2S,GACpCxuC,EAAKE,KAAKuM,QAAQsI,OAAO8mB,WAAW4S,GACpCzuC,EAAKE,KAAKuM,QAAQsI,OAAOooB,aAAaqR,GACtCxuC,EAAKE,KAAKuM,QAAQsI,OAAOooB,aAAasR,GACtC3uC,KAAK4R,WAAWF,IAGpBrP,EAGO+c,QAAP,SAAuC1S,EAAmB2H,EAAcwD,EAASpR,GAC7E,GAAsB,iBAAXiG,EACPxM,EAAKE,KAAKuM,QAAQsI,OAAOO,KAAK,CAC1BzB,OAAQ/T,KAAKmuC,iBAAiBzhC,GAC9B2H,KAAMA,EACNwD,KAAMA,EACN4H,WAAYhZ,QAEb,CACH,IAAMylC,EAAOlsC,KAAK8sC,YAAYpgC,EAAOlJ,OAASxD,KAAKitC,iBAAiBvgC,EAAOlJ,OAASxD,KAAKmtC,kBAAkBzyB,EAASC,YAChHuxB,EACAhsC,EAAKE,KAAKuM,QAAQsI,OAAOO,KAAK,CAC1BzB,OAAQ/T,KAAKmuC,iBAAiBjC,EAAKzxB,UACnCpG,KAAMA,EACNwD,KAAMA,EACN4H,WAAYhZ,KAGhBzG,KAAKuW,MAAM,UAAW7J,EAAOgF,KAAM2C,GACnC5N,GAAYA,EAAS,SAKjCpE,EAGOgd,WAAP,SAA0C3S,EAAuC2H,EAAcwD,EAASnD,GACpG,GAAsB,iBAAXhI,EACPxM,EAAKE,KAAKuM,QAAQsI,OAAOylB,QAAQ,CAC7B3mB,OAAQ/T,KAAKmuC,iBAAiBzhC,GAC9B2H,KAAMA,EACNwD,KAAMA,EACN4H,WAAY/K,QAEb,CACH,IAAMw3B,EAAOlsC,KAAK8sC,YAAYpgC,EAAOlJ,OAASxD,KAAKitC,iBAAiBvgC,EAAOlJ,OAASxD,KAAKmtC,kBAAkBzyB,EAASC,YAChHuxB,EACAhsC,EAAKE,KAAKuM,QAAQsI,OAAOylB,QAAQ,CAC7B3mB,OAAQ/T,KAAKmuC,iBAAiBjC,EAAKzxB,UACnCpG,KAAMA,EACNwD,KAAMA,EACN4H,WAAY/K,IAGhB1U,KAAKuW,MAAM,aAAc7J,EAAOgF,KAAM2C,KAKlDhS,EAGOid,WAAP,SAA0C5S,EAAmB2H,EAAcwD,EAASpR,GAChF,GAAsB,iBAAXiG,EACPxM,EAAKE,KAAKuM,QAAQsI,OAAOomB,QAAQ,CAC7BtnB,OAAQ/T,KAAKmuC,iBAAiBzhC,GAC9B2H,KAAMA,EACNwD,KAAMA,EACN4H,WAAYhZ,QAEb,CACH,IAAMylC,EAAOlsC,KAAK8sC,YAAYpgC,EAAOlJ,OAASxD,KAAKitC,iBAAiBvgC,EAAOlJ,OAASxD,KAAKmtC,kBAAkBzyB,EAASC,YAChHuxB,EACAhsC,EAAKE,KAAKuM,QAAQsI,OAAOomB,QAAQ,CAC7BtnB,OAAQ/T,KAAKmuC,iBAAiBjC,EAAKzxB,UACnCpG,KAAMA,EACNwD,KAAMA,EACN4H,WAAYhZ,KAGhBzG,KAAKuW,MAAM,aAAc7J,EAAOgF,KAAM2C,GACtC5N,GAAYA,EAAS,OAKjCpE,EAGOkd,cAAP,SAA6C7S,EAAuC2H,EAAcwD,EAASnD,GACvG,GAAsB,iBAAXhI,EACPxM,EAAKE,KAAKuM,QAAQsI,OAAO2lB,WAAW,CAChC7mB,OAAQ/T,KAAKmuC,iBAAiBzhC,GAC9B2H,KAAMA,EACNwD,KAAMA,EACN4H,WAAY/K,QAEb,CACH,IAAMw3B,EAAOlsC,KAAK8sC,YAAYpgC,EAAOlJ,OAASxD,KAAKitC,iBAAiBvgC,EAAOlJ,OAASxD,KAAKmtC,kBAAkBzyB,EAASC,YAChHuxB,EACAhsC,EAAKE,KAAKuM,QAAQsI,OAAO2lB,WAAW,CAChC7mB,OAAQ/T,KAAKmuC,iBAAiBjC,EAAKzxB,UACnCpG,KAAMA,EACNwD,KAAMA,EACN4H,WAAY/K,IAGhB1U,KAAKuW,MAAM,gBAAiB7J,EAAOgF,KAAM2C,KAKrDhS,EAGOq4B,QAAP,SAAehpB,EAAyBgD,GAA6D,IAAAyJ,OAEjG,IAAKzM,EAMD,OALA1R,KAAKuW,MAAM,UAAW,aACtB7B,GAAYxH,YAAW,WACdC,EAAQnN,OACb0U,EAAS,UAKjB1U,KAAKouC,WAAW18B,GAAM,SAAAkK,GAAgB,IAC5B2yB,EADsB3yB,KACH4yB,aAAa98B,GACtCxR,EAAKE,KAAKuM,QAAQsI,OAAOylB,QAAQ,CAC7B3mB,OAAQoK,EAAK6vB,oBAAoBt8B,GACjC2C,KAAM8J,EAAKovB,UAAU77B,GACrBmG,KAAM02B,EAAUhS,EAAapoB,EAC7BsL,WAAY/K,QAKxBrS,EAMOmT,KAAP,SAAY9D,GACR,IAAM+C,GAAY7S,UAAAC,eAAA2pB,EAAA5pB,gBAAAA,UAAAC,eAAA2pB,EAAA5pB,cACZ8S,GAAY9S,UAAAC,eAAA2pB,EAAA5pB,gBAAAA,UAAAC,eAAA2pB,EAAA5pB,cAGlB,IAAK8P,EAMD,OALA1R,KAAKuW,MAAM,OAAQ,aACnB7B,GAAYxH,YAAW,WACdC,EAAQnN,OACb0U,EAAS,UAMjB1U,KAAKquC,UAAU38B,GAAM,SAACkL,GAClB,OAAKA,EACElI,GAAYA,EAASkI,GADRlI,GAAYA,EAAS,QAE1CD,IAGPpS,EAKO0c,QAAP,SAAe6vB,GAAyC,IAAAzS,OAC9C8R,EAA8B,iBAAdW,EAAyBA,EAAYA,EAAUn0B,SAErE,GAAKwzB,EAAL,CAMA,GAAyB,iBAAdW,EACP5uC,KAAK4tC,aAAaK,GAAQ,GAAMnnC,SAAQ,SAACtD,GACrC,IAAM0pC,EAAM/Q,EAAK2Q,YAAYtpC,GACxB0pC,GAKDA,EAAI2B,QACJ1S,EAAK7lB,KAAK,UAAc23B,wBAExBf,IAAQ/Q,EAAKiO,WACbjO,EAAKiO,SAAW,MAEhB8C,IAAQ/Q,EAAKkO,YACblO,EAAKkO,UAAY,MAGrBlO,EAAKyO,oBAAoBsC,GAErB1pC,GAAQ2J,EAAQ3J,GAAM,KACtBA,EAAKoS,OAAS,KACdpS,EAAK8B,YAlBL62B,EAAK5lB,MAAM,UAAc03B,0BAuBhC,CACGW,EAAUC,QACV7uC,KAAKsW,KAAK,UAAc23B,wBAExBW,IAAc5uC,KAAKoqC,WACnBpqC,KAAKoqC,SAAW,MAEhBwE,IAAc5uC,KAAKqqC,YACnBrqC,KAAKqqC,UAAY,MAGrBrqC,KAAK4qC,oBAAoBgE,GAEzB,IAAMprC,EAAOorC,EAAUprC,KACnBA,GAAQ2J,EAAQ3J,GAAM,KACtBA,EAAKoS,OAAS,KACdpS,EAAK8B,WAKb,IAAMwpC,EAAQ9uC,KAAK4tC,aAAaK,GAAQ,IACnB,IAAjBa,EAAMjtC,QAAgBitC,EAAMC,OAAM,SAAAvrC,GAAI,OAAK2J,EAAQ3J,GAAM,SACzDxD,KAAKyuC,YAAYR,GACjBjuC,KAAK4R,aAAaq8B,SAxDlBjuC,KAAKuW,MAAM,UAAcq4B,YA4DjCvsC,EAKO05B,WAAP,SAAkBiT,GAAoB,IAAAxS,OAClCjsB,OAAO0W,KAAKjnB,KAAKsqC,aAAaxjC,SAAQ,SAAC4K,GAC/Bs9B,IAAsC,IAA3BA,EAAQ9jC,QAAQwG,IAC/B8qB,EAAKzd,QAAQrN,MAEjBnB,OAAO0W,KAAKjnB,KAAKuqC,YAAYzjC,SAAQ,SAAC4K,GAC9Bs9B,IAAsC,IAA3BA,EAAQ9jC,QAAQwG,IAC/B8qB,EAAKzd,QAAQrN,OAIrBrP,EAMQ4sC,aAAR,SAAqBv9B,EAAyBoC,EAAWrN,GAAsC,IAAAg2B,OAC3Fz8B,KAAKquC,UAAU38B,GAAM,SAACkL,GAClB,IAAKA,EAAQ,OAAOnW,GAAU,GAC9B,IAAMyoC,EAAOzS,EAAK4Q,WAAW37B,GAC7B,OAAKw9B,EACAA,EAAKr1B,iBACVq1B,EAAKr1B,aAAY,SAACs1B,GACd1oC,EAAS0oC,EAAQ,EAAI,KACtBr7B,GAH2BrN,EAAS,GADrBA,EAAS,OAQnCpE,EAGOoc,aAAP,WAKI,IAHA,IAAIS,GAAU,EAEVkwB,EAAUpvC,KAAKgqC,cAAcoD,SACxBz9B,EAAQy/B,EAAQvtC,OAAS,EAAG8N,GAAS,EAAGA,IAAS,CACtD,IAAM0/B,EAASD,EAAQz/B,GACvB,GAAI0/B,IAAWrvC,KAAK6gB,OAASwuB,IAAWrvC,KAAKy1B,QAGzC,IADA,IAAI2X,EAAWiC,EAAOjC,SACb5xB,EAAI4xB,EAASvrC,OAAS,EAAG2Z,GAAK,EAAGA,IAAK,CAC3C,IAAMhY,EAAO4pC,EAAS5xB,GACtB,GAAIhY,IAASxD,KAAK6gB,MAAlB,CAEA,IAAMqsB,EAAMltC,KAAK8sC,YAAYtpC,GAC7B,GAAK0pC,KAGAhuB,GAAWguB,EAAIoC,gBAAkBpC,EAAI2B,SACtC3vB,GAAU,EACNlf,KAAKqqC,YAAc6C,IACnB//B,EAAQnN,KAAKqqC,WAAW,IAASrqC,KAAKqqC,UAAU53B,YAAYnQ,UAAU0c,MAAMrf,KAAKK,KAAKqqC,WAAW,GACjGrqC,KAAKqqC,UAAY6C,EACjBltC,KAAKqqC,UAAU53B,YAAYnQ,UAAU0c,MAAMrf,KAAKK,KAAKqqC,WAAW,KAIpE6C,EAAIqC,aAAerC,EAAI2B,QAAQ,CAC/B,IAAMW,EAAej/B,OAAOk/B,OAAO,GAAIxQ,EAAU3yB,QAAQuU,MAAOqsB,EAAIz6B,YAAYnQ,UAAU6d,QAAQxgB,KAAKutC,IACnGsC,EAAahQ,KACbx/B,KAAK6gB,MAAM7T,aAAa0iC,GAAY7jC,KAAK,EAAG,IAAK,IAAK,GAAG,GAEzD7L,KAAK6gB,MAAM7T,aAAa0iC,GAAY7jC,KACF,iBAAvB2jC,EAAapQ,MAAqB,EAAIoQ,EAAapQ,MAC5B,iBAAvBoQ,EAAanQ,MAAqB,GAAKmQ,EAAanQ,MAC/B,iBAArBmQ,EAAalQ,IAAmB,IAAMkQ,EAAalQ,IAC5B,iBAAvBkQ,EAAajQ,MAAqB,IAAMiQ,EAAajQ,OAC5D,GAGRv/B,KAAK6gB,MAAM2rB,MAAQhpC,EAAKgpC,MACxBxsC,KAAK6gB,MAAMjL,OAASy5B,EACpBrvC,KAAK6gB,MAAMhL,QAAS,EAEpB7V,KAAK6gB,MAAMjD,YAAY5d,KAAK6gB,MAAMhD,SAASC,EAAG9d,KAAK6gB,MAAMhD,SAASE,EAAGva,EAAKqa,SAAS8xB,GAEnF,IAAIC,EAAa5vC,KAAK6gB,MAAMgvB,kBACxBC,EAAYtsC,EAAKqsC,kBAMrB,YALID,EAAaE,EACb9vC,KAAK6gB,MAAM5C,gBAAgB6xB,GAE3B9vC,KAAK6gB,MAAM5C,gBAAgB6xB,EAAY,OAQ3D9vC,KAAK6gB,MAAMhL,QAAS,EACpB7V,KAAK6gB,MAAM7T,aAAa0iC,GAAYrqC,QAC/B6Z,IACD/R,EAAQnN,KAAKqqC,WAAW,IAASrqC,KAAKqqC,UAAU53B,YAAYnQ,UAAU0c,MAAMrf,KAAKK,KAAKqqC,WAAW,GACjGrqC,KAAKqqC,UAAY,OAIzBhoC,EACQ0tC,cAAR,SAAsBt6B,EAAgB/D,GAAc,IAAAs+B,EAChD,IAAKv6B,EAAQ,OAAO,KAEpB,IAAMjS,EAAOmS,EAAYF,GAUzB,OARAjS,EAAKqS,QAAS,EACVrS,EAAKkO,OAASA,IACd1R,KAAKsW,KAAK,wCAAyCtW,KAAKutC,UAAU77B,IAClElO,EAAKkO,KAAOA,GAGhBlO,EAAKoS,OAAS5V,KAAKytC,YAAY/7B,UAC/Bs+B,EAAAxsC,EAAKwJ,aAAa6F,KAAlBm9B,EAA2BC,kBACpBzsC,GAGXnB,EACQ6tC,aAAR,SAAqBpV,EAAmBppB,GACpC,IAAKopB,IAAUA,EAAMqV,MAAO,OAAO,KAE/BrV,EAAMqV,MAAMz+B,OAASA,IACrB1R,KAAKsW,KAAK,uCAAwCtW,KAAKutC,UAAU77B,IACjEopB,EAAMqV,MAAMz+B,KAAOA,GAGvB,IAAMw6B,EAAOlsC,KAAKmtC,kBAAkBrS,EAAMqV,OAC1C,OAAKjE,GAKLA,EAAK1oC,KAAKqS,QAAS,EACfq2B,EAAK1oC,KAAKkO,OAASA,IACnB1R,KAAKsW,KAAK,uCAAwCtW,KAAKutC,UAAU77B,IACjEw6B,EAAK1oC,KAAKkO,KAAOA,GAEdw6B,EAAK1oC,OATRxD,KAAKuW,MAAM,0CAA2CvW,KAAKutC,UAAU77B,IAC9D,OASdrP,EAEO+tC,iBAAR,SAAyB1+B,EAAc2+B,GACnC,IAAMx+B,EAAOw+B,GAAerwC,KAAK4T,aAMjC,OALK5T,KAAK2qC,aAAavhC,IAAIsI,GAGvB1R,KAAK2qC,aAAa5qC,IAAI2R,GAAMjI,KAAKoI,GAFjC7R,KAAK2qC,aAAaplC,IAAImM,EAAM,CAACG,IAI1BA,GACVxP,EAEOiuC,oBAAR,SAA4B5+B,EAAcG,GACtC,IAAK7R,KAAK2qC,aAAavhC,IAAIsI,GAAO,OAAO,EACzC,IAAM/B,EAAQ3P,KAAK2qC,aAAa5qC,IAAI2R,GAAMxG,QAAQ2G,GAClD,OAAe,IAAXlC,IACJ3P,KAAK2qC,aAAa5qC,IAAI2R,GAAM7B,OAAOF,EAAO,IACnC,IAGXtN,EAGQkuC,SAAR,SAAiB7+B,EAAcsL,EAAiBvW,GAA8C,IAAA+pC,OAEpFH,EAAcrzB,EAAS,GAAKhd,KAAKywC,cACjCC,EAAgB1wC,KAAKowC,iBAAiB1+B,EAAM2+B,GAGlD,GAAK3+B,EAAL,CAcA,IAAMlO,EAAOxD,KAAK4tC,aAAal8B,GAC3BvE,EAAQ3J,GAAM,KAAgD,IAAvCxD,KAAK8sC,YAAYtpC,GAAMmtC,YAC9CzjC,YAAW,WACP,GAAKC,EAAQqjC,GAGb,OAAsD,IAAlDA,EAAKF,oBAAoB5+B,EAAMg/B,GACxBF,EAAKI,YAAYP,QAIxBljC,EAAQ3J,GAAM,IACVgtC,EAAKrG,YAAcz4B,EACnBjL,EAASjD,EAAMkX,EAASC,YAExBlU,EAASjD,GAEbgtC,EAAKI,YAAYP,KAEjBG,EAAKD,SAAS7+B,EAAMsL,EAAQvW,GAC5B+pC,EAAKI,YAAYP,QAO7BrwC,KAAKwV,KAAK9D,GAAM,SAACopB,GACb,GAAK3tB,EAAQqjC,GAAb,CAGA,IAAsD,IAAlDA,EAAKF,oBAAoB5+B,EAAMg/B,GAC/B,OAAOF,EAAKI,YAAYP,GAI5B,GAAIvV,aAAiByB,EAGjB,OAFA91B,EAAS+pC,EAAKN,aAAapV,EAAOppB,GAAOopB,EAAMqV,YAC/CK,EAAKI,YAAYP,GAKrB,IAAM7sC,EAAOgtC,EAAK5C,aAAal8B,GAC1BvE,EAAQ3J,GAAM,KAAgD,IAAvCgtC,EAAK1D,YAAYtpC,GAAMmtC,aAI/ClqC,EAASjD,GACTgtC,EAAKI,YAAYP,KAJjB5pC,EAAS+pC,EAAKT,cAAcjV,EAAOppB,IACnC8+B,EAAKI,YAAYP,aA3DrBnjC,YAAW,WACP,GAAKC,EAAQqjC,GAAb,CAEA,IAAsD,IAAlDA,EAAKF,oBAAoB5+B,EAAMg/B,GAC/B,OAAOF,EAAKI,YAAYP,GAE5B5pC,EAAS,MACT+pC,EAAKI,YAAYP,QA4D7BhuC,EAGOuL,YAAP,SAAmBqO,GACXjc,KAAKk/B,UACLl/B,KAAK+c,KAAK,CACNrL,KAAM1R,KAAKk/B,UACXprB,KAAM9T,KAAKkqC,YACXjuB,OAAAA,KAGJ/b,EAAKE,KAAKuM,QAAQC,GAAGikC,UAAU,mCAAoC,KACnE50B,GAAUA,IACVjc,KAAKsW,KAAK,kCAIlBjU,EAGOwsC,OAAP,SAAcn9B,GACV,QAAS1R,KAAK8tC,eAAep8B,IACzB1R,KAAK8wC,UAAUp/B,IACf1R,KAAK+wC,UAAUr/B,IAGvBrP,EAGOyuC,UAAP,SAAiBp/B,GACb,QAAS1R,KAAK6qC,UAAUmC,MAAK,SAAC3W,GAAQ,OAAOA,EAAE3kB,MAAQA,MAG3DrP,EAGO0uC,UAAP,SAAiBr/B,GACb,OAAO1R,KAAK2qC,aAAavhC,IAAIsI,IAAS1R,KAAK2qC,aAAa5qC,IAAI2R,GAAM7P,OAAS,GAG/EQ,EAGQ2uC,eAAR,SAAuBl9B,GACA,SAAfA,EAAKm9B,OAA8C,IAA1BjxC,KAAK6qC,UAAUhpC,OACxC7B,KAAK6qC,UAAUphC,KAAKqK,GAEpB9T,KAAK6qC,UAAUh7B,OAAO,EAAG,EAAGiE,GAEF,IAA1B9T,KAAK6qC,UAAUhpC,QACf7B,KAAKkxC,oBAIb7uC,EAGQ6uC,iBAAR,WAA2B,IAAA9T,OACvB,GAA8B,IAA1Bp9B,KAAK6qC,UAAUhpC,OAAnB,CACA,IAAMiS,EAAO9T,KAAK6qC,UAAU,GAC5B7qC,KAAK+c,KAAK,CACNrL,KAAMoC,EAAKpC,KACXoC,KAAMA,EAAKA,KACXmI,OAAQnI,EAAKmI,OACbC,OAAQ,SAACU,GACL9I,EAAKoI,QAAUpI,EAAKoI,OAAOU,GAC3BwgB,EAAKyN,UAAUnsB,QACf0e,EAAK8T,oBAET7zB,QAASvJ,EAAKuJ,QAAU,SAAC9G,EAAe+G,GACpC,IAAM6zB,EAAMr9B,EAAKuJ,QAAQ9G,EAAO+G,GAGhC,OAFA8f,EAAKyN,UAAUnsB,QACf0e,EAAK8T,mBACEC,QACP3lB,EACJtY,IAAKY,EAAKZ,IACV+J,KAAMnJ,EAAKmJ,KACXD,OAAQlJ,EAAKkJ,WAEpB3a,EAEO+uC,OAAR,SAAezW,GAA6B,IAAA+C,OAChChsB,EAAiFipB,EAAjFjpB,KAAMoC,EAA2E6mB,EAA3E7mB,KAAMmI,EAAqE0e,EAArE1e,OAAQC,EAA6Dye,EAA7Dze,OAAQmB,EAAqDsd,EAArDtd,QAAOg0B,EAA8C1W,EAA5CznB,IAAAA,WAAGm+B,GAAOA,EAAAC,EAAkC3W,EAAhC1d,KAAAA,WAAIq0B,EAAG,KAAIA,EAAAC,EAAqB5W,EAAnB3d,OAAAA,WAAMu0B,GAAQA,EAEpFvxC,KAAKuwC,SAAS7+B,EAAMsL,GAAQ,SAACxZ,EAAM2sC,GAC/B,IAAK3sC,EAAM,CAGP,GAFAk6B,EAAKnnB,MAAM,OAAW7E,eAElB2L,IAA0E,IAA/DA,EAAW3L,cAAiButB,EAAUxhB,UAAUC,WAC3D,OAIJ,OAFAggB,EAAK7gB,cAAa,WAAA,OAAM6gB,EAAK0T,OAAOzW,KAAS,QACxC3d,GAAQ0gB,EAAK+S,YAAY,KAIjCN,GAASj9B,GAAO1P,EAAKya,iBAAiB,GAEvC,IAAMivB,EAAMxP,EAAKoP,YAAYtpC,GAC7Bk6B,EAAKkN,aAAarlC,IAAI2nC,EAAKx7B,GAC3Bw7B,EAAIz6B,YAAYnQ,UAAUya,KAAKpd,KAAKutC,EAAKp5B,EAAMmJ,GAE3C,SAACL,GACG8gB,EAAKkN,aAAarlC,IAAI2nC,EAAKx7B,GAC3BuK,GAAUA,EAAOW,MAGrB,SAACA,GACG8gB,EAAKkN,oBAAoBsC,GACzBhxB,GAAUA,EAAOU,MAGrB,SAACrG,GACG,GAAIA,EACAmnB,EAAKkN,oBAAoBsC,GACzB7vB,GAAWA,EAAQ9G,EAAO0oB,EAAUxhB,UAAU+zB,iBAC3C,GAAIj5B,EAASH,OAAO1G,GAAO,CAC9BgsB,EAAKkN,aAAarlC,IAAI2nC,EAAKx7B,GAC3B,IAAM+/B,EAAS/T,EAAK0M,SAKpB,GAJA1M,EAAK0M,SAAW8C,EACZ//B,EAAQskC,GAAQ,IAASA,IAAWvE,GAAOuE,EAAO5C,QAClD4C,EAAOh/B,YAAYnQ,UAAUoZ,KAAK/b,KAAK8xC,EAAQ,CAAE//B,KAAAA,IAEjDy+B,EACIsB,IAAWvE,IACXxP,EAAKyM,UAAYz4B,EACjBgJ,EAASg3B,kBAAkBvB,EAAO,MAAM,WACpCzS,EAAK9rB,aAAaF,YAGvB,GAAIgsB,EAAKyM,YAAcZ,EAAS,CACnC7L,EAAKyM,UAAYZ,EACjB,IAAM4G,EAAQ,IAAI31B,EAAM+uB,GACxB4G,EAAMwB,mBAAoB,EAC1Bj3B,EAASg3B,kBAAkBvB,EAAO,MAAM,WACpCzS,EAAK9rB,iCASjCvP,EAIO0a,KAAP,SAAiC4d,GAE2E,IAAA6D,OAChG9sB,EAA+CipB,EAA/CjpB,KAAMoC,EAAyC6mB,EAAzC7mB,KAAMm9B,EAAmCtW,EAAnCsW,MAAO5zB,EAA4Bsd,EAA5Btd,QAAOu0B,EAAqBjX,EAAnB3d,OAAAA,WAAM40B,GAAQA,EAGlD,GAAIX,EACAjxC,KAAKgxC,eAAerW,OADxB,CAKA36B,KAAK4R,aAAaF,GAGlB,IAAM2+B,EAAcrzB,EAAS,GAAKhd,KAAKywC,cACjCC,EAAgB1wC,KAAKowC,iBAAiB1+B,EAAM2+B,GAElDnwC,EAAKE,KAAKwK,IAAIC,KAAKk7B,SAAQ,SAAC96B,GACxBuzB,EAAKyQ,aAAav9B,EAAMoC,GAAM,SAACq7B,GAE3B,IAAsD,IAAlD3Q,EAAK8R,oBAAoB5+B,EAAMg/B,GAAnC,CAMA,IAAe,IAAXvB,EAGA,OAFA3Q,EAAKjoB,MAAM,OAAW7E,eAElB2L,IAA0E,IAA/DA,EAAW3L,cAAiButB,EAAUxhB,UAAUC,WACpD8gB,EAAKoS,YAAYP,GAErBplC,EAAM,GAIjB,GAAc,IAAVkkC,EAKA,OAJA3Q,EAAKloB,KAAK,OAAW5E,SACrB8sB,EAAKiQ,YAAY/8B,GACjB2L,GAAWA,EAAW3L,QAAWutB,EAAUxhB,UAAUo0B,mBACrDrT,EAAKoS,YAAYP,GAIrB7R,EAAK4S,OAAOzW,GACZ6D,EAAKoS,YAAYP,QAxBb7R,EAAKoS,YAAYP,WA6BjChuC,EAIOyvC,UAAP,SAAsCnX,GAEoF,IAAA+D,OACtH,OAAO,IAAIvD,SAAQ,SAACC,GAChBsD,EAAK3hB,KAAIge,KACFJ,GACHze,gBAAOU,GACHwe,EAAQxe,WAMxBva,EAIOqZ,KAAP,SAAAM,GAEkF,IAAA2iB,OAF/CjtB,EAAIsK,EAAJtK,KAAMoC,EAAIkI,EAAJlI,KAAMoI,EAAMF,EAANE,OAGrC4yB,EAAQ9uC,KAAK8tC,eAAep8B,GAAM,GAIxC,GAFA1R,KAAK4R,aAAaF,GAEG,IAAjBo9B,EAAMjtC,UACD7B,KAAK2qC,aAAavhC,IAAIsI,IAAgD,IAAvC1R,KAAK2qC,aAAa5qC,IAAI2R,GAAM7P,QAC5D,OAAO7B,KAAKsW,KAAK,OAAW5E,UAIhC1R,KAAK2qC,aAAavhC,IAAIsI,KACtB1R,KAAK2qC,aAAa5qC,IAAI2R,GAAM5K,SAAQ,SAACupC,GAAW,OAAK1R,EAAKiS,YAAYP,MACtErwC,KAAK2qC,aAAa5qC,IAAI2R,GAAM7P,OAAS,GAGzC,IAAK,IAAI8N,EAAQm/B,EAAMjtC,OAAS,EAAG8N,GAAS,EAAGA,IAAS,CACpD,IAAMnM,EAAOsrC,EAAMn/B,GACbu9B,EAAMltC,KAAK8sC,YAAYtpC,GAEzBxD,KAAKoqC,WAAa8C,IAClBltC,KAAKoqC,SAAW,MAGpB8C,EAAIz6B,YAAYnQ,UAAUoZ,KAAK/b,KAAKutC,EAAKp5B,EAAMoI,KAIvD7Z,EAIOvB,IAAP,SAAA47B,GAEkF,IAFhDhrB,EAAIgrB,EAAJhrB,KAAMoC,EAAI4oB,EAAJ5oB,KAAMoI,EAAMwgB,EAANxgB,OAGpC4yB,EAAQ9uC,KAAK8tC,eAAep8B,GAAM,GAExC,GAAI1R,KAAK2qC,aAAavhC,IAAIsI,IAAS1R,KAAK2qC,aAAa5qC,IAAI2R,GAAM7P,OAAQ,CACnE,IAAMwuC,EAAcrwC,KAAK2qC,aAAa5qC,IAAI2R,GAAM5Q,MAGhD,OAFAd,KAAK4wC,YAAYP,QACjBrwC,KAAK4R,YAAYF,GAIrB,GAAIo9B,EAAMjtC,OAAQ,CACd,IAAM2B,EAAOsrC,EAAMhuC,MACbosC,EAAMltC,KAAK8sC,YAAYtpC,GAQ7B,OANIxD,KAAKoqC,WAAa8C,IAClBltC,KAAKoqC,SAAW,MAGpB8C,EAAIz6B,YAAYnQ,UAAUoZ,KAAK/b,KAAKutC,EAAKp5B,EAAMoI,QAC/Clc,KAAK4R,YAAYF,GAIrB1R,KAAKsW,KAAK,MAAU5E,WAGxBrP,EAIOqc,MAAP,SAAAwe,GAEkF,IAF9CxrB,EAAIwrB,EAAJxrB,KAAMoC,EAAIopB,EAAJppB,KAAMoI,EAAMghB,EAANhhB,OAGtC4yB,EAAQ9uC,KAAK8tC,eAAep8B,GAAM,GAExC,GAAIo9B,EAAMjtC,OAAQ,CACd,IAAM2B,EAAOsrC,EAAM,GACb5B,EAAMltC,KAAK8sC,YAAYtpC,GAQ7B,OANIxD,KAAKoqC,WAAa8C,IAClBltC,KAAKoqC,SAAW,MAGpB8C,EAAIz6B,YAAYnQ,UAAUoZ,KAAK/b,KAAKutC,EAAKp5B,EAAMoI,QAC/Clc,KAAK4R,cAAcF,GAIvB,GAAI1R,KAAK2qC,aAAavhC,IAAIsI,IAAS1R,KAAK2qC,aAAa5qC,IAAI2R,GAAM7P,OAAQ,CACnE,IAAMwuC,EAAcrwC,KAAK2qC,aAAa5qC,IAAI2R,GAAMgN,QAGhD,OAFA1e,KAAK4wC,YAAYP,QACjBrwC,KAAK4R,cAAcF,GAIvB1R,KAAKsW,KAAK,QAAY5E,WAG1BrP,EAKO0vC,QAAP,SAAAC,GAAiF,IAAAC,OAAAzU,WAAAwU,EAAV,GAAEA,EAAxDl+B,EAAI0pB,EAAJ1pB,KAAMk7B,EAAOxR,EAAPwR,QACnBhvC,KAAK4R,IAAI,WAET5R,KAAK4qC,aAAa9jC,SAAQ,SAAC4K,EAAMw7B,GACzB30B,EAASwB,QAAQrI,IACjBs9B,IAAsC,IAA3BA,EAAQ9jC,QAAQwG,IAC3Bw7B,IAAQ+E,EAAK7H,UACjB8C,EAAIz6B,YAAYnQ,UAAUoZ,KAAK/b,KAAKutC,EAAKp5B,MAG7C9T,KAAK2qC,aAAa7jC,SAAQ,SAACtB,EAAOkM,GAC1B6G,EAASwB,QAAQrI,IACjBs9B,IAAsC,IAA3BA,EAAQ9jC,QAAQwG,KAC/BlM,EAAMsB,SAAQ,SAACupC,GAAW,OAAK4B,EAAKrB,YAAYP,MAChD7qC,EAAM3D,OAAS,OAEtBQ,EAEMouC,YAAP,SAAmB/K,GAAa,IAKrBwM,EALqBC,iBAAbzM,IAAAA,EAAU,GACzB1lC,KAAKy1B,QAAQ5f,QAAS,EACtB7V,KAAKy1B,QAAQxX,iBAAiB,GAC1Bje,KAAKy1B,QAAQzoB,aAAaolC,IAC1BpyC,KAAKy1B,QAAQzoB,aAAaolC,GAAcvmC,cAGxCqmC,OAAKzc,QAAQjR,uBAAuB4tB,KAApCF,EAAmDrmC,OAEvD,IAAMgG,EAAO7R,KAAK4T,aAKlB,OAJA5T,KAAK0qC,eAAenlC,IAAIsM,GAAM,GAC1B6zB,EAAU,GAAG1lC,KAAK6c,cAAa,WAC/Bs1B,EAAKvB,YAAY/+B,KAClB6zB,GACI7zB,GACVxP,EAEMuuC,YAAP,SAAmB/+B,GACf,GAAKA,IACL7R,KAAK0qC,sBAAsB74B,GACM,IAA7B7R,KAAK0qC,eAAeh7B,MAAY,CAGzB,IAAA2iC,EAFP,GAAIryC,KAAKy1B,QAAQzoB,aAAaolC,GAC1BpyC,KAAKy1B,QAAQzoB,aAAaolC,GAAc/sC,oBAGxCgtC,OAAK5c,QAAQjR,uBAAuB4tB,KAApCC,EAAmDhtC,QAEvDrF,KAAKy1B,QAAQ5f,QAAS,IAI9BxT,EAGOiwC,aAAP,SAAoB5M,GAAa,IAAA6M,gBAAb7M,IAAAA,EAAU,GAC1B1lC,KAAK4sC,uBACL,IAAM/6B,EAAO7R,KAAK4T,aAKlB,OAJA5T,KAAKyqC,aAAallC,IAAIsM,GAAM,GACxB6zB,EAAU,GAAG1lC,KAAK6c,cAAa,WAC/B01B,EAAKC,gBAAgB3gC,KACtB6zB,GACI7zB,GAGXxP,EAIOmwC,gBAAP,SAAuB3gC,GACdA,IACL7R,KAAKyqC,oBAAoB54B,GACzB7R,KAAK6sC,4BAGTxqC,EAKOwuC,UAAP,SAAiB4B,EAAiB/M,GAC9B,IAAK1lC,KAAKiqC,MACN,OAAOjqC,KAAKuW,MAAM,YAAa,qDAEnCvW,KAAKiqC,MAAMhsB,iBAAiB,GAC5Bje,KAAKiqC,MAAMj9B,aAAa0lC,GAAY3nC,IAAI,CACpC0nC,QAAAA,EAAS/M,QAAAA,KAIjBrjC,EAGOswC,WAAP,WACS3yC,KAAKiqC,OACVjqC,KAAKiqC,MAAMj9B,aAAa0lC,GAAYrtC,SAGxChD,EAIOwY,gBAAP,SAAuBC,GACfA,GACA9a,KAAKwqC,cAAe,EACpBxqC,KAAK6sC,4BAEL7sC,KAAK4sC,uBACL5sC,KAAKwqC,cAAe,GAExBxqC,KAAKsW,KAAK,kBAAmBtW,KAAKwqC,eAGtCnoC,EAGO+L,gBAAP,WAAwD,QAAAuC,EAAA/O,UAAAC,OAA9BC,MAAIC,MAAA4O,GAAAC,IAAAA,EAAAD,EAAAC,IAAJ9O,EAAI8O,GAAAhP,UAAAgP,GAC1BnN,EAAKnB,UAAUsB,GAAG3B,MAAMjC,KAAKgqC,cAAeloC,IAGhDO,EAGOwK,kBAAP,WAA4D,QAAAgE,EAAAjP,UAAAC,OAAhCC,MAAIC,MAAA8O,GAAAC,IAAAA,EAAAD,EAAAC,IAAJhP,EAAIgP,GAAAlP,UAAAkP,GAC5BrN,EAAKnB,UAAU/B,KAAK0B,MAAMjC,KAAKgqC,cAAeloC,IAGlDO,EAGO8L,iBAAP,WAA0D,QAAA4C,EAAAnP,UAAAC,OAA/BC,MAAIC,MAAAgP,GAAAC,IAAAA,EAAAD,EAAAC,IAAJlP,EAAIkP,GAAApP,UAAAoP,GAC3BvN,EAAKnB,UAAUqL,IAAI1L,MAAMjC,KAAKgqC,cAAeloC,IAGjDO,EAGOuwC,uBAAP,WAAsE,QAAA3hC,EAAArP,UAAAC,OAArCC,MAAIC,MAAAkP,GAAAC,IAAAA,EAAAD,EAAAC,IAAJpP,EAAIoP,GAAAtP,UAAAsP,GACjCzN,EAAKnB,UAAUgO,UAAUrO,MAAMjC,KAAKgqC,cAAeloC,IAGvDO,EAGOyZ,kBAAP,SAAyBpK,GAAiB,IAAAmhC,SACtCA,OAAK7I,uBAAa6I,EAAlBA,EACMnvB,eAAehS,YAAKmhC,EAD1BA,EAEM7lC,aAAa2/B,KAFnBkG,EAGMC,gBAGVzwC,EAWO0wC,WAAP,SAAkBC,EAA8B5R,GAM5C,IAEM6R,UAFU7R,SAAAA,EAAM6R,aAAcv4B,EAASC,WAAWmwB,wBAAwBC,IAErDmI,MAAK,SAAC5P,EAAGhG,GAAC,OAAKgG,EAAE2H,SAAW3N,EAAE2N,YACpDxuB,QAAO,SAAAuuB,GACJ,QAAKA,EAAOmI,sBACRnI,EAAOoI,sBACJhS,IAAAA,EAAMiS,cAAejS,EAAKiS,aAAarI,QAEhDsI,EAAcL,EAAWpM,KAAI,SAAAmE,GAAM,OAAIA,EAAOA,UAUpD,OARAiI,EAAWnsC,SAAQ,SAAAkkC,GACfA,EAAOoI,cAAgBJ,KAE3Bt4B,EAASpF,KAAKi+B,SAASC,OAAOF,GAC9BL,EAAWnsC,SAAQ,SAAAkkC,GACfA,EAAOoI,cAAgB,QAGpBJ,GACVnzC,EAAAo/B,IAAAn/B,WAAAC,IA52CD,WACI,OAAOC,KAAKwD,KAAKoS,OAAOA,UAG5B9V,aAAAC,IACA,WACI,OAAOC,KAAKyzC,OAAOC,mBAGvB5zC,aAAAC,IACA,WACI,OAAOC,KAAKsV,KAAKtI,aAAaoW,OACjC6b,GA9FkFrzB,IAE5EU,QAgBH,GAAEgM,EAGCmF,UAAYA,EAASnF,EAGrBmxB,SAAWA,EAAQnxB,EAGnBoxB,aAAeA,EAAYroC,EAAAC,GAiBhCC,EAjBgC+W,GAAAhW,wBAAAnB,IAAAuB,gBAAAC,cAAAC,YAAAC,uBAAA,OAML,QAAImW,EAAA1X,EAAAC,EAAAe,sBAAAqV,IAAAjV,gBAAAC,cAAAC,YAAAC,uBAAA,OAMN,QAAIoW,EAAA3X,EAAAC,EAAAe,sBAAAyV,IAAArV,gBAAAC,cAAAC,YAAAC,uBAAA,OAMJ,QADzBC,EAC6BvB,KAAAuB,MA7CLjC,IAAAC;;6dClK9B,IAAQC,EAAwCC,EAAxCD,QAASE,EAA+BD,EAA/BC,SAAUmnB,EAAqBpnB,EAArBonB,8BAIMlnB,EAFhCH,EAAQ,gBAAeI,EACvBinB,EAAiB9M,GAAY3D,EAEzB1W,EAASwC,GAAKsU,EAGd9W,EAAS,CAAE6W,QAAS,UAAUE,EAG9B/W,EAAS,CAAE6W,QAAS,cAAc5W,EAAA4B,EAAA3B,GAPYE,EAAAC,GAOZC,WAAAwI,GAAA,SAAAqoC,IAAA,IAAA,IAAA1wC,EAAAC,EAAAC,UAAAC,OAAAC,MAAAC,MAAAJ,GAAAK,IAAAA,EAAAL,EAAAK,IAAAF,EAAAE,GAAAJ,UAAAI,GAYf,OAZeN,EAAAqI,EAAApK,KAAAsC,MAAA8H,SAAA7H,OAAAJ,UAAAK,EAAAT,YAAAL,EAAAe,EAAAV,IAAAS,EAAAT,SAAAsX,EAAA5W,EAAAV,IAAAS,EAAAT,UAAAuX,EAAA7W,EAAAV,IAAAA,EAG3B+S,SAAW,EAAC/S,EACZiyC,UAAY,EAACjyC,EACbkyC,SAAU,EAAKlyC,EAEfmyC,WAAa,IAAGnyC,EAChBoyC,UAAY,IAAIpyC,EAEhBqyC,QAAS,EAAKryC,EACdsyC,SAAU,EAAKtyC,EACfuyC,SAAW,EAACvyC,EAZe9B,EAAAwyC,EAAAroC,GAYf,IAAA1H,EAAA+vC,EAAA9vC,UAwFnB,OAxFmBD,EAEpBwJ,KAAA,WACQ7L,KAAK+zC,SACT/zC,KAAK+zC,QAAS,EAEd/zC,KAAKyU,SAAW,EAChBzU,KAAK2zC,UAAY,EACjB3zC,KAAKy1B,QAAQye,MAAQ,EACrBl0C,KAAK4zC,SAAU,EAEf5zC,KAAKg0C,SAAU,EACfh0C,KAAKi0C,SAAWj0C,KAAKo/B,MACrBp/B,KAAKy1B,QAAQzoB,aAAamnC,GAAU9uC,UACvChD,EAEDgD,MAAA,WACIrF,KAAK+zC,QAAS,EACd/zC,KAAKg0C,SAAU,GAGnB3xC,EAGQ+xC,OAAR,WACI,IAAMC,EAAWr0C,KAAKy1B,QAAQzoB,aAAamnC,GACrC94B,EAAcrb,KAAKy1B,QAAQzoB,aAAasO,GAExCg5B,EAAUt0C,KAAK0P,KAAK4T,OAAS,GAAMjI,EAAY2O,SAC/CuqB,EAAUv0C,KAAK0P,KAAK8T,QAAU,GAAMnI,EAAY4O,SAEhDuqB,EAAI9lC,KAAKK,IAAI/O,KAAK0P,KAAK4T,MAAQ,EAAGtjB,KAAK0P,KAAK8T,OAAS,GAErDixB,EAAQ/lC,KAAKgmC,GAInB,GADAL,EAAShvC,QACLrF,KAAK4zC,QAAS,CACd,IAAMnoC,EAAQ,GAAMiD,KAAKgmC,GAJf,EAKJpV,EAAM,GAAM5wB,KAAKgmC,GAAqB,EAAhB10C,KAAKyU,SAAeggC,EALtC,EAMVJ,EAASM,IAAIL,EAASC,EAASC,EAAG/oC,EAAO6zB,GAAK,OAC3C,CACH,IAAM7zB,EAAQ,GAAMiD,KAAKgmC,GARf,EASJpV,EAAM,GAAM5wB,KAAKgmC,GAAqB,EAAhB10C,KAAKyU,SAAeggC,EATtC,EAUVJ,EAASM,IAAIL,EAASC,EAASC,EAAG/oC,EAAO6zB,GAAK,GAElD+U,EAASO,UACZvyC,EAESokB,OAAV,SAAiB0F,GACb,GAAKnsB,KAAK+zC,OAAV,CAGA,IAAK/zC,KAAKg0C,QAAS,CAIf,GAHIh0C,KAAKi0C,SAAW,IAChBj0C,KAAKi0C,UAAY9nB,KAEjBnsB,KAAKi0C,UAAY,GAGjB,OAFAj0C,KAAKg0C,SAAU,EAOvBh0C,KAAKy1B,QAAQye,OAASl0C,KAAK6zC,WAAa1nB,GACpCnsB,KAAKy1B,QAAQye,OAAS,KAAOl0C,KAAKy1B,QAAQye,QAAU,OACpDl0C,KAAKy1B,QAAQye,MAAQl0C,KAAKy1B,QAAQye,MAAQ,KAI1Cl0C,KAAK2zC,UAAY,GACjB3zC,KAAKyU,SAAW/F,KAAKK,IAAI,EAAG/O,KAAKyU,SAAWzU,KAAK8zC,UAAY9zC,KAAK2zC,WAE7C,GAAjB3zC,KAAKyU,WACLzU,KAAK2zC,WAAa,EAClB3zC,KAAK4zC,SAAW5zC,KAAK4zC,WAGzB5zC,KAAKyU,SAAW/F,KAAKC,IAAI,EAAG3O,KAAKyU,SAAWzU,KAAK8zC,UAAY9zC,KAAK2zC,WAE7C,GAAjB3zC,KAAKyU,WACLzU,KAAK2zC,UAAY,EACjB3zC,KAAK4zC,SAAW5zC,KAAK4zC,UAI7B5zC,KAAKo0C,WACRhC,GA3GqCpjC,IAAS1M,qBAAAqV,IAAAjV,gBAAAC,cAAAC,YAAAC,mBAAAmW,EAAA1X,EAAAC,EAAAe,kBAAAyV,IAAArV,gBAAAC,cAAAC,YAAAC,uBAAA,OAK1B,IAAIgyC,EAAK,GAAI,OAAG57B,EAAA3X,EAAAC,EAAAe,mBAAA0V,IAAAtV,gBAAAC,cAAAC,YAAAC,uBAAA,OAGrB,KADmBC,EAClBvB,KAAAuB,IAAAA,MARYjC,IAAAC;;4nBCHjC,IAAQC,EAAwCC,EAAxCD,QAASE,EAA+BD,EAA/BC,SAAUmnB,EAAqBpnB,EAArBonB,8BAKIlnB,EAH9BH,EAAQ,cAAaI,EACrBinB,EAAiBhnB,GAAOuW,EACxByQ,EAAiB0sB,GAAU/8B,EAEvB9W,EAAS8zC,GAAS/8B,EAGlB/W,EAASgf,GAAY/e,EAAA4B,EAAA3B,EAAA2B,EAAA6U,GAJuBtW,EAAAC,GAIvBC,WAAAwI,GAAA,SAAA2lC,IAAA,IAAA,IAAAhuC,EAAAC,EAAAC,UAAAC,OAAAC,MAAAC,MAAAJ,GAAAK,IAAAA,EAAAL,EAAAK,IAAAF,EAAAE,GAAAJ,UAAAI,GA8Ce,OA9CfN,EAAAqI,EAAApK,KAAAsC,MAAA8H,SAAA7H,OAAAJ,UAAAK,EAAAT,iBAAAL,EAAAe,EAAAV,IAAAS,EAAAT,eAAAsX,EAAA5W,EAAAV,IAAAS,EAAAT,WAAAuX,EAAA7W,EAAAV,IAAAS,EAAAT,WAAAwX,EAAA9W,EAAAV,IAAAS,EAAAT,SAAAyX,EAAA/W,EAAAV,IAAAS,EAAAT,WAAA6mB,EAAAnmB,EAAAV,IAAAA,EA0CdqyC,QAAS,EAAKryC,EACdsyC,SAAU,EAAKtyC,EACfuyC,SAAW,EAACvyC,EAEZszC,UAAyB,KAAItzC,EA9Cf9B,EAAA8vC,EAAA3lC,GA8Ce,IAAA1H,EAAAqtC,EAAAptC,UANpC,OAMoCD,EAErCwJ,KAAA,SAAKuzB,EAAeC,EAAeC,EAAaC,EAAeC,GAAe,IAAAn1B,OAC1E,GAAIm1B,EAAM,CACN9kB,EAASpK,UAAUtQ,MACnBA,KAAK+zC,QAAS,EACd/zC,KAAKg0C,SAAU,EAEfh0C,KAAKi1C,OAAOpyB,MAAQC,EAAMC,MAC1B/iB,KAAKi1C,OAAOC,eAAiB,KAC7Bl1C,KAAKi1C,OAAO/0B,YAAclgB,KAAKg1C,UAC3Bh1C,KAAKg1C,YAAWh1C,KAAKg1C,UAAUG,SAAU,GAE7C,IAAInhC,EAAQ,EACNohC,EAAU16B,EAASC,WAAWmwB,wBAAwBC,GAC5DrwB,EAAS9W,GAAG6d,EAAS4zB,qBAAqB,WAAM,IAAAC,EAC5CthC,IAEA,IASiBuhC,EATXvC,EAAgB,IAAIwC,EACpB9lC,EAAOrF,EAAK7G,KAAKwJ,aAAasO,GAQpC,OAPA03B,EAAcyC,MAAM,CAAEnyB,MAAO5T,EAAK4T,MAAQ,EAAGE,OAAQ9T,EAAK8T,OAAS,IACnEwvB,EAAchY,SAEd96B,EAAKE,KAAKuM,QAAQC,GAAGmmC,WAAWC,EAAe,CAC3CC,WAAYmC,IAGF,IAAVphC,GACA3J,EAAK2qC,UAAY,IAAI/0B,SACrBs1B,EAAAlrC,EAAK2qC,mBAASO,EAAdA,EAAgBG,UAAhBH,EAAyBta,SACzB5wB,EAAK2qC,UAAUU,QAAU1C,EACzB3oC,EAAK2qC,UAAUG,SAAU,EACzB9qC,EAAK4qC,OAAO/0B,YAAc7V,EAAK2qC,UAC/B3qC,EAAK4qC,OAAOC,eAAiB7qC,EAAKsrC,kBAClCtrC,EAAKsrC,aAAaC,YAAY,YAAa,IAIjC,IAAV5hC,GACA0G,EAASpK,UAAUjG,GACnBA,EAAK4qC,OAAO/0B,YAAYi1B,SAAU,OAClC9qC,EAAK4qC,OAAOC,eAAiB,eAIjCI,EAAAjrC,EAAK2qC,mBAASM,EAAdA,EAAgBI,UAAhBJ,EAAyBra,SACzB5wB,EAAK2qC,UAAUU,QAAU1C,EACzB3oC,EAAK2qC,UAAUG,SAAU,EACzB9qC,EAAK4qC,OAAO/0B,YAAc7V,EAAK2qC,UAC/B3qC,EAAK4qC,OAAOC,eAAiB7qC,EAAKsrC,kBAClCtrC,EAAKsrC,aAAaC,YAAY,YAAuB,IAAV5hC,EAAc,EAAI,MAC9DhU,WAEH0a,EAASpK,UAAUtQ,MACnBA,KAAKi1C,OAAO/0B,YAAclgB,KAAK61C,WAC/B71C,KAAKi1C,OAAOpyB,MAAQC,EAAME,MAC1BhjB,KAAKi1C,OAAOC,eAAiB,KAGjCl1C,KAAKo/B,MAAQA,EACbp/B,KAAKq/B,MAAQA,EACbr/B,KAAKs/B,IAAMA,EACXt/B,KAAKu/B,MAAQA,EACbv/B,KAAKg0C,SAAU,EAEXh0C,KAAK+zC,SACT/zC,KAAK+zC,QAAS,EACd/zC,KAAKi0C,SAAWj0C,KAAKo/B,MAErBp/B,KAAK81C,QAAQA,QAAU91C,KAAKi0C,SAAW,EAAI,EAAIj0C,KAAKq/B,QACvDh9B,EAEDgD,MAAA,WAAQ,IAAA0wC,EAAAC,EACJh2C,KAAK+zC,QAAS,EACd/zC,KAAKg0C,SAAU,EACft5B,EAASpK,UAAUtQ,aACnB+1C,OAAKf,mBAASe,EAAdA,EAAgBL,UAAhBK,EAAyB9a,gBACzB+a,OAAKhB,YAALgB,EAAgB1wC,UAChBtF,KAAKg1C,UAAY,KACjBh1C,KAAKi1C,OAAO/0B,YAAc,MAC7B7d,EAESokB,OAAV,SAAiB0F,GACb,GAAKnsB,KAAK+zC,QACL/zC,KAAKg0C,QAAV,CAEA,GAAIh0C,KAAKi0C,SAAW,EAAG,CAEnB,GADAj0C,KAAKi0C,UAAY9nB,EACbnsB,KAAKi0C,SAAW,EAAG,OAEvBj0C,KAAK81C,QAAQA,QAAU91C,KAAKq/B,MAGhC,IAAM4W,EAAYj2C,KAAK81C,QACnB91C,KAAKu/B,MAAQ,GACb0W,EAAUH,SAAW91C,KAAKu/B,MAAQpT,EAC9B8pB,EAAUH,QAAU91C,KAAKs/B,MACzB2W,EAAUH,QAAU91C,KAAKs/B,MAEtBt/B,KAAKu/B,MAAQ,IACpB0W,EAAUH,SAAW91C,KAAKu/B,MAAQpT,EAC9B8pB,EAAUH,QAAU91C,KAAKs/B,MACzB2W,EAAUH,QAAU91C,KAAKs/B,MAG7B2W,EAAUH,SAAW91C,KAAKs/B,MAC1Bt/B,KAAKg0C,SAAU,KAEtBn0C,EAAA6vC,IAAA5vC,YAAAC,IArJD,WACc,OAAOC,KAAKk2C,QAAS3wC,IACnC,SAAU8wB,GAAKr2B,KAAKk2C,OAASxnC,KAAKC,IAAI0nB,EAAG,MAAKv2B,YAAAC,IAI9C,WACc,OAAOC,KAAKm2C,QAAS5wC,IACnC,SAAU8wB,GAASA,GAAK,GAAKA,GAAK,MAAKr2B,KAAKm2C,OAAS9f,MAAIv2B,UAAAC,IAIzD,WACY,OAAOC,KAAKo2C,MAAO7wC,IAC/B,SAAQ8wB,GAASA,GAAK,GAAKA,GAAK,MAAKr2B,KAAKo2C,KAAO/f,MAAIv2B,YAAAC,IAIrD,WAEI,OAAIC,KAAKq/B,OAASr/B,KAAKs/B,IACZ,EACAt/B,KAAKq/B,MAAQr/B,KAAKs/B,IAClBt/B,KAAKq2C,OAAS,GAAKr2C,KAAKq2C,OAASr2C,KAAKq2C,OAEtCr2C,KAAKq2C,QAAU,EAAIr2C,KAAKq2C,QAAUr2C,KAAKq2C,QAErD9wC,IACD,SAAU8wB,GAAKr2B,KAAKq2C,OAAShgB,KAAIv2B,aAAAC,IAEjC,WACI,OAAOC,KAAKwD,KAAKwJ,aAAa5L,MACjCtB,cAAAC,IACD,WACI,OAAOC,KAAKwD,KAAKwJ,aAAa8nC,OACjCpF,GA5CmC1gC,IAAS1M,0BAAAyV,IAAArV,gBAAAC,cAAAC,YAAAC,uBAAA,OAEZ,QAAImW,EAAA1X,EAAAC,EAAAe,wBAAA0V,IAAAtV,gBAAAC,cAAAC,YAAAC,uBAAA,OAGH,QAAIoW,EAAA3X,EAAAC,EAAAe,oBAErCrB,IAAQyB,gBAAAC,cAAAC,YAAAC,uBAAA,OACQ,KAACvB,EAAAC,EAAAe,mBACjBrB,GAAQsP,OAAAuQ,yBAAAvf,EAAAe,mBAAAf,EAAAe,WAAA4W,EAAA5X,EAAAC,EAAAe,oBAIRrB,IAAQyB,gBAAAC,cAAAC,YAAAC,uBAAA,OACQ,KAACvB,EAAAC,EAAAe,mBACjBrB,GAAQsP,OAAAuQ,yBAAAvf,EAAAe,mBAAAf,EAAAe,WAAA6W,EAAA7X,EAAAC,EAAAe,kBAIRrB,IAAQyB,gBAAAC,cAAAC,YAAAC,uBAAA,OACM,OAAGvB,EAAAC,EAAAe,iBACjBrB,GAAQsP,OAAAuQ,yBAAAvf,EAAAe,iBAAAf,EAAAe,WAAAimB,EAAAjnB,EAAAC,EAAAe,oBAIRrB,IAAQyB,gBAAAC,cAAAC,YAAAC,uBAAA,OACQ,MAAEvB,EAAAC,EAAAe,mBAClBrB,GAAQsP,OAAAuQ,yBAAAvf,EAAAe,mBAAAf,EAAAe,WAvBaQ,EAuBbvB,KAAAuB,IAAAA,IAAAA,MA3BkBjC,IAAAC;;glBCL/B,IAAQG,EAAwCD,EAAxCC,SAAUF,EAA8BC,EAA9BD,QAASqnB,EAAqBpnB,EAArBonB,8BAIIlnB,EAF9BH,EAAQ,cAAaI,EACrBinB,EAAiB9M,GAAY3D,EAEzB1W,EAASkT,GAAOjT,EAAA4B,EAAA3B,GAD4BE,EAAAC,GAC5BC,WAAAwI,GAAA,SAAA2oC,IAAA,IAAA,IAAAhxC,EAAAC,EAAAC,UAAAC,OAAAC,MAAAC,MAAAJ,GAAAK,IAAAA,EAAAL,EAAAK,IAAAF,EAAAE,GAAAJ,UAAAI,GAaY,OAbZN,EAAAqI,EAAApK,KAAAsC,MAAA8H,SAAA7H,OAAAJ,UAAAK,EAAAT,SAAAL,EAAAe,EAAAV,IAGjBA,EACQ40C,SAAW,EAEnB50C,EACQ60C,QAAU,GAElB70C,EACQ80C,aAAe,IAEvB90C,EACQwzB,KAAO,IAAIP,EAAUjzB,EAbZ9B,EAAA8yC,EAAA3oC,GAaY,IAAA1H,EAAAqwC,EAAApwC,UAiC5B,OAjC4BD,EAE7B0I,IAAA,SAAI+I,GAGD,IAAAzJ,OACOosC,EAAOz2C,KAAKk1B,KAAKn1B,OAAS4V,EAAY3V,KAAKy2C,MACjDA,EAAK74B,YAAY,EAAG,EAAG,GACvB64B,EAAK7gC,OAAS5V,KAAKwD,KACnBizC,EAAK5gC,QAAS,EAEd4gC,EAAKzpC,aAAa0pC,GAAgB7qC,KAAKiI,EAAK2+B,SAE5CgE,EAAKzpC,aAAa8nC,GAAWgB,QAAU,IACvCa,EAAMF,EAAKzpC,aAAa8nC,IACnB1V,MAAMtrB,EAAK4xB,SAAW1lC,KAAKs2C,UAC3BM,GAAG52C,KAAKu2C,QAAS,CAAET,QAAS,IAC5Bn2C,MAAK,WACF0K,EAAK6qB,KAAKK,IAAIkhB,MAEjBhrC,SACRpJ,EAEDgD,MAAA,WAEI,IADA,IAAM+nC,EAAWptC,KAAKwD,KAAK4pC,SAClBz9B,EAAQy9B,EAASvrC,OAAS,EAAG8N,GAAS,EAAGA,IAC9CknC,EAAMC,gBAAgB1J,EAASz9B,GAAO3C,aAAa8nC,IACnD1H,EAASz9B,GAAOrK,WAEvBjD,EAMSwlB,UAAV,WACI7nB,KAAKk1B,KAAK7vB,SACbhD,EAESokB,OAAV,SAAiB0F,GAEb,IADA,IAAMihB,EAAWptC,KAAKwD,KAAK4pC,SAClBz9B,EAAQy9B,EAASvrC,OAAS,EAAGk1C,GAAW,EAAOpnC,GAAS,EAAGA,IAAS,CACzE,IAAMqnC,EAAOrnC,IAAUy9B,EAASvrC,OAAS,EACnCo1C,EAAO7J,EAASz9B,GAGtB,GAAIonC,EACAF,EAAMC,gBAAgBG,EAAKjqC,aAAa8nC,IACxC90C,KAAKk1B,KAAKK,IAAI0hB,QAIlB,GAAID,EAAM,CACN,IAEME,EAAW,EAFFD,EAAKjqC,aAAasO,GAELkI,OAAS,EAC/B2zB,EAAWF,EAAKp5B,SAASE,EAAIm5B,EAEnC,GAAIC,EAAWD,EAAU,CAErB,IAAME,EAAS1oC,KAAKC,KAAK3O,KAAKw2C,aAAerqB,GAAMihB,EAASvrC,OAAS8N,GAAQunC,EAAWC,GACxFF,EAAKr5B,YAAYq5B,EAAKp5B,SAASC,EAAGm5B,EAAKp5B,SAASE,EAAIq5B,EAAQH,EAAKp5B,SAAS8xB,QAE3E,CACH,IAAM0H,EAAOjK,EAASz9B,EAAQ,GACxB2nC,EAASL,EAAKjqC,aAAasO,GAC3Bi8B,EAASF,EAAKrqC,aAAasO,GAE3B67B,EAAWF,EAAKp5B,SAASE,EAAIu5B,EAAO9zB,OAAS,EAAI,EACjD0zB,EAAWG,EAAKx5B,SAASE,EAAIw5B,EAAO/zB,OAAS,EAEnD,GAAI2zB,EAAWD,EAAU,CAErB,IAAME,EAAS1oC,KAAKK,IAAI/O,KAAKw2C,aAAerqB,GAAMihB,EAASvrC,OAAS8N,EAAQ,GAAIunC,EAAWC,GAC3FF,EAAKr5B,YAAYq5B,EAAKp5B,SAASC,EAAGm5B,EAAKp5B,SAASE,EAAIq5B,EAAQH,EAAKp5B,SAAS8xB,GAEtEwH,EADYjL,EAAKsL,iBACEh0B,OAAS,IAE5BuzB,GAAW,EACXF,EAAMC,gBAAgBG,EAAKjqC,aAAa8nC,IACxC90C,KAAKk1B,KAAKK,IAAI0hB,SAEf,GAAIE,EAAWD,EAAU,CAE5B,IAAME,EAAS1oC,KAAKC,KAAK3O,KAAKw2C,aAAerqB,GAAMihB,EAASvrC,OAAS8N,GAAQunC,EAAWC,GACxFF,EAAKr5B,YAAYq5B,EAAKp5B,SAASC,EAAGm5B,EAAKp5B,SAASE,EAAIq5B,EAAQH,EAAKp5B,SAAS8xB,OAIzF9vC,EAAA6yC,IAAA5yC,WAAAC,IA1DD,WACI,OAAOC,KAAKwD,KAAK4pC,SAASvrC,WAC7B6wC,GA/CmC1jC,IAAS1M,kBAAAqV,IAAAjV,gBAAAC,cAAAC,YAAAC,uBAAA,OAEtB,QADNC,EACUvB,KAAAuB,IAAAA,MAFAjC,IAAAC;;kdCL/B,IAAQC,EAAwCC,EAAxCD,QAASE,EAA+BD,EAA/BC,SAAUmnB,EAAqBpnB,EAArBonB,8BAKQlnB,EAHlCH,EAAQ,kBAAiBI,EACzBinB,EAAiB0sB,GAAUn9B,EAC3ByQ,EAAiB9M,GAAYvD,EAEzB9W,EAASgjB,GAAM/iB,EAAA4B,EAAA3B,EAAA2B,EAAA6U,GADiCtW,EAAAC,GACjCC,WAAAwI,GAAA,SAAA2sC,IAAA,IAAA,IAAAh1C,EAAAC,EAAAC,UAAAC,OAAAC,MAAAC,MAAAJ,GAAAK,IAAAA,EAAAL,EAAAK,IAAAF,EAAAE,GAAAJ,UAAAI,GAAA,OAAAN,EAAAqI,EAAApK,KAAAsC,MAAA8H,SAAA7H,OAAAJ,UAAAK,EAAAT,UAAAL,EAAAe,EAAAV,IAAAA,EAAA9B,EAAA82C,EAAA3sC,GAAA,IAAA1H,EAAAq0C,EAAAp0C,UAgBf,OAhBeD,EAGhBwJ,KAAA,SAAKkzB,GACGA,EAAMiE,MAAM,MAAMgK,MAAK,SAAC3W,GAAC,OAAKA,EAAEx0B,OAAS,OACzC7B,KAAK++B,MAAM5a,SAAWF,EAAMwzB,SAASC,cACrC13C,KAAK++B,MAAM/xB,aAAasO,GAAagI,MAAQ,KAE7CtjB,KAAK++B,MAAM5a,SAAWF,EAAMwzB,SAASpuB,KAEzCrpB,KAAK++B,MAAM7a,OAAS6a,EACpB/+B,KAAK++B,MAAM4Y,kBAAiB,IAC/Bt1C,EAEDu1C,MAAA,WACI53C,KAAK++B,MAAM7a,OAAS,IACvBwyB,GAjBuC1nC,IAAS1M,mBAAAyV,IAAArV,gBAAAC,cAAAC,YAAAC,uBAAA,OAE1B,QADPC,EACWvB,KAAAuB,IAAAA,IAAAA,MAFIjC,IAAAC;;gWCLnC,IAAQC,EAAYC,EAAZD,oBAEPA,EAAQ,cAAcG,CAAA4B,WAAAiH,GAAA,SAAA4iC,IAAA,IAAA,IAAAjrC,EAAAC,EAAAC,UAAAC,OAAAC,MAAAC,MAAAJ,GAAAK,IAAAA,EAAAL,EAAAK,IAAAF,EAAAE,GAAAJ,UAAAI,GAGS,OAHTN,EAAAqI,EAAApK,KAAAsC,MAAA8H,SAAA7H,OAAAJ,WAEX+1C,QAAS,EAAKn2C,EACdo2C,QAAkB,GAAEp2C,EAHT9B,EAAA+sC,EAAA5iC,GAGS,IAAA1H,EAAAsqC,EAAArqC,UA2D3B,OA3D2BD,EAElBE,OAAV,WACIvC,KAAK+3C,oBACL/3C,KAAKwD,KAAKI,GAAGH,EAAK9C,UAAUq3C,YAAah4C,KAAKi4C,aAAcj4C,MAC5DA,KAAKwD,KAAKI,GAAGH,EAAK9C,UAAUu3C,cAAel4C,KAAKm4C,gBAAiBn4C,MAC7DyD,EAAK9C,UAAUy3C,uBACfp4C,KAAKwD,KAAKI,GAAGH,EAAK9C,UAAUy3C,uBAAwBp4C,KAAK+3C,kBAAmB/3C,MAE5EA,KAAKwD,KAAKI,GAAGH,EAAK9C,UAAU03C,sBAAuBr4C,KAAK+3C,kBAAmB/3C,OAElFqC,EAESwlB,UAAV,WACInN,EAAS/M,IAAI8T,EAAS62B,mBAAoBt4C,KAAK8yC,aAAc9yC,MAC7DA,KAAKwD,KAAKmK,IAAIlK,EAAK9C,UAAUq3C,YAAah4C,KAAKi4C,aAAcj4C,MAC7DA,KAAKwD,KAAKmK,IAAIlK,EAAK9C,UAAUu3C,cAAel4C,KAAKm4C,gBAAiBn4C,MAC9DyD,EAAK9C,UAAUy3C,uBACfp4C,KAAKwD,KAAKmK,IAAIlK,EAAK9C,UAAUy3C,uBAAwBp4C,KAAK+3C,kBAAmB/3C,MAE7EA,KAAKwD,KAAKmK,IAAIlK,EAAK9C,UAAU03C,sBAAuBr4C,KAAK+3C,kBAAmB/3C,OAEnFqC,EAEO41C,aAAR,SAAqB7rB,GACjBpsB,KAAK+3C,oBACL3rB,EAAMxoB,GAAGH,EAAK9C,UAAU43C,kBAAmBv4C,KAAK+3C,kBAAmB/3C,OACtEqC,EAEO81C,gBAAR,SAAwB/rB,GACpBA,EAAMze,IAAIlK,EAAK9C,UAAU43C,kBAAmBv4C,KAAK+3C,kBAAmB/3C,OACvEqC,EAEO01C,kBAAR,WACQ/3C,KAAK63C,SACT73C,KAAK63C,QAAS,EACdn9B,EAASna,KAAKkhB,EAAS62B,mBAAoBt4C,KAAK8yC,aAAc9yC,QAGlEqC,EAGOywC,aAAP,WACS9yC,KAAK63C,SACV91C,MAAMO,UAAUmH,KAAKxH,MAAMjC,KAAK83C,QAAS93C,KAAKwD,KAAK4pC,UACnDptC,KAAK83C,QACA5E,MAAK,SAAC5P,EAAGhG,GACN,OAAQgG,EAAEzlB,SAAS8xB,EAAIrS,EAAEzf,SAAS8xB,GAC1BrM,EAAEuM,kBAAoBvS,EAAEuS,qBAEnC/oC,SAAQ,SAACslB,EAAOzc,GACbyc,EAAMnO,gBAAgBtO,MAM9B3P,KAAK63C,QAAS,EACd73C,KAAK83C,QAAQj2C,OAAS,IACzB8qC,GA7DoC39B,KAASlM,KAAlBjC,IAAAC","file":"all.js","sourcesContent":["import { Game, game } from 'cc';\r\nimport { DEBUG, DEV, EDITOR } from 'cc/env';\r\nimport Core from '../../extensions/app/assets/Core';\r\nimport { IApp } from '../app-builtin/app-admin/executor';\r\nimport { appInited, appReady, cccInited, cccReady } from './handle';\r\n\r\nexport class App extends Core<IApp> {\r\n    protected static _inst: App = null;\r\n    static get inst() {\r\n        if (!this._inst) this._inst = new App();\r\n        return this._inst;\r\n    }\r\n\r\n    private constructor() {\r\n        super();\r\n    }\r\n}\r\n\r\nexport const app = App.inst;\r\n\r\nif (DEBUG) {\r\n    //@ts-ignore\r\n    window['app'] = app;\r\n    //@ts-ignore\r\n    window['App'] = App;\r\n}\r\n\r\nif (!EDITOR || DEV) {\r\n    cccReady && cccReady(app);\r\n    appReady && appReady(app);\r\n    cccInited && game.once(Game.EVENT_ENGINE_INITED, function () { cccInited(app); });\r\n    appInited && app.once(App.EventType.EVENT_APPINIT_FINISHED, function () { appInited(app); });\r\n}","import { Sprite, SpriteFrame, _decorator } from 'cc';\r\nimport BaseAppInit from '../../../extensions/app/assets/base/BaseAppInit';\r\n// import { app } from '../../app/app';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('AppInit')\r\nexport class AppInit extends BaseAppInit {\r\n    // @property(Button)\r\n    // login: Button;\r\n    @property(Sprite)\r\n    bg: Sprite;\r\n\r\n    // /**\r\n    // * nextInit\r\n    // */\r\n    // protected getUserAssetNum(): number {\r\n    //     return 1;\r\n    // }\r\n\r\n    // protected onUserInit() {\r\n    //     this.login.node.active = true;\r\n    //     this.login.node.on(Button.EventType.CLICK, async () => {\r\n    //         // \r\n    //         const uuid = app.manager.ui.showLoading();\r\n    //         await app.store.user.login();\r\n    //         app.manager.ui.hideLoading(uuid);\r\n    //         app.manager.ui.showToast('');\r\n    //         // \r\n    //         this.nextInit();\r\n    //     });\r\n    // }\r\n\r\n    onLoad() {\r\n        // this.login.node.active = false;\r\n        // app.Manager.Util.InitLayout();\r\n        // let self = this;\r\n        // if (app.Manager.Util.IsIphoneX()) {\r\n        //     app.manager.loader.load({\r\n        //         bundle: '', // bundleresources\r\n        //         path: 'bj_liuhai/spriteFrame',\r\n        //         type: SpriteFrame,\r\n        //         onComplete(asset) {\r\n        //             console.log('', asset);\r\n        //             self.bg.getComponent(Sprite).spriteFrame = asset;\r\n        //         }\r\n        //     })\r\n        // }\r\n        // else if (app.Manager.Util.IsIpad()) {\r\n        //     app.manager.loader.load({\r\n        //         bundle: '', // bundleresources\r\n        //         path: 'bj_pad/spriteFrame',\r\n        //         type: SpriteFrame,\r\n        //         onComplete(asset) {\r\n        //             console.log('', asset);\r\n        //             self.bg.getComponent(Sprite).spriteFrame = asset;\r\n        //         }\r\n        //     })\r\n        // }\r\n    }\r\n\r\n    onFinish() {\r\n    //     // \r\n    //     this.node.destroy();\r\n    }\r\n}","import { AudioClip, AudioSource, Node } from 'cc';\r\n\r\nexport default class Audio {\r\n    private volume = 1;\r\n    private volumeScale = 1;\r\n    private mute = false;\r\n    private endedCallback: Function = null;\r\n    private startedCallback: Function = null;\r\n\r\n    private _playing = false;\r\n    public get playing() {\r\n        return this._playing;\r\n    }\r\n    private set playing(value) {\r\n        this._playing = value;\r\n    }\r\n\r\n    private _paused = false;\r\n    public get paused() {\r\n        return this._paused;\r\n    }\r\n    private set paused(value) {\r\n        this._paused = value;\r\n    }\r\n\r\n    private audioSource: AudioSource = null;\r\n    constructor() {\r\n        const node = new Node('audio');\r\n        this.audioSource = node.addComponent(AudioSource);\r\n        node.on(AudioSource.EventType.ENDED, this.onAudioEnded, this);\r\n        node.on(AudioSource.EventType.STARTED, this.onAudioStarted, this);\r\n    }\r\n\r\n    private onAudioEnded() {\r\n        if (this.endedCallback) {\r\n            const endedCallback = this.endedCallback;\r\n            this.endedCallback = null;\r\n            endedCallback();\r\n        }\r\n    }\r\n\r\n    private onAudioStarted() {\r\n        if (this.startedCallback) {\r\n            const startedCallback = this.startedCallback;\r\n            this.startedCallback = null;\r\n            startedCallback();\r\n        }\r\n    }\r\n\r\n    play(clip: AudioClip, onEnded: Function = null, onStarted: Function = null) {\r\n        this.audioSource.clip = clip;\r\n        this.endedCallback = onEnded;\r\n        this.startedCallback = onStarted;\r\n        this.audioSource.play();\r\n        this.playing = true;\r\n        this.paused = false;\r\n        return this;\r\n    }\r\n\r\n    stop() {\r\n        this.playing = false;\r\n        this.paused = false;\r\n        this.audioSource.stop();\r\n        this.audioSource.node.emit(AudioSource.EventType.ENDED);\r\n        return this;\r\n    }\r\n\r\n    pause() {\r\n        if (!this.playing) return this;\r\n\r\n        this.paused = true;\r\n        this.audioSource.pause();\r\n        return this;\r\n    }\r\n\r\n    resume() {\r\n        if (!this.playing) return this;\r\n        if (!this.paused) return this;\r\n\r\n        this.paused = false;\r\n        this.audioSource.play();\r\n        return this;\r\n    }\r\n\r\n    setVolume(volume = 1, scale?: number) {\r\n        this.volume = volume;\r\n        if (typeof scale === 'number') this.volumeScale = scale;\r\n        this.audioSource.volume = volume * this.volumeScale * (this.mute ? 0 : 1);\r\n        return this;\r\n    }\r\n\r\n    getVolume() {\r\n        return this.volume;\r\n    }\r\n\r\n    setVolumeScale(scale = 1) {\r\n        this.volumeScale = scale;\r\n        this.audioSource.volume = this.volume * scale * (this.mute ? 0 : 1);\r\n        return this;\r\n    }\r\n\r\n    getVolumeScale() {\r\n        return this.volumeScale;\r\n    }\r\n\r\n    setLoop(loop: boolean) {\r\n        this.audioSource.loop = loop;\r\n        return this;\r\n    }\r\n\r\n    getLoop() {\r\n        return this.audioSource.loop;\r\n    }\r\n\r\n    setMute(mute = true) {\r\n        this.mute = mute;\r\n        this.setVolume(this.volume);\r\n        return this;\r\n    }\r\n\r\n    getMute() {\r\n        return this.mute;\r\n    }\r\n\r\n    onEnded(endedCallback: Function) {\r\n        this.endedCallback = endedCallback;\r\n        return this;\r\n    }\r\n\r\n    clear() {\r\n        this.volume = 1;\r\n        this.volumeScale = 1;\r\n        this.mute = false;\r\n        this.paused = false;\r\n        this.endedCallback = null;\r\n        this.startedCallback = null;\r\n        if (this.audioSource) {\r\n            this.audioSource.stop();\r\n            this.audioSource.volume = 1;\r\n            this.audioSource.clip = null;\r\n            this.audioSource.loop = false;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    destroy() {\r\n        this.clear();\r\n        this.audioSource.destroy();\r\n        this.audioSource.node.destroy();\r\n        this.audioSource = null;\r\n    }\r\n}","import { AudioClip } from 'cc';\r\nimport Audio from './Audio';\r\nimport AudioManager from './AudioManager';\r\n\r\nexport default class AudioEngine {\r\n    private static _inst: AudioEngine = null;\r\n    static get inst() {\r\n        if (!this._inst) this._inst = new AudioEngine();\r\n        return this._inst;\r\n    }\r\n    private constructor() { }\r\n\r\n    /**effectid1musicid0 */\r\n    private audioID = 1;\r\n    private endedCallbackMap: Map<number, Function> = new Map();\r\n    private effectMap: Map<number, Audio> = new Map();\r\n    private music: Audio = null;\r\n\r\n    private musicMute = false;\r\n    private musicVolumeScale = 1;\r\n\r\n    private effectMute = false;\r\n    private effectVolumeScale = 1;\r\n\r\n    ////////////////////////////////\r\n    //                         //\r\n    ////////////////////////////////\r\n    playEffect(audioClip: AudioClip, volume = 1, loop = false, onStarted: (audioID: number) => any = null, onEnded: Function = null) {\r\n        if (this.audioID > 100000) this.audioID = 1;\r\n\r\n        const audioID = this.audioID++;\r\n        const audio = AudioManager.inst.getAudio();\r\n        this.effectMap.set(audioID, audio);\r\n        if (onEnded) this.endedCallbackMap.set(audioID, onEnded);\r\n\r\n        audio.setLoop(loop)\r\n            .setMute(this.effectMute)\r\n            .setVolume(volume, this.effectVolumeScale)\r\n            .play(audioClip, () => {\r\n                AudioManager.inst.putAudio(audio);\r\n                this.effectMap.delete(audioID);\r\n                const callback = this.endedCallbackMap.get(audioID);\r\n                if (callback) {\r\n                    this.endedCallbackMap.delete(audioID);\r\n                    callback();\r\n                }\r\n            }, () => {\r\n                onStarted && onStarted(audioID);\r\n            });\r\n\r\n        return audioID;\r\n    }\r\n\r\n    stopEffect(id: number) {\r\n        return !!this.effectMap.get(id)?.stop();\r\n    }\r\n\r\n    stopAllEffects() {\r\n        this.effectMap.forEach((audio) => {\r\n            audio.stop();\r\n        });\r\n    }\r\n\r\n    pauseEffect(id: number) {\r\n        return !!this.effectMap.get(id)?.pause();\r\n    }\r\n\r\n    pauseAllEffects() {\r\n        this.effectMap.forEach((audio) => {\r\n            audio.pause();\r\n        });\r\n    }\r\n\r\n    resumeEffect(id: number) {\r\n        return !!this.effectMap.get(id)?.resume();\r\n    }\r\n\r\n    resumeAllEffects() {\r\n        this.effectMap.forEach((audio) => {\r\n            audio.resume();\r\n        });\r\n    }\r\n\r\n    setEffectMute(id: number, mute: boolean) {\r\n        return !!this.effectMap.get(id)?.setMute(mute);\r\n    }\r\n\r\n    getEffectMute(id: number) {\r\n        return !!this.effectMap.get(id)?.getMute();\r\n    }\r\n\r\n    setEffectVolume(id: number, volume: number) {\r\n        return !!this.effectMap.get(id)?.setVolume(volume);\r\n    }\r\n\r\n    getEffectVolume(id: number) {\r\n        return this.effectMap.get(id)?.getVolume() || 0;\r\n    }\r\n\r\n    setAllEffectsVolume(volume: number) {\r\n        this.effectMap.forEach((audio) => {\r\n            audio.setVolume(volume);\r\n        });\r\n    }\r\n\r\n    setEffectVolumeScale(id: number, volume: number) {\r\n        return !!this.effectMap.get(id)?.setVolumeScale(volume);\r\n    }\r\n\r\n    getEffectVolumeScale(id: number) {\r\n        return this.effectMap.get(id)?.getVolumeScale() || 0;\r\n    }\r\n\r\n    setGlobalEffectsVolumeScale(scale: number) {\r\n        this.effectVolumeScale = scale;\r\n        this.effectMap.forEach((audio) => {\r\n            audio.setVolumeScale(scale);\r\n        });\r\n    }\r\n\r\n    getGlobalEffectsVolumeScale() {\r\n        return this.effectVolumeScale;\r\n    }\r\n\r\n    setGlobalEffectsMute(mute: boolean) {\r\n        this.effectMute = mute;\r\n        this.effectMap.forEach((audio) => {\r\n            audio.setMute(mute);\r\n        });\r\n    }\r\n\r\n    getGlobalEffectsMute() {\r\n        return this.effectMute;\r\n    }\r\n\r\n    ////////////////////////////////\r\n    //                         //\r\n    ////////////////////////////////\r\n    playMusic(audioClip: AudioClip, volume = 1, onStarted: Function = null) {\r\n        this.stopMusic();\r\n\r\n        this.music = AudioManager.inst.getAudio();\r\n        this.music\r\n            .setLoop(true)\r\n            .setMute(this.musicMute)\r\n            .setVolume(volume, this.musicVolumeScale)\r\n            .play(audioClip, null, onStarted);\r\n\r\n        return 0;\r\n    }\r\n\r\n    stopMusic() {\r\n        if (!this.music) return false;\r\n        this.music.destroy();\r\n        this.music = null;\r\n        return true;\r\n    }\r\n\r\n    pauseMusic() {\r\n        if (!this.music) return false;\r\n        this.music.pause();\r\n        return true;\r\n    }\r\n\r\n    resumeMusic() {\r\n        if (!this.music) return false;\r\n        this.music.resume();\r\n        return true;\r\n    }\r\n\r\n    setMusicVolume(volume: number) {\r\n        if (!this.music) return false;\r\n        this.music.setVolume(volume);\r\n        return true;\r\n    }\r\n\r\n    getMusicVolume() {\r\n        if (!this.music) return -1;\r\n        return this.music.getVolume();\r\n    }\r\n\r\n    setMusicVolumeScale(scale: number) {\r\n        this.musicVolumeScale = scale;\r\n        this.music?.setVolumeScale(scale);\r\n        return true;\r\n    }\r\n\r\n    getMusicVolumeScale() {\r\n        return this.musicVolumeScale;\r\n    }\r\n\r\n    setMusicMute(mute: boolean) {\r\n        this.musicMute = mute;\r\n        this.music?.setMute(mute);\r\n        return true;\r\n    }\r\n\r\n    getMusicMute() {\r\n        return this.musicMute;\r\n    }\r\n\r\n    ////////////////////////////////\r\n    //                         //\r\n    ////////////////////////////////\r\n    setEndedCallback(audioID: number, callback: Function) {\r\n        if (audioID === 0) {\r\n            return !!this.music?.onEnded(callback);\r\n        } else {\r\n            if (this.effectMap.has(audioID)) {\r\n                this.endedCallbackMap.set(audioID, callback);\r\n                return true;\r\n            }\r\n            return false;\r\n        }\r\n    }\r\n\r\n    stop(audioID: number) {\r\n        if (audioID === 0) {\r\n            return this.stopMusic();\r\n        } else {\r\n            return this.stopEffect(audioID);\r\n        }\r\n    }\r\n\r\n    pause(audioID: number) {\r\n        if (audioID === 0) {\r\n            return this.pauseMusic();\r\n        } else {\r\n            return this.pauseEffect(audioID);\r\n        }\r\n    }\r\n\r\n    resume(audioID: number) {\r\n        if (audioID === 0) {\r\n            return this.resumeMusic();\r\n        } else {\r\n            return this.resumeEffect(audioID);\r\n        }\r\n    }\r\n\r\n    pauseAll() {\r\n        this.pauseMusic();\r\n        this.pauseAllEffects();\r\n    }\r\n\r\n    resumeAll() {\r\n        this.resumeMusic();\r\n        this.resumeAllEffects();\r\n    }\r\n\r\n    stopAll() {\r\n        this.stopMusic();\r\n        this.stopAllEffects();\r\n    }\r\n\r\n    setVolume(audioID: number, volume: number) {\r\n        if (audioID === 0) {\r\n            return this.setMusicVolume(volume);\r\n        } else {\r\n            return this.setEffectVolume(audioID, volume);\r\n        }\r\n    }\r\n\r\n    getVolume(audioID: number) {\r\n        if (audioID === 0) {\r\n            return this.getMusicVolume();\r\n        } else {\r\n            return this.getEffectVolume(audioID);\r\n        }\r\n    }\r\n\r\n    setVolumeScale(audioID: number, scale: number) {\r\n        if (audioID === 0) {\r\n            return this.setMusicVolumeScale(scale);\r\n        } else {\r\n            return this.setEffectVolumeScale(audioID, scale);\r\n        }\r\n    }\r\n\r\n    getVolumeScale(audioID: number) {\r\n        if (audioID === 0) {\r\n            return this.getMusicVolumeScale();\r\n        } else {\r\n            return this.getEffectVolumeScale(audioID);\r\n        }\r\n    }\r\n}","import Audio from './Audio';\r\n\r\nexport default class AudioManager {\r\n    private static _inst: AudioManager = null;\r\n    static get inst() {\r\n        if (!this._inst) this._inst = new AudioManager();\r\n        return this._inst;\r\n    }\r\n    private constructor() { }\r\n\r\n    private audioArray: Audio[] = [];\r\n\r\n    getAudio() {\r\n        if (this.audioArray.length) {\r\n            return this.audioArray.pop();\r\n        }\r\n        return new Audio();\r\n    }\r\n\r\n    putAudio(audio: Audio) {\r\n        audio.clear();\r\n        this.audioArray.push(audio);\r\n    }\r\n}","import { Button, Component, EventTouch, Node, Settings, _decorator, assetManager, isValid, settings, warn } from 'cc';\r\nimport { EDITOR } from 'cc/env';\r\nimport Core from '../Core';\r\nimport BaseManager from './BaseManager';\r\nconst { ccclass } = _decorator;\r\n\r\nconst AdminBundleName = 'app-admin';\r\nconst ModelBundleName = 'app-model';\r\nconst ControlBundleName = 'app-control';\r\nconst ControllerBundleName = 'app-controller';\r\nconst ManagerBundleName = 'app-manager';\r\nconst DontRewriteFuns = ['startInit', 'nextInit'];\r\n\r\n@ccclass('BaseAppInit')\r\nexport default abstract class BaseAppInit extends Component {\r\n    private get _base_mgr_total() {\r\n        return Math.max(0, BaseManager.getTotalAssetNum(assetManager.getBundle(ManagerBundleName)));\r\n    }\r\n    private get _base_user_total() {\r\n        return Math.max(0, this.getUserAssetNum());\r\n    }\r\n    private get _base_total() {\r\n        return this._base_mgr_total + this._base_user_total;\r\n    }\r\n\r\n    private _base_mgr_completed = 0;\r\n    private _base_user_completed = 0;\r\n    private get _base_completed() {\r\n        return this._base_mgr_completed + Math.min(this._base_user_total, this._base_user_completed);\r\n    }\r\n\r\n    private _base_inited = false;\r\n    private _base_finished = false;\r\n\r\n    constructor() {\r\n        super();\r\n        if (EDITOR) {\r\n            DontRewriteFuns.forEach((funName) => {\r\n                if (BaseAppInit.prototype[funName] !== this[funName]) {\r\n                    warn(`[AppInit] {${funName}}`);\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * [] \r\n     */\r\n    protected startInit() {\r\n        const projectBundles = settings.querySettings(Settings.Category.ASSETS, 'projectBundles') as string[];\r\n        Core.inst.lib.task.createAny()\r\n            // controlmodeladminmanager\r\n            .add([\r\n                (next, retry) => {\r\n                    // control()\r\n                    if (projectBundles.indexOf(ControlBundleName) === -1) return next();\r\n                    assetManager.preloadAny({ url: ControlBundleName }, { ext: 'bundle' }, null, (err) => {\r\n                        if (err) return retry(0.1);\r\n                        next();\r\n                    });\r\n                },\r\n                (next, retry) => {\r\n                    // controller\r\n                    if (projectBundles.indexOf(ControllerBundleName) === -1) return next();\r\n                    assetManager.preloadAny({ url: ControllerBundleName }, { ext: 'bundle' }, null, (err) => {\r\n                        if (err) return retry(0.1);\r\n                        next();\r\n                    });\r\n                },\r\n                (next, retry) => {\r\n                    // model\r\n                    if (projectBundles.indexOf(ModelBundleName) === -1) return next();\r\n                    assetManager.preloadAny({ url: ModelBundleName }, { ext: 'bundle' }, null, (err) => {\r\n                        if (err) return retry(0.1);\r\n                        next();\r\n                    });\r\n                },\r\n                (next, retry) => {\r\n                    // admin\r\n                    if (projectBundles.indexOf(AdminBundleName) === -1) return next();\r\n                    assetManager.preloadAny({ url: AdminBundleName }, { ext: 'bundle' }, null, (err) => {\r\n                        if (err) return retry(0.1);\r\n                        next();\r\n                    });\r\n                },\r\n                (next, retry) => {\r\n                    // manage\r\n                    if (projectBundles.indexOf(ManagerBundleName) === -1) return next();\r\n                    assetManager.preloadAny({ url: ManagerBundleName }, { ext: 'bundle' }, null, (err) => {\r\n                        if (err) return retry(0.1);\r\n                        next();\r\n                    });\r\n                }\r\n            ])\r\n            // control()\r\n            .add((next, retry) => {\r\n                if (projectBundles.indexOf(ControlBundleName) === -1) return next();\r\n                assetManager.loadBundle(ControlBundleName, (err) => {\r\n                    if (err) return retry(0.1);\r\n                    next();\r\n                });\r\n            })\r\n            // controller\r\n            .add((next, retry) => {\r\n                if (projectBundles.indexOf(ControllerBundleName) === -1) return next();\r\n                assetManager.loadBundle(ControllerBundleName, (err) => {\r\n                    if (err) return retry(0.1);\r\n                    next();\r\n                });\r\n            })\r\n            // model\r\n            .add((next, retry) => {\r\n                if (projectBundles.indexOf(ModelBundleName) === -1) return next();\r\n                assetManager.loadBundle(ModelBundleName, (err) => {\r\n                    if (err) return retry(0.1);\r\n                    next();\r\n                });\r\n            })\r\n            // admin\r\n            .add((next, retry) => {\r\n                if (projectBundles.indexOf(AdminBundleName) === -1) return next();\r\n                assetManager.loadBundle(AdminBundleName, (err) => {\r\n                    if (err) return retry(0.1);\r\n                    next();\r\n                });\r\n            })\r\n            // manager\r\n            .add((next, retry) => {\r\n                if (projectBundles.indexOf(ManagerBundleName) === -1) return next();\r\n                assetManager.loadBundle(ManagerBundleName, (err) => {\r\n                    if (err) return retry(0.1);\r\n                    next();\r\n                });\r\n            })\r\n            .start(() => {\r\n                this._base_inited = true;\r\n                this.onProgress(0, this._base_total);\r\n\r\n                // app, completeonUserInitmanager\r\n                BaseManager.init(\r\n                    assetManager.getBundle(ManagerBundleName),\r\n                    () => {\r\n                        this.innerNextInit();\r\n                    },\r\n                    () => {\r\n                        this.onUserInit();\r\n                        if (this._base_completed < this._base_total) return;\r\n                        // \r\n                        this.innerFinished();\r\n                    }\r\n                );\r\n            });\r\n    }\r\n\r\n    /**\r\n     * [] \r\n     */\r\n    private innerFinished() {\r\n        if (this._base_finished) return;\r\n        this._base_finished = true;\r\n        Core.emit(Core.EventType.EVENT_APPINIT_FINISHED);\r\n        // (Button, input)\r\n        if (Core.inst.Manager.Sound.setting.defaultEffectName) {\r\n            const playDefaultEffect = function (e: EventTouch) {\r\n                // SoundManager.setButtonEffectButtonuseDefaultEffectfalse\r\n                if (e.target['useDefaultEffect'] === false) return;\r\n                Core.inst.manager.ui.onceUserInterface(Node.EventType.TOUCH_END, function (event: EventTouch) {\r\n                    if (!event.target.getComponent(Button)) return;\r\n                    setTimeout(() => {\r\n                        if (!isValid(Core.inst.manager.sound)) return;\r\n                        // scrollViewbutton\r\n                        if (event.eventPhase === EventTouch.CAPTURING_PHASE) return;\r\n                        Core.inst.manager.sound.playDefaultEffect();\r\n                    });\r\n                }, null, true);\r\n            };\r\n            const onEnable = Button.prototype.onEnable;\r\n            Button.prototype.onEnable = function () {\r\n                onEnable.call(this);\r\n                this.node.on(Node.EventType.TOUCH_START, playDefaultEffect);\r\n            };\r\n            const onDisable = Button.prototype.onDisable;\r\n            Button.prototype.onDisable = function () {\r\n                this.node.off(Node.EventType.TOUCH_START, playDefaultEffect);\r\n                onDisable.call(this);\r\n            };\r\n        }\r\n        return Core.inst.manager.ui.showDefault(() => {\r\n            // \r\n            this.onFinish();\r\n            // ()\r\n            if (Core.inst.Manager.Sound.setting.defaultMusicName) {\r\n                const onTouch = function () {\r\n                    if (!isValid(Core.inst.manager.sound)) return;\r\n                    if (Core.inst.manager.sound.isMusicPlaying && !Core.inst.manager.sound.isMusicPaused) {\r\n                        Core.inst.manager.sound.replayMusic(() => {\r\n                            Core.inst.manager.ui.offUserInterface(Node.EventType.TOUCH_START, onTouch, this, true);\r\n                        });\r\n                    } else {\r\n                        Core.inst.manager.ui.offUserInterface(Node.EventType.TOUCH_START, onTouch, this, true);\r\n                    }\r\n                };\r\n                Core.inst.manager.ui.onUserInterface(Node.EventType.TOUCH_START, onTouch, this, true);\r\n                Core.inst.manager.sound.playDefaultMusic(() => {\r\n                    Core.inst.manager.ui.offUserInterface(Node.EventType.TOUCH_START, onTouch, this, true);\r\n                });\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * [] \r\n     */\r\n    private innerNextInit() {\r\n        // +1\r\n        this._base_mgr_completed += 1;\r\n        // \r\n        this.onProgress(this._base_completed, this._base_total);\r\n    }\r\n\r\n    /**\r\n     * [] \r\n     */\r\n    protected nextInit(): any {\r\n        if (this._base_finished) return;\r\n\r\n        if (!this._base_inited) {\r\n            // +1\r\n            this._base_user_completed += 1;\r\n            // \r\n            this.onProgress(this._base_completed, this._base_total);\r\n            return;\r\n        }\r\n\r\n        // +1\r\n        this._base_user_completed += 1;\r\n        // \r\n        this.onProgress(this._base_completed, this._base_total);\r\n\r\n        // \r\n        if (this._base_completed >= this._base_total) {\r\n            this.innerFinished();\r\n        }\r\n    }\r\n\r\n    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////\r\n    ////////////////////////////////////////////                ////////////////////////////////////////////\r\n    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////\r\n    /**\r\n     * [] startstartInit\r\n     */\r\n    protected start(): any { this.startInit(); }\r\n\r\n    /**\r\n     * [] nextInit\r\n     */\r\n    protected getUserAssetNum(): number { return 0; }\r\n\r\n    /**\r\n     * [] \r\n     */\r\n    protected onUserInit(): any { return 0; }\r\n\r\n    /**\r\n     * [] \r\n     * @param {Number} completed\r\n     * @param {Number} total\r\n     */\r\n    protected onProgress(completed: number, total: number): any { return completed / total; }\r\n\r\n    /**\r\n     * [] \r\n     */\r\n    protected onFinish() { }\r\n}","class CallbackInfo {\r\n    public callback: Function = null;\r\n    public target: unknown = null;\r\n    public once = false;\r\n\r\n    public constructor(callback: Function, target: unknown = null, once: boolean = false) {\r\n        this.callback = callback;\r\n        this.target = target;\r\n        this.once = once;\r\n    }\r\n}\r\n\r\ntype Parameters<T extends (...args: any) => any> = T extends (...args: infer P) => any ? P : any;\r\ntype AnyFunc = (...args: any[]) => any;\r\n\r\nclass CallbackList {\r\n    private callbacks: CallbackInfo[] = [];\r\n\r\n    public size() {\r\n        return this.callbacks.length;\r\n    }\r\n\r\n    public add(callback: Function, target: unknown = null, once: boolean = false) {\r\n        this.callbacks.push(new CallbackInfo(callback, target, once));\r\n    }\r\n\r\n    public emit(args: any[]) {\r\n        for (let index = 0; index < this.callbacks.length; index++) {\r\n            const info = this.callbacks[index];\r\n            // \r\n            if (info.once) {\r\n                this.callbacks.splice(index, 1);\r\n                --index;\r\n            }\r\n            if (info.callback) {\r\n                info.callback.apply(info.target, args);\r\n            }\r\n        }\r\n    }\r\n\r\n    public call(args: any[]) {\r\n        if (this.callbacks.length === 0) return;\r\n        const info = this.callbacks[0];\r\n\r\n        // \r\n        if (info.once) this.callbacks.splice(0, 1);\r\n        if (!info.callback) return;\r\n\r\n        return info.callback.apply(info.target, args);\r\n    }\r\n\r\n    public remove(callback: Function, target: unknown = null) {\r\n        for (let index = this.callbacks.length - 1; index >= 0; index--) {\r\n            const info = this.callbacks[index];\r\n            if (info.callback !== callback || info.target !== target) continue;\r\n            this.callbacks.splice(index, 1);\r\n        }\r\n    }\r\n\r\n    public removeByCallback(callback: Function) {\r\n        for (let index = this.callbacks.length - 1; index >= 0; index--) {\r\n            const info = this.callbacks[index];\r\n            if (info.callback !== callback) continue;\r\n            this.callbacks.splice(index, 1);\r\n        }\r\n    }\r\n\r\n    public removeByTarget(target: unknown) {\r\n        for (let index = this.callbacks.length - 1; index >= 0; index--) {\r\n            const info = this.callbacks[index];\r\n            if (info.target !== target) continue;\r\n            this.callbacks.splice(index, 1);\r\n        }\r\n    }\r\n}\r\n\r\nclass EventEmitter {\r\n    private listeners: { [key in string]: CallbackList } = {};\r\n\r\n    public on(event: string | number, cb: (...data: any[]) => void, target?: unknown) {\r\n        if (!event.toString() || !cb) return;\r\n        if (!this.listeners[event]) this.listeners[event] = new CallbackList();\r\n        this.listeners[event].add(cb, target);\r\n    }\r\n\r\n    public once(event: string | number, cb: (...data: any[]) => void, target?: unknown) {\r\n        if (!event.toString() || !cb) return;\r\n        if (!this.listeners[event]) this.listeners[event] = new CallbackList();\r\n        this.listeners[event].add(cb, target, true);\r\n    }\r\n\r\n    public off(event: string | number, cb: (...data: any[]) => void, target?: unknown) {\r\n        if (!event.toString() || !cb) return;\r\n        if (!this.listeners[event]) return;\r\n\r\n        this.listeners[event].remove(cb, target);\r\n    }\r\n\r\n    public targetOff(target?: unknown) {\r\n        if (!target) return;\r\n\r\n        for (const key in this.listeners) {\r\n            if (Object.prototype.hasOwnProperty.call(this.listeners, key)) {\r\n                const element = this.listeners[key];\r\n                element.removeByTarget(target);\r\n            }\r\n        }\r\n    }\r\n\r\n    public emit(event: string | number, args: any[]) {\r\n        if (!event.toString()) return;\r\n        if (!this.listeners[event]) return;\r\n        this.listeners[event].emit(args);\r\n    }\r\n\r\n    public call(event: string | number, args: any[]) {\r\n        if (!event.toString()) return;\r\n        if (!this.listeners[event]) return;\r\n        return this.listeners[event].call(args);\r\n    }\r\n}\r\n\r\nexport interface IBaseControl<C, E, T extends { [key in keyof E]?: AnyFunc }> {\r\n    readonly inst: Readonly<C>\r\n\r\n    //////////////////\r\n    new(): SuperBaseControl<E, T>//\r\n    ///////////////////////////////\r\n}\r\n\r\nclass SuperBaseControl<E, T extends { [key in keyof E]?: AnyFunc }> {\r\n    ////\r\n    private e: E;////\r\n    private t: T;////\r\n    /////////////////\r\n\r\n    private event = new EventEmitter();\r\n\r\n    protected call<K extends keyof E & keyof T>(key: E[K], ...args: Parameters<T[K]>): ReturnType<T[K]> {\r\n        return this.event.call.call(this.event, key, args);\r\n    }\r\n\r\n    protected emit<K extends keyof E & keyof T>(key: E[K], ...args: Parameters<T[K]>): void {\r\n        return this.event.emit.call(this.event, key, args);\r\n    }\r\n\r\n    private on(...args: any[]): void {\r\n        return this.event.on.apply(this.event, args);\r\n    }\r\n\r\n    private once(...args: any[]): void {\r\n        return this.event.once.apply(this.event, args);\r\n    }\r\n\r\n    private off(...args: any[]): void {\r\n        return this.event.off.apply(this.event, args);\r\n    }\r\n\r\n    private targetOff(target: any): void {\r\n        return this.event.targetOff.call(this.event, target);\r\n    }\r\n}\r\n\r\n/**\r\n * @deprecated ControllerControl\r\n */\r\nexport default function BaseControl<C, E = any, T extends { [key in keyof E & string]?: AnyFunc } = any>(Event?: E) {\r\n    return class BaseControl extends SuperBaseControl<E, T> {\r\n        public static Event = Event;\r\n\r\n        private static _base_inst: Readonly<C> = null;\r\n        public static get inst() {\r\n            if (this._base_inst === null) {\r\n                this._base_inst = new this() as C;\r\n            }\r\n            return this._base_inst;\r\n        }\r\n    };\r\n}","import { DEV } from 'cc/env';\r\nimport { IReadOnly } from '../../../../assets/app-builtin/app-admin/executor';\r\nimport { Logger } from '../lib/logger/logger';\r\n\r\nclass CallbackInfo {\r\n    public callback: Function = null;\r\n    public target: unknown = null;\r\n    public once = false;\r\n\r\n    public constructor(callback: Function, target: unknown = null, once: boolean = false) {\r\n        this.callback = callback;\r\n        this.target = target;\r\n        this.once = once;\r\n    }\r\n}\r\n\r\ntype Parameters<T extends (...args: any) => any> = T extends (...args: infer P) => any ? P : any;\r\ntype AnyFunc = (...args: any[]) => any;\r\n\r\nclass CallbackList {\r\n    private callbacks: CallbackInfo[] = [];\r\n\r\n    public size() {\r\n        return this.callbacks.length;\r\n    }\r\n\r\n    public add(callback: Function, target: unknown = null, once: boolean = false) {\r\n        this.callbacks.push(new CallbackInfo(callback, target, once));\r\n    }\r\n\r\n    public emit(args: any[]) {\r\n        for (let index = 0; index < this.callbacks.length; index++) {\r\n            const info = this.callbacks[index];\r\n            // \r\n            if (info.once) {\r\n                this.callbacks.splice(index, 1);\r\n                --index;\r\n            }\r\n            if (info.callback) {\r\n                info.callback.apply(info.target, args);\r\n            }\r\n        }\r\n    }\r\n\r\n    public call(args: any[]) {\r\n        if (this.callbacks.length === 0) return;\r\n        const info = this.callbacks[0];\r\n\r\n        // \r\n        if (info.once) this.callbacks.splice(0, 1);\r\n        if (!info.callback) return;\r\n\r\n        return info.callback.apply(info.target, args);\r\n    }\r\n\r\n    public remove(callback: Function, target: unknown = null) {\r\n        for (let index = this.callbacks.length - 1; index >= 0; index--) {\r\n            const info = this.callbacks[index];\r\n            if (info.callback !== callback || info.target !== target) continue;\r\n            this.callbacks.splice(index, 1);\r\n        }\r\n    }\r\n\r\n    public removeByCallback(callback: Function) {\r\n        for (let index = this.callbacks.length - 1; index >= 0; index--) {\r\n            const info = this.callbacks[index];\r\n            if (info.callback !== callback) continue;\r\n            this.callbacks.splice(index, 1);\r\n        }\r\n    }\r\n\r\n    public removeByTarget(target: unknown) {\r\n        for (let index = this.callbacks.length - 1; index >= 0; index--) {\r\n            const info = this.callbacks[index];\r\n            if (info.target !== target) continue;\r\n            this.callbacks.splice(index, 1);\r\n        }\r\n    }\r\n}\r\n\r\nclass EventEmitter {\r\n    private listeners: { [key in string]: CallbackList } = {};\r\n\r\n    public on(event: string | number, cb: (...data: any[]) => void, target?: unknown) {\r\n        if (!event.toString() || !cb) return;\r\n        if (!this.listeners[event]) this.listeners[event] = new CallbackList();\r\n        this.listeners[event].add(cb, target);\r\n    }\r\n\r\n    public once(event: string | number, cb: (...data: any[]) => void, target?: unknown) {\r\n        if (!event.toString() || !cb) return;\r\n        if (!this.listeners[event]) this.listeners[event] = new CallbackList();\r\n        this.listeners[event].add(cb, target, true);\r\n    }\r\n\r\n    public off(event: string | number, cb: (...data: any[]) => void, target?: unknown) {\r\n        if (!event.toString() || !cb) return;\r\n        if (!this.listeners[event]) return;\r\n\r\n        this.listeners[event].remove(cb, target);\r\n    }\r\n\r\n    public targetOff(target?: unknown) {\r\n        if (!target) return;\r\n\r\n        for (const key in this.listeners) {\r\n            if (Object.prototype.hasOwnProperty.call(this.listeners, key)) {\r\n                const element = this.listeners[key];\r\n                element.removeByTarget(target);\r\n            }\r\n        }\r\n    }\r\n\r\n    public emit(event: string | number, args: any[]) {\r\n        if (!event.toString()) return;\r\n        if (!this.listeners[event]) return;\r\n        this.listeners[event].emit(args);\r\n    }\r\n\r\n    public call(event: string | number, args: any[]) {\r\n        if (!event.toString()) return;\r\n        if (!this.listeners[event]) return;\r\n        return this.listeners[event].call(args);\r\n    }\r\n}\r\n\r\nexport interface IBaseController<C, T extends { [key in string]?: AnyFunc }> {\r\n    readonly inst: Readonly<C>\r\n\r\n    //////////////////\r\n    new(): SuperBaseController<T>//\r\n    ///////////////////////////////\r\n}\r\n\r\nclass SuperBaseController<T extends { [key in string]?: AnyFunc }> {\r\n    ////\r\n    private t: T;////\r\n    /////////////////\r\n\r\n    private event = new EventEmitter();\r\n\r\n    /** */\r\n    protected call<K extends keyof T>(key: K, ...args: Parameters<T[K]>): ReturnType<T[K]> {\r\n        return this.event.call.call(this.event, key, args);\r\n    }\r\n\r\n    /** */\r\n    protected emit<K extends keyof T>(key: K, ...args: Parameters<T[K]>): void {\r\n        return this.event.emit.call(this.event, key, args);\r\n    }\r\n\r\n    private on(...args: any[]): void {\r\n        return this.event.on.apply(this.event, args);\r\n    }\r\n\r\n    private once(...args: any[]): void {\r\n        return this.event.once.apply(this.event, args);\r\n    }\r\n\r\n    private off(...args: any[]): void {\r\n        return this.event.off.apply(this.event, args);\r\n    }\r\n\r\n    private targetOff(target: any): void {\r\n        return this.event.targetOff.call(this.event, target);\r\n    }\r\n\r\n    /** */\r\n    protected get log(): Function {\r\n        return Logger.create('log', '#4682b4', DEV ? `[${this['constructor'].name}] LOG` : `[${this['constructor'].name}] [LOG]`);\r\n    }\r\n\r\n    /** */\r\n    protected get warn(): Function {\r\n        return Logger.create('warn', '#ff7f50', DEV ? `[${this['constructor'].name}] WARN` : `[${this['constructor'].name}] [WARN]`);\r\n    }\r\n\r\n    /** */\r\n    protected get error(): Function {\r\n        return Logger.create('error', '#ff4757', DEV ? `[${this['constructor'].name}] ERROR` : `[${this['constructor'].name}] [ERROR]`);\r\n    }\r\n}\r\n\r\nexport default function BaseController<C, T extends { [key in string]?: AnyFunc } = any>() {\r\n    return class BaseController extends SuperBaseController<T> {\r\n        /**\r\n         * \r\n         */\r\n        public static Event: { [key in keyof T]: key } = new Proxy({} as any, {\r\n            get: function (target, key) {\r\n                if (target[key]) return target[key];\r\n                target[key] = key;\r\n                return key;\r\n            }\r\n        });\r\n\r\n        private static _base_inst: IReadOnly<C> = null;\r\n        /**\r\n         * \r\n         * - app.controllerBundleController\r\n         */\r\n        public static get inst() {\r\n            return this._base_inst;\r\n        }\r\n\r\n        constructor() {\r\n            super();\r\n            BaseController._base_inst = this as any;\r\n        }\r\n    };\r\n}","/**\n * \n * */\n\nexport default class BaseData {\n    constructor() {\n        console.log(\"Load BaseData\");\n    }\n\n\n}","import { AssetManager, Component, EventTarget, Prefab, Widget, _decorator, error, instantiate, js, path, warn } from 'cc';\r\nimport { DEBUG, DEV, EDITOR } from 'cc/env';\r\nimport Core from '../Core';\r\nimport { Logger } from '../lib/logger/logger';\r\n\r\nconst { ccclass } = _decorator;\r\n\r\nconst UserManagerPath = 'UserManager';\r\nconst DontRewriteFuns = ['emit', 'on', 'once', 'off', 'targetOff'];\r\n\r\nconst uuid = new class UUID {\r\n    private index = 0;\r\n\r\n    public create(): string {\r\n        if (this.index++ > 10000000) {\r\n            this.index = 0;\r\n        }\r\n        return `${Date.now()}-${this.index}`;\r\n    }\r\n};\r\n\r\nconst loadBegin = Logger.create('log', '#32cd32', DEV ? '[BaseManager] ' : '[BaseManager] []');\r\n\r\nconst loadFinish = Logger.create('log', '#00ae9d', DEV ? '[BaseManager] ' : '[BaseManager] []');\r\n\r\nconst loadError = Logger.create('log', '#ff4757', DEV ? '[BaseManager] ' : '[BaseManager] []');\r\n\r\nconst initBegin = Logger.create('log', '#3e4145', DEV ? '[BaseManager] ' : '[BaseManager] []');\r\n\r\nconst initFinish = Logger.create('log', '#008080', DEV ? '[BaseManager] ' : '[BaseManager] []');\r\n\r\n@ccclass('BaseManager')\r\nexport default class BaseManager extends Component {\r\n    // \r\n    private _base_event: EventTarget = new EventTarget();\r\n\r\n    // manager\r\n    private _base_manager_name: string = js.getClassName(this);\r\n    public get managerName() {\r\n        return this._base_manager_name;\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n\r\n        if (EDITOR) {\r\n            DontRewriteFuns.forEach((funName) => {\r\n                if (BaseManager.prototype[funName] !== this[funName]) {\r\n                    warn(`[${this._base_manager_name}] {${funName}}`);\r\n                }\r\n            });\r\n        }\r\n\r\n        if (this._base_manager_name !== 'Manager' && this._base_manager_name.slice(-7) === 'Manager') {\r\n            const managerName = this._base_manager_name.slice(0, - 7);\r\n            Core.inst.Manager[managerName] = this.constructor;\r\n            Core.inst.manager[managerName.toLocaleLowerCase()] = this;\r\n        } else if (EDITOR) {\r\n            error(`[${this._base_manager_name}] manager( xxxxManager Manager)`);\r\n        } else if (DEBUG) {\r\n            error(`[${this._base_manager_name}] manager( xxxxManager Manager)`);\r\n        }\r\n    }\r\n\r\n    //  Reset \r\n    resetInEditor() {\r\n        const widget = this.node.getComponent(Widget) || this.node.addComponent(Widget);\r\n        widget.isAlignBottom = true;\r\n        widget.isAlignLeft = true;\r\n        widget.isAlignRight = true;\r\n        widget.isAlignTop = true;\r\n        widget.top = 0;\r\n        widget.left = 0;\r\n        widget.right = 0;\r\n        widget.bottom = 0;\r\n        widget.alignMode = Widget.AlignMode.ON_WINDOW_RESIZE;\r\n    }\r\n\r\n    /**\r\n     * [] , init\r\n     */\r\n    protected onInited() {\r\n    }\r\n\r\n    /**\r\n     * [] manager\r\n     */\r\n    protected onFinished() {\r\n    }\r\n\r\n    /**\r\n     * [] managerfinish\r\n     * @param {Function} finish \r\n     */\r\n    protected init(finish?: Function) {\r\n        finish && finish();\r\n    }\r\n\r\n    protected createUUID() {\r\n        return uuid.create();\r\n    }\r\n\r\n    /** */\r\n    protected get log() {\r\n        if (DEV) {\r\n            return window.console.log.bind(window.console,\r\n                '%c %s %c %s ',\r\n                'background:#4169e1; padding: 2px; border-radius: 5px 0 0 5px; border: 1px solid #4169e1; color: #fff; font-weight: normal;',\r\n                `[${this._base_manager_name}] LOG ${new Date().toLocaleString()}`,\r\n                'background:#ffffff ; padding: 2px; border-radius: 0 5px 5px 0; border: 1px solid #4169e1; color: #4169e1; font-weight: normal;'\r\n            );\r\n        }\r\n        return window.console.log.bind(window.console,\r\n            `[${this._base_manager_name}] [LOG] [${new Date().toLocaleString()}]`,\r\n        );\r\n    }\r\n\r\n    /** */\r\n    protected get warn() {\r\n        if (DEV) {\r\n            return window.console.warn.bind(window.console,\r\n                '%c %s %c %s ',\r\n                'background:#ff7f50; padding: 2px; border-radius: 5px 0 0 5px; border: 1px solid #ff7f50; color: #fff; font-weight: normal;',\r\n                `[${this._base_manager_name}] WARN ${new Date().toLocaleString()}`,\r\n                'background:#ffffff ; padding: 2px; border-radius: 0 5px 5px 0; border: 1px solid #ff7f50; color: #ff7f50; font-weight: normal;'\r\n            );\r\n        }\r\n        return window.console.warn.bind(window.console,\r\n            `[${this._base_manager_name}] [WARN] [${new Date().toLocaleString()}]`,\r\n        );\r\n    }\r\n\r\n    /** */\r\n    protected get error() {\r\n        if (DEV) {\r\n            return window.console.error.bind(window.console,\r\n                '%c %s %c %s ',\r\n                'background:#ff4757; padding: 2px; border-radius: 5px 0 0 5px; border: 1px solid #ff4757; color: #fff; font-weight: normal;',\r\n                `[${this._base_manager_name}] ERROR ${new Date().toLocaleString()}`,\r\n                'background:#ffffff ; padding: 2px; border-radius: 0 5px 5px 0; border: 1px solid #ff4757; color: #ff4757; font-weight: normal;'\r\n            );\r\n        }\r\n        return window.console.error.bind(window.console,\r\n            `[${this._base_manager_name}] [ERROR] [${new Date().toLocaleString()}]`,\r\n        );\r\n    }\r\n\r\n    /**\r\n     * [] \r\n     */\r\n    public emit(event: string | number, ...data: any[]) {\r\n        this._base_event.emit(event as any, ...data);\r\n    }\r\n\r\n    /**\r\n     * [] \r\n     */\r\n    public on(event: string | number, cb: (...any: any[]) => void, target?: any) {\r\n        this._base_event.on(event as any, cb, target);\r\n    }\r\n\r\n    /**\r\n     * [] \r\n     */\r\n    public once(event: string | number, cb: (...any: any[]) => void, target?: any) {\r\n        this._base_event.once(event as any, cb, target);\r\n    }\r\n\r\n    /**\r\n     * [] \r\n     */\r\n    public off(event: string | number, cb?: (...any: any[]) => void, target?: any) {\r\n        this._base_event.off(event as any, cb, target);\r\n    }\r\n\r\n    /**\r\n     * [] \r\n     */\r\n    public targetOff(target: any) {\r\n        this._base_event.targetOff(target);\r\n    }\r\n\r\n    /**********************************************************************/\r\n    /**\r\n     * Manager\r\n     * @private\r\n     */\r\n    public static get sysMgrCount() {\r\n        return 5;\r\n    }\r\n\r\n    /**\r\n     * (sysMgrCount)\r\n     * @private\r\n     */\r\n    public static getTotalAssetNum(bundle: AssetManager.Bundle) {\r\n        let count = this.sysMgrCount;\r\n\r\n        if (!bundle) return count;\r\n\r\n        const array = bundle.getDirWithPath('/', Prefab) as { uuid: string, path: string, ctor: Function }[];\r\n\r\n        array.forEach(function (item) {\r\n            if (item.path.endsWith('Manager')) {\r\n                count++;\r\n            }\r\n        });\r\n\r\n        return count;\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @private\r\n     */\r\n    public static getUserAssetUrls(bundle: AssetManager.Bundle) {\r\n        const pathArr: string[] = [];\r\n\r\n        if (!bundle) return pathArr;\r\n\r\n        const array = bundle.getDirWithPath('/', Prefab) as { uuid: string, path: string, ctor: Function }[];\r\n\r\n        array.forEach(function (item) {\r\n            if (item.path.endsWith('Manager')) {\r\n                pathArr.push(item.path);\r\n            }\r\n        });\r\n\r\n        return pathArr;\r\n    }\r\n\r\n    /**\r\n     * manager\r\n     * @private\r\n     */\r\n    public static init(\r\n        bundle: AssetManager.Bundle,\r\n        progress: (completeAsset: Number, totalAsset: Number) => any,\r\n        complete: (totalAsset: Number) => any) {\r\n        const urls = this.getUserAssetUrls(bundle);\r\n\r\n        const totalAsset = urls.length + this.sysMgrCount;\r\n        let completeAsset = 0;\r\n\r\n        const onProgress = function (next: Function, manager: BaseManager) {\r\n            if (DEBUG) {\r\n                const startTime = window?.performance?.now ? performance.now() : Date.now();\r\n                initBegin(manager.managerName);\r\n                return function () {\r\n                    manager.onInited();\r\n                    if (DEBUG) {\r\n                        const endTime = window?.performance?.now ? performance.now() : Date.now();\r\n                        initFinish(`${manager.managerName} :${(endTime - startTime).toFixed(6)} ms`);\r\n                    }\r\n                    progress && progress(++completeAsset, totalAsset);\r\n                    next();\r\n                };\r\n            }\r\n            return function () {\r\n                manager.onInited();\r\n                progress && progress(++completeAsset, totalAsset);\r\n                next();\r\n            };\r\n        };\r\n\r\n        // manager()\r\n        const userMgrList: BaseManager[] = [];\r\n        // manager()\r\n        const sysMgrList: BaseManager[] = [Core.inst.manager.event, Core.inst.manager.timer, Core.inst.manager.loader, Core.inst.manager.ui, Core.inst.manager.sound] as any as BaseManager[];\r\n\r\n        // manager\r\n        const initSysMgrTask = Core.inst.lib.task.createASync();\r\n        sysMgrList.forEach(function (manager: BaseManager) {\r\n            initSysMgrTask.add(function (next) {\r\n                manager.init(onProgress(next, manager));\r\n            });\r\n        });\r\n\r\n        // manager\r\n        const loadUserMgrTask = Core.inst.lib.task.createASync();\r\n        const UserManagerRoot = Core.inst.manager.ui.root.getChildByPath(UserManagerPath);\r\n        urls.forEach(function (url) {\r\n            loadUserMgrTask.add(function (next, retry) {\r\n                if (DEBUG) {\r\n                    const managerName = path.basename(url);\r\n                    const startTime = window?.performance?.now ? performance.now() : Date.now();\r\n                    loadBegin(managerName);\r\n                    bundle.load(url, Prefab, function (err, prefab: Prefab) {\r\n                        if (err || !prefab) {\r\n                            loadError(managerName, '...');\r\n                            retry(1);\r\n                        } else {\r\n                            const endTime = window?.performance?.now ? performance.now() : Date.now();\r\n                            loadFinish(`${managerName} :${(endTime - startTime).toFixed(6)} ms`);\r\n                            const node = instantiate(prefab);\r\n                            node.parent = UserManagerRoot;\r\n                            node.active = true;\r\n                            userMgrList.push(node.getComponent(BaseManager));\r\n                            next();\r\n                        }\r\n                    });\r\n                    return;\r\n                }\r\n                bundle.load(url, Prefab, function (err, prefab: Prefab) {\r\n                    if (err || !prefab) {\r\n                        loadError(path.basename(url), '...');\r\n                        retry(1);\r\n                    } else {\r\n                        const node = instantiate(prefab);\r\n                        node.parent = UserManagerRoot;\r\n                        node.active = true;\r\n                        userMgrList.push(node.getComponent(BaseManager));\r\n                        next();\r\n                    }\r\n                });\r\n            });\r\n        });\r\n\r\n        Core.inst.lib.task.createAny()\r\n            .add([\r\n                next => initSysMgrTask.start(next),\r\n                next => loadUserMgrTask.start(next),\r\n            ])\r\n            .add(function (next) {\r\n                Core.emit(Core.EventType.EVENT_SYS_MANAGER_INITED);\r\n                next();\r\n            })\r\n            .add(function (next) {\r\n                // manager\r\n                const initUserMgrTask = Core.inst.lib.task.createASync();\r\n                userMgrList.forEach(manager => {\r\n                    initUserMgrTask.add(function (next) {\r\n                        manager.init(onProgress(next, manager));\r\n                    });\r\n                });\r\n                initUserMgrTask.start(next);\r\n            })\r\n            .add(function (next) {\r\n                Core.emit(Core.EventType.EVENT_USER_MANAGER_INITED);\r\n                Core.emit(Core.EventType.EVENT_MANAGER_INITED);\r\n                next();\r\n            })\r\n            .add(function (next) {\r\n                // manager\r\n                sysMgrList.forEach(function (manager) {\r\n                    manager.onFinished();\r\n                });\r\n                userMgrList.forEach(function (manager) {\r\n                    manager.onFinished();\r\n                });\r\n                next();\r\n            })\r\n            .start(function () {\r\n                Core.emit(Core.EventType.EVENT_MANAGER_FINISHED);\r\n                complete && complete(totalAsset);\r\n            });\r\n    }\r\n\r\n}","// export type IModel<T> = {\r\n//     [P in keyof T]: T[P] extends Function\r\n//     ? ''\r\n//     : (\r\n//         T[P] extends Array<infer R>\r\n//         ? (\r\n//             R extends Function\r\n//             ? ''\r\n//             : T[P]\r\n//         )\r\n//         : T[P] // IModel<T[P]> \r\n//     );\r\n// };\r\n\r\n// export type IStore<T> = {\r\n//     [P in keyof T]: T[P] extends Function\r\n//     ? T[P]\r\n//     : (\r\n//         T[P] extends Array<infer R>\r\n//         ? (\r\n//             R extends Function\r\n//             ? ''\r\n//             : IModel<T[P]>\r\n//         )\r\n//         : IModel<T[P]>\r\n//     );\r\n// };\r\n\r\nexport type IModel<T> = {\r\n    [P in keyof T]: T[P] extends Function\r\n    ? ''\r\n    : T[P];\r\n};\r\n\r\n// export type IStore<T> = {\r\n//     [P in keyof T]: T[P] extends Function\r\n//     ? T[P]\r\n//     : IModel<T[P]>;\r\n// };\r\n\r\nexport type IStore<T> = {\r\n    [P in keyof T]: T[P];\r\n};","import { Asset, Component, Enum, EventTouch, Font, Label, Node, Scene, Sprite, SpriteFrame, UITransform, Widget, _decorator, director, isValid, js, sp } from 'cc';\r\nimport { DEV, EDITOR } from 'cc/env';\r\nimport { IMiniViewName, IMiniViewNames, IViewName } from '../../../../assets/app-builtin/app-admin/executor';\r\nimport Core from '../Core';\r\nimport { Logger } from '../lib/logger/logger';\r\nimport { IBaseControl } from './BaseControl';\r\nimport { IBaseController } from './BaseController';\r\n\r\nconst { ccclass, property, disallowMultiple } = _decorator;\r\n\r\nconst BlockEvents = [\r\n    Node.EventType.TOUCH_START, Node.EventType.TOUCH_MOVE, Node.EventType.TOUCH_END, Node.EventType.TOUCH_CANCEL,\r\n    Node.EventType.MOUSE_DOWN, Node.EventType.MOUSE_MOVE, Node.EventType.MOUSE_UP,\r\n    Node.EventType.MOUSE_ENTER, Node.EventType.MOUSE_LEAVE, Node.EventType.MOUSE_WHEEL\r\n];\r\n\r\nconst HideEvent = Enum({\r\n    destroy: 1,\r\n    active: 2\r\n});\r\n\r\nexport type IShade = {\r\n    /** 0 */\r\n    delay?: number,\r\n    /** 60 */\r\n    begin?: number,\r\n    /** 180 */\r\n    end?: number,\r\n    /** 100 */\r\n    speed?: number,\r\n    /**\r\n     *  false\r\n     * - \r\n     */\r\n    blur?: boolean,\r\n};\r\n\r\nexport interface IShowParamAttr {\r\n    zIndex?: number,\r\n    siblingIndex?: number,\r\n}\r\n\r\nexport interface IShowParamOnShow<T = any> {\r\n    (result: T): any\r\n}\r\n\r\nexport interface IShowParamOnHide<T = any> {\r\n    (result: T): any\r\n}\r\n\r\nexport interface IShowParamBeforeShow {\r\n    (error: string): any\r\n}\r\n\r\nexport interface IShowParamInnerLoad {\r\n    (name: string, path: string, type: { prototype: Asset }, callback: (result: Asset) => any): void\r\n}\r\n\r\nexport interface IHideParamOnHide<T = any> {\r\n    (result: T): any\r\n}\r\n\r\nexport type IViewType = 'Page' | 'Paper' | 'Pop' | 'Top';\r\n\r\nexport enum ViewType {\r\n    Page = 'Page',\r\n    Paper = 'Paper',\r\n    PaperAll = 'PaperAll',\r\n    Pop = 'Pop',\r\n    Top = 'Top'\r\n}\r\n\r\ninterface IMiniOnShow {\r\n    (name: IMiniViewName, data?: any): any\r\n}\r\ninterface IMiniOnHide {\r\n    (name: IMiniViewName, data?: any): any\r\n}\r\ninterface IMiniOnFinish {\r\n    (): any\r\n}\r\ntype IPick<T> = {\r\n    -readonly [P in keyof T]: T[P] extends Function\r\n    ? T[P]\r\n    : (T[P] extends Object\r\n        ? IPick<T[P]>\r\n        : T[P]);\r\n};\r\ninterface IBaseViewController<C, T extends { [key in string]: any }> {\r\n    new(): BaseView & {\r\n        readonly controller: IPick<C> & Readonly<{\r\n            /** */\r\n            emit<K extends keyof T>(key: K, ...args: Parameters<T[K]>): void;\r\n            /** */\r\n            call<K extends keyof T & keyof T>(key: K, ...args: Parameters<T[K]>): ReturnType<T[K]>;\r\n            /** */\r\n            on<K extends keyof T>(key: K, callback: (...args: Parameters<T[K]>) => ReturnType<T[K]>, target?: any): void;\r\n            /** */\r\n            once<K extends keyof T>(key: K, callback: (...args: Parameters<T[K]>) => ReturnType<T[K]>, target?: any): void;\r\n            /** */\r\n            off(key: keyof T, callback: Function, target?: any): void;\r\n            /** */\r\n            targetOff(target: any): void;\r\n        }>\r\n    }\r\n}\r\n\r\nenum ViewState {\r\n    BeforeShow,\r\n    Showing,\r\n    Showed,\r\n    BeforeHide,\r\n    Hiding,\r\n    Hid,\r\n}\r\n\r\nconst Group = { id: 'BaseView', name: 'Settings', displayOrder: -Infinity, style: 'section' };\r\n\r\n// PaperAllowner\r\nconst PaperAllToOwner: Map<IMiniViewName, string> = new Map();\r\n\r\n@ccclass('BaseView')\r\n@disallowMultiple()\r\nexport default class BaseView extends Component {\r\n    /**\r\n     * @deprecated BindControllerBindControl\r\n     */\r\n    static BindControl<C, E, T extends { [key in keyof E]?: any }>(Control: IBaseControl<C, E, T>) {\r\n        return class BindControl extends BaseView {\r\n            protected get control(): Pick<C, keyof C> & Readonly<{\r\n                call<K extends keyof E>(key: E[K], ...args: Parameters<T[K]>): ReturnType<T[K]>;\r\n                emit<K extends keyof E>(key: E[K], ...args: Parameters<T[K]>): void;\r\n                on<K extends keyof E>(key: E[K], callback: (...args: Parameters<T[K]>) => ReturnType<T[K]>, target?: any): void;\r\n                once<K extends keyof E>(key: E[K], callback: (...args: Parameters<T[K]>) => ReturnType<T[K]>, target?: any): void;\r\n                off(key: E[keyof E], callback: Function, target?: any): void;\r\n                targetOff(target: any): void;\r\n            }> {\r\n                return Control ? Control.inst as any : null;\r\n            }\r\n        };\r\n    }\r\n\r\n    /**\r\n     * UIthis.controller(emitononceofftargetOff)\r\n     */\r\n    static BindController<C, T extends { [key in string]: any }>(Controller: IBaseController<C, T>) {\r\n        @disallowMultiple()\r\n        class BindController extends BaseView {\r\n            protected get controller() {\r\n                return Controller ? Controller.inst as any : null;\r\n            }\r\n        }\r\n        return BindController as any as IBaseViewController<C, T>;\r\n    }\r\n\r\n    /**\r\n     * falseapp.manager.ui.showonError\r\n     */\r\n    public static isViewValid(next: (valid: boolean) => void, data: any) {\r\n        data;\r\n        next && next(true);\r\n    }\r\n\r\n    public static isPage(name: string) {\r\n        return name.indexOf(ViewType.Page) === 0;\r\n    }\r\n\r\n    public static isPaper(name: string) {\r\n        return name.indexOf(ViewType.Paper) === 0;\r\n    }\r\n\r\n    public static isPaperAll(name: string) {\r\n        return name.indexOf(ViewType.PaperAll) === 0;\r\n    }\r\n\r\n    public static isPop(name: string) {\r\n        return name.indexOf(ViewType.Pop) === 0;\r\n    }\r\n\r\n    public static isTop(name: string) {\r\n        return name.indexOf(ViewType.Top) === 0;\r\n    }\r\n\r\n    // \r\n    private _base_view_created = false;\r\n    // view\r\n    private _base_view_state = ViewState.Hid;\r\n    // view\r\n    private _base_view_name: IViewName | IMiniViewName = js.getClassName(this) as any;\r\n    // \r\n    private _base_touch_enable = true;\r\n    // show/hide\r\n    private _base_show_hide_delays: Function[] = [];\r\n    // \r\n    private _base_mini_show: Set<IMiniViewName> = new Set();\r\n\r\n    protected isPage() {\r\n        return BaseView.isPage(this._base_view_name);\r\n    }\r\n\r\n    protected isPaper() {\r\n        return BaseView.isPaper(this._base_view_name);\r\n    }\r\n\r\n    protected isPaperAll() {\r\n        return BaseView.isPaperAll(this._base_view_name);\r\n    }\r\n\r\n    protected isPop() {\r\n        return BaseView.isPop(this._base_view_name);\r\n    }\r\n\r\n    protected isTop() {\r\n        return BaseView.isTop(this._base_view_name);\r\n    }\r\n\r\n    protected is2D() {\r\n        return !this.is3D();\r\n    }\r\n\r\n    protected is3D() {\r\n        if (this.node.parent instanceof Scene) {\r\n            return this.node.parent.name === this.viewName;\r\n        }\r\n        const scene = director.getScene();\r\n        return scene.name === this.viewName;\r\n    }\r\n\r\n    @property\r\n    private _hideEvent = HideEvent.destroy;\r\n    @property({\r\n        group: Group,\r\n        type: HideEvent,\r\n        tooltip: '\\n1destroy: UI\\n2active: UI',\r\n    })\r\n    public get hideEvent() {\r\n        if (this.is3D()) return HideEvent.destroy;\r\n        return this._hideEvent;\r\n    }\r\n    public set hideEvent(value) {\r\n        if (this.is3D() && value !== HideEvent.destroy) {\r\n            this.log('3Ddestroy');\r\n            return;\r\n        }\r\n        this._hideEvent = value;\r\n    }\r\n\r\n    @property\r\n    private _singleton = true;\r\n    private static _singleton = true;\r\n    @property({\r\n        group: Group,\r\n        tooltip: '\\n1: UI(onShow)\\n2: UI',\r\n    })\r\n    protected get singleton(): boolean {\r\n        if (this.isPage()) return true;\r\n        if (this.isPaperAll()) return true;\r\n        if (this.isPaper()) return true;\r\n        return this._singleton && (<typeof BaseView>this.constructor)._singleton;\r\n    }\r\n    protected set singleton(value) {\r\n        if (!value) {\r\n            if (this.isPage()) {\r\n                this.log('Page');\r\n                return;\r\n            }\r\n            if (this.isPaper()) {\r\n                this.log('Paper');\r\n                return;\r\n            }\r\n        }\r\n        this._singleton = (<typeof BaseView>this.constructor)._singleton = !!value;\r\n    }\r\n\r\n    @property\r\n    private _captureFocus = true;\r\n    @property({\r\n        group: Group,\r\n        tooltip: '<onLostFocusonFocus>\\n1UI\\nUIfocus',\r\n        visible(this: BaseView) {\r\n            if (this.is3D()) return false;\r\n            return true;\r\n        }\r\n    })\r\n    protected get captureFocus() {\r\n        if (this.is3D()) return false;\r\n        return this._captureFocus;\r\n    }\r\n    protected set captureFocus(value) {\r\n        if (value && this.is3D()) {\r\n            this.log('2D');\r\n            return;\r\n        }\r\n\r\n        if (!EDITOR && this._captureFocus !== value) {\r\n            this._captureFocus = value;\r\n            Core.inst?.manager?.ui?.refreshShade();\r\n        } else {\r\n            this._captureFocus = value;\r\n        }\r\n    }\r\n\r\n    @property\r\n    private _shade = true;\r\n    @property({\r\n        group: Group,\r\n        tooltip: '',\r\n        visible(this: BaseView) {\r\n            if (this.is3D()) return false;\r\n            if (this.isPage()) return false;\r\n            return true;\r\n        }\r\n    })\r\n    protected get shade() {\r\n        if (this.is3D()) return false;\r\n        if (this.isPage()) return false;\r\n        return this._shade;\r\n    }\r\n    protected set shade(value) {\r\n        if (value) {\r\n            if (this.is3D()) {\r\n                this.log('2D');\r\n                return;\r\n            }\r\n            if (this.isPage()) {\r\n                this.log('Page');\r\n                return;\r\n            }\r\n        }\r\n\r\n        if (!EDITOR && this._shade !== value) {\r\n            this._shade = value;\r\n            Core.inst?.manager?.ui?.refreshShade();\r\n        } else {\r\n            this._shade = value;\r\n        }\r\n    }\r\n\r\n    @property\r\n    private _blockInput = true;\r\n    @property({\r\n        group: Group,\r\n        tooltip: '',\r\n        visible(this: BaseView) {\r\n            if (this.is3D()) return false;\r\n            return true;\r\n        }\r\n    })\r\n    protected get blockInput() {\r\n        if (this.is3D()) return false;\r\n        return this._blockInput;\r\n    }\r\n    protected set blockInput(value) {\r\n        if (value && this.is3D()) {\r\n            this.log('2D');\r\n            return;\r\n        }\r\n        this._blockInput = value;\r\n    }\r\n\r\n    /**\r\n     * (Page)\r\n     */\r\n    protected miniViews: IMiniViewNames = [];\r\n\r\n    /**\r\n     * view\r\n     */\r\n    public get viewName() {\r\n        return this._base_view_name;\r\n    }\r\n\r\n    /**\r\n     * , PageHome => Home\r\n     */\r\n    public get baseName() {\r\n        return this._base_view_name.slice(this.typeName.length);\r\n    }\r\n\r\n    /**\r\n     * , PageHome => Page\r\n     */\r\n    public get typeName() {\r\n        if (this._base_view_name.indexOf(ViewType.Paper) === 0) return ViewType.Paper;\r\n        if (this._base_view_name.indexOf(ViewType.Pop) === 0) return ViewType.Pop;\r\n        if (this._base_view_name.indexOf(ViewType.Top) === 0) return ViewType.Top;\r\n        return ViewType.Page;\r\n    }\r\n\r\n    /**\r\n     * \r\n     */\r\n    public get isSingleton(): boolean {\r\n        return this.singleton;\r\n    }\r\n\r\n    /**\r\n     * \r\n     */\r\n    public get isCaptureFocus(): boolean {\r\n        return this.captureFocus;\r\n    }\r\n\r\n    /**\r\n     * \r\n     */\r\n    public get isNeedShade(): boolean {\r\n        return this.shade;\r\n    }\r\n\r\n    /**\r\n     * (Hid)\r\n     */\r\n    public get isShow(): boolean {\r\n        return this._base_view_state != ViewState.Hid;\r\n    }\r\n\r\n    /**\r\n     * show\r\n     */\r\n    protected isMiniViewShow(name: IMiniViewName) {\r\n        return this._base_mini_show.has(name);\r\n    }\r\n\r\n    //  Reset \r\n    resetInEditor(): any {\r\n        if (EDITOR) {\r\n            const is3D = this.is3D();\r\n            if (this.viewName.indexOf(ViewType.Page) >= 0) {\r\n                this.shade = false;\r\n                this.blockInput = is3D ? false : true;\r\n                this.captureFocus = is3D ? false : true;\r\n            } else if (this.viewName.indexOf(ViewType.Paper) >= 0) {\r\n                this.shade = false;\r\n                this.captureFocus = false;\r\n                this.blockInput = false;\r\n            }\r\n\r\n            if (is3D) return;\r\n            this.node.getComponent(UITransform) || this.node.addComponent(UITransform);\r\n\r\n            const widget = this.node.getComponent(Widget) || this.node.addComponent(Widget);\r\n            widget.isAlignBottom = true;\r\n            widget.isAlignLeft = true;\r\n            widget.isAlignRight = true;\r\n            widget.isAlignTop = true;\r\n            widget.top = 0;\r\n            widget.left = 0;\r\n            widget.right = 0;\r\n            widget.bottom = 0;\r\n            widget.alignMode = Widget.AlignMode.ON_WINDOW_RESIZE;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * \r\n     */\r\n    protected setTouchEnabled(enabled: boolean = true): any {\r\n        this._base_touch_enable = !!enabled;\r\n    }\r\n\r\n    private blockPropagation(event: EventTouch) {\r\n        if (this.blockInput) {\r\n            event.propagationStopped = true;\r\n            if (event.type === Node.EventType.TOUCH_START) {\r\n                this.log('');\r\n            }\r\n        }\r\n    }\r\n\r\n    private stopPropagation(event: EventTouch) {\r\n        if (!this._base_touch_enable) {\r\n            event.propagationStopped = true;\r\n            event.propagationImmediateStopped = true;\r\n            if (event.type === Node.EventType.TOUCH_START) {\r\n                this.log('');\r\n            }\r\n        }\r\n    }\r\n\r\n    private onBaseViewCreate(): any {\r\n        if (this.is3D()) return;\r\n        const uiTransform = this.getComponent(UITransform);\r\n        if (uiTransform) uiTransform.hitTest = (...args: any[]): boolean => {\r\n            if (this.blockInput) {\r\n                return UITransform.prototype.hitTest.apply(uiTransform, args);\r\n            }\r\n            return false;\r\n        };\r\n\r\n        for (let i = 0; i < BlockEvents.length; i++) {\r\n            this.node.on(BlockEvents[i], this.blockPropagation, this);\r\n            this.node.on(BlockEvents[i], this.stopPropagation, this, true);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * \r\n     */\r\n    protected hideAllMiniViews(data?: any) {\r\n        this._base_mini_show.forEach((name) => {\r\n            Core.inst.manager.ui.hide({ name, data });\r\n        });\r\n        this._base_mini_show.clear();\r\n    }\r\n\r\n    /**\r\n     * \r\n     */\r\n    protected hideMiniViews({ data, views }: { data?: any, views: IMiniViewNames }) {\r\n        if (this.miniViews.length === 0) return;\r\n        if (views.length === 0) return;\r\n\r\n        views.forEach(name => {\r\n            if (this.miniViews.indexOf(name) === -1) {\r\n                this.warn('hideMiniViews', `${name}miniViews, `);\r\n                return;\r\n            }\r\n\r\n            // \r\n            if (!this._base_mini_show.has(name)) return;\r\n            // \r\n            Core.inst.manager.ui.hide({ name, data });\r\n        });\r\n        // TODO PaperUI()\r\n        Core.inst.manager.ui.sortUserInterface('Paper');\r\n    }\r\n\r\n    /**\r\n     * \r\n     */\r\n    protected showMiniViews({ data, views, onShow, onHide, onFinish }: {\r\n        /** */\r\n        data?: any,\r\n        /** */\r\n        views: Array<IMiniViewName | IMiniViewNames>,\r\n        /** */\r\n        onShow?: IMiniOnShow,\r\n        /** */\r\n        onHide?: IMiniOnHide,\r\n        /** */\r\n        onFinish?: IMiniOnFinish\r\n    }) {\r\n        if (views.length === 0) return false;\r\n        if (this.typeName !== ViewType.Page) {\r\n            this.warn('showMiniViews', 'Page');\r\n            return false;\r\n        }\r\n\r\n        const task = Core.inst.lib.task.createSync();\r\n\r\n        for (let index = 0; index < views.length; index++) {\r\n            const names = views[index];\r\n            if (names instanceof Array) {\r\n                task.add(next => {\r\n                    this.createMixMiniViewsTask(names, data, onShow, onHide).start(next);\r\n                });\r\n            } else {\r\n                task.add(next => {\r\n                    this.createMixMiniViewsTask([names], data, onShow, onHide).start(next);\r\n                });\r\n            }\r\n        }\r\n\r\n        task.start(onFinish && function () {\r\n            onFinish();\r\n        });\r\n\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * \r\n     */\r\n    private createMixMiniViewsTask(views: IMiniViewNames = [], data?: any, onShow?: IMiniOnShow, onHide?: IMiniOnHide) {\r\n        const task = Core.inst.lib.task.createSync();\r\n\r\n        if (this.typeName !== ViewType.Page) {\r\n            this.warn('showMiniViews', 'Page');\r\n            return task;\r\n        }\r\n\r\n        views = views.filter(name => {\r\n            if (!name) {\r\n                this.warn('showMiniViews', 'name');\r\n                return false;\r\n            }\r\n            if (this._base_mini_show.has(name)) {\r\n                this.warn('showMiniViews', `${name}, `);\r\n                return false;\r\n            }\r\n            if (this.miniViews.indexOf(name) === -1) {\r\n                this.warn('showMiniViews', `${name}miniViews, `);\r\n                return false;\r\n            }\r\n            if (name.indexOf(this.baseName) !== ViewType.Paper.length && name.indexOf(ViewType.PaperAll) !== 0) {\r\n                this.warn('showMiniViews', `${name}Page, `);\r\n                return false;\r\n            }\r\n\r\n            this._base_mini_show.add(name);\r\n            return true;\r\n        });\r\n\r\n        if (views.length === 0) return task;\r\n\r\n        // load\r\n        task.add((next) => {\r\n            const aSync = Core.inst.lib.task.createASync();\r\n            views.forEach(name => {\r\n                aSync.add((next, retry) => {\r\n                    this.log(`: ${name}`);\r\n                    Core.inst.manager.ui.load(name as any, result => {\r\n                        result ? next() : this.scheduleOnce(retry, 0.1);\r\n                    });\r\n                });\r\n            });\r\n            aSync.start(next);\r\n        });\r\n\r\n        // show\r\n        task.add((next) => {\r\n            const aSync = Core.inst.lib.task.createASync();\r\n            views.forEach(name => {\r\n                aSync.add((next) => {\r\n                    if (!this._base_mini_show?.has(name)) return next();\r\n\r\n                    this.log(`: ${name}`);\r\n                    // PaperAll,owner\r\n                    if (BaseView.isPaperAll(name)) {\r\n                        PaperAllToOwner.set(name, this.uuid);\r\n                    }\r\n                    Core.inst.manager.ui.show({\r\n                        name, data,\r\n                        silent: true,\r\n                        attr: { zIndex: this.miniViews.indexOf(name) },\r\n                        onShow: (result) => {\r\n                            if (onShow) onShow(name, result);\r\n                            next();\r\n                        },\r\n                        onHide: (result) => {\r\n                            if (BaseView.isPaperAll(name)) {\r\n                                // PaperAllPage\r\n                                const owner = PaperAllToOwner.get(name);\r\n                                if (owner && owner === this.uuid) {\r\n                                    PaperAllToOwner.delete(name);\r\n                                }\r\n                            }\r\n                            this._base_mini_show?.delete(name);\r\n                            if (onHide) onHide(name, result);\r\n                        },\r\n                        onError: (result, code) => {\r\n                            if (code === Core.inst.Manager.UI.ErrorCode.LoadError) return true;\r\n                            if (BaseView.isPaperAll(name)) {\r\n                                // PaperAllPage\r\n                                const owner = PaperAllToOwner.get(name);\r\n                                if (owner && owner === this.uuid) {\r\n                                    PaperAllToOwner.delete(name);\r\n                                    Core.inst.manager.ui.hide({ name });\r\n                                }\r\n                            }\r\n                            this._base_mini_show?.delete(name);\r\n                            this.warn('', name, result);\r\n                            next();\r\n                        },\r\n                    });\r\n                });\r\n            });\r\n            aSync.start(() => {\r\n                // TODO PaperUI()\r\n                Core.inst.manager.ui.sortUserInterface('Paper');\r\n                next();\r\n            });\r\n        });\r\n\r\n        return task;\r\n    }\r\n\r\n    /**\r\n     * \r\n     */\r\n    private setNodeAttr(attr: IShowParamAttr) {\r\n        if (!attr) return;\r\n        if (typeof attr.zIndex === 'number') {\r\n            // z2.xzIndex\r\n            this.node.setPosition(this.node.position.x, this.node.position.y, attr.zIndex);\r\n        }\r\n\r\n        if (typeof attr.siblingIndex === 'number') {\r\n            this.node.setSiblingIndex(attr.siblingIndex);\r\n        }\r\n    }\r\n\r\n    private show(data?: any, attr?: IShowParamAttr, onShow?: IShowParamOnShow, onHide?: IShowParamOnHide, beforeShow?: IShowParamBeforeShow) {\r\n        // show\r\n        if (this._base_view_state !== ViewState.Showed &&\r\n            this._base_view_state !== ViewState.Hid) {\r\n            this._base_show_hide_delays.push(\r\n                this.show.bind(this, data, attr, onShow, onHide, beforeShow)\r\n            );\r\n            return;\r\n        }\r\n\r\n        // show\r\n        const changeState = this._base_view_state === ViewState.Hid;\r\n        if (changeState) this._base_view_state = ViewState.BeforeShow;\r\n        const next = (error: string) => {\r\n            if (!error) {\r\n                // PaperPaperPageshow\r\n                // PaprAllPagePaperAllPageshowonHide\r\n                if (this.isPaperAll()) this.node.emit('onHide');\r\n            }\r\n            beforeShow && beforeShow(error);\r\n            if (!error) {\r\n                // \r\n                if (changeState) this._base_view_state = ViewState.Showing;\r\n                onHide && this.node.once('onHide', onHide);\r\n\r\n                // onCreate\r\n                if (this._base_view_created === false) {\r\n                    this._base_view_created = true;\r\n                    this.onBaseViewCreate();\r\n                }\r\n\r\n                // \r\n                this.setNodeAttr(attr);\r\n\r\n                // onLoadonEnable\r\n                if (this.node.active !== true) { this.node.active = true; }\r\n\r\n                this.log('onShow');\r\n                let result = null;\r\n                try {\r\n                    result = this.onShow(data);\r\n                } catch (err) {\r\n                    this.onError();\r\n                    console.error(err);\r\n                }\r\n\r\n                // focus\r\n                Core.inst.manager.ui.refreshShade();\r\n\r\n                try {\r\n                    onShow && onShow(result);\r\n                    this.node.emit('onShow', result);\r\n                    Core.inst.manager.ui.emit(this._base_view_name, { event: 'onShow', result: result });\r\n                    Core.inst.manager.ui.emit('onShow', { name: this._base_view_name, result: result });\r\n                } catch (err) {\r\n                    console.error(err);\r\n                }\r\n\r\n                if (changeState) this._base_view_state = ViewState.Showed;\r\n            } else {\r\n                if (changeState) this._base_view_state = ViewState.Hid;\r\n            }\r\n\r\n            if (this._base_show_hide_delays.length > 0) {\r\n                this._base_show_hide_delays.shift()();\r\n            }\r\n        };\r\n\r\n        this.log('beforeShow');\r\n        let isNextCalled = false;\r\n        this.beforeShow((error) => {\r\n            if (isNextCalled) return this.error('beforeShow', 'next');\r\n            isNextCalled = true;\r\n            next(error || null);\r\n        }, data);\r\n    }\r\n\r\n    protected hide(\r\n        //@ts-ignore\r\n        data?: Parameters<this['onHide']>[0],\r\n        onHide?: IHideParamOnHide) {\r\n\r\n        // hide\r\n        if (this._base_view_state !== ViewState.Hid &&\r\n            this._base_view_state !== ViewState.Showed) {\r\n            this._base_show_hide_delays.push(\r\n                this.hide.bind(this, data, onHide)\r\n            );\r\n            return;\r\n        }\r\n\r\n        // hide\r\n        const changeState = this._base_view_state === ViewState.Showed;\r\n        if (changeState) this._base_view_state = ViewState.BeforeHide;\r\n        this.log('beforeHide');\r\n        const error = this.beforeHide(data);\r\n        if (!error) {\r\n            this.log('onHide');\r\n            if (changeState) this._base_view_state = ViewState.Hiding;\r\n            this.hideAllMiniViews(data);\r\n\r\n            let result = null;\r\n            try {\r\n                result = this.onHide(data);\r\n            } catch (error) {\r\n                console.error(error);\r\n            }\r\n\r\n            try {\r\n                onHide && onHide(result);\r\n                this.node.emit('onHide', result);\r\n                Core.inst.manager.ui.emit(this._base_view_name, { event: 'onHide', result: result });\r\n                Core.inst.manager.ui.emit('onHide', { name: this._base_view_name, result: result });\r\n            } catch (error) {\r\n                console.error(error);\r\n            }\r\n\r\n            if (changeState) this._base_view_state = ViewState.Hid;\r\n\r\n            if (this.hideEvent === HideEvent.active) { this.node.active = false; }\r\n            else if (this.hideEvent === HideEvent.destroy) { Core.inst.manager.ui.release(this); }\r\n            Core.inst.manager.ui.refreshShade();\r\n        } else {\r\n            if (changeState) this._base_view_state = ViewState.Showed;\r\n        }\r\n\r\n        if (this._base_show_hide_delays.length > 0) {\r\n            this._base_show_hide_delays.shift()();\r\n        }\r\n    }\r\n\r\n    private focus(boo: boolean): any {\r\n        let result = null;\r\n        let event = '';\r\n        if (boo) {\r\n            result = this.onFocus();\r\n            event = 'onFocus';\r\n        } else {\r\n            result = this.onLostFocus();\r\n            event = 'onLostFocus';\r\n        }\r\n\r\n        this.node.emit(event, result);\r\n        Core.inst.manager.ui.emit(this._base_view_name, { event: event, result: result });\r\n        Core.inst.manager.ui.emit(event, { name: this._base_view_name, result: result });\r\n    }\r\n\r\n    /**\r\n     * UIresources\r\n     * @param path resources\r\n     * @param callback \r\n     * this.loadRes('Bag', Prefab, function(asset){})\r\n     */\r\n    protected loadRes<T extends typeof Asset>(path: string, type: T, callback?: (result: InstanceType<T> | null) => any) {\r\n        Core.inst.manager.ui.loadRes(this, path, type, callback);\r\n    }\r\n\r\n    /**\r\n     * UIresources\r\n     * @param path resources\r\n     * this.preloadRes('Bag', Prefab)\r\n     */\r\n    protected preloadRes<T extends typeof Asset>(path: string, type: T) {\r\n        Core.inst.manager.ui.preloadRes(this, path, type);\r\n    }\r\n\r\n    /**\r\n     * UIresources\r\n     * @param path resources\r\n     * @param callback \r\n     * this.loadResDir('Bag', Prefab, function(asset){})\r\n     */\r\n    protected loadResDir<T extends typeof Asset>(path: string, type: T, callback?: (result: InstanceType<T>[] | null) => any) {\r\n        Core.inst.manager.ui.loadResDir(this, path, type, callback);\r\n    }\r\n\r\n    /**\r\n     * UIresources\r\n     * @param path resources\r\n     * this.preloadResDir('Bag', Prefab)\r\n     */\r\n    protected preloadResDir<T extends typeof Asset>(path: string, type: T) {\r\n        Core.inst.manager.ui.preloadResDir(this, path, type);\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param path UIresources\r\n     */\r\n    protected setFont(target: Label, path: string, onComplete?: (success: boolean) => any) {\r\n        this.loadRes(path, Font, (font) => {\r\n            if (!font || !isValid(target)) {\r\n                return onComplete && onComplete(false);\r\n            }\r\n            target.font = font;\r\n            onComplete && onComplete(true);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Spine\r\n     * @param path UIresources\r\n     */\r\n    protected setSpine(target: sp.Skeleton, path: string, onComplete?: (success: boolean) => any) {\r\n        this.loadRes(path, sp.SkeletonData, (skeletonData) => {\r\n            if (!skeletonData || !isValid(target)) {\r\n                return onComplete && onComplete(false);\r\n            }\r\n            target.skeletonData = skeletonData;\r\n            onComplete && onComplete(true);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param path UIresources(/spriteFrame)\r\n     * \r\n     * @example\r\n     * setSprite(sprite, 'img/a/spriteFrame', onComplete:(succ)=>{})\r\n     */\r\n    protected setSprite(target: Sprite, path: string, onComplete?: (success: boolean) => any) {\r\n        this.loadRes(path, SpriteFrame, (spriteFrame) => {\r\n            if (!spriteFrame || !isValid(target)) {\r\n                return onComplete && onComplete(false);\r\n            }\r\n            target.spriteFrame = spriteFrame;\r\n            onComplete && onComplete(true);\r\n        });\r\n    }\r\n\r\n    /** */\r\n    protected get log() {\r\n        return Logger.create('log', '#1e90ff', DEV ? `[${this._base_view_name}] LOG` : `[${this._base_view_name}] [LOG]`);\r\n    }\r\n\r\n    /** */\r\n    protected get warn() {\r\n        return Logger.create('warn', '#ff7f50', DEV ? `[${this._base_view_name}] WARN` : `[${this._base_view_name}] [WARN]`);\r\n    }\r\n\r\n    /** */\r\n    protected get error() {\r\n        return Logger.create('error', '#ff4757', DEV ? `[${this._base_view_name}] ERROR` : `[${this._base_view_name}] [ERROR]`);\r\n    }\r\n\r\n    ////////////////////////////\r\n    /**\r\n    * \r\n    * @param data onShow\r\n    * @returns \r\n    */\r\n    protected onShow(data?: any): any {\r\n        return data;\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param data onHide\r\n     * @returns \r\n     */\r\n    protected onHide(data?: any): any {\r\n        return data;\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @returns \r\n     */\r\n    protected onLostFocus(): any {\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @returns \r\n     */\r\n    protected onFocus(): any {\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * onShow\r\n     * @param next erroronShow\r\n     * @param data onShow\r\n     */\r\n    protected beforeShow(next: (error?: string) => void, data?: any): any {\r\n        next(null);\r\n    }\r\n\r\n    /**\r\n     * hide\r\n     * @param data onHide\r\n     * @returns \r\n     */\r\n    protected beforeHide(data?: any): string | void {\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * onShow\r\n     */\r\n    protected onError(): any {\r\n        return;\r\n    }\r\n\r\n    /**\r\n     * \r\n     */\r\n    protected onShade(): IShade {\r\n        return {};\r\n    }\r\n}","import { Component, Director, director, EventTarget, js } from 'cc';\r\nimport { DEV, EDITOR } from 'cc/env';\r\nimport * as debug from './lib/debug/debug';\r\nimport logger from './lib/logger/logger';\r\nimport storage from './lib/storage/storage';\r\nimport task from './lib/task/task';\r\nimport EventManager from './manager/event/EventManager';\r\nimport LoaderManager from './manager/loader/LoaderManager';\r\nimport SoundManager from './manager/sound/SoundManager';\r\nimport TimerManager from './manager/timer/TimerManager';\r\nimport UIManager from './manager/ui/UIManager';\r\n\r\nenum EventType {\r\n    /**AppInit */\r\n    EVENT_APPINIT_FINISHED = 'EVENT_APPINIT_FINISHED',\r\n    /**Manager */\r\n    EVENT_SYS_MANAGER_INITED = 'EVENT_SYS_MANAGER_INITED',\r\n    /**Manager */\r\n    EVENT_USER_MANAGER_INITED = 'EVENT_USER_MANAGER_INITED',\r\n    /**Manager */\r\n    EVENT_MANAGER_INITED = 'EVENT_MANAGER_INITED',\r\n    /**Manager */\r\n    EVENT_MANAGER_FINISHED = 'EVENT_MANAGER_FINISHED'\r\n}\r\n\r\ntype IData = { [key in string]: any };\r\ntype IConfig = { [key in string]: any };\r\ntype IStore = { [key in string]: any };\r\ntype ICtrl = { [key in string]: any };\r\n\r\ninterface ITypeofManager {\r\n    Loader: Omit<typeof LoaderManager, keyof Component>,\r\n    Event: Omit<typeof EventManager, keyof Component>,\r\n    Sound: Omit<typeof SoundManager, keyof Component>,\r\n    Timer: Omit<typeof TimerManager, keyof Component>,\r\n    UI: Omit<typeof UIManager, keyof Component>\r\n}\r\n\r\ninterface IManager {\r\n    loader: Omit<LoaderManager, keyof Component>,\r\n    event: Omit<EventManager, keyof Component>,\r\n    sound: Omit<SoundManager<any, any>, keyof Component>,\r\n    timer: Omit<TimerManager, keyof Component>,\r\n    ui: Omit<UIManager<any, any>, keyof Component>\r\n}\r\n\r\ninterface ICore {\r\n    data: IData,\r\n    config: IConfig,\r\n    store: IStore,\r\n    controller: ICtrl,\r\n    Controller: ICtrl,\r\n    manager: IManager,\r\n    Manager: ITypeofManager\r\n}\r\n\r\nconst Lib = { task, storage, debug, logger };\r\nconst Config = {};\r\nconst Data = {};\r\nconst Store = {};\r\nconst controller = {};\r\nconst Controller = {};\r\nconst Manager = {};\r\nconst manager = {};\r\n\r\nconst eventTarget = new EventTarget();\r\nlet EventMap = {};\r\n\r\ndirector.on(Director.EVENT_RESET, () => {\r\n    js.clear(Config);\r\n    js.clear(Data);\r\n    js.clear(Store);\r\n    js.clear(controller);\r\n    js.clear(Controller);\r\n    js.clear(Manager);\r\n    js.clear(manager);\r\n\r\n    EventMap = {};\r\n});\r\n\r\nexport default class Core<T extends ICore> {\r\n    static EventType = EventType;\r\n\r\n    protected static _inst: Core<ICore> | undefined;\r\n    static get inst() {\r\n        if (!this._inst) this._inst = new Core();\r\n        return this._inst;\r\n    }\r\n\r\n    lib = Lib;\r\n    config: T['config'] = null;\r\n    data: T['data'] = null;\r\n    store: T['store'] = null;\r\n    Controller: T['Controller'] = null;\r\n    controller: T['controller'] = null;\r\n    Manager: T['Manager'] = null;\r\n    manager: T['manager'] = null;\r\n\r\n    constructor() {\r\n        this.config = Config;\r\n        this.data = Data;\r\n        this.store = Store;\r\n        this.Controller = Controller;\r\n        this.controller = controller;\r\n        this.Manager = Manager as any;\r\n        this.manager = manager as any;\r\n        if (!EDITOR || DEV) {\r\n            if (this.constructor !== Core && !js.getClassById('App')) {\r\n                js.setClassAlias(this.constructor as any, 'App');\r\n            }\r\n        }\r\n    }\r\n\r\n    on(event: keyof typeof EventType, callback: (...any: any[]) => void, target?: any): any {\r\n        if (EventMap[event]) callback.call(target);\r\n        eventTarget.on(event, callback, target);\r\n    }\r\n\r\n    once(event: keyof typeof EventType, callback: Function, target?: any): any {\r\n        if (EventMap[event]) {\r\n            callback.call(target);\r\n        } else {\r\n            eventTarget.once(event, callback as any, target);\r\n        }\r\n    }\r\n\r\n    off(event: keyof typeof EventType, callback: (...any: any[]) => void, target?: any): any {\r\n        eventTarget.off(event, callback, target);\r\n    }\r\n\r\n    targetOff(target: any) {\r\n        eventTarget.targetOff(target);\r\n    }\r\n\r\n    /**\r\n     * \r\n     */\r\n    static emit(event: keyof typeof EventType, ...args: any[]): any {\r\n        EventMap[event] = true;\r\n        eventTarget.emit(event, ...args);\r\n    }\r\n}","import { Color, Canvas, UITransform, instantiate, math, Toggle, TextureCube, _decorator, Component, Button, labelAssembler, game, director, Node, Scene, renderer, CameraComponent, Label, ForwardPipeline, RichText } from 'cc';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('internal.DebugViewRuntimeControl')\r\nexport class DebugViewRuntimeControl extends Component {\r\n    @property(Node)\r\n    compositeModeToggle: Node | null = null;\r\n    @property(Node)\r\n    singleModeToggle: Node | null = null;\r\n    @property(Node)\r\n    EnableAllCompositeModeButton: Node | null = null;\r\n\t_single: number = 0;\r\n\r\n    private strSingle: string[] = [\r\n        'No Single Debug',\r\n        'Vertex Color',\r\n        'Vertex Normal',\r\n        'Vertex Tangent',\r\n        'World Position',\r\n        'Vertex Mirror',\r\n        'Face Side',\r\n        'UV0',\r\n        'UV1',\r\n        'UV Lightmap',\r\n        'Project Depth',\r\n        'Linear Depth',\r\n\r\n        'Fragment Normal',\r\n        'Fragment Tangent',\r\n        'Fragment Binormal',\r\n        'Base Color',\r\n        'Diffuse Color',\r\n        'Specular Color',\r\n        'Transparency',\r\n        'Metallic',\r\n        'Roughness',\r\n        'Specular Intensity',\r\n        'IOR',\r\n\r\n        'Direct Diffuse',\r\n        'Direct Specular',\r\n        'Direct All',\r\n        'Env Diffuse',\r\n        'Env Specular',\r\n        'Env All',\r\n        'Emissive',\r\n        'Light Map',\r\n        'Shadow',\r\n        'AO',\r\n\r\n        'Fresnel',\r\n        'Direct Transmit Diffuse',\r\n        'Direct Transmit Specular',\r\n        'Env Transmit Diffuse',\r\n        'Env Transmit Specular',\r\n        'Transmit All',\r\n        'Direct Internal Specular',\r\n        'Env Internal Specular',\r\n        'Internal All',\r\n\r\n        'Fog',\r\n    ];\r\n    private strComposite: string[] = [\r\n        'Direct Diffuse',\r\n        'Direct Specular',\r\n        'Env Diffuse',\r\n        'Env Specular',\r\n        'Emissive',\r\n        'Light Map',\r\n        'Shadow',\r\n        'AO',\r\n\r\n        'Normal Map',\r\n        'Fog',\r\n\r\n        'Tone Mapping',\r\n        'Gamma Correction',\r\n\r\n        'Fresnel',\r\n        'Transmit Diffuse',\r\n        'Transmit Specular',\r\n        'Internal Specular',\r\n        'TT',\r\n    ];\r\n    private strMisc: string[] = [\r\n        'CSM Layer Coloration',\r\n        'Lighting With Albedo',\r\n    ];\r\n\r\n    private compositeModeToggleList: Node[] = [];\r\n    private singleModeToggleList: Node[] = [];\r\n    private miscModeToggleList: Node[] = [];\r\n    private textComponentList: RichText[] = [];\r\n    private labelComponentList: Label[] = [];\r\n    private textContentList: string[] = [];\r\n    private hideButtonLabel: Label;\r\n    start() {\r\n        // get canvas resolution\r\n        const canvas = this.node.parent.getComponent(Canvas);\r\n        if (!canvas) {\r\n            console.error('debug-view-runtime-control should be child of Canvas');\r\n            return;\r\n        }\r\n\r\n        const uiTransform = this.node.parent.getComponent(UITransform);\r\n        const halfScreenWidth = uiTransform.width * 0.5;\r\n        const halfScreenHeight = uiTransform.height * 0.5;\r\n\r\n        let x = -halfScreenWidth + halfScreenWidth * 0.1, y = halfScreenHeight - halfScreenHeight * 0.1;\r\n        const width = 200, height = 20;\r\n\r\n        // new nodes\r\n        const miscNode = this.node.getChildByName('MiscMode');\r\n        const buttonNode = instantiate(miscNode);\r\n        buttonNode.parent = this.node;\r\n        buttonNode.name = 'Buttons';\r\n        const titleNode = instantiate(miscNode);\r\n        titleNode.parent = this.node;\r\n        titleNode.name = 'Titles';\r\n\r\n        // title\r\n        for (let i = 0; i < 2; i++) {\r\n            const newLabel = instantiate(this.EnableAllCompositeModeButton.getChildByName('Label'));\r\n            newLabel.setPosition(x + (i > 0 ? 50 + width * 2 : 150), y, 0.0);\r\n            newLabel.setScale(0.75, 0.75, 0.75);\r\n            newLabel.parent = titleNode;\r\n            const labelComponent = newLabel.getComponent(Label);\r\n            labelComponent.string = i ? '----------Composite Mode----------' : '----------Single Mode----------';\r\n            labelComponent.color = Color.WHITE;\r\n            labelComponent.overflow = 0;\r\n            this.labelComponentList[this.labelComponentList.length] = labelComponent;\r\n        }\r\n\r\n        y -= height;\r\n        // single\r\n        let currentRow = 0;\r\n        for (let i = 0; i < this.strSingle.length; i++, currentRow++) {\r\n            if (i === this.strSingle.length >> 1) {\r\n                x += width;\r\n                currentRow = 0;\r\n            }\r\n            const newNode = i ? instantiate(this.singleModeToggle) : this.singleModeToggle;\r\n            newNode.setPosition(x, y - height * currentRow, 0.0);\r\n            newNode.setScale(0.5, 0.5, 0.5);\r\n            newNode.parent = this.singleModeToggle.parent;\r\n\r\n            const textComponent = newNode.getComponentInChildren(RichText);\r\n            textComponent.string = this.strSingle[i];\r\n            this.textComponentList[this.textComponentList.length] = textComponent;\r\n            this.textContentList[this.textContentList.length] = textComponent.string;\r\n\r\n            newNode.on(Toggle.EventType.TOGGLE, this.toggleSingleMode, this);\r\n\r\n            this.singleModeToggleList[i] = newNode;\r\n        }\r\n\r\n        x += width;\r\n        // buttons\r\n        this.EnableAllCompositeModeButton.setPosition(x + 15, y, 0.0);\r\n        this.EnableAllCompositeModeButton.setScale(0.5, 0.5, 0.5);\r\n        this.EnableAllCompositeModeButton.on(Button.EventType.CLICK, this.enableAllCompositeMode, this);\r\n        this.EnableAllCompositeModeButton.parent = buttonNode;\r\n        let labelComponent = this.EnableAllCompositeModeButton.getComponentInChildren(Label);\r\n        this.labelComponentList[this.labelComponentList.length] = labelComponent;\r\n\r\n        const changeColorButton = instantiate(this.EnableAllCompositeModeButton);\r\n        changeColorButton.setPosition(x + 90, y, 0.0);\r\n        changeColorButton.setScale(0.5, 0.5, 0.5);\r\n        changeColorButton.on(Button.EventType.CLICK, this.changeTextColor, this);\r\n        changeColorButton.parent = buttonNode;\r\n        labelComponent = changeColorButton.getComponentInChildren(Label);\r\n        labelComponent.string = 'TextColor';\r\n        this.labelComponentList[this.labelComponentList.length] = labelComponent;\r\n\r\n        const HideButton = instantiate(this.EnableAllCompositeModeButton);\r\n        HideButton.setPosition(x + 200, y, 0.0);\r\n        HideButton.setScale(0.5, 0.5, 0.5);\r\n        HideButton.on(Button.EventType.CLICK, this.hideUI, this);\r\n        HideButton.parent = this.node.parent;\r\n        labelComponent = HideButton.getComponentInChildren(Label);\r\n        labelComponent.string = 'Hide UI';\r\n        this.labelComponentList[this.labelComponentList.length] = labelComponent;\r\n        this.hideButtonLabel = labelComponent;\r\n\r\n        // misc\r\n        y -= 40;\r\n        for (let i = 0; i < this.strMisc.length; i++) {\r\n            const newNode = instantiate(this.compositeModeToggle);\r\n            newNode.setPosition(x, y - height * i, 0.0);\r\n            newNode.setScale(0.5, 0.5, 0.5);\r\n            newNode.parent = miscNode;\r\n\r\n            const textComponent = newNode.getComponentInChildren(RichText);\r\n            textComponent.string = this.strMisc[i];\r\n            this.textComponentList[this.textComponentList.length] = textComponent;\r\n            this.textContentList[this.textContentList.length] = textComponent.string;\r\n\r\n            const toggleComponent = newNode.getComponent(Toggle);\r\n            toggleComponent.isChecked = i ? true : false;\r\n            newNode.on(Toggle.EventType.TOGGLE, i ? this.toggleLightingWithAlbedo : this.toggleCSMColoration, this);\r\n            this.miscModeToggleList[i] = newNode;\r\n        }\r\n\r\n        // composite\r\n        y -= 150;\r\n        for (let i = 0; i < this.strComposite.length; i++) {\r\n            const newNode = i ? instantiate(this.compositeModeToggle) : this.compositeModeToggle;\r\n            newNode.setPosition(x, y - height * i, 0.0);\r\n            newNode.setScale(0.5, 0.5, 0.5);\r\n            newNode.parent = this.compositeModeToggle.parent;\r\n\r\n            const textComponent = newNode.getComponentInChildren(RichText);\r\n            textComponent.string = this.strComposite[i];\r\n            this.textComponentList[this.textComponentList.length] = textComponent;\r\n            this.textContentList[this.textContentList.length] = textComponent.string;\r\n\r\n            newNode.on(Toggle.EventType.TOGGLE, this.toggleCompositeMode, this);\r\n\r\n            this.compositeModeToggleList[i] = newNode;\r\n        }\r\n    }\r\n\r\n    isTextMatched(textUI, textDescription) : boolean {\r\n        let tempText = new String(textUI);\r\n        const findIndex = tempText.search('>');\r\n        if (findIndex === -1) {\r\n            return textUI === textDescription;\r\n        } else {\r\n            tempText = tempText.substr(findIndex + 1);\r\n            tempText = tempText.substr(0, tempText.search('<'));\r\n            return tempText === textDescription;\r\n        }\r\n    }\r\n    toggleSingleMode(toggle: Toggle) {\r\n        const debugView = director.root!.debugView;\r\n        const textComponent = toggle.getComponentInChildren(RichText);\r\n        for (let i = 0; i < this.strSingle.length; i++) {\r\n            if (this.isTextMatched(textComponent.string, this.strSingle[i])) {\r\n                debugView.singleMode = i;\r\n            }\r\n        }\r\n    }\r\n    toggleCompositeMode(toggle: Toggle) {\r\n        const debugView = director.root!.debugView;\r\n        const textComponent = toggle.getComponentInChildren(RichText);\r\n        for (let i = 0; i < this.strComposite.length; i++) {\r\n            if (this.isTextMatched(textComponent.string, this.strComposite[i])) {\r\n                debugView.enableCompositeMode(i, toggle.isChecked);\r\n            }\r\n        }\r\n    }\r\n    toggleLightingWithAlbedo(toggle: Toggle) {\r\n        const debugView = director.root!.debugView;\r\n        debugView.lightingWithAlbedo = toggle.isChecked;\r\n    }\r\n    toggleCSMColoration(toggle: Toggle) {\r\n        const debugView = director.root!.debugView;\r\n        debugView.csmLayerColoration = toggle.isChecked;\r\n    }\r\n    enableAllCompositeMode(button: Button) {\r\n        const debugView = director.root!.debugView;\r\n        debugView.enableAllCompositeMode(true);\r\n        for (let i = 0; i < this.compositeModeToggleList.length; i++) {\r\n            const toggleComponent = this.compositeModeToggleList[i].getComponent(Toggle);\r\n            toggleComponent.isChecked = true;\r\n        }\r\n\r\n        let toggleComponent = this.miscModeToggleList[0].getComponent(Toggle);\r\n        toggleComponent.isChecked = false;\r\n        debugView.csmLayerColoration = false;\r\n        toggleComponent = this.miscModeToggleList[1].getComponent(Toggle);\r\n        toggleComponent.isChecked = true;\r\n        debugView.lightingWithAlbedo = true;\r\n    }\r\n    hideUI(button: Button) {\r\n        const titleNode = this.node.getChildByName('Titles');\r\n        const activeValue = !titleNode.active;\r\n        this.singleModeToggleList[0].parent.active = activeValue;\r\n        this.miscModeToggleList[0].parent.active = activeValue;\r\n        this.compositeModeToggleList[0].parent.active = activeValue;\r\n        this.EnableAllCompositeModeButton.parent.active = activeValue;\r\n        titleNode.active = activeValue;\r\n        this.hideButtonLabel.string = activeValue ? 'Hide UI' : 'Show UI';\r\n    }\r\n\r\n    private _currentColorIndex = 0;\r\n    private strColor: string[] = [\r\n        '<color=#ffffff>',\r\n        '<color=#000000>',\r\n        '<color=#ff0000>',\r\n        '<color=#00ff00>',\r\n        '<color=#0000ff>',\r\n    ];\r\n    private color: Color[] = [\r\n        Color.WHITE,\r\n        Color.BLACK,\r\n        Color.RED,\r\n        Color.GREEN,\r\n        Color.BLUE,\r\n    ];\r\n    changeTextColor(button: Button) {\r\n        this._currentColorIndex++;\r\n        if (this._currentColorIndex >= this.strColor.length) {\r\n            this._currentColorIndex = 0;\r\n        }\r\n        for (let i = 0; i < this.textComponentList.length; i++) {\r\n            this.textComponentList[i].string = this.strColor[this._currentColorIndex] + this.textContentList[i] + '</color>';\r\n        }\r\n        for (let i = 0; i < this.labelComponentList.length; i++) {\r\n            this.labelComponentList[i].color = this.color[this._currentColorIndex];\r\n        }\r\n    }\r\n\r\n    onLoad() {\r\n    }\r\n    update(deltaTime: number) {\r\n    }\r\n}\r\n","import { DEBUG, DEV } from 'cc/env';\r\n\r\nfunction jsGetSet(obj: unknown, prop: string, getter: Function, setter?: Function) {\r\n    Object.defineProperty(obj, prop, {\r\n        get: getter as any,\r\n        set: setter as any,\r\n        enumerable: false,\r\n        configurable: false\r\n    });\r\n}\r\nfunction clear(object: Record<string | number, any>) {\r\n    if (!object) return;\r\n    for (const key of Object.keys(object)) {\r\n        delete object[key];\r\n    }\r\n}\r\n/**\r\n * ()\r\n * @param owner object | string | number | boolean | Array | Function | ...\r\n * @param callback \r\n * @returns \r\n */\r\nexport function unobservable(owner: unknown, callback?: Function) {\r\n    if (DEV || DEBUG) return;\r\n    if (!owner) return;\r\n    function define() {\r\n        function accessor() {\r\n            if (callback) {\r\n                callback();\r\n            } else {\r\n                clear(owner);\r\n            }\r\n        }\r\n        try {\r\n            jsGetSet(owner, 'unobservable', accessor.bind(null, 'de' + 'bu' + 'gg' + 'er'));\r\n        }\r\n        catch (e) { !0; }\r\n    }\r\n    define();\r\n}","import { EventTarget, _decorator } from 'cc';\r\nimport BaseManager from '../../base/BaseManager';\r\nconst { ccclass } = _decorator;\r\n\r\n@ccclass('EventManager')\r\nexport default class EventManager extends BaseManager {\r\n    private events: Map<string | number, EventTarget> = new Map();\r\n\r\n    clear() {\r\n        return this.events.clear();\r\n    }\r\n\r\n    delete(rootName: string | number) {\r\n        return this.events.delete(rootName);\r\n    }\r\n\r\n    get(rootName: string | number): EventTarget {\r\n        if (this.events.has(rootName)) {\r\n            return this.events.get(rootName);\r\n        }\r\n\r\n        const event = new EventTarget();\r\n        this.events.set(rootName, event);\r\n\r\n        return event;\r\n    }\r\n}\r\n","import { App } from './app';\r\n\r\n/**\r\n * ccc\r\n */\r\nexport function cccReady(app: App) {\r\n\r\n}\r\n\r\n/**\r\n * ccc\r\n */\r\nexport function cccInited(app: App) {\r\n\r\n}\r\n\r\n/**\r\n * appManager\r\n */\r\nexport function appReady(app: App) {\r\n\r\n}\r\n\r\n/**\r\n * app\r\n */\r\nexport function appInited(app: App) {\r\n\r\n}","import { _decorator, Component, EventTouch, Node, Vec2 } from \"cc\";\n\nconst { ccclass, property } = _decorator;\n@ccclass\nexport class JmClickComponent extends Component {\n    private performClick = false\n    private startPos: Vec2//Touch\n\n    onEnable() {\n        super.onEnable && super.onEnable();\n        this.node.on(Node.EventType.TOUCH_START, this.OnClickTouchEnd, this)\n        this.node.on(Node.EventType.TOUCH_MOVE, this.OnClickTouchEnd, this)\n        this.node.on(Node.EventType.TOUCH_END, this.OnClickTouchEnd, this)\n    }\n\n    onDisable() {\n        super.onDisable && super.onDisable();\n        this.node.off(Node.EventType.TOUCH_START, this.OnClickTouchEnd, this)\n        this.node.off(Node.EventType.TOUCH_MOVE, this.OnClickTouchEnd, this)\n        this.node.off(Node.EventType.TOUCH_END, this.OnClickTouchEnd, this)\n    }\n\n    onDestroy() {\n        super.onDestroy && super.onDestroy();\n    }\n\n    OnClickTouchEnd(event: EventTouch) {\n        switch (event.getType()) {\n            case Node.EventType.TOUCH_START:\n                // JmLobbyLog.Log(\"TOUCH_START\")\n                this.performClick = true\n                this.startPos = event.getLocation()\n                break\n            case Node.EventType.TOUCH_MOVE:\n                // JmLobbyLog.Log(\"TOUCH_MOVE\")\n                let pos = event.getLocation()\n                let dst: Vec2 = this.startPos.subtract(pos)\n                if (dst.length() > 5) {//TOUCH_MOVE\n                    this.performClick = false\n                }\n                break\n            case Node.EventType.TOUCH_END:\n                if (this.performClick) {\n                    this.onItemClick(this)\n                }\n                this.performClick = false\n                break\n        }\n    }\n\n    protected onItemClick(target:any) {\n    }\n\n}","import { Component, EventTouch, instantiate, Node, Prefab, ScrollView, UITransform, Vec2, _decorator } from \"cc\";\r\nimport JmRefreshFooter from \"./JmRefreshFooter\";\r\nimport { RefreshOrLoadState } from \"./RefreshOrLoadState\";\r\n//import JmLobbyLog from \"../util/JmLobbyLog\";\r\n\r\nconst { ccclass, property, menu, requireComponent } = _decorator;\r\n@ccclass()\r\n@requireComponent(ScrollView)\r\n@menu(\"UI /JmHorizontalListView\")\r\nexport default class JmHorizontalListView extends Component {\r\n    @property(Prefab)\r\n    itemPrefab: Prefab = null\r\n\r\n    @property\r\n    itemWidth: number = 0\r\n\r\n    @property\r\n    spacing = 0\r\n    @property\r\n    leftOffset = 0\r\n    @property\r\n    rightOffset = 0\r\n\r\n    @property\r\n    pullLeftToLoadEnabled = false\r\n    @property\r\n    footerOffset = 0\r\n    private footerController: JmRefreshFooter\r\n    private onPullLeftToLoad: Function\r\n    private hasMore: boolean = true\r\n\r\n    scrollView: ScrollView\r\n    footer: Prefab\r\n    footerWidth = 100\r\n\r\n    private _touchStartX = 0\r\n    private _touchStartFromLeft = false\r\n\r\n    private footerHolderWidth = 0;//itemView\r\n\r\n    private isUserTouched = false;\r\n    private loadingState: RefreshOrLoadState = RefreshOrLoadState.NONE\r\n\r\n    private componentName: string = \"JmListViewItem\"\r\n\r\n    private showingViews = new Map<number, any>()\r\n    private recycledViews = new Array<any>()\r\n    private itemViewDirty = new Map<number, boolean>()\r\n    private itemViewWidths = new Array<number>()\r\n\r\n    private _data = new Array<any>()\r\n\r\n    private _dirty = false//ListView\r\n    private _sizeDirty = false\r\n    private _checkRight = false\r\n\r\n\r\n    protected onLoad() {\r\n        this.scrollView = this.node.getComponent(ScrollView)\r\n        //anchoritemViewanchor\r\n        this.scrollView.content.getComponent(UITransform).anchorX = 0\r\n        this.scrollView.content.getComponent(UITransform).anchorY = 0.5\r\n\r\n        // JmLobbyLoaderMgr.LoadAssetCfg(JmLobbyAssetsCfg.JmRefreshFooterHorizontal).then((footer: Prefab) => {\r\n        //     this.footer = footer\r\n        // })\r\n\r\n        // if (!this.scrollView.elastic && this.scrollView.bounceDuration > 0 && this.pullDownToRefreshEnabled) {\r\n        //     //scrollViewelastic\r\n        //     //bounceDuration0updatecontent\r\n        //     JmLobbyLog.Error(\"set elastic true or pullRefresh Events will not work!!\")\r\n        // }\r\n        // if (this.scrollView.cancelInnerEvents) {\r\n        //     //cancelInnerEventstrueItemViewcancel\r\n        //     JmLobbyLog.Error(\"do not set cancelInnerEvent true, it'll effect Refresh Events!!\")\r\n        // }\r\n    }\r\n\r\n    protected onEnable() {\r\n        this.scrollView.node.on(Node.EventType.TOUCH_START, this.onTouchStart, this)\r\n        this.scrollView.node.on(Node.EventType.TOUCH_END, this.onTouchEnd, this)\r\n        this.scrollView.node.on(Node.EventType.TOUCH_MOVE, this.onTouchMove, this)\r\n        this.scrollView.node.on(Node.EventType.TOUCH_CANCEL, this.onTouchCancel, this)\r\n    }\r\n\r\n    protected onDisable() {\r\n        this.scrollView.node.off(Node.EventType.TOUCH_START, this.onTouchStart, this)\r\n        this.scrollView.node.off(Node.EventType.TOUCH_END, this.onTouchEnd, this)\r\n        this.scrollView.node.off(Node.EventType.TOUCH_MOVE, this.onTouchMove, this)\r\n        this.scrollView.node.off(Node.EventType.TOUCH_CANCEL, this.onTouchCancel, this)\r\n    }\r\n\r\n    onTouchStart(event: EventTouch) {\r\n        // JmLobbyLog.Log(\"onTouchStart\")\r\n        this.isUserTouched = true\r\n        this._touchStartX = event.getLocationX()\r\n        this._touchStartFromLeft = Math.floor(this.scrollView.getScrollOffset().x) <= 1//scrollOffset\r\n        // JmLobbyLog.Log(`isTop-->${this._touchStartFromTop}, startY-->${this._touchStartY}`)\r\n    }\r\n\r\n    onTouchMove(event: EventTouch) {\r\n        // let offsetY = event.getLocationY() - this._touchStartY\r\n        // JmLobbyLog.Log(\"getLocationY-->\" + event.getLocationY())\r\n        // if (this.isUserTouched) {//touch\r\n        //     this.checkPullDownRefresh(offsetY)\r\n        // }\r\n    }\r\n\r\n    onTouchEnd() {\r\n        // JmLobbyLog.Log(\"onTouchEnd\")\r\n        // this.startPullDownRefresh()\r\n        this.isUserTouched = false\r\n    }\r\n\r\n    onTouchCancel() {\r\n        // JmLobbyLog.Log(\"onTouchCancel\")\r\n        // this.startPullDownRefresh()\r\n        this.isUserTouched = false\r\n    }\r\n\r\n    getData() {\r\n        return this._data\r\n    }\r\n\r\n    setData(data?: any) {\r\n        this._data = data\r\n    }\r\n\r\n    setComponentName(name: string) {\r\n        this.componentName = name\r\n    }\r\n\r\n    private updateSize() {\r\n        if (this.scrollView.vertical || !this.scrollView.horizontal) {\r\n            console.log(\"scroll orientation must set vertical in ListView!\")\r\n            return\r\n        }\r\n\r\n        // if (this.refreshState == RefreshOrLoadState.REFRESHING) {\r\n        //     height = height + 100\r\n        // }\r\n        this.scrollView.content.getComponent(UITransform).width = this.getNormalContentWidth()\r\n    }\r\n    getNormalContentWidth() {\r\n        let width = this.getContentWidth()\r\n        if (this.pullLeftToLoadEnabled) {\r\n            width += this.footerWidth\r\n        }\r\n        if (width < this.scrollView.node.getComponent(UITransform).width) {\r\n            this.footerHolderWidth = this.scrollView.node.getComponent(UITransform).width - width\r\n            width = this.scrollView.node.getComponent(UITransform).width\r\n        }\r\n        return width\r\n    }\r\n\r\n    private getContentWidth() {\r\n        return this.getItemPosOffset(this.getItemCount()) + this.leftOffset + this.rightOffset;\r\n    }\r\n\r\n    private getItemPosOffset(index: number) {\r\n        let sum = 0\r\n        for (let i = 0; i < index; i++) {\r\n            sum += this.getItemWidthWithSpacing(i)\r\n        }\r\n        return sum\r\n    }\r\n\r\n    private getItemWidthWithSpacing(index?: number) {\r\n        if (index != undefined) {\r\n            return (this.itemViewWidths[index] || this.itemWidth) + this.spacing\r\n        }\r\n        return this.itemWidth + this.spacing\r\n    }\r\n\r\n    private getListLeftRightVisiblePos() {\r\n        //scrollX0contentWidth\r\n        let scrollX = -this.scrollView.getScrollOffset().x\r\n        let width = this.scrollView.node.getComponent(UITransform).width\r\n        let leftVisibleX = scrollX\r\n        let rightVisibleX = scrollX + width\r\n        return [leftVisibleX, rightVisibleX]\r\n    }\r\n\r\n    /**\r\n     * Item\r\n     * @param index\r\n     * @private\r\n     */\r\n    private isVisible(index: number) {\r\n        let [leftVisibleX, rightVisibleX] = this.getListLeftRightVisiblePos()\r\n\r\n        let itemLeftX = this.getItemPosOffset(index)\r\n        let itemRightX = itemLeftX + this.getItemWidthWithSpacing(index)\r\n\r\n        //itemitem\r\n        return (itemLeftX >= leftVisibleX && itemLeftX <= rightVisibleX)\r\n            || (itemRightX >= leftVisibleX && itemRightX <= rightVisibleX)\r\n            //Item\r\n            || (itemLeftX <= leftVisibleX && itemRightX >= rightVisibleX)\r\n    }\r\n\r\n    protected update(dt: number) {\r\n        if (this._dirty) { //dirty\r\n            let data = this._data\r\n            for (let i = 0; i < this.getItemCount(); ++i) {\r\n                if (this.isVisible(i)) {//UI\r\n                    if (this.itemViewDirty.get(i)) {\r\n                        let child = this.getItemView(i)\r\n                        let component = child.getComponent(this.componentName)\r\n                        if (component == null) {\r\n                            throw \"ERROR! item view must implements\" + this.componentName + \" component!!\"\r\n                        }\r\n                        component.updateItem(i, data[i], this)\r\n                        //updateItem\r\n                        if (this.itemViewWidths[i] == undefined) {\r\n                            this.itemViewWidths[i] = component.getItemWidth() || this.itemWidth\r\n                        }\r\n                        let x = this.getItemPosOffset(i) + this.getItemWidthWithSpacing(i) * child.anchorX + this.leftOffset\r\n                        // console.log(\"TestV-----------index-->\" + i, \"yPos--->\" + y, \"height-->\" + this.itemViewHeights)\r\n                        child.setPosition(x, 0)\r\n                        this._sizeDirty = true\r\n\r\n                        this.itemViewDirty.set(i, false);\r\n                        // JmLobbyLog.Log(\"clear item view dirty-->\" + i)\r\n                        if (child.parent == null) {\r\n                            this.scrollView.content.addChild(child)\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            //showingViews, \r\n            this.showingViews.forEach((child: Node, index: number) => {\r\n                if (!this.isVisible(index) || this._data == null || this._data[index] == null) {\r\n                    // JmLobbyLog.Log(\"not visible, index = \" + index + \", child is\" + child)\r\n                    if (child != null) {\r\n                        this.recycleChild(index, child)\r\n                    }\r\n                }\r\n            })\r\n\r\n            this.checkFooterView()\r\n            // JmLobbyLog.Log(\"total Items:\" + this._data.length)\r\n            this._dirty = false\r\n        }\r\n        if (this._sizeDirty) {\r\n\r\n            let isRight = false\r\n            if (this._checkRight) {\r\n                isRight = this.isRight()\r\n            }\r\n            this.updateSize()\r\n            if (isRight) {\r\n                this.scrollView.scrollToOffset(new Vec2(this.scrollView.getMaxScrollOffset().x, 0))\r\n                this._dirty = true//scrollItemView\r\n            }\r\n            this._sizeDirty = false\r\n        }\r\n    }\r\n\r\n    //addOrUpdateFooterView\r\n    private checkFooterView() {\r\n        if (this.footerController == null) {\r\n            if (this.footer != null && this.pullLeftToLoadEnabled) {\r\n                // JmLobbyLog.Log(\"addFooter\")\r\n                let footerView = instantiate(this.footer)\r\n                let component = footerView.getComponent<JmRefreshFooter>(JmRefreshFooter)\r\n                this.footerController = component\r\n                this.scrollView.content.addChild(footerView)\r\n                component.setState(RefreshOrLoadState.NONE)\r\n            }\r\n        }\r\n        if (this.footerController != null) {\r\n            let viewBottomY = -this.getContentWidth() - this.footerWidth / 2\r\n            let contentBottomY = -this.scrollView.content.getComponent(UITransform).width + this.footerWidth / 2 + this.footerOffset\r\n            this.footerController.node.setPosition(Math.min(viewBottomY, contentBottomY), 0)\r\n        }\r\n    }\r\n\r\n    private recycleChild(index: number, child: Node) {\r\n        child.removeFromParent()\r\n        this.showingViews.delete(index)\r\n        this.recycledViews.push(child)\r\n        this.itemViewDirty.set(index, true);\r\n    }\r\n\r\n    private getItemCount() {\r\n        return this._data ? this._data.length : 0\r\n    }\r\n\r\n    private getItemView(index: number) {\r\n        let itemView = this.showingViews.get(index)\r\n        if (itemView == null) {\r\n            this.itemViewDirty.set(index, true);\r\n        }\r\n        if (itemView == null) {\r\n            itemView = this.recycledViews.pop()\r\n        }\r\n        if (itemView == null) {\r\n            this.itemViewDirty.set(index, true);\r\n            itemView = instantiate(this.itemPrefab)\r\n        }\r\n        this.showingViews.set(index, itemView)\r\n        return itemView\r\n    }\r\n\r\n\r\n    onScrollEvent(sender: any, event: any) {\r\n        switch (event) {\r\n            case ScrollView.EventType.SCROLLING:\r\n                this.startPullLeftLoad()\r\n                this._dirty = true\r\n                break\r\n            default:\r\n                // JmLobbyLog.Log(\"event-->\" + event)\r\n                break\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Item\r\n     */\r\n    private markChildrenDirty() {\r\n        for (let i = 0; i < this.getItemCount(); i++) {\r\n            this.itemViewDirty.set(i, true);\r\n        }\r\n    }\r\n\r\n    private isRight() {\r\n        return this.scrollView.getScrollOffset().x >= this.scrollView.getMaxScrollOffset().x\r\n    }\r\n\r\n    /**\r\n     * Item\r\n     * @param checkRight ListView\r\n     *\r\n     * fixme bugnotifyChange0.1\r\n     */\r\n    notifyChange(checkRight?: boolean) {\r\n        // if (this.getItemCount() == 0) {\r\n        //     if (this.emptyView) {\r\n        //         this.emptyView.active = true\r\n        //         if (JmNative.GetNetWorkState() == sys.NetworkType.NONE && this.noNetworkImg) {\r\n        //             this.emptyPic.spriteFrame = this.noNetworkImg\r\n        //         } else if (this.emptyImg) {\r\n        //             this.emptyPic.spriteFrame = this.emptyImg\r\n        //         }\r\n        //     }\r\n        // } else {\r\n        //     if (this.emptyView) {\r\n        //         this.emptyView.active = false\r\n        //     }\r\n        this._sizeDirty = true\r\n        this._checkRight = checkRight\r\n        this.markChildrenDirty()\r\n        // }\r\n        this._dirty = true\r\n    }\r\n\r\n    /**\r\n     * Item\r\n     */\r\n    notifyItemChange(index: number) {\r\n        this.itemViewDirty.set(index, true);\r\n        this._dirty = true\r\n    }\r\n\r\n    updateHeight(index: number, height: number) {\r\n        this.itemViewWidths[index] = height\r\n        this.notifyChange()\r\n    }\r\n\r\n    /**\r\n     * {@link JmListView#onLoadComplete()}\r\n     */\r\n    setPullLeftToLoadListener(listener: Function) {\r\n        this.onPullLeftToLoad = listener\r\n    }\r\n\r\n    private startPullLeftLoad() {\r\n        // JmLobbyLog.Log(\"startPullUpLoad\", this.refreshState, this.loadingState)\r\n        if (this.pullLeftToLoadEnabled && this.hasMore && this.loadingState != RefreshOrLoadState.REFRESHING && !this.isUserTouched) {\r\n            let [offset, maxOffset] = [this.scrollView.getScrollOffset().y, this.scrollView.getMaxScrollOffset().y]\r\n            //offset\r\n            if (Math.ceil(offset) >= Math.floor(maxOffset)) {\r\n                // JmLobbyLog.Log(\"PullUpToLoad\")\r\n                this.updateLoadingState(RefreshOrLoadState.REFRESHING)\r\n                if (this.onPullLeftToLoad) {\r\n                    this.onPullLeftToLoad()\r\n                }\r\n\r\n                /***/\r\n                // this.scheduleOnce(() => {\r\n                //     if (this._data.length > 0) {\r\n                //         this._data.push(this._data[0])\r\n                //     }\r\n                //     this.onLoadComplete(true)\r\n                // }, 2)\r\n            } else {\r\n                // JmLobbyLog.Log(\"offset--->\" + offset, \"maxOffset-->\" + maxOffset)\r\n            }\r\n        }\r\n    }\r\n\r\n    onLoadComplete(hasMore: boolean = true) {\r\n        this.hasMore = hasMore\r\n        if (hasMore) {\r\n            this.updateLoadingState(RefreshOrLoadState.NONE)\r\n        } else {\r\n            this.updateLoadingState(RefreshOrLoadState.COMPLETE)\r\n        }\r\n        // JmLobbyLog.Log(\"loading done\")\r\n        this.notifyChange()\r\n    }\r\n\r\n    private updateLoadingState(state: RefreshOrLoadState) {\r\n        if (this.loadingState != state) {\r\n            this.loadingState = state\r\n            this.onLoadingStateChange(state)\r\n        }\r\n    }\r\n\r\n    private onLoadingStateChange(newState: RefreshOrLoadState) {\r\n        // JmLobbyLog.Log(\"onLoadingStateChange-->\" + this.loadingState)\r\n        this.footerController && this.footerController.setState(newState)\r\n    }\r\n}","import JmRefreshHeader from \"./JmRefreshHeader\";\r\nimport JmRefreshFooter from \"./JmRefreshFooter\";\r\nimport { RefreshOrLoadState } from \"./RefreshOrLoadState\";\r\nimport { _decorator, Component, Node, UITransform, Prefab, Sprite, SpriteFrame, ScrollView, Vec2, instantiate, sys, EventTouch } from 'cc';\r\nimport BaseView from \"db://app/base/BaseView\";\r\n// import { sysDefine } from \"./sysDefine\";\r\n// import { AssetsCfg } from \"./AssetsCfg\";\r\nconst { ccclass, property } = _decorator;\r\n\r\n\r\n@ccclass('JmListView')\r\n//@requireComponent(ScrollView)\r\n//@menu(\"UI /JmListView\")\r\nexport default class JmListView extends BaseView {\r\n    @property(Prefab)\r\n    itemPrefab: Prefab = null\r\n\r\n    @property\r\n    itemHeight: number = 0\r\n    @property(Node)\r\n    emptyView: Node = null\r\n    @property(Sprite)\r\n    emptyPic: Sprite = null\r\n    @property(SpriteFrame)\r\n    noNetworkImg: SpriteFrame = null\r\n    @property(SpriteFrame)\r\n    emptyImg: SpriteFrame = null\r\n\r\n    @property\r\n    spacing = 0\r\n    @property\r\n    topMargin = 0\r\n    @property\r\n    bottomMargin = 0\r\n\r\n    @property\r\n    pullDownToRefreshEnabled = false\r\n    private headerController: JmRefreshHeader\r\n    private onPullDownToRefresh: Function\r\n\r\n    @property\r\n    pullUpToLoadEnabled = false\r\n    @property\r\n    footerOffset = 0\r\n    @property\r\n    refreshFooterShow = true\r\n    private footerController: JmRefreshFooter\r\n    private onPullUpToLoad: Function\r\n    private hasMore: boolean = true\r\n\r\n    scrollView: ScrollView\r\n    header: Prefab;\r\n    headerHeight = 300\r\n    footer: Prefab;\r\n    footerHeight = 250\r\n\r\n    private _touchStartY = 0\r\n    private _touchStartFromTop = false\r\n\r\n    //\r\n    private isUserTouched = false;\r\n    private refreshState: RefreshOrLoadState = RefreshOrLoadState.NONE\r\n    private loadingState: RefreshOrLoadState = RefreshOrLoadState.NONE\r\n\r\n    private componentName: string = \"JmListViewItem\"\r\n\r\n    private footerHolderHeight = 0;//itemView\r\n\r\n    private showingViews = new Map<number, any>()\r\n    private recycledViews = new Array<any>()\r\n    private itemViewDirty = new Map<number, boolean>()//View\r\n    private itemViewHeights = new Array<number>()//View\r\n\r\n    private _data = new Array<any>()\r\n\r\n    private _dirty = false//ListView\r\n    private _sizeDirty = false//ListViewcontent\r\n    private _checkBottom = false\r\n\r\n    private extraData: any = {}\r\n\r\n    protected onLoad() {\r\n        this.scrollView = this.node.getComponent(ScrollView)\r\n        //prefab\r\n        //if (this.pullDownToRefreshEnabled) {\r\n            // JmLobbyLoaderMgr.LoadAssetCfg(HoldOnAssetsCfg.HoldOnRefreshHeader).then((header: Prefab) => {\r\n            //     this.header = header\r\n            // })\r\n            // Jm.AssetManager.loadResInBundle(SysDefine.bundleName, HoldOnAssetsCfg.HoldOnRefreshHeader, function (err, header) {\r\n            //     this.header = header\r\n            // })\r\n        //}\r\n        //if (this.pullUpToLoadEnabled && this.refreshFooterShow) {\r\n            // JmLobbyLoaderMgr.LoadAssetCfg(HoldOnAssetsCfg.HoldOnRefreshFooter).then((footer: Prefab) => {\r\n            //     this.footer = footer\r\n            // })\r\n            // let self = this\r\n            // let self1 = this.footer\r\n            // Jm.AssetManager.loadResInBundle(sysDefine.bundleName, AssetsCfg.RefreshFooter, function (err, footer: Prefab) {\r\n            //     self.footer = footer\r\n            // })\r\n        //}\r\n\r\n        if (!this.scrollView.elastic && this.scrollView.bounceDuration > 0 && this.pullDownToRefreshEnabled) {\r\n            //scrollViewelastic\r\n            //bounceDuration0updatecontent\r\n            console.log(\"set elastic true or pullRefresh Events will not work!!\")\r\n        }\r\n        if (this.scrollView.cancelInnerEvents) {\r\n            //cancelInnerEventstrueItemViewcancel\r\n            // JmLobbyLog.Error(\"do not set cancelInnerEvent true, it'll effect Refresh Events!!\")\r\n            this.scrollView.cancelInnerEvents = false\r\n        }\r\n    }\r\n\r\n    protected onEnable() {\r\n        this.scrollView.node.on(Node.EventType.TOUCH_START, this.onTouchStart, this)\r\n        this.scrollView.node.on(Node.EventType.TOUCH_MOVE, this.onTouchMove, this)\r\n        this.scrollView.node.on(Node.EventType.TOUCH_END, this.onTouchEnd, this)\r\n        this.scrollView.node.on(Node.EventType.TOUCH_CANCEL, this.onTouchCancel, this)\r\n    }\r\n\r\n    protected onDisable() {\r\n        this.scrollView.node.off(Node.EventType.TOUCH_START, this.onTouchStart, this)\r\n        this.scrollView.node.off(Node.EventType.TOUCH_MOVE, this.onTouchMove, this)\r\n        this.scrollView.node.off(Node.EventType.TOUCH_END, this.onTouchEnd, this)\r\n        this.scrollView.node.off(Node.EventType.TOUCH_CANCEL, this.onTouchCancel, this)\r\n    }\r\n\r\n    onDestroy() {\r\n        // Util.ReleaseAsset(this.itemPrefab);\r\n    }\r\n\r\n    onTouchStart(event: EventTouch) {\r\n        // JmLobbyLog.console.log(\"onTouchStart\")\r\n        this.isUserTouched = true\r\n        this._touchStartY = event.getLocationY()\r\n        this._touchStartFromTop = Math.floor(this.scrollView.getScrollOffset().y) <= 1//scrollOffset\r\n\r\n        // JmLobbyLog.console.log(`isTop-->${this._touchStartFromTop}, startY-->${this._touchStartY}`)\r\n    }\r\n\r\n    onTouchMove(event: EventTouch) {\r\n        if (!this.pullDownToRefreshEnabled) return\r\n        let offsetY = event.getLocationY() - this._touchStartY\r\n        // JmLobbyLog.console.log(\"getLocationY-->\" + event.getLocationY())\r\n        if (this.isUserTouched) {//touch\r\n            this.checkPullDownRefresh(offsetY)\r\n            this.headerController && this.headerController.onScrollOffset(offsetY)\r\n        }\r\n    }\r\n\r\n    onTouchEnd() {\r\n        // JmLobbyLog.console.log(\"onTouchEnd\")\r\n        this.startPullDownRefresh()\r\n        this.isUserTouched = false\r\n    }\r\n\r\n    onTouchCancel() {\r\n        // JmLobbyLog.console.log(\"onTouchCancel\")\r\n        this.startPullDownRefresh()\r\n        this.isUserTouched = false\r\n    }\r\n\r\n    getData() {\r\n        return this._data || []\r\n    }\r\n\r\n    setData(data?: any) {\r\n        this._data = data\r\n    }\r\n\r\n    private updateSize() {\r\n        if (this.scrollView.horizontal || !this.scrollView.vertical) {\r\n            console.log(\"scroll orientation must set vertical in ListView!\")\r\n            return\r\n        }\r\n\r\n        // if (this.refreshState == RefreshOrLoadState.REFRESHING) {\r\n        //     height = height + 100\r\n        // }\r\n        let height = this.scrollView.content.getComponent(UITransform).height\r\n        let newHeight = this.getNormalContentHeight()\r\n        this.scrollView.content.getComponent(UITransform).height = newHeight\r\n        if (height > newHeight) {\r\n            this.notifyChange()\r\n        }\r\n    }\r\n\r\n    getNormalContentHeight() {\r\n        let height = this.getContentHeight()// get total content height\r\n        // console.log(\"contentHeight-->\", height, this.getItemCount())\r\n        if (this.pullUpToLoadEnabled && this.refreshFooterShow) {\r\n            height = height + this.footerHeight\r\n        }\r\n        if (height < this.scrollView.node.getComponent(UITransform).height) {\r\n            this.footerHolderHeight = this.scrollView.node.getComponent(UITransform).height - height\r\n            //ViewView \r\n            height = this.scrollView.node.getComponent(UITransform).height\r\n        }\r\n        return height\r\n    }\r\n\r\n    /**\r\n     * Item\r\n     */\r\n    setComponentName(name: string) {\r\n        this.componentName = name\r\n    }\r\n\r\n    setTopMargin(num: number) {\r\n        this.topMargin = num\r\n    }\r\n\r\n    getContentHeight() {\r\n        return this.getItemPosOffset(this.getItemCount()) + this.topMargin + this.bottomMargin;\r\n    }\r\n\r\n    private getItemPosOffset(index: number) {\r\n        let sum = 0\r\n        for (let i = 0; i < index; i++) {\r\n            sum += this.getItemHeightWithSpacing(i)\r\n        }\r\n        return sum\r\n    }\r\n\r\n    /**\r\n     * indexitem\r\n     */\r\n    private getItemHeightWithSpacing(index?: number) {\r\n        if (index != undefined) {\r\n            return (this.itemViewHeights[index] || this.itemHeight) + this.spacing\r\n        }\r\n        return this.itemHeight + this.spacing\r\n    }\r\n\r\n    private getListTopBottomVisiblePos() {\r\n        //scrollY (scrollView.node.getComponent(UITransform).height/2) ~ (scrollView.content.height - scrollView.node.getComponent(UITransform).height/2)\r\n        let scrollY = this.scrollView.content.position.y\r\n        let halfHeight = this.scrollView.node.getComponent(UITransform).height / 2\r\n        let topVisibleY = scrollY - halfHeight\r\n        let bottomVisibleY = scrollY + halfHeight\r\n        bottomVisibleY += this.headerHeight//headerHeight\r\n        return [topVisibleY, bottomVisibleY]\r\n    }\r\n\r\n    /**\r\n     * Item\r\n     * @param index\r\n     * @private\r\n     */\r\n    private isVisible(index: number) {\r\n        let [topVisibleY, bottomVisibleY] = this.getListTopBottomVisiblePos()\r\n\r\n        let itemTopY = this.getItemPosOffset(index) + this.topMargin\r\n        let itemBottomY = itemTopY + this.getItemHeightWithSpacing(index)\r\n\r\n        //itemitem\r\n        return (itemTopY >= topVisibleY && itemTopY <= bottomVisibleY)\r\n            || (itemBottomY >= topVisibleY && itemBottomY <= bottomVisibleY)\r\n            //Item\r\n            || (itemTopY <= topVisibleY && itemBottomY >= bottomVisibleY)\r\n    }\r\n\r\n    protected update(dt: number) {\r\n        if (this.pullDownToRefreshEnabled && this.refreshState == RefreshOrLoadState.REFRESHING) {\r\n            //this.scrollView.content.position.y = this.scrollView.node.getComponent(UITransform).height / 2 - this.headerHeight\r\n            this.scrollView.content.setPosition(this.scrollView.node.getComponent(UITransform).width / 2, this.scrollView.node.getComponent(UITransform).height / 2 - this.headerHeight)\r\n        }\r\n        if (this._dirty) { //dirty\r\n            let data = this._data\r\n            for (let i = 0; i < this.getItemCount(); ++i) {\r\n                if (this.isVisible(i)) {//UI\r\n                    if (this.itemViewDirty.get(i)) {\r\n                        let child = this.getItemView(i)\r\n                        if (child == null) {\r\n                            console.log(`JmListView Child Is Null! ${this.componentName}`)\r\n                            return;\r\n                        }\r\n                        let component = child.getComponent(this.componentName)\r\n                        if (component == null) {\r\n                            throw \"ERROR! item view must implements\" + this.componentName + \" component!!\"\r\n                        }\r\n                        component.updateItem(i, data[i], this)\r\n                        //updateItem\r\n                        if (this.itemViewHeights[i] == undefined) {\r\n                            this.itemViewHeights[i] = this.itemHeight//component.getItemHeight() || this.itemHeight\r\n                        }\r\n                        let y = -this.getItemPosOffset(i) - this.getItemHeightWithSpacing(i) * (1 - child.getComponent(UITransform).anchorY) - this.topMargin\r\n                        // console.log(\"TestV-----------index-->\" + i, \"yPos--->\" + y, \"height-->\" + this.itemViewHeights)\r\n                        child.setPosition(0, y)\r\n                        this._sizeDirty = true\r\n\r\n                        this.itemViewDirty.set(i, false);\r\n                        // JmLobbyLog.console.log(\"clear item view dirty-->\" + i)\r\n                        if (child.parent == null) {\r\n                            this.scrollView.content.addChild(child)\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            //showingViews, \r\n            this.showingViews.forEach((child: Node, index: number) => {\r\n                if (!this.isVisible(index) || this._data == null || (this._data.length - 1) < index) {\r\n                    // JmLobbyLog.console.log(\"not visible, index = \" + index + \", child is\" + child)\r\n                    if (child != null) {\r\n                        this.recycleChild(index, child)\r\n                    }\r\n                }\r\n            })\r\n\r\n            this.checkHeaderView()\r\n            this.checkFooterView()\r\n            // JmLobbyLog.console.log(\"total Items:\" + this._data.length)\r\n            this._dirty = false\r\n        }\r\n        if (this._sizeDirty) {\r\n\r\n            let isBottom = false\r\n            if (this._checkBottom) {\r\n                isBottom = this.isBottom()\r\n            }\r\n            this.updateSize()\r\n            if (isBottom) {\r\n                this.scrollView.scrollToOffset(new Vec2(0, this.scrollView.getMaxScrollOffset().y))\r\n                this._dirty = true//scrollItemView\r\n            }\r\n            this._sizeDirty = false\r\n        }\r\n    }\r\n\r\n    //addOrUpdateHeaderView\r\n    private checkHeaderView() {\r\n        if (this.headerController == null) {\r\n            if (this.header != null && this.pullDownToRefreshEnabled) {\r\n                // JmLobbyLog.console.log(\"addHeader\")\r\n                let headerView = instantiate(this.header)\r\n                headerView.setPosition(0, this.headerHeight / 2 - this.topMargin)\r\n                this.scrollView.content.addChild(headerView)\r\n                let component = headerView.getComponent<JmRefreshHeader>(JmRefreshHeader)\r\n                component.setState(this.refreshState)\r\n                this.headerController = component\r\n            }\r\n        }\r\n    }\r\n\r\n    //addOrUpdateFooterView\r\n    private checkFooterView() {\r\n        if (this.footerController == null) {\r\n            if (this.footer != null && this.pullUpToLoadEnabled) {\r\n                // JmLobbyLog.console.log(\"addFooter\")\r\n                let footerView = instantiate(this.footer)\r\n                this.scrollView.content.addChild(footerView)\r\n                let component = footerView.getComponent<JmRefreshFooter>(JmRefreshFooter)\r\n                component.setState(RefreshOrLoadState.NONE)\r\n                this.footerController = component\r\n            }\r\n        }\r\n        if (this.footerController != null) {\r\n            let viewBottomY = -this.getContentHeight() - this.footerHeight / 2\r\n            let contentBottomY = -this.scrollView.content.getComponent(UITransform).height + this.footerHeight / 2 + this.footerOffset\r\n            this.footerController.node.setPosition(0, Math.min(viewBottomY, contentBottomY) + this.bottomMargin)\r\n        }\r\n    }\r\n\r\n    private recycleChild(index: number, child: Node) {\r\n        child.removeFromParent()\r\n        this.showingViews.delete(index)\r\n        this.recycledViews.push(child)\r\n        this.itemViewDirty.set(index, true);\r\n    }\r\n\r\n    private getItemCount() {\r\n        return this._data ? this._data.length : 0\r\n    }\r\n\r\n    private getItemView(index: number) {\r\n        let itemView = this.showingViews.get(index)\r\n        if (itemView != null) {\r\n            // JmLobbyLog.console.log(\"getFromShowingViews-->\" + index)\r\n        } else {\r\n            // JmLobbyLog.console.log(\"mark item view dirty-->\" + index)\r\n            this.itemViewDirty.set(index, true);\r\n        }\r\n        if (itemView == null) {\r\n            itemView = this.recycledViews.pop()\r\n        }\r\n        if (itemView == null) {\r\n            itemView = instantiate(this.itemPrefab)\r\n            this.itemViewDirty.set(index, true);\r\n        }\r\n        this.showingViews.set(index, itemView)\r\n        return itemView\r\n    }\r\n    onScrollEvent(sender: any, event: any) {\r\n        // if (event == ScrollView.EventType.SCROLLING) {\r\n        if (event == 4) {\r\n            if (this.pullUpToLoadEnabled) {\r\n                this.checkPullUpLoad()\r\n            }\r\n            this._dirty = true\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Item\r\n     */\r\n    private markChildrenDirty() {\r\n        for (let i = 0; i < this.getItemCount(); i++) {\r\n            this.itemViewDirty.set(i, true);\r\n        }\r\n    }\r\n\r\n    private isBottom() {\r\n        return this.scrollView.getScrollOffset().y >= this.scrollView.getMaxScrollOffset().y\r\n    }\r\n\r\n    /**\r\n     * Item\r\n     * @param checkBottom ListView\r\n     *\r\n     * fixme bugnotifyChange0.1\r\n     */\r\n    notifyChange(checkBottom?: boolean) {\r\n        if (this.getItemCount() == 0) {\r\n            if (this.emptyView) {\r\n                this.emptyView.active = true\r\n                if (sys.getNetworkType() == sys.NetworkType.NONE && this.noNetworkImg) {\r\n                    this.emptyPic.spriteFrame = this.noNetworkImg\r\n                } else if (this.emptyImg) {\r\n                    this.emptyPic.spriteFrame = this.emptyImg\r\n                }\r\n                this.updateLoadingState(RefreshOrLoadState.NONE)\r\n            }\r\n        } else {\r\n            if (this.emptyView) {\r\n                this.emptyView.active = false\r\n            }\r\n            this._sizeDirty = true\r\n            this._checkBottom = checkBottom\r\n            this.markChildrenDirty()\r\n        }\r\n        this._dirty = true\r\n    }\r\n\r\n    /**\r\n     * Item\r\n     */\r\n    notifyItemChange(index: number) {\r\n        this.itemViewDirty.set(index, true);\r\n        this._dirty = true\r\n    }\r\n\r\n    updateHeight(index: number, height: number) {\r\n        this.itemViewHeights[index] = height\r\n        this.notifyChange()\r\n    }\r\n\r\n    /**\r\n     * {@link JmListView#onLoadComplete()}\r\n     */\r\n    setPullUpToLoadListener(listener: Function) {\r\n        this.onPullUpToLoad = listener\r\n    }\r\n\r\n    /**\r\n     * {@link JmListView#onRefreshComplete()}\r\n     */\r\n    setPullDownToRefreshListener(listener: Function) {\r\n        this.onPullDownToRefresh = listener\r\n    }\r\n\r\n    private checkPullDownRefresh(offsetY: number) {\r\n        if (this.pullDownToRefreshEnabled && this.refreshState != RefreshOrLoadState.REFRESHING && this.loadingState != RefreshOrLoadState.REFRESHING) {\r\n            if (this._touchStartFromTop && offsetY < -this.headerHeight * 1.5) {\r\n                this.updateRefreshState(RefreshOrLoadState.READY_TO_REFRESH)\r\n            } else {\r\n                this.updateRefreshState(RefreshOrLoadState.NONE)\r\n            }\r\n        }\r\n    }\r\n\r\n    private checkPullUpLoad() {\r\n        // JmLobbyLog.console.log(\"checkPullUpLoad\", this.refreshState, this.loadingState)\r\n        if (this.pullUpToLoadEnabled && this.hasMore && this.loadingState != RefreshOrLoadState.REFRESHING && this.refreshState != RefreshOrLoadState.REFRESHING && !this.isUserTouched) {\r\n            let [offset, maxOffset] = [this.scrollView.getScrollOffset().y, this.scrollView.getMaxScrollOffset().y]\r\n            //offset\r\n            if (Math.ceil(offset) >= Math.floor(maxOffset)) {\r\n                // JmLobbyLog.console.log(\"PullUpToLoad\")\r\n                this.updateLoadingState(RefreshOrLoadState.REFRESHING)\r\n                if (this.onPullUpToLoad) {\r\n                    this.onPullUpToLoad()\r\n                }\r\n\r\n                /***/\r\n                // this.scheduleOnce(() => {\r\n                //     if (this._data.length > 0) {\r\n                //         this._data.push(this._data[0])\r\n                //     }\r\n                //     this.onLoadComplete(true)\r\n                // }, 2)\r\n            } else {\r\n                // JmLobbyLog.console.log(\"offset--->\" + offset, \"maxOffset-->\" + maxOffset)\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * \r\n     */\r\n    pullDownRefresh() {\r\n        this.scrollView.stopAutoScroll()\r\n        //this.scrollView.content.position.y = this.scrollView.node.getComponent(UITransform).height / 2 - this.headerHeight\r\n        this.scrollView.content.setPosition(this.scrollView.node.getComponent(UITransform).width / 2, this.scrollView.node.getComponent(UITransform).height / 2 - this.headerHeight)\r\n        this._dirty = true\r\n        this.updateRefreshState(RefreshOrLoadState.REFRESHING)\r\n        this.scheduleOnce(() => {//REFRESHING\r\n            if (this.onPullDownToRefresh != null) {\r\n                this.onPullDownToRefresh()\r\n            }\r\n        }, 1.5)\r\n    }\r\n\r\n    private startPullDownRefresh() {\r\n        // JmLobbyLog.console.log(\"startPullDownRefresh\", this.refreshState, this.loadingState)\r\n        if (this.pullDownToRefreshEnabled && this.refreshState == RefreshOrLoadState.READY_TO_REFRESH && this.loadingState != RefreshOrLoadState.REFRESHING) {\r\n            this.updateRefreshState(RefreshOrLoadState.REFRESHING)\r\n            this.scheduleOnce(() => {//REFRESHING\r\n                if (this.onPullDownToRefresh != null) {\r\n                    this.onPullDownToRefresh()\r\n                }\r\n            }, 1.5)\r\n            /***/\r\n            // this.scheduleOnce(() => {\r\n            //     this.onRefreshComplete()\r\n            // }, 2)\r\n        } else {\r\n            this.headerController && this.headerController.onScrollOffset(0)\r\n        }\r\n    }\r\n\r\n    onRefreshComplete(scrollToTop = true) {\r\n        // JmLobbyLog.console.log(\"refresh done\")\r\n        let hasMore = this.hasMore = this.getItemCount() > 0\r\n        if (hasMore) {\r\n            this.updateLoadingState(RefreshOrLoadState.NONE)\r\n        } else {\r\n            this.updateLoadingState(RefreshOrLoadState.EMPTY)\r\n        }\r\n\r\n        if (scrollToTop) {\r\n            // this.updateRefreshState(RefreshOrLoadState.COMPLETING)\r\n            // this.scrollView.content.stopAllActions()\r\n            // let move = cc.moveTo(0.1, cc.v2(0, this.scrollView.node.getComponent(UITransform).height / 2))\r\n            // let delay = cc.delayTime(0.3)\r\n            // let finish = cc.callFunc(() => {\r\n            //     this.updateRefreshState(RefreshOrLoadState.NONE)\r\n            // })\r\n            // this.headerController && this.headerController.onScrollOffset(0)\r\n            // this.scrollView.content.runAction(cc.sequence(move, delay, finish))\r\n        } else {\r\n            this.updateRefreshState(RefreshOrLoadState.NONE)\r\n        }\r\n\r\n        this.notifyChange()\r\n    }\r\n\r\n    stopPullDownRefresh() {\r\n        this.updateRefreshState(RefreshOrLoadState.COMPLETING)\r\n        //this.scrollView.content.stopAllActions()\r\n        this.headerController && this.headerController.onScrollOffset(0)\r\n        //this.scrollView.content.position.y = this.scrollView.node.getComponent(UITransform).height / 2\r\n        this.scrollView.content.setPosition(this.scrollView.node.getComponent(UITransform).width / 2, this.scrollView.node.getComponent(UITransform).height / 2)\r\n    }\r\n\r\n    onLoadComplete(hasMore: boolean = true) {\r\n        this.hasMore = hasMore\r\n        if (hasMore) {\r\n            this.updateLoadingState(RefreshOrLoadState.NONE)\r\n        } else {\r\n            this.updateLoadingState(RefreshOrLoadState.COMPLETE)\r\n        }\r\n        // JmLobbyLog.console.log(\"loading done\")\r\n        this.notifyChange()\r\n    }\r\n\r\n    private updateRefreshState(state: RefreshOrLoadState) {\r\n        if (this.refreshState != state) {\r\n            // JmLobbyLog.console.log(\"updateRefreshState-->\", this.refreshState, state)\r\n            this.refreshState = state\r\n            this.onRefreshStateChange(state)\r\n        }\r\n    }\r\n\r\n    private onRefreshStateChange(newState: RefreshOrLoadState) {\r\n        // JmLobbyLog.console.log(\"onRefreshStateChange-->\" + this.refreshState)\r\n        this.headerController && this.headerController.setState(newState)\r\n    }\r\n\r\n    private updateLoadingState(state: RefreshOrLoadState) {\r\n        if (this.loadingState != state) {\r\n            this.loadingState = state\r\n            this.onLoadingStateChange(state)\r\n        }\r\n    }\r\n\r\n    private onLoadingStateChange(newState: RefreshOrLoadState) {\r\n        // JmLobbyLog.console.log(\"onLoadingStateChange-->\" + this.loadingState)\r\n        this.footerController && this.footerController.setState(newState)\r\n    }\r\n\r\n    setExtraData(key: string, value: any) {\r\n        this.extraData[key] = value\r\n    }\r\n\r\n    getExtraData(key: string) {\r\n        return this.extraData[key]\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @return Component\r\n     */\r\n    static handleSuccess(result: Array<any>, isLoadMore: boolean, listView: JmListView, hasMore?: boolean, scrollToTop = true) {\r\n        if (!listView.node.isValid) return\r\n        let data = listView.getData()\r\n        let newData: Array<any>\r\n        if (isLoadMore) {\r\n            newData = data.concat(result)\r\n        } else if (Array.isArray(result)) {\r\n            newData = result\r\n        }\r\n        listView.setData(newData)\r\n        if (isLoadMore) {\r\n            listView.onLoadComplete(hasMore == undefined ? result.length > 0 : hasMore)\r\n        } else {\r\n            listView.onRefreshComplete(scrollToTop)\r\n        }\r\n    }\r\n\r\n    static handleFailure(listView: JmListView, loadMore: boolean, scrollToTop = true) {\r\n        if (!listView.node.isValid) return\r\n        if (loadMore) {\r\n            listView.onLoadComplete(true)\r\n        } else {\r\n            listView.onRefreshComplete(scrollToTop)\r\n        }\r\n    }\r\n\r\n}\r\n\r\nexport enum Orientation {\r\n    HORIZONTAL,\r\n    VERTICAL\r\n}","import JmListView from \"./JmListView\";\r\nimport JmHorizontalListView from \"./JmHorizontalListView\";\r\nimport { Component, EventTouch, Node, Vec2, _decorator } from \"cc\";\r\nimport BaseView from \"db://app/base/BaseView\";\r\n\r\nconst { ccclass } = _decorator;\r\n\r\n@ccclass\r\nexport default class JmListViewItem extends BaseView {\r\n    protected itemId: number\r\n    protected listView: JmListView | JmHorizontalListView;\r\n    protected performClick = false\r\n    private startPos: Vec2//Touch\r\n\r\n    protected onLoad() {\r\n        super.onLoad && super.onLoad()\r\n    }\r\n\r\n    protected onEnable() {\r\n        this.node.on(Node.EventType.TOUCH_START, this.onTouchEvent, this)\r\n        this.node.on(Node.EventType.TOUCH_MOVE, this.onTouchEvent, this)\r\n        this.node.on(Node.EventType.TOUCH_END, this.onTouchEvent, this)\r\n    }\r\n\r\n    protected onDisable() {\r\n        this.node.off(Node.EventType.TOUCH_START, this.onTouchEvent, this)\r\n        this.node.off(Node.EventType.TOUCH_MOVE, this.onTouchEvent, this)\r\n        this.node.off(Node.EventType.TOUCH_END, this.onTouchEvent, this)\r\n    }\r\n\r\n    onTouchEvent(event: EventTouch) {\r\n        switch (event.getType()) {\r\n            case Node.EventType.TOUCH_START:\r\n                // JmLobbyLog.Log(\"TOUCH_START\")\r\n                this.performClick = true\r\n                this.startPos = event.getLocation()\r\n                break\r\n            case Node.EventType.TOUCH_MOVE:\r\n                // JmLobbyLog.Log(\"TOUCH_MOVE\")\r\n                let pos = event.getLocation()\r\n                let dstx = Math.abs(this.startPos.x - pos.x)\r\n                let dsty = Math.abs(this.startPos.y - pos.y)\r\n                if (dstx > 5 || dsty > 5) {//TOUCH_MOVE\r\n                    this.performClick = false\r\n                }\r\n\r\n                // let dst: Vec2 = this.startPos.sub(pos)\r\n                // if (dst.len() > 5) {//TOUCH_MOVE\r\n                //     this.performClick = false\r\n                // }\r\n                break\r\n            case Node.EventType.TOUCH_END:\r\n                if (this.performClick) {\r\n                    this.onItemClick(event)\r\n                }\r\n                this.performClick = false\r\n                break\r\n        }\r\n    }\r\n\r\n    onItemClick(event?: EventTouch) {\r\n        // JmLobbyLog.Log(\"ItemClicked, itemId-->\" + this.itemId)\r\n    }\r\n\r\n    updateItem(id: number, data: any, listView: JmListView | JmHorizontalListView) {\r\n        this.itemId = id\r\n        this.listView = listView\r\n        //\r\n    }\r\n\r\n    getItemHeight(): number {\r\n        return undefined\r\n    }\r\n\r\n    getItemWidth(): number {\r\n        return undefined\r\n    }\r\n\r\n}","import { Component, instantiate, isValid, NodePool, Prefab } from \"cc\";\n\nexport class JmNodePool extends NodePool {\n    private _cellPfb: Prefab;\n    get cellPfb() {\n        return this._cellPfb;\n    }\n\n    set cellPfb(value) {\n        this._cellPfb = value;\n    }\n}\n\nexport default class JmNodePoolMgr {\n    private static _nodePoolData: Map<string, JmNodePool> = new Map<string, JmNodePool>();\n\n    static IdentityCellPool: string = \"IDENTITY_CELL_POOL\";\n\n    /**\n     * */\n    static InitNodePool(poolKey: string, cellPfb: Prefab, poolHandlerComp?: string) {\n        this.DestroyPool(poolKey);\n\n        let pool = new JmNodePool(poolHandlerComp);\n        pool.cellPfb = cellPfb;\n        this._nodePoolData.set(poolKey, pool);\n    }\n\n    static GetCell(poolKey: string) {\n        let pool = this.GetPool(poolKey);\n        if (pool) {\n            let node;\n            if (pool.size()) {\n                node = pool.get();\n            } else {\n                node = instantiate(pool.cellPfb);\n            }\n            node.active = true;\n            return node;\n        }\n    }\n\n    static PutCell(poolKey: string, node: any) {\n        let pool = this.GetPool(poolKey);\n        if (pool) {\n            node.active = false;\n            pool.put(node);\n        }\n    }\n\n    static DestroyPool(poolKey: string) {\n        let pool = this._nodePoolData.get(poolKey);\n        if (pool) {\n            for (let i = 0; i < pool.size(); i++) {\n                let node = pool.get();\n                if (isValid(node, true)) {\n                    node.active = false;\n                    node.destroy();\n                }\n            }\n            pool.clear();\n            this._nodePoolData.delete(poolKey);\n        }\n    }\n\n    static GetPool(poolKey: string) {\n        let pool = this._nodePoolData.get(poolKey);\n        if (pool) {\n            return pool;\n        } else {\n            console.log(`JmNodePoolMgr.GetPool!The pool is null! please instance it! ${poolKey}`);\n        }\n    }\n}\n\n\n","import { RefreshOrLoadState } from \"./RefreshOrLoadState\";\r\nimport { _decorator, Component, Sprite, Label } from 'cc';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass\r\nexport default class JmRefreshFooter extends Component {\r\n\r\n    @property(Label)\r\n    loading: Label = null;\r\n    @property(Sprite)\r\n    emptyImg: Sprite = null;\r\n\r\n    setState(state: RefreshOrLoadState) {\r\n        switch (state) {\r\n            case RefreshOrLoadState.NONE:\r\n            case RefreshOrLoadState.EMPTY:\r\n                this.loading.node.active = false\r\n                this.emptyImg.node.active = false\r\n                break;\r\n            case RefreshOrLoadState.READY_TO_REFRESH:\r\n                break;\r\n            case RefreshOrLoadState.REFRESHING:\r\n                this.loading.node.active = true\r\n                this.loading.string = \"\"\r\n                this.emptyImg.node.active = false\r\n                break;\r\n            case RefreshOrLoadState.COMPLETE:\r\n                this.emptyImg.node.active = true\r\n                this.loading.node.active = false\r\n                break\r\n        }\r\n    }\r\n\r\n    start() {\r\n\r\n    }\r\n}\r\n","import { Component, Skeleton, _decorator } from \"cc\";\r\nimport { RefreshOrLoadState } from \"./RefreshOrLoadState\";\r\n\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass\r\nexport default class JmRefreshHeader extends Component {\r\n    @property(Skeleton)\r\n    refreshSpine: Skeleton = null\r\n\r\n    private _state = RefreshOrLoadState.NONE\r\n\r\n    start() {\r\n\r\n    }\r\n\r\n    onScrollOffset(offsetY: number) {\r\n        if (offsetY < -40) {\r\n            offsetY = -40\r\n        }\r\n        this.refreshSpine.node.y = offsetY - 50\r\n    }\r\n\r\n    setState(state: RefreshOrLoadState) {\r\n        this._state = state\r\n        // switch (state) {\r\n        //     case RefreshOrLoadState.NONE:\r\n        //         this.refreshSpine.setAnimation(0, \"refresh_1\", false)\r\n        //         break;\r\n        //     case RefreshOrLoadState.READY_TO_REFRESH:\r\n        //         this.refreshSpine.setAnimation(0, \"refresh_1\", false)\r\n        //         break;\r\n        //     case RefreshOrLoadState.REFRESHING:\r\n        //         this.refreshSpine.setAnimation(0, \"refresh_2\", true)\r\n        //         break;\r\n        // }\r\n    }\r\n\r\n}\r\n","/**\n * \n * */\nimport BaseData from \"./BaseData\";\n\nexport default class JmRoomData extends BaseData {\n    private _roomData: any;\n    constructor() {\n        super();\n        this._roomData = {};\n    }\n\n    initRoomData(roomData: object) {\n        this.updateRoomData(roomData);\n    }\n\n    updateRoomProperty(k: string, v: any) {\n        this._roomData[k] = v;\n    }\n\n    updateRoomData(roomData: any) {\n        if (this._roomData == null) {\n            this._roomData = {};\n        }\n        for (let k in roomData) {\n            this.updateRoomProperty(k, roomData[k]);\n        }\n    }\n\n    getIdentities() {\n        return this._roomData[\"identities\"];\n    }\n    getIdentity() {\n        return this._roomData[\"identity\"];\n    }\n\n    getRoomNum() {\n        return this._roomData[\"roomNum\"];\n    }\n\n    getSeats() {\n        return this._roomData[\"seats\"];\n    }\n}\n\n\n","/**\r\n * ,\r\n * */\r\nimport JmRoomData from \"../data/JmRoomData\";\r\nexport default class JmRoomDataMgr {\r\n    private static _roomsData: Map<string, JmRoomData> = new Map<string, JmRoomData>();\r\n    private static _roomsKeys: Array<string> = [];\r\n    private static _joinRoomsList: Array<string> = []; //\r\n    private static _offset: number = 0;\r\n    private static _currentRoomData: object;\r\n    private static _currentRoomKey: number;\r\n    private static currentType: number = 0;\r\n    private static _roomCfg: Map<number, number> = new Map<number, number>();\r\n    private static _roomCount: number = 0;\r\n    private static _gameState: number = 2;//0 1 2\r\n    private static _isDay: boolean = true;\r\n    private static _isOwner: boolean = false;\r\n    private static _loadKey: boolean = true;\r\n    /**\r\n     * */\r\n    static OnReceiveServerData(serverData:any) {\r\n        this.InitRoomsData(serverData);\r\n    }\r\n\r\n    static InitRoomsData(data: Array<object>) {\r\n        for (let i = 0, len = data.length; i < len; i++) {\r\n            this.InitRoomData(data[i]);\r\n        }\r\n    }\r\n    \r\n    static InitRoomData(data: any) {\r\n        let roomKey = data[\"recordId\"];\r\n        if (roomKey) {\r\n            let room = this.GetRoom(roomKey);\r\n            room.initRoomData(data);\r\n        }\r\n    }\r\n\r\n    static CreateRoom(roomData: object) {\r\n        this.InitCurrentRoom(roomData);\r\n    }\r\n\r\n    static CleanRooms() {\r\n        this._offset = 0;\r\n        this._roomsData.clear();\r\n        this._roomCfg.clear();\r\n        this._roomsKeys = [];\r\n        this._gameState = 2\r\n    }\r\n\r\n    static CleanRoom(roomKey: string) {\r\n        let room = this._roomsData.get(roomKey);\r\n        if (room) {\r\n            room = null;\r\n            this._roomsData.delete(roomKey);\r\n        }\r\n    }\r\n\r\n    static GetOffSet() {\r\n        return this._offset || 0;\r\n    }\r\n\r\n    static GetRoomByRoomKey(roomKey:any) {\r\n        let room = this._roomsData.get(roomKey);\r\n        if (room) {\r\n            return room;\r\n        }\r\n        return null;\r\n    }\r\n\r\n    static GetRoomNum() {\r\n        let roomData = this.GetRoomByRoomKey(this._currentRoomKey);\r\n        return roomData.getRoomNum();\r\n    }\r\n    \r\n    static GetRoomIdentities() {\r\n        let roomData = this.GetRoomByRoomKey(this._currentRoomKey);\r\n        return roomData.getIdentities();\r\n    }\r\n\r\n    static GetRoomIdentity() {\r\n        let roomData = this.GetRoomByRoomKey(this._currentRoomKey);\r\n        return roomData.getIdentity();\r\n    }\r\n\r\n    static GetRoomSeats() {\r\n        let roomData = this.GetRoomByRoomKey(this._currentRoomKey);\r\n        return roomData.getSeats();\r\n    }\r\n\r\n    static InitCurrentRoomProto(roomData: any) {\r\n        let roomKey = roomData[\"recordId\"]\r\n        this._roomCount = roomData[\"players\"]\r\n        let room = this.GetRoom(roomKey);\r\n        room.initRoomData(roomData);\r\n        this._gameState = roomData[\"status\"]\r\n        this._currentRoomData = roomData;\r\n        this._currentRoomKey = roomKey;\r\n        this._joinRoomsList.unshift(roomData[\"roomNum\"]);\r\n    }\r\n\r\n    //\r\n    static InitCurrentRoom(roomData: any) {\r\n        console.log(`JmRoomDataMgr.InitCurrentRoom ${JSON.stringify(roomData)}`);\r\n\r\n        let roomKey = roomData[\"recordId\"]\r\n        this._isOwner = roomData[\"judge\"]\r\n        this._roomCount = roomData[\"players\"]\r\n        let room = this.GetRoom(roomKey);\r\n        room.initRoomData(roomData);\r\n        this._gameState = roomData[\"status\"]\r\n        this._currentRoomData = roomData;\r\n        this._currentRoomKey = roomKey;\r\n        this._joinRoomsList.unshift(roomData[\"roomNum\"]);\r\n    }\r\n\r\n    static GetRoom(roomKey: string) {\r\n        let room = this._roomsData.get(roomKey);\r\n        if (!room) {\r\n            room = new JmRoomData();\r\n            this._roomsData.set(roomKey, room);\r\n            this._roomsKeys.push(roomKey);\r\n        }\r\n        return room;\r\n    }\r\n\r\n    static GetCurrentRoomInfo() {\r\n        return this._currentRoomData;\r\n    }\r\n\r\n    static GetCurrentRoomKey() {\r\n        return this._currentRoomKey || 0;\r\n    }\r\n\r\n\r\n    static SetCurrentNullRoomKey() {\r\n        this._currentRoomKey = null;\r\n    }\r\n\r\n    static SetRoomDayOrNight(currentType:number) {\r\n        this.currentType = currentType;\r\n    }\r\n    static GetRoomDayOrNight() {\r\n        return this.currentType;\r\n    }\r\n    static delRoomCfg(key:any) {\r\n        this._roomCfg.delete(key);\r\n    }\r\n    static setRoomCfg(key:any, vule:any) {\r\n        this._roomCfg.set(key, vule);\r\n    }\r\n    static getRoomCfg() {\r\n        return this._roomCfg;\r\n    }\r\n\r\n    static getRoomCount() {\r\n        return this._roomCount\r\n    }\r\n    static setRoomCount(count:number) {\r\n        this._roomCount = count\r\n    }\r\n\r\n    static setGameState(state:number) {\r\n        this._gameState = state\r\n    }\r\n    static getGameState() {\r\n        return this._gameState\r\n    }\r\n\r\n    static setGameDay(bol:boolean) {\r\n        this._isDay = bol\r\n    }\r\n    static getGameDay() {\r\n        return this._isDay;\r\n    }\r\n\r\n    static setOwner(bol:boolean) {\r\n        this._isOwner = bol\r\n    }\r\n    static isOwner() {\r\n        return this._isOwner\r\n    }\r\n    static getLoadKey() {\r\n        return this._loadKey\r\n    }\r\n    static setLoadKey(bol:boolean) {\r\n        this._loadKey = bol\r\n    }\r\n}\r\n\r\n\r\n","import { Asset, AssetManager, Font, ImageAsset, JsonAsset, Label, SceneAsset, Sprite, SpriteFrame, Texture2D, TextureCube, _decorator, assetManager, isValid, path, sp } from 'cc';\r\nimport { MINIGAME } from 'cc/env';\r\nimport BaseManager from '../../base/BaseManager';\r\nimport Core from '../../Core';\r\nconst { ccclass } = _decorator;\r\nconst REGEX = /^https?:\\/\\/.*/;\r\n\r\nclass Command {\r\n    private static cache: Command[] = [];\r\n\r\n    static create(onComplete: (items: unknown) => void, onProgress: (finish: number, total: number, item: AssetManager.RequestItem) => void = null) {\r\n        const command = Command.cache.pop() || new Command();\r\n        onProgress && command.onProgress.push(onProgress);\r\n        onComplete && command.onComplete.push(onComplete);\r\n        return command;\r\n    }\r\n\r\n    static put(command: Command) {\r\n        command.onProgress.length = 0;\r\n        command.onComplete.length = 0;\r\n        Command.cache.push(command);\r\n    }\r\n\r\n    onProgress: Array<(finish: number, total: number, item: AssetManager.RequestItem) => void> = [];\r\n    onComplete: Array<(items: unknown) => void> = [];\r\n\r\n    private constructor() { }\r\n}\r\n\r\nclass Loader {\r\n    private assetMap = new Map<string, Asset>();\r\n    private loadingMap = new Map<string, Command>();\r\n\r\n    /**\r\n     * \r\n     * @param params.bundle resources, bundlebundleurl(urlbundle)https://docs.cocos.com/creator/manual/zh/asset/bundle.html#%E5%8A%A0%E8%BD%BD-asset-bundle\r\n     * @param params.version bundlehttps://docs.cocos.com/creator/manual/zh/asset/bundle.html#asset-bundle-%E7%9A%84%E7%89%88%E6%9C%AC\r\n     */\r\n    public preload(params: { path: string, bundle?: string, version?: string, type?: typeof Asset, onProgress?: (finish: number, total: number, item: AssetManager.RequestItem) => void, onComplete?: (item: AssetManager.RequestItem[] | null) => void }) {\r\n        return Core.inst.manager.loader.preload(params);\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param params.bundle resources, bundlebundleurl(urlbundle)https://docs.cocos.com/creator/manual/zh/asset/bundle.html#%E5%8A%A0%E8%BD%BD-asset-bundle\r\n     * @param params.version bundlehttps://docs.cocos.com/creator/manual/zh/asset/bundle.html#asset-bundle-%E7%9A%84%E7%89%88%E6%9C%AC\r\n     */\r\n    public preloadDir(params: { path: string, bundle?: string, version?: string, type?: typeof Asset, onProgress?: (finish: number, total: number, item: AssetManager.RequestItem) => void, onComplete?: (items: AssetManager.RequestItem[] | null) => void }) {\r\n        return Core.inst.manager.loader.preloadDir(params);\r\n    }\r\n\r\n    /**\r\n     * bundle\r\n     * @param params.bundle resources, bundlebundleurl(urlbundel)https://docs.cocos.com/creator/manual/zh/asset/bundle.html#%E5%8A%A0%E8%BD%BD-asset-bundle\r\n     * @param params.version bundlehttps://docs.cocos.com/creator/manual/zh/asset/bundle.html#asset-bundle-%E7%9A%84%E7%89%88%E6%9C%AC\r\n     * @param params.path bundle\r\n     * @param params.type \r\n     */\r\n    public load<T extends typeof Asset>(params: { path: string, bundle?: string, version?: string, type?: T, onProgress?: (finish: number, total: number, item: AssetManager.RequestItem) => void, onComplete?: (item: InstanceType<T> | null) => void }) {\r\n        const key = `${params.bundle || 'resources'}-${params.type.name}-${params.path}-${params.version || ''}`;\r\n\r\n        if (this.loadingMap.has(key)) {\r\n            const command = this.loadingMap.get(key);\r\n            params.onProgress && command.onProgress.push(params.onProgress);\r\n            params.onComplete && command.onComplete.push(params.onComplete);\r\n            return;\r\n        }\r\n\r\n        // \r\n        const command = Command.create(params.onComplete, params.onProgress);\r\n        this.loadingMap.set(key, command);\r\n\r\n        // \r\n        if (this.assetMap.has(key)) {\r\n            const asset = this.assetMap.get(key);\r\n            // onProgress\r\n            setTimeout(() => {\r\n                // \r\n                if (!this.loadingMap.has(key)) return;\r\n                this.loadingMap.delete(key);\r\n                command.onComplete.forEach(cb => cb(asset));\r\n                Command.put(command);\r\n            }, 0);\r\n            return;\r\n        }\r\n\r\n        Core.inst.manager.loader.load({\r\n            ...params,\r\n            onProgress: (finish, total, item) => {\r\n                if (!this.loadingMap.has(key)) return;\r\n                command.onProgress.forEach(cb => cb(finish, total, item));\r\n            },\r\n            onComplete: (asset) => {\r\n                // \r\n                if (!this.loadingMap.has(key)) {\r\n                    asset.addRef();\r\n                    asset.decRef();\r\n                    return;\r\n                }\r\n                this.loadingMap.delete(key);\r\n                if (asset) {\r\n                    asset.addRef();\r\n                    this.assetMap.set(key, asset);\r\n                }\r\n                command.onComplete.forEach(cb => cb(asset));\r\n                Command.put(command);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * bundle\r\n     * @param params.bundle resources, bundlebundleurl(urlbundle)https://docs.cocos.com/creator/manual/zh/asset/bundle.html#%E5%8A%A0%E8%BD%BD-asset-bundle\r\n     * @param params.version bundlehttps://docs.cocos.com/creator/manual/zh/asset/bundle.html#asset-bundle-%E7%9A%84%E7%89%88%E6%9C%AC\r\n     * @param params.path bundle\r\n     * @param params.type \r\n     */\r\n    public loadAsync<T extends typeof Asset>(params: { path: string, bundle?: string, version?: string, type?: T, onProgress?: (finish: number, total: number, item: AssetManager.RequestItem) => void }): Promise<InstanceType<T> | null> {\r\n        return new Promise((resolve) => {\r\n            this.load({\r\n                ...params,\r\n                onComplete: resolve\r\n            });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * bundle\r\n     * @param params.bundle resources, bundlebundleurl(urlbundel)https://docs.cocos.com/creator/manual/zh/asset/bundle.html#%E5%8A%A0%E8%BD%BD-asset-bundle\r\n     * @param params.version bundlehttps://docs.cocos.com/creator/manual/zh/asset/bundle.html#asset-bundle-%E7%9A%84%E7%89%88%E6%9C%AC\r\n     * @param params.path bundle\r\n     * @param params.type \r\n     */\r\n    public loadDir<T extends typeof Asset>(params: { path: string, bundle?: string, version?: string, type?: T, onProgress?: (finish: number, total: number, item: AssetManager.RequestItem) => void, onComplete?: (items: InstanceType<T>[] | null) => void }) {\r\n        const key = `${params.bundle || 'resources'}-${params.type.name}-${params.path}-${params.version || ''}:`;\r\n\r\n        if (this.loadingMap.has(key)) {\r\n            const command = this.loadingMap.get(key);\r\n            params.onProgress && command.onProgress.push(params.onProgress);\r\n            params.onComplete && command.onComplete.push(params.onComplete);\r\n            return;\r\n        }\r\n\r\n        // \r\n        const command = Command.create(params.onComplete, params.onProgress);\r\n        this.loadingMap.set(key, command);\r\n\r\n        const results = [] as InstanceType<T>[];\r\n        this.assetMap.forEach((asset, path) => {\r\n            if (path.indexOf(key) === 0) {\r\n                results.push(asset as InstanceType<T>);\r\n            }\r\n        });\r\n\r\n        // \r\n        if (results.length) {\r\n            // onProgress\r\n            setTimeout(() => {\r\n                // \r\n                if (!this.loadingMap.has(key)) return;\r\n                this.loadingMap.delete(key);\r\n                command.onComplete.forEach(cb => cb(results));\r\n                Command.put(command);\r\n            }, 0);\r\n            return;\r\n        }\r\n\r\n        Core.inst.manager.loader.loadDir({\r\n            ...params,\r\n            onProgress: (finish, total, item) => {\r\n                if (!this.loadingMap.has(key)) return;\r\n                command.onProgress.forEach(cb => cb(finish, total, item));\r\n            },\r\n            onComplete: (assets) => {\r\n                // \r\n                if (!this.loadingMap.has(key)) {\r\n                    assets?.forEach((asset) => {\r\n                        asset.addRef();\r\n                        asset.decRef();\r\n                    });\r\n                    return;\r\n                }\r\n                this.loadingMap.delete(key);\r\n                assets?.forEach((asset) => {\r\n                    asset.addRef();\r\n                    this.assetMap.set(key + asset.uuid, asset);\r\n                });\r\n                command.onComplete.forEach(cb => cb(results));\r\n                Command.put(command);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * bundle\r\n     * @param params.bundle resources, bundlebundleurl(urlbundle)https://docs.cocos.com/creator/manual/zh/asset/bundle.html#%E5%8A%A0%E8%BD%BD-asset-bundle\r\n     * @param params.version bundlehttps://docs.cocos.com/creator/manual/zh/asset/bundle.html#asset-bundle-%E7%9A%84%E7%89%88%E6%9C%AC\r\n     * @param params.path bundle\r\n     * @param params.type \r\n     */\r\n    public loadDirAsync<T extends typeof Asset>(params: { path: string, bundle?: string, version?: string, type?: T, onProgress?: (finish: number, total: number, item: AssetManager.RequestItem) => void }): Promise<InstanceType<T>[] | null> {\r\n        return new Promise((resolve) => {\r\n            this.loadDir({\r\n                ...params,\r\n                onComplete: resolve\r\n            });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @example\r\n     * loadRemote({url:'', ext:'.png', onComplete:(result){ }})\r\n     */\r\n    public loadRemote({ url, ext, onComplete }: { url: string, ext?: string, onComplete?: (result: Asset | null) => void }) {\r\n        if (this.loadingMap.has(url)) {\r\n            const command = this.loadingMap.get(url);\r\n            onComplete && command.onComplete.push(onComplete);\r\n            return;\r\n        }\r\n\r\n        // \r\n        const command = Command.create(onComplete);\r\n        this.loadingMap.set(url, command);\r\n\r\n        // \r\n        if (this.assetMap.has(url)) {\r\n            const asset = this.assetMap.get(url);\r\n            // onProgress\r\n            setTimeout(() => {\r\n                // \r\n                if (!this.loadingMap.has(url)) return;\r\n                this.loadingMap.delete(url);\r\n                command.onComplete.forEach(cb => cb(asset));\r\n                Command.put(command);\r\n            }, 0);\r\n            return;\r\n        }\r\n\r\n        Core.inst.manager.loader.loadRemote({\r\n            url, ext,\r\n            onComplete: (asset) => {\r\n                // \r\n                if (!this.loadingMap.has(url)) {\r\n                    asset.addRef();\r\n                    asset.decRef();\r\n                    return;\r\n                }\r\n                this.loadingMap.delete(url);\r\n                if (asset) {\r\n                    asset.addRef();\r\n                    this.assetMap.set(url, asset);\r\n                }\r\n                command.onComplete.forEach(cb => cb(asset));\r\n                Command.put(command);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @example\r\n     * await loadRemoteAsync({url:'', ext:'.png'})\r\n     */\r\n    public loadRemoteAsync(params: { url: string, ext?: string }): Promise<Asset | null> {\r\n        return new Promise((resolve) => {\r\n            this.loadRemote({\r\n                ...params,\r\n                onComplete: resolve\r\n            });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param params.bundle resources\r\n     * @param params.path bundle\r\n     * \r\n     * @example\r\n     * setFont({target:label, path:'font/num', bundle:'resources', onComplete:(succ)=>{}})\r\n     * setFont({target:label, url:'http://img/a/font',ext:'.ttf', onComplete:(succ)=>{}})\r\n     */\r\n    public setFont(params: { target: Label, url: string, ext?: string, onComplete?: (success: boolean) => any, onSuccess?: () => void, onFail?: () => void }): void;\r\n    public setFont(params: { target: Label, path: string, bundle?: string, onComplete?: (success: boolean) => any, onSuccess?: () => void, onFail?: () => void }): void;\r\n    public setFont(params: { target: Label, path?: string, bundle?: string, url?: string, ext?: string, onComplete?: (success: boolean) => any, onSuccess?: () => void, onFail?: () => void }) {\r\n        if (params.url) {\r\n            this.loadRemote({\r\n                url: params.url,\r\n                ext: params.ext,\r\n                onComplete: (font: Font) => {\r\n                    if (!font || !isValid(params.target)) {\r\n                        params.onFail && params.onFail();\r\n                        params.onComplete && params.onComplete(false);\r\n                        return;\r\n                    }\r\n                    params.target.font = font;\r\n                    params.onSuccess && params.onSuccess();\r\n                    params.onComplete && params.onComplete(true);\r\n                }\r\n            });\r\n        } else {\r\n            this.load({\r\n                path: params.path,\r\n                bundle: params.bundle,\r\n                type: Font,\r\n                onComplete: (font) => {\r\n                    if (!font || !isValid(params.target)) {\r\n                        params.onFail && params.onFail();\r\n                        params.onComplete && params.onComplete(false);\r\n                        return;\r\n                    }\r\n                    params.target.font = font;\r\n                    params.onSuccess && params.onSuccess();\r\n                    params.onComplete && params.onComplete(true);\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Spine\r\n     * @param params.bundle resources\r\n     * @param params.path bundle\r\n     * \r\n     * @example\r\n     * setSpine({target:spine, path:'spine/role', bundle:'resources', onComplete:(succ)=>{}})\r\n     */\r\n    public setSpine(params: { target: sp.Skeleton, path: string, bundle?: string, onComplete?: (success: boolean) => any, onSuccess?: () => void, onFail?: () => void }) {\r\n        this.load({\r\n            path: params.path,\r\n            bundle: params.bundle,\r\n            type: sp.SkeletonData,\r\n            onComplete: (skeletonData) => {\r\n                if (!skeletonData || !isValid(params.target)) {\r\n                    params.onFail && params.onFail();\r\n                    params.onComplete && params.onComplete(false);\r\n                    return;\r\n                }\r\n                params.target.skeletonData = skeletonData;\r\n                params.onSuccess && params.onSuccess();\r\n                params.onComplete && params.onComplete(true);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param params.bundle resources\r\n     * @param params.path bundle\r\n     * \r\n     * @example\r\n     * setSprite({target:sprite, path:'img/a/spriteFrame', bundle:'resources', onComplete:(succ)=>{}})\r\n     * setSprite({target:sprite, url:'http://img/a/avatar',ext:'.png', onComplete:(succ)=>{}})\r\n     */\r\n    public setSprite(params: { target: Sprite, url: string, ext?: string, onComplete?: (success: boolean) => any, onSuccess?: () => void, onFail?: () => void }): void;\r\n    public setSprite(params: { target: Sprite, path: string, bundle?: string, onComplete?: (success: boolean) => any, onSuccess?: () => void, onFail?: () => void }): void;\r\n    public setSprite(params: { target: Sprite, path?: string, bundle?: string, url?: string, ext?: string, onComplete?: (success: boolean) => any, onSuccess?: () => void, onFail?: () => void }) {\r\n        if (params.url) {\r\n            this.loadRemote({\r\n                url: params.url,\r\n                ext: params.ext,\r\n                onComplete: (imageAsset: ImageAsset) => {\r\n                    if (!imageAsset || !isValid(params.target)) {\r\n                        params.onFail && params.onFail();\r\n                        params.onComplete && params.onComplete(false);\r\n                        return;\r\n                    }\r\n                    const spriteFrame = SpriteFrame.createWithImage(imageAsset);\r\n                    params.target.spriteFrame = spriteFrame;\r\n                    params.onSuccess && params.onSuccess();\r\n                    params.onComplete && params.onComplete(true);\r\n                }\r\n            });\r\n        } else {\r\n            this.load({\r\n                path: params.path,\r\n                bundle: params.bundle,\r\n                type: SpriteFrame,\r\n                onComplete: (spriteFrame) => {\r\n                    if (!spriteFrame || !isValid(params.target)) {\r\n                        params.onFail && params.onFail();\r\n                        params.onComplete && params.onComplete(false);\r\n                        return;\r\n                    }\r\n                    params.target.spriteFrame = spriteFrame;\r\n                    params.onSuccess && params.onSuccess();\r\n                    params.onComplete && params.onComplete(true);\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * \r\n     */\r\n    public releaseAll() {\r\n        const assetList: Asset[] = [];\r\n        this.assetMap.forEach(asset => assetList.push(asset));\r\n        this.assetMap.clear();\r\n        this.loadingMap.clear();\r\n        // \r\n        setTimeout(() => {\r\n            assetList.forEach(asset => asset.decRef());\r\n        }, 1000);\r\n    }\r\n}\r\n\r\n@ccclass('LoaderManager')\r\nexport default class LoaderManager extends BaseManager {\r\n    /**\r\n     * `Loader``LoaderManager``Loader``Loader```LoaderManagercc.assetManagerAsset Bundle\r\n     * @example\r\n     * // Loader\r\n     * const loader = new LoaderManager.Loader();\r\n     * // \r\n     * loader.load({path:'img/a/spriteFrame', bundle:'resources', type:SpriteFrame, onComplete:(spriteFrame)=>{}})\r\n     * // \r\n     * loader.loadRemote({url:'http://img/a/avatar',ext:'.png', onComplete:(imageAsset)=>{}})\r\n     * // \r\n     * loader.releaseAll();\r\n     */\r\n    static Loader = Loader;\r\n\r\n    private handle(handle: string, { bundle, version, path, type, onProgress, onComplete }: { bundle?: string, version?: string, path: string, type?: typeof Asset, onProgress?: (finish: number, total: number, item: AssetManager.RequestItem) => void, onComplete?: (result: unknown | null) => void }) {\r\n        if (!handle) {\r\n            this.error('handle is empty');\r\n            return onComplete && onComplete(null);\r\n        }\r\n        if (!path) {\r\n            this.error(`${handle} fail. path is empty`);\r\n            return onComplete && onComplete(null);\r\n        }\r\n        if (!bundle) bundle = 'resources';\r\n\r\n        const args: any[] = [path];\r\n        if (type) args.push(type);\r\n        if (onProgress) args.push(onProgress);\r\n        args.push((err: string, res: any) => {\r\n            if (err) {\r\n                this.error(`${handle} \"${path}\" fail`, err);\r\n                if (type === SpriteFrame && path.slice(-12) !== '/spriteFrame') {\r\n                    this.warn(`SpriteFrame, /spriteFrame, : ${path} -> ${path}/spriteFrame`);\r\n                } else if (type === Texture2D && path.slice(-8) !== '/texture') {\r\n                    this.warn(`Texture2D, /texture, : ${path} -> ${path}/texture`);\r\n                } else if (type === TextureCube && path.slice(-12) !== '/textureCube') {\r\n                    this.warn(`TextureCube, /textureCube, : ${path} -> ${path}/textureCube`);\r\n                }\r\n                onComplete && onComplete(null);\r\n            } else {\r\n                onComplete && onComplete(res);\r\n            }\r\n        });\r\n\r\n        this.loadBundle({\r\n            bundle, version,\r\n            onComplete(bundle) {\r\n                if (!bundle) return onComplete && onComplete(null);\r\n                bundle[handle](args[0], args[1], args[2], args[3]);\r\n            },\r\n        });\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param params.bundle resources, bundlebundleurl(urlbundle)https://docs.cocos.com/creator/manual/zh/asset/bundle.html#%E5%8A%A0%E8%BD%BD-asset-bundle\r\n     * @param params.version bundlehttps://docs.cocos.com/creator/manual/zh/asset/bundle.html#asset-bundle-%E7%9A%84%E7%89%88%E6%9C%AC\r\n     */\r\n    public preload(params: { path: string, bundle?: string, version?: string, type?: typeof Asset, onProgress?: (finish: number, total: number, item: AssetManager.RequestItem) => void, onComplete?: (item: AssetManager.RequestItem[] | null) => void }) {\r\n        if (SceneAsset === params.type as typeof Asset) {\r\n            this.handle('preloadScene', { path: params.path, bundle: params.bundle, version: params.version, onProgress: params.onProgress, onComplete: params.onComplete });\r\n        } else {\r\n            this.handle('preload', params);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param params.bundle resources, bundlebundleurl(urlbundle)https://docs.cocos.com/creator/manual/zh/asset/bundle.html#%E5%8A%A0%E8%BD%BD-asset-bundle\r\n     * @param params.version bundlehttps://docs.cocos.com/creator/manual/zh/asset/bundle.html#asset-bundle-%E7%9A%84%E7%89%88%E6%9C%AC\r\n     */\r\n    public preloadDir(params: { path: string, bundle?: string, version?: string, type?: typeof Asset, onProgress?: (finish: number, total: number, item: AssetManager.RequestItem) => void, onComplete?: (items: AssetManager.RequestItem[] | null) => void }) {\r\n        this.handle('preloadDir', params);\r\n    }\r\n\r\n    /**\r\n     * bundle\r\n     * @param params.bundle resources, bundlebundleurl(urlbundle)https://docs.cocos.com/creator/manual/zh/asset/bundle.html#%E5%8A%A0%E8%BD%BD-asset-bundle\r\n     * @param params.version bundlehttps://docs.cocos.com/creator/manual/zh/asset/bundle.html#asset-bundle-%E7%9A%84%E7%89%88%E6%9C%AC\r\n     * @param params.path bundle\r\n     * @param params.type \r\n     */\r\n    public load<T extends typeof Asset>(params: { path: string, bundle?: string, version?: string, type?: T, onProgress?: (finish: number, total: number, item: AssetManager.RequestItem) => void, onComplete?: (item: InstanceType<T> | null) => void }) {\r\n        if (SceneAsset === params.type as typeof Asset) {\r\n            this.handle('loadScene', { path: params.path, bundle: params.bundle, version: params.version, onProgress: params.onProgress, onComplete: params.onComplete });\r\n        } else {\r\n            this.handle('load', params);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * bundle\r\n     * @param params.bundle resources, bundlebundleurl(urlbundle)https://docs.cocos.com/creator/manual/zh/asset/bundle.html#%E5%8A%A0%E8%BD%BD-asset-bundle\r\n     * @param params.version bundlehttps://docs.cocos.com/creator/manual/zh/asset/bundle.html#asset-bundle-%E7%9A%84%E7%89%88%E6%9C%AC\r\n     * @param params.path bundle\r\n     * @param params.type \r\n     */\r\n    public loadAsync<T extends typeof Asset>(params: { path: string, bundle?: string, version?: string, type?: T, onProgress?: (finish: number, total: number, item: AssetManager.RequestItem) => void }): Promise<InstanceType<T> | null> {\r\n        return new Promise((resolve) => {\r\n            this.load({\r\n                ...params,\r\n                onComplete: resolve\r\n            });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * bundle\r\n     * @param params.bundle resources, bundlebundleurl(urlbundle)https://docs.cocos.com/creator/manual/zh/asset/bundle.html#%E5%8A%A0%E8%BD%BD-asset-bundle\r\n     * @param params.version bundlehttps://docs.cocos.com/creator/manual/zh/asset/bundle.html#asset-bundle-%E7%9A%84%E7%89%88%E6%9C%AC\r\n     * @param params.path bundle\r\n     * @param params.type \r\n     */\r\n    public loadDir<T extends typeof Asset>(params: { path: string, bundle?: string, version?: string, type?: T, onProgress?: (finish: number, total: number, item: AssetManager.RequestItem) => void, onComplete?: (items: InstanceType<T>[] | null) => void }) {\r\n        this.handle('loadDir', params);\r\n    }\r\n\r\n    /**\r\n     * bundle\r\n     * @param params.bundle resources, bundlebundleurl(urlbundle)https://docs.cocos.com/creator/manual/zh/asset/bundle.html#%E5%8A%A0%E8%BD%BD-asset-bundle\r\n     * @param params.version bundlehttps://docs.cocos.com/creator/manual/zh/asset/bundle.html#asset-bundle-%E7%9A%84%E7%89%88%E6%9C%AC\r\n     * @param params.path bundle\r\n     * @param params.type \r\n     */\r\n    public loadDirAsync<T extends typeof Asset>(params: { path: string, bundle?: string, version?: string, type?: T, onProgress?: (finish: number, total: number, item: AssetManager.RequestItem) => void }): Promise<InstanceType<T>[] | null> {\r\n        return new Promise((resolve) => {\r\n            this.loadDir({\r\n                ...params,\r\n                onComplete: resolve\r\n            });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * bundlepathtype\r\n     * @param params.bundle resourcesbundleurlbundle\r\n     * @param params.path bundle\r\n     * @param params.type \r\n     */\r\n    public release({ path, bundle, type }: { path: string, bundle?: string, type?: typeof Asset }) {\r\n        if (!bundle) bundle = 'resources';\r\n        assetManager.getBundle(bundle)?.release(path, type);\r\n    }\r\n\r\n    /**\r\n     * bundle\r\n     * @param bundle resourcesbundleurlbundle\r\n     */\r\n    public releaseAll(bundle?: string) {\r\n        if (!bundle) bundle = 'resources';\r\n        const _bundle = assetManager.getBundle(bundle);\r\n        if (!_bundle) return;\r\n        // \r\n        _bundle.getDirWithPath('/', Asset).forEach((asset) => {\r\n            _bundle.release(asset.path, asset.ctor);\r\n        });\r\n        // cocos()\r\n        // _bundle?.releaseAll();\r\n    }\r\n\r\n    /**\r\n     * bundle\r\n     * @param bundle resourcesbundleurlbundle\r\n     */\r\n    public releaseUnused(bundle?: string) {\r\n        if (!bundle) bundle = 'resources';\r\n        //@ts-ignore\r\n        assetManager.getBundle(bundle)?.releaseUnusedAssets();\r\n    }\r\n\r\n    /**\r\n     * bundle\r\n     * @param params.bundle resources, bundlebundleurl(urlbundle)https://docs.cocos.com/creator/manual/zh/asset/bundle.html#%E5%8A%A0%E8%BD%BD-asset-bundle\r\n     * @param params.version bundlehttps://docs.cocos.com/creator/manual/zh/asset/bundle.html#asset-bundle-%E7%9A%84%E7%89%88%E6%9C%AC\r\n     */\r\n    public loadBundle({ bundle, version, onComplete }: { bundle?: string, version?: string, onComplete?: (bundle: AssetManager.Bundle | null) => any }) {\r\n        if (!bundle) bundle = 'resources';\r\n\r\n        if (MINIGAME) {\r\n            if (REGEX.test(bundle)) {\r\n                this.warn('Bundle, ');\r\n                this.reloadBundle({ bundle, version, onComplete });\r\n                return;\r\n            }\r\n            if (version && assetManager.downloader.bundleVers[bundle] !== version) {\r\n                this.warn('Bundle, ');\r\n                // bundle\r\n                assetManager.loadBundle(bundle, (err: Error, b: AssetManager.Bundle) => {\r\n                    if (err || !b) return onComplete?.(null);\r\n                    // \r\n                    this.reloadBundle({ bundle, version, onComplete });\r\n                });\r\n            } else {\r\n                assetManager.loadBundle(bundle, (err: Error, bundle: AssetManager.Bundle) => {\r\n                    onComplete && onComplete(err ? null : bundle);\r\n                });\r\n            }\r\n            return;\r\n        }\r\n\r\n        if (version) {\r\n            assetManager.loadBundle(bundle, { version }, (err: Error, bundle: AssetManager.Bundle) => {\r\n                onComplete && onComplete(err ? null : bundle);\r\n            });\r\n        } else {\r\n            assetManager.loadBundle(bundle, (err: Error, bundle: AssetManager.Bundle) => {\r\n                onComplete && onComplete(err ? null : bundle);\r\n            });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * bundle\r\n     * @param params.bundle resources, bundlebundleurl(urlbundle)https://docs.cocos.com/creator/manual/zh/asset/bundle.html#%E5%8A%A0%E8%BD%BD-asset-bundle\r\n     * @param params.version bundlehttps://docs.cocos.com/creator/manual/zh/asset/bundle.html#asset-bundle-%E7%9A%84%E7%89%88%E6%9C%AC\r\n     */\r\n    public loadBundleAsync(params: { bundle?: string, version?: string }): Promise<AssetManager.Bundle | null> {\r\n        return new Promise((resolve) => {\r\n            this.loadBundle({\r\n                ...params,\r\n                onComplete: resolve\r\n            });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * bundle\r\n     * @param bundle resourcesbundleurlbundle\r\n     */\r\n    public getBundle(bundle?: string) {\r\n        if (!bundle) bundle = 'resources';\r\n        return assetManager.getBundle(bundle);\r\n    }\r\n\r\n    /**\r\n     * bundle\r\n     * @param bundle resourcesbundleurlbundle\r\n     */\r\n    public removeBundle(bundle?: string) {\r\n        if (!bundle) bundle = 'resources';\r\n        const b = assetManager.getBundle(bundle);\r\n        if (b) assetManager.removeBundle(b);\r\n    }\r\n\r\n    /**\r\n     * bundle()\r\n     * - bundle\r\n     * @param params.bundle resources, bundlebundleurl(urlbundle)https://docs.cocos.com/creator/manual/zh/asset/bundle.html#%E5%8A%A0%E8%BD%BD-asset-bundle\r\n     * @param params.version bundlehttps://docs.cocos.com/creator/manual/zh/asset/bundle.html#asset-bundle-%E7%9A%84%E7%89%88%E6%9C%AC\r\n     */\r\n    public reloadBundle({ bundle, version, onComplete }: { bundle?: string, version?: string, onComplete?: (bundle: AssetManager.Bundle | null) => any }) {\r\n        if (!bundle) bundle = 'resources';\r\n\r\n        let baseUrl = '';\r\n        let configUrl = '';\r\n\r\n        if (REGEX.test(bundle)) {\r\n            baseUrl = bundle;\r\n            const suffix = version ? `${version}.` : '';\r\n            configUrl = `${baseUrl}config.${suffix}json`;\r\n        }\r\n        else {\r\n            baseUrl = `${assetManager.downloader.remoteServerAddress}remote/${bundle}/`;\r\n            const suffix = version ? `${version}.` : '';\r\n            configUrl = `${baseUrl}config.${suffix}json`;\r\n        }\r\n\r\n        // config\r\n        assetManager.cacheManager?.removeCache(configUrl);\r\n        assetManager.loadRemote(configUrl, (err: Error, data: JsonAsset) => {\r\n            if (err) {\r\n                this.error(`Bundle: ${configUrl}`);\r\n                onComplete?.(null);\r\n                return;\r\n            }\r\n\r\n            this.releaseAll(path.basename(bundle));\r\n            this.removeBundle(path.basename(bundle));\r\n\r\n            const ab = new AssetManager.Bundle();\r\n            const config = data.json as any;\r\n            config.base = baseUrl;\r\n            ab.init(config);\r\n            onComplete?.(ab);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * bundle()\r\n     * - bundle\r\n     * @param params.bundle resources, bundlebundleurl(urlbundle)https://docs.cocos.com/creator/manual/zh/asset/bundle.html#%E5%8A%A0%E8%BD%BD-asset-bundle\r\n     * @param params.version bundlehttps://docs.cocos.com/creator/manual/zh/asset/bundle.html#asset-bundle-%E7%9A%84%E7%89%88%E6%9C%AC\r\n     */\r\n    public reloadBundleAsync(params: { bundle?: string, version?: string }): Promise<AssetManager.Bundle | null> {\r\n        return new Promise((resolve) => {\r\n            this.reloadBundle({\r\n                ...params,\r\n                onComplete: resolve\r\n            });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @example\r\n     * loadRemote({url:'', ext:'.png', onComplete:(result){ }})\r\n     */\r\n    public loadRemote({ url, ext, onComplete }: { url: string, ext?: string, onComplete?: (result: Asset | null) => void }) {\r\n        if (ext) {\r\n            assetManager.loadRemote(url, { ext }, (error, res) => {\r\n                if (error) {\r\n                    this.error(`loadRemote ${url} fail`);\r\n                    return onComplete && onComplete(null);\r\n                }\r\n                onComplete && onComplete(res);\r\n            });\r\n        } else {\r\n            assetManager.loadRemote(url, (error, res) => {\r\n                if (error) {\r\n                    this.error(`loadRemote ${url} fail`);\r\n                    return onComplete && onComplete(null);\r\n                }\r\n                onComplete && onComplete(res);\r\n            });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @example\r\n     * await loadRemoteAsync({url:'', ext:'.png'})\r\n     */\r\n    public loadRemoteAsync(params: { url: string, ext?: string }): Promise<Asset | null> {\r\n        return new Promise((resolve) => {\r\n            this.loadRemote({\r\n                ...params,\r\n                onComplete: resolve\r\n            });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param params.bundle resources\r\n     * @param params.path bundle\r\n     * \r\n     * @example\r\n     * setFont({target:label, path:'font/num', bundle:'resources', onComplete:(succ)=>{}})\r\n     * setFont({target:label, url:'http://img/a/font',ext:'.ttf', onComplete:(succ)=>{}})\r\n     */\r\n    public setFont(params: { target: Label, url: string, ext?: string, onComplete?: (success: boolean) => any, onSuccess?: () => void, onFail?: () => void }): void;\r\n    public setFont(params: { target: Label, path: string, bundle?: string, onComplete?: (success: boolean) => any, onSuccess?: () => void, onFail?: () => void }): void;\r\n    public setFont(params: { target: Label, path?: string, bundle?: string, url?: string, ext?: string, onComplete?: (success: boolean) => any, onSuccess?: () => void, onFail?: () => void }) {\r\n        if (params.url) {\r\n            this.loadRemote({\r\n                url: params.url,\r\n                ext: params.ext,\r\n                onComplete: (font: Font) => {\r\n                    if (!font || !isValid(params.target)) {\r\n                        params.onFail && params.onFail();\r\n                        params.onComplete && params.onComplete(false);\r\n                        return;\r\n                    }\r\n                    params.target.font = font;\r\n                    params.onSuccess && params.onSuccess();\r\n                    params.onComplete && params.onComplete(true);\r\n                }\r\n            });\r\n        } else {\r\n            this.load({\r\n                path: params.path,\r\n                bundle: params.bundle,\r\n                type: Font,\r\n                onComplete: (font) => {\r\n                    if (!font || !isValid(params.target)) {\r\n                        params.onFail && params.onFail();\r\n                        params.onComplete && params.onComplete(false);\r\n                        return;\r\n                    }\r\n                    params.target.font = font;\r\n                    params.onSuccess && params.onSuccess();\r\n                    params.onComplete && params.onComplete(true);\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Spine\r\n     * @param params.bundle resources\r\n     * @param params.path bundle\r\n     * \r\n     * @example\r\n     * setSpine({target:spine, path:'spine/role', bundle:'resources', onComplete:(succ)=>{}})\r\n     */\r\n    public setSpine(params: { target: sp.Skeleton, path: string, bundle?: string, onComplete?: (success: boolean) => any, onSuccess?: () => void, onFail?: () => void }) {\r\n        this.load({\r\n            path: params.path,\r\n            bundle: params.bundle,\r\n            type: sp.SkeletonData,\r\n            onComplete: (skeletonData) => {\r\n                if (!skeletonData || !isValid(params.target)) {\r\n                    params.onFail && params.onFail();\r\n                    params.onComplete && params.onComplete(false);\r\n                    return;\r\n                }\r\n                params.target.skeletonData = skeletonData;\r\n                params.onSuccess && params.onSuccess();\r\n                params.onComplete && params.onComplete(true);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param params.bundle resources\r\n     * @param params.path bundle\r\n     * \r\n     * @example\r\n     * setSprite({target:sprite, path:'img/a/spriteFrame', bundle:'resources', onComplete:(succ)=>{}})\r\n     * setSprite({target:sprite, url:'http://img/a/avatar',ext:'.png', onComplete:(succ)=>{}})\r\n     */\r\n    public setSprite(params: { target: Sprite, url: string, ext?: string, onComplete?: (success: boolean) => any, onSuccess?: () => void, onFail?: () => void }): void;\r\n    public setSprite(params: { target: Sprite, path: string, bundle?: string, onComplete?: (success: boolean) => any, onSuccess?: () => void, onFail?: () => void }): void;\r\n    public setSprite(params: { target: Sprite, path?: string, bundle?: string, url?: string, ext?: string, onComplete?: (success: boolean) => any, onSuccess?: () => void, onFail?: () => void }) {\r\n        if (params.url) {\r\n            this.loadRemote({\r\n                url: params.url,\r\n                ext: params.ext,\r\n                onComplete: (imageAsset: ImageAsset) => {\r\n                    if (!imageAsset || !isValid(params.target)) {\r\n                        params.onFail && params.onFail();\r\n                        params.onComplete && params.onComplete(false);\r\n                        return;\r\n                    }\r\n                    const spriteFrame = SpriteFrame.createWithImage(imageAsset);\r\n                    params.target.spriteFrame = spriteFrame;\r\n                    params.onSuccess && params.onSuccess();\r\n                    params.onComplete && params.onComplete(true);\r\n                }\r\n            });\r\n        } else {\r\n            this.load({\r\n                path: params.path,\r\n                bundle: params.bundle,\r\n                type: SpriteFrame,\r\n                onComplete: (spriteFrame) => {\r\n                    if (!spriteFrame || !isValid(params.target)) {\r\n                        params.onFail && params.onFail();\r\n                        params.onComplete && params.onComplete(false);\r\n                        return;\r\n                    }\r\n                    params.target.spriteFrame = spriteFrame;\r\n                    params.onSuccess && params.onSuccess();\r\n                    params.onComplete && params.onComplete(true);\r\n                }\r\n            });\r\n        }\r\n    }\r\n}","import { DEV } from 'cc/env';\r\n\r\ninterface ILog {\r\n    (title: string, ...args: any[]): void\r\n}\r\n\r\nfunction empty() { }\r\n\r\n/**\r\n * \r\n */\r\nexport class Logger {\r\n    static setting: {\r\n        filter: Array<'log' | 'warn' | 'error'>\r\n    } = {\r\n            filter: ['error', 'log', 'warn']\r\n        };\r\n\r\n    /**\r\n     * \r\n     */\r\n    static create(level: 'log' | 'warn' | 'error', styleColor: string, title: string, titleColor = '#fff') {\r\n        if (this.setting.filter.indexOf(level) == -1) {\r\n            return empty;\r\n        }\r\n\r\n        if (DEV) {\r\n            return window.console[level].bind(window.console,\r\n                '%c %s %c %s ',\r\n                `background:${styleColor}; padding: 2px; border-radius: 5px 0 0 5px; border: 1px solid ${styleColor}; color: ${titleColor}; font-weight: normal;`,\r\n                `${title} ${new Date().toLocaleString()}`,\r\n                `background:#ffffff ; padding: 2px; border-radius: 0 5px 5px 0; border: 1px solid ${styleColor}; color: ${styleColor}; font-weight: normal;`\r\n            );\r\n        }\r\n        return window.console[level].bind(window.console,\r\n            `${title} [${new Date().toLocaleString()}]`\r\n        );\r\n    }\r\n\r\n    /**\r\n     * \r\n     */\r\n    get log() {\r\n        return Logger.create('log', '#6495ed', '[LOG]', '#000') as ILog;\r\n    }\r\n\r\n    /**\r\n     * \r\n     */\r\n\r\n    get warn() {\r\n        return Logger.create('warn', '#ff7f50', '[WARN]', '#000') as ILog;\r\n    }\r\n\r\n    /**\r\n     * \r\n     */\r\n    get error() {\r\n        return Logger.create('error', '#ff4757', '[ERROR]', '#000') as ILog;\r\n    }\r\n\r\n    /**\r\n     * \r\n     */\r\n    get debug() {\r\n        return Logger.create('log', '#ff6347', '[DEBUG]', '#000') as ILog;\r\n    }\r\n\r\n    /**\r\n     * \r\n     */\r\n    get success() {\r\n        return Logger.create('log', '#00ae9d', '[SUCC]', '#000') as ILog;\r\n    }\r\n}\r\n\r\nexport default new Logger();","export enum RefreshOrLoadState {\r\n    NONE,//\r\n    READY_TO_REFRESH,//\r\n    REFRESHING,//\r\n    COMPLETE,//\r\n    COMPLETING,//\r\n    EMPTY, //COMPLETE\r\n}","import SoundManager from '../../extensions/app/assets/manager/sound/SoundManager';\r\nimport UIManager from '../../extensions/app/assets/manager/ui/UIManager';\r\n\r\n// UI(app.lib.task.createAny)\r\nUIManager.setting.preload = ['PageMain'];\r\n// UI, show\r\nUIManager.setting.defaultUI = 'PageMain';\r\n// \r\nUIManager.setting.autoFit = true; // \r\n// \r\nUIManager.setting.shade = {\r\n    delay: 0,\r\n    begin: 100,\r\n    end: 200,\r\n    speed: 400,\r\n    blur: true\r\n};\r\n\r\n// ()\r\nSoundManager.setting.preload = [];\r\n// , \r\nSoundManager.setting.defaultMusicName = '';\r\n// , Button\r\nSoundManager.setting.defaultEffectName = 'effect/button';","import { AssetManager, AudioClip, Button, Game, _decorator, game, isValid, sys } from 'cc';\r\nimport { IEffectName, IMusicName } from '../../../../../assets/app-builtin/app-admin/executor';\r\nimport Core from '../../Core';\r\nimport BaseManager from '../../base/BaseManager';\r\nimport AudioEngine from './AudioEngine';\r\nconst { ccclass } = _decorator;\r\n\r\ninterface playMusic<T> { name: T, volume?: number, force?: boolean, onPlay?: Function, onError?: Function }\r\ninterface playEffect<T> { name: T, volume?: number, loop?: boolean, interval?: number, onPlay?: (audioID: number) => any, onError?: Function, onEnded?: Function }\r\ninterface playMusicAsync<T> { name: T, volume?: number, force?: boolean }\r\ninterface playEffectAsync<T> { name: T, volume?: number, loop?: boolean, interval?: number, onEnded?: Function }\r\n\r\ninterface playMusicWidthBundle { name: string, bundle: string, volume?: number, force?: boolean, onPlay?: Function, onError?: Function }\r\ninterface playEffectWidthBundle { name: string, bundle: string, volume?: number, loop?: boolean, interval?: number, onPlay?: (audioID: number) => any, onError?: Function, onEnded?: Function }\r\ninterface playMusicWidthBundleAsync { name: string, bundle: string, volume?: number, force?: boolean }\r\ninterface playEffectWidthBundleAsync { name: string, bundle: string, volume?: number, loop?: boolean, interval?: number, onEnded?: Function }\r\n\r\nconst storage = {\r\n    set(key: string, value: any) {\r\n        sys.localStorage.setItem(key, JSON.stringify(value));\r\n    },\r\n    get(key: string) {\r\n        const data = sys.localStorage.getItem(key);\r\n        if (data && typeof data === 'string') {\r\n            return JSON.parse(data);\r\n        }\r\n        return undefined;\r\n    }\r\n};\r\n\r\n/**\r\n * \r\n */\r\nconst MusicName: { [key in IMusicName]: key } = new Proxy({} as any, {\r\n    get: function (target, key) {\r\n        if (target[key]) return target[key];\r\n        target[key] = key;\r\n        return key;\r\n    }\r\n});\r\n\r\n/**\r\n * \r\n */\r\nconst EffectName: { [key in IEffectName]: key } = new Proxy({} as any, {\r\n    get: function (target, key) {\r\n        if (target[key]) return target[key];\r\n        target[key] = key;\r\n        return key;\r\n    }\r\n});\r\n\r\nconst BundleName = 'app-sound';\r\n@ccclass('SoundManager')\r\nexport default class SoundManager<E extends string, M extends string> extends BaseManager {\r\n    /** */\r\n    static setting: {\r\n        /** */\r\n        preload?: (IMusicName | IEffectName)[],\r\n\r\n        /** */\r\n        defaultMusicName?: IMusicName | '',\r\n        /** */\r\n        defaultMusicVolume?: number,\r\n\r\n        /** */\r\n        defaultEffectName?: IEffectName | '',\r\n        /** */\r\n        defaultEffectVolume?: number\r\n    } = {};\r\n\r\n    /** */\r\n    static MusicName = MusicName;\r\n    /** */\r\n    static EffectName = EffectName;\r\n\r\n    private musicMuteCacheKey = 'SoundManager:MusicMute';\r\n    private effectMuteCacheKey = 'SoundManager:EffectMute';\r\n    private musicVolumeScaleCacheKey = 'SoundManager:MusicVolumeScale';\r\n    private effectVolumeScaleCacheKey = 'SoundManager:EffectVolumeScale';\r\n\r\n    private defaultMusicName = '';\r\n    private defaultMusicVolume = 1;\r\n    private defaultEffectName = '';\r\n    private defaultEffectVolume = 1;\r\n\r\n    private audioCache = {};\r\n    private effectInterval: { [key in string]: number } = {};\r\n    private playingMusic = { uuid: '', id: -1, name: '', volume: 1, playing: false, paused: false };\r\n\r\n    protected init(finish: Function) {\r\n        const setting = SoundManager.setting;\r\n\r\n        // \r\n        if (setting.defaultMusicName) this.defaultMusicName = setting.defaultMusicName;\r\n        if (typeof setting.defaultMusicVolume === 'number') this.defaultMusicVolume = setting.defaultMusicVolume;\r\n\r\n        // \r\n        if (setting.defaultEffectName) this.defaultEffectName = setting.defaultEffectName;\r\n        if (typeof setting.defaultEffectVolume === 'number') this.defaultEffectVolume = setting.defaultEffectVolume;\r\n\r\n        if (this.musicMuteCacheKey) {\r\n            const musicMute = storage.get(this.musicMuteCacheKey) === true;\r\n            AudioEngine.inst.setMusicMute(musicMute);\r\n        } else {\r\n            this.warn('musicMuteCacheKey');\r\n        }\r\n        if (this.effectMuteCacheKey) {\r\n            const effectMute = storage.get(this.effectMuteCacheKey) === true;\r\n            AudioEngine.inst.setGlobalEffectsMute(effectMute);\r\n        } else {\r\n            this.warn('effectMuteCacheKey');\r\n        }\r\n        if (this.musicVolumeScaleCacheKey) {\r\n            const musicVolumeScale = storage.get(this.musicVolumeScaleCacheKey);\r\n            if (typeof musicVolumeScale === 'number') AudioEngine.inst.setMusicVolumeScale(musicVolumeScale);\r\n        } else {\r\n            this.warn('musicVolumeScaleCacheKey');\r\n        }\r\n        if (this.effectVolumeScaleCacheKey) {\r\n            const effectVolumeScale = storage.get(this.effectVolumeScaleCacheKey);\r\n            if (typeof effectVolumeScale === 'number') AudioEngine.inst.setGlobalEffectsVolumeScale(effectVolumeScale);\r\n        } else {\r\n            this.warn('effectVolumeScaleCacheKey');\r\n        }\r\n\r\n        super.init(finish);\r\n\r\n        // \r\n        setting.preload?.forEach((path: string) => {\r\n            Core.inst.manager.loader.preload({\r\n                bundle: BundleName,\r\n                type: AudioClip,\r\n                path: path\r\n            });\r\n        });\r\n    }\r\n\r\n    protected onLoad() {\r\n        game.on(Game.EVENT_HIDE, function () {\r\n            AudioEngine.inst.pauseAll();\r\n        });\r\n        game.on(Game.EVENT_SHOW, function () {\r\n            AudioEngine.inst.resumeAll();\r\n        });\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param name sound\r\n     * @param bundle Bundleapp-sound\r\n     */\r\n    public preload(name: string, bundle: string, complete?: (item: AssetManager.RequestItem[] | null) => any): void;\r\n    public preload(name: (E | M), complete?: (item: AssetManager.RequestItem[] | null) => any): void;\r\n    public preload(name: string, ...args: any[]) {\r\n        const bundleName = (args.length >= 1\r\n            && (typeof args[0] === 'string')\r\n            ? (args[0] || BundleName)\r\n            : BundleName\r\n        ) as string;\r\n        const complete = (args.length >= 1\r\n            && (args[args.length - 1] instanceof Function)\r\n            ? args[args.length - 1]\r\n            : null\r\n        ) as (item: AssetManager.RequestItem[] | null) => any;\r\n\r\n        if (!name) {\r\n            this.error('preload', 'fail');\r\n            complete && setTimeout(function () {\r\n                if (!isValid(this)) return;\r\n                complete(null);\r\n            });\r\n            return;\r\n        }\r\n\r\n        if (name.indexOf('effect') !== 0 && name.indexOf('music') !== 0) {\r\n            this.error('preload', 'fail', name);\r\n            complete && setTimeout(function () {\r\n                if (!isValid(this)) return;\r\n                complete(null);\r\n            });\r\n            return;\r\n        }\r\n\r\n        // \r\n        Core.inst.manager.loader.preload({\r\n            bundle: bundleName,\r\n            path: name,\r\n            type: AudioClip,\r\n            onComplete: complete\r\n        });\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param name sound\r\n     * @param bundle Bundleapp-sound\r\n     * @param progress \r\n     * @param complete \r\n     */\r\n    public load(name: string, bundle: string): void;\r\n    public load(name: string, bundle: string, complete: (result: AudioClip | null) => any): void;\r\n    public load(name: string, bundle: string, progress: (finish: number, total: number, item: AssetManager.RequestItem) => void, complete: (result: AudioClip | null) => any): void;\r\n    public load(name: (E | M)): void;\r\n    public load(name: (E | M), complete: (result: AudioClip | null) => any): void;\r\n    public load(name: (E | M), progress: (finish: number, total: number, item: AssetManager.RequestItem) => void, complete: (result: AudioClip | null) => any): void;\r\n    public load(name: string, ...args: any[]): void {\r\n        const bundleName = (args.length >= 1\r\n            && (typeof args[0] === 'string')\r\n            ? (args[0] || BundleName)\r\n            : BundleName\r\n        ) as string;\r\n        const progress = (args.length >= 2\r\n            && (args[args.length - 1] instanceof Function)\r\n            && (args[args.length - 2] instanceof Function)\r\n            ? args[args.length - 2]\r\n            : null\r\n        ) as (finish: number, total: number, item: AssetManager.RequestItem) => void;\r\n        const complete = (args.length >= 1\r\n            && (args[args.length - 1] instanceof Function)\r\n            ? args[args.length - 1]\r\n            : null\r\n        ) as (result: AudioClip | null) => any;\r\n\r\n        if (!name) {\r\n            this.error('load', 'fail');\r\n            complete && setTimeout(() => {\r\n                if (!isValid(this)) return;\r\n                complete(null);\r\n            });\r\n            return;\r\n        }\r\n\r\n        const soundName = `${bundleName}://${name}`;\r\n\r\n        // \r\n        const audio = this.audioCache[soundName];\r\n        if (audio) {\r\n            complete && setTimeout(() => {\r\n                if (!isValid(this)) return;\r\n                complete(audio);\r\n            });\r\n            return;\r\n        }\r\n\r\n        // \r\n        Core.inst.manager.loader.load({\r\n            path: name,\r\n            bundle: bundleName,\r\n            type: AudioClip,\r\n            onProgress: progress,\r\n            onComplete: (audioClip) => {\r\n                if (!isValid(this)) return;\r\n                if (audioClip) {\r\n                    this.audioCache[soundName] = audioClip;\r\n                    complete && complete(audioClip);\r\n                } else {\r\n                    complete && complete(null);\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param name \r\n     * @param bundle Bundleapp-sound\r\n     */\r\n    public release(name: string, bundle: string): void;\r\n    public release(name: E | M): void;\r\n    public release(name: string, bundle?: string) {\r\n        const bundleName = bundle || BundleName;\r\n        const soundName = `${bundleName}://${name}`;\r\n\r\n        delete this.audioCache[soundName];\r\n        Core.inst.manager.loader.release({ bundle: bundleName, path: name, type: AudioClip });\r\n    }\r\n\r\n    /**\r\n     * \r\n     */\r\n    public playDefaultMusic(onPlay?: Function) {\r\n        if (this.defaultMusicName) {\r\n            this.playMusic({ name: <M>this.defaultMusicName, volume: this.defaultMusicVolume, onPlay });\r\n        } else {\r\n            this.warn('defaultMusicName ');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * \r\n     */\r\n    public playDefaultEffect(onPlay?: (audioID: number) => void) {\r\n        if (this.defaultEffectName) {\r\n            this.playEffect({ name: <E>this.defaultEffectName, volume: this.defaultEffectVolume, onPlay });\r\n        } else {\r\n            this.warn('defaultEffectName ');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param name ()\r\n     * @param opts.volume \r\n     * @param opts.interval \r\n     */\r\n    public setButtonEffect(target: Button, name?: E, opts?: {\r\n        volume: number,\r\n        interval: number\r\n    }) {\r\n        if (name) {\r\n            const { volume = 1, interval = 0 } = opts || {};\r\n            //@ts-ignore\r\n            target.node['useDefaultEffect'] = false;\r\n            target.node.targetOff(this);\r\n            target.node.on(Button.EventType.CLICK, function (this: SoundManager<E, M>) {\r\n                this.playEffect({ name, volume, interval });\r\n            }, this);\r\n        } else {\r\n            //@ts-ignore\r\n            target.node['useDefaultEffect'] = true;\r\n            target.node.targetOff(this);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param name \r\n     * @param bundle Bundleapp-sound\r\n     * @param loop \r\n     * @param volume \r\n     * @param interval \r\n     */\r\n    public playEffect({ name, volume, loop, interval, onEnded, onPlay, onError }: playEffect<E>): void;\r\n    public playEffect({ name, bundle, volume, loop, interval, onEnded, onPlay, onError }: playEffectWidthBundle): void;\r\n    public playEffect({ name, bundle, volume = 1, loop = false, interval = 0, onEnded, onPlay, onError }) {\r\n        if (!name) {\r\n            onError && onError();\r\n            return;\r\n        }\r\n\r\n        const bundleName = bundle || BundleName;\r\n        const soundName = `${bundleName}://${name}`;\r\n\r\n        // \r\n        if (this.isEffectMute) {\r\n            onError && onError();\r\n            return;\r\n        }\r\n        // \r\n        if (this.effectInterval[soundName] && Date.now() < this.effectInterval[soundName]) {\r\n            onError && onError();\r\n            return;\r\n        }\r\n\r\n        // \r\n        this.load(name, bundleName, (audioClip) => {\r\n            if (!isValid(this)) {\r\n                onError && onError();\r\n                return;\r\n            }\r\n            // \r\n            if (this.isEffectMute) {\r\n                onError && onError();\r\n                return;\r\n            }\r\n            // \r\n            if (this.effectInterval[soundName] && Date.now() < this.effectInterval[soundName]) {\r\n                onError && onError();\r\n                return;\r\n            }\r\n            if (!audioClip) {\r\n                this.error(`playEffect ${name} `);\r\n                onError && onError();\r\n                return;\r\n            }\r\n\r\n            if (interval > 0) {\r\n                this.effectInterval[soundName] = Date.now() + interval * 1000;\r\n            }\r\n\r\n            AudioEngine.inst.playEffect(audioClip, volume, loop, onPlay, onEnded);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param name \r\n     * @param bundle Bundleapp-sound\r\n     * @param loop \r\n     * @param volume \r\n     * @param interval \r\n     * @returns Promisenull()\r\n     */\r\n    public async playEffectAsync(params: playEffectAsync<E>): Promise<number>;\r\n    public async playEffectAsync(params: playEffectWidthBundleAsync): Promise<number>;\r\n    public async playEffectAsync(params: any): Promise<number> {\r\n        return new Promise((resolve) => {\r\n            this.playEffect({\r\n                ...params,\r\n                onPlay: (audioID) => {\r\n                    resolve(audioID);\r\n                },\r\n                onError: () => {\r\n                    resolve(null);\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param id \r\n     * @returns \r\n     */\r\n    public pauseEffect(id: number) {\r\n        return AudioEngine.inst.pauseEffect(id);\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @returns \r\n     */\r\n    public pauseAllEffects() {\r\n        return AudioEngine.inst.pauseAllEffects();\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param id \r\n     * @returns \r\n     */\r\n    public resumeEffect(id: number) {\r\n        return AudioEngine.inst.resumeEffect(id);\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @returns \r\n     */\r\n    public resumeAllEffects() {\r\n        return AudioEngine.inst.resumeAllEffects();\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param id \r\n     * @returns \r\n     */\r\n    public stopEffect(id: number) {\r\n        return AudioEngine.inst.stopEffect(id);\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @returns \r\n     */\r\n    public stopAllEffects() {\r\n        return AudioEngine.inst.stopAllEffects();\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param volume \r\n     * @param bundle Bundleapp-sound\r\n     * @param force \r\n     */\r\n    public playMusic(params: playMusic<M>): void;\r\n    public playMusic(params: playMusicWidthBundle): void;\r\n    public playMusic({ name, bundle, volume = 1, force = false, onPlay, onError }): void {\r\n        if (!name) {\r\n            onError && onError();\r\n            return;\r\n        }\r\n\r\n        const bundleName = bundle || BundleName;\r\n        const soundName = `${bundleName}://${name}`;\r\n\r\n        // \r\n        if (!force && this.playingMusic.id !== -1 && this.playingMusic.name === soundName) {\r\n            AudioEngine.inst.setMusicVolume(volume);\r\n            onPlay && onPlay();\r\n            return;\r\n        }\r\n\r\n        // \r\n        this.stopMusic();\r\n\r\n        // uuid\r\n        const uuid = this.createUUID();\r\n        this.playingMusic.uuid = uuid;\r\n        // \r\n        this.playingMusic.name = soundName;\r\n        // \r\n        this.playingMusic.volume = volume;\r\n        // \r\n        this.playingMusic.playing = true;\r\n        this.playingMusic.paused = false;\r\n\r\n        // \r\n        if (this.isMusicMute) {\r\n            onPlay && onPlay();\r\n            return;\r\n        }\r\n\r\n        // \r\n        this.load(name, bundleName, (audioClip) => {\r\n            if (!isValid(this)) {\r\n                onError && onError();\r\n                return;\r\n            }\r\n            // \r\n            if (this.playingMusic.id !== -1) {\r\n                onError && onError();\r\n                return;\r\n            }\r\n            if (this.playingMusic.name !== soundName) {\r\n                onError && onError();\r\n                return;\r\n            }\r\n            if (this.playingMusic.uuid !== this.playingMusic.uuid) {\r\n                onError && onError();\r\n                return;\r\n            }\r\n            // \r\n            if (!audioClip) {\r\n                this.error(`playMusic ${name} `);\r\n                onError && onError();\r\n                return;\r\n            }\r\n            // \r\n            if (this.isMusicMute) {\r\n                onPlay && onPlay();\r\n                return;\r\n            }\r\n\r\n            this.playingMusic.id = AudioEngine.inst.playMusic(audioClip, volume, onPlay);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param volume \r\n     * @param bundle Bundleapp-sound\r\n     * @param force \r\n     * @returns Promisefalse\r\n     */\r\n    public playMusicAsync(params: playMusicAsync<M>): Promise<boolean>;\r\n    public playMusicAsync(params: playMusicWidthBundleAsync): Promise<boolean>;\r\n    public playMusicAsync(params: any): Promise<boolean> {\r\n        return new Promise((resolve) => {\r\n            this.playMusic({\r\n                ...params,\r\n                onPlay: () => {\r\n                    resolve(true);\r\n                },\r\n                onError: () => {\r\n                    resolve(false);\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * \r\n     */\r\n    public replayMusic(onPlay?: Function) {\r\n        if (!this.playingMusic.playing) return;\r\n        if (!this.playingMusic.name) return;\r\n        if (this.playingMusic.name.indexOf('://') > 0) {\r\n            const [bundle, name] = this.playingMusic.name.split('://');\r\n            this.playMusic({\r\n                name,\r\n                bundle,\r\n                volume: this.playingMusic.volume,\r\n                force: true,\r\n                onPlay\r\n            });\r\n        } else {\r\n            this.playMusic({\r\n                name: this.playingMusic.name as any,\r\n                volume: this.playingMusic.volume,\r\n                force: true,\r\n                onPlay\r\n            });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * \r\n     */\r\n    public pauseMusic() {\r\n        if (!this.playingMusic.playing) return false;\r\n        this.playingMusic.paused = true;\r\n        return AudioEngine.inst.pauseMusic();\r\n    }\r\n\r\n    /**\r\n     * \r\n     */\r\n    public resumeMusic() {\r\n        if (!this.playingMusic.playing) return false;\r\n        this.playingMusic.paused = false;\r\n        return AudioEngine.inst.resumeMusic();\r\n    }\r\n\r\n    /**\r\n     * \r\n     */\r\n    public stopMusic() {\r\n        this.playingMusic.playing = false;\r\n        this.playingMusic.paused = false;\r\n        this.playingMusic.volume = 1;\r\n        this.playingMusic.name = '';\r\n        this.playingMusic.uuid = '';\r\n        this.playingMusic.id = -1;\r\n        return AudioEngine.inst.stopMusic();\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param mute \r\n     * @param isCache (localstorage)\r\n     */\r\n    public setMusicMute(mute: boolean, isCache = false) {\r\n        isCache && storage.set(this.musicMuteCacheKey, mute);\r\n        AudioEngine.inst.setMusicMute(mute);\r\n        if (!mute && this.playingMusic.name) {\r\n            if (this.playingMusic.name.indexOf('://') > 0) {\r\n                const [bundle, name] = this.playingMusic.name.split('://');\r\n                this.playMusic({\r\n                    name,\r\n                    bundle,\r\n                    volume: this.playingMusic.volume,\r\n\r\n                });\r\n            } else {\r\n                this.playMusic({\r\n                    name: this.playingMusic.name as any,\r\n                    volume: this.playingMusic.volume\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * \r\n     */\r\n    get isMusicPlaying() {\r\n        return this.playingMusic.playing;\r\n    }\r\n\r\n    /**\r\n     * \r\n     */\r\n    get isMusicPaused() {\r\n        return this.playingMusic.paused;\r\n    }\r\n\r\n    /**\r\n     * \r\n     */\r\n    public get isMusicMute() {\r\n        return AudioEngine.inst.getMusicMute();\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param mute \r\n     * @param isCache (localstorage)\r\n     */\r\n    public setEffectMute(mute: boolean, isCache = false) {\r\n        AudioEngine.inst.setGlobalEffectsMute(mute);\r\n        isCache && storage.set(this.effectMuteCacheKey, mute);\r\n    }\r\n\r\n    /**\r\n     * \r\n     */\r\n    public get isEffectMute() {\r\n        return AudioEngine.inst.getGlobalEffectsMute();\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param scale \r\n     * @param isCache (localstorage)\r\n     */\r\n    public setMusicVolumeScale(scale: number, isCache = false) {\r\n        AudioEngine.inst.setMusicVolumeScale(scale);\r\n        isCache && storage.set(this.musicVolumeScaleCacheKey, scale);\r\n    }\r\n\r\n    /**\r\n     * \r\n     */\r\n    public get musicVolumeScale() {\r\n        return AudioEngine.inst.getMusicVolumeScale();\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param scale \r\n     * @param isCache (localstorage)\r\n     */\r\n    public setEffectVolumeScale(scale: number, isCache = false) {\r\n        AudioEngine.inst.setGlobalEffectsVolumeScale(scale);\r\n        isCache && storage.set(this.effectVolumeScaleCacheKey, scale);\r\n    }\r\n\r\n    /**\r\n     * \r\n     */\r\n    public get effectVolumeScale() {\r\n        return AudioEngine.inst.getGlobalEffectsVolumeScale();\r\n    }\r\n}","import { error, js, log, sys } from 'cc';\r\n\r\nconst chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\r\n\r\nfunction encode(text: string, key: string) {\r\n    key = key || chars;\r\n    let encrypted = '';\r\n    for (let i = 0; i < text.length; i++) {\r\n        const charCode = text.charCodeAt(i) ^ key.charCodeAt(i % key.length);\r\n        encrypted += String.fromCharCode(charCode);\r\n    }\r\n    return encrypted;\r\n}\r\n\r\nfunction decode(encryptedText: string, key: string) {\r\n    key = key || chars;\r\n    let decrypted = '';\r\n    for (let i = 0; i < encryptedText.length; i++) {\r\n        const charCode = encryptedText.charCodeAt(i) ^ key.charCodeAt(i % key.length);\r\n        decrypted += String.fromCharCode(charCode);\r\n    }\r\n    return decrypted;\r\n}\r\n\r\nconst weekOfYear = function (curDate?: Date) {\r\n    /*\r\n     date1\r\n     date2\r\n     d\r\n     d + 7\r\n     */\r\n    curDate = curDate || new Date();\r\n    let a = curDate.getFullYear();\r\n    let b = curDate.getMonth() + 1;\r\n    let c = curDate.getDate();\r\n\r\n    let date1 = new Date(a, b - 1, c), date2 = new Date(a, 0, 1),\r\n        d = Math.round((date1.valueOf() - date2.valueOf()) / 86400000);\r\n    return Math.ceil(\r\n        (d + ((date2.getDay() + 1) - 1)) / 7\r\n    );\r\n};\r\n\r\nconst getWeekUpdateTime = function () {\r\n    const date = new Date();\r\n    const year = date.getFullYear();\r\n    const week = weekOfYear(date);\r\n    return year + '' + week;\r\n};\r\n\r\nconst getDayUpdateTime = function (curDate?: Date) {\r\n    curDate = curDate || new Date();\r\n    return curDate.toLocaleDateString();\r\n};\r\n\r\nexport class Storage {\r\n    static setting: {\r\n        /**\r\n         *   \r\n         * - \r\n         */\r\n        secretKey: string\r\n    } = {\r\n            secretKey: ''\r\n        };\r\n\r\n    private _cache = {};\r\n\r\n    /**\r\n     * false\r\n     */\r\n    set(key: string, value: unknown) {\r\n        if (typeof key === 'string' && typeof value !== 'undefined') {\r\n            try {\r\n                const data = JSON.stringify(value);\r\n                if (Storage.setting.secretKey) {\r\n                    sys.localStorage.setItem(key, encode(data, Storage.setting.secretKey));\r\n                } else {\r\n                    sys.localStorage.setItem(key, data);\r\n                }\r\n                // \r\n                this._cache[key] = data;\r\n                return true;\r\n            } catch (err) { log(err); }\r\n        } else {\r\n            error('storage set error');\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * undefined\r\n     */\r\n    get(key: string) {\r\n        // \r\n        if (typeof this._cache[key] !== 'undefined') {\r\n            return JSON.parse(this._cache[key]);\r\n        }\r\n\r\n        let result = null;\r\n        try {\r\n            let data = sys.localStorage.getItem(key);\r\n            if (data && typeof data === 'string') {\r\n                if (Storage.setting.secretKey) data = decode(data, Storage.setting.secretKey);\r\n                // \r\n                this._cache[key] = data;\r\n                result = JSON.parse(data);\r\n            } else if (data !== '' && data !== null) {\r\n                result = undefined;\r\n            }\r\n        } catch (e) {\r\n            result = undefined;\r\n        }\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * false\r\n     */\r\n    add(key: string, value: number = 1) {\r\n        let result = this.get(key);\r\n        if (result !== undefined) {\r\n            result = result || 0;\r\n            result += value;\r\n            if (this.set(key, result)) {\r\n                return result;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * false\r\n     */\r\n    remove(key: string) {\r\n        try {\r\n            sys.localStorage.removeItem(key);\r\n            delete this._cache[key];\r\n            return true;\r\n        } catch (err) {\r\n            return false;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * false\r\n     */\r\n    clear() {\r\n        try {\r\n            sys.localStorage.clear();\r\n            js.clear(this._cache);\r\n            return true;\r\n        } catch (err) {\r\n            return false;\r\n        }\r\n    }\r\n\r\n    /**\r\n     *  [false]\r\n     * @param {Function} cb cbtrue\r\n     */\r\n    setWeek(key: string, value: unknown, cb?: (oldValue: unknown, newValue: unknown) => boolean) {\r\n        const updateTime = getWeekUpdateTime();\r\n\r\n        if (cb) {\r\n            const data = this.getWeek(key);\r\n            if (data !== undefined) {\r\n                if (data === null || cb(data, value)) {\r\n                    return this.set(key, {\r\n                        data: value,\r\n                        updateTime: updateTime\r\n                    });\r\n                }\r\n            }\r\n        } else {\r\n            return this.set(key, {\r\n                data: value,\r\n                updateTime: updateTime\r\n            });\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     *  [undefined]\r\n     */\r\n    getWeek(key: string) {\r\n        const data = this.get(key);\r\n        if (data && data.updateTime == getWeekUpdateTime()) {\r\n            return data.data;\r\n        }\r\n        return data && null;\r\n    }\r\n\r\n    /**\r\n     *  [false]\r\n     * @param {Function} cb cbtrue\r\n     */\r\n    setDay(key: string, value: unknown, cb?: (oldValue: unknown, newValue: unknown) => boolean) {\r\n        const updateTime = getDayUpdateTime();\r\n\r\n        if (cb) {\r\n            const data = this.getDay(key);\r\n            if (data !== undefined) {\r\n                if (data === null || cb(data, value)) {\r\n                    return this.set(key, {\r\n                        data: value,\r\n                        updateTime: updateTime\r\n                    });\r\n                }\r\n            }\r\n        } else {\r\n            return this.set(key, {\r\n                data: value,\r\n                updateTime: updateTime\r\n            });\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     *  [undefined]\r\n     * @param {*} key \r\n     */\r\n    getDay(key: string) {\r\n        const data = this.get(key);\r\n        if (data && data.updateTime == getDayUpdateTime()) {\r\n            return data.data;\r\n        }\r\n        return data && null;\r\n    }\r\n}\r\n\r\nexport default new Storage();","interface IHandle {\r\n    (next: (data?: any) => boolean, retry: (timeout?: number) => Promise<boolean>, end: (data?: any) => boolean): void\r\n}\r\n\r\ninterface IFinish<T> {\r\n    (results?: T, success?: boolean): any\r\n}\r\n\r\nexport interface ITask<T extends Array<any> = any[]> {\r\n    readonly results: Readonly<T>;\r\n    size(): number;\r\n    add(handle: IHandle): this;\r\n    start(finish?: IFinish<T> | Function): this;\r\n    stop(): boolean;\r\n    isRunning(): boolean;\r\n}\r\n\r\n/**\r\n * \r\n */\r\nexport class Sync<T extends Array<any>> implements ITask<T> {\r\n    private running = false;\r\n    private index: number = -1;\r\n    private list: IHandle[] = [];\r\n    private finish: IFinish<T> | Function = null;\r\n\r\n    /**\r\n     * handlenextend\r\n     */\r\n    public results: T = [] as T;\r\n\r\n    /**\r\n     * \r\n     * @returns \r\n     */\r\n    public size(): number {\r\n        return this.list.length;\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param handle \r\n     * @returns \r\n     */\r\n    public add(handle: IHandle) {\r\n        this.list.push(handle);\r\n        this.results.push(undefined);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param finish \r\n     * @returns \r\n     */\r\n    public start(finish?: IFinish<T> | Function) {\r\n        if (this.running) {\r\n            return this;\r\n        }\r\n\r\n        this.running = true;\r\n        this.index = -1;\r\n        this.finish = finish;\r\n\r\n        this.next(this.index);\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @returns \r\n     */\r\n    public stop(): boolean {\r\n        if (!this.running) {\r\n            return false;\r\n        }\r\n\r\n        this.running = false;\r\n        if (this.finish) {\r\n            this.finish(this.results, false);\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @returns \r\n     */\r\n    public isRunning() {\r\n        return this.running;\r\n    }\r\n\r\n    /**\r\n     * @deprecated\r\n     * @returns \r\n     */\r\n    public isStop() {\r\n        return !this.running;\r\n    }\r\n\r\n    private end(data?: any): boolean {\r\n        if (!this.running) {\r\n            return false;\r\n        }\r\n\r\n        if (typeof data !== 'undefined') {\r\n            this.results[this.index] = data;\r\n        }\r\n\r\n        this.running = false;\r\n        if (this.finish) {\r\n            this.finish(this.results, true);\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    private next(index: number, data?: any): boolean {\r\n        if (!this.running) {\r\n            return false;\r\n        }\r\n\r\n        if (index !== this.index) return false;\r\n\r\n        if (typeof data !== 'undefined') {\r\n            this.results[this.index] = data;\r\n        }\r\n\r\n        if (++this.index < this.list.length) {\r\n            this.retry(this.index);\r\n        } else {\r\n            this.end();\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    private retry(index: number): boolean {\r\n        if (!this.running) {\r\n            return false;\r\n        }\r\n\r\n        if (index !== this.index) return false;\r\n\r\n        const handle = this.list[index];\r\n        handle && handle(\r\n            (data?: any) => this.next(index, data),\r\n            (timeout = 0) => {\r\n                return new Promise(resolve => {\r\n                    if (timeout > 0) {\r\n                        setTimeout(() => {\r\n                            resolve(this.retry(index));\r\n                        }, timeout * 1000);\r\n                    } else {\r\n                        resolve(this.retry(index));\r\n                    }\r\n                });\r\n            },\r\n            (data?: any) => this.end(data)\r\n        );\r\n\r\n        return true;\r\n    }\r\n}\r\n\r\n/**\r\n * \r\n */\r\nexport class ASync<T extends Array<any>> implements ITask<T> {\r\n    private running = false;\r\n    private count: number = 0;\r\n    private list: IHandle[] = [];\r\n    private finish: IFinish<T> | Function = null;\r\n\r\n    /**\r\n     * handlenextend\r\n     */\r\n    public results: T = [] as T;\r\n\r\n    /**\r\n     * \r\n     * @returns \r\n     */\r\n    public size(): number {\r\n        return this.list.length;\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param handle \r\n     * @returns \r\n     */\r\n    public add(handle: IHandle) {\r\n        this.list.push(handle);\r\n        this.results.push(undefined);\r\n\r\n        if (this.running) {\r\n            this.retry(this.list.length - 1);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param finish \r\n     * @returns \r\n     */\r\n    public start(finish?: IFinish<T> | Function) {\r\n        if (this.running) {\r\n            return this;\r\n        }\r\n\r\n        this.running = true;\r\n        this.count = 0;\r\n        this.finish = finish;\r\n\r\n        if (this.list.length) {\r\n            for (let index = 0; index < this.list.length; index++) {\r\n                this.retry(index);\r\n            }\r\n        } else {\r\n            this.end && this.end(this.count);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @returns \r\n     */\r\n    public stop(): boolean {\r\n        if (!this.running) {\r\n            return false;\r\n        }\r\n        this.running = false;\r\n        if (this.finish) {\r\n            this.finish(this.results, false);\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @returns \r\n     */\r\n    public isRunning() {\r\n        return this.running;\r\n    }\r\n\r\n    /**\r\n     * @deprecated\r\n     * @returns \r\n     */\r\n    public isStop() {\r\n        return !this.running;\r\n    }\r\n\r\n    private end(index: number, data?: any): boolean {\r\n        if (!this.running) {\r\n            return false;\r\n        }\r\n\r\n        if (index >= 0 && index < this.results.length) {\r\n            if (this.results[index] || this.results[index] === null) return false;\r\n            this.results[index] = typeof data !== 'undefined' ? data : null;\r\n        }\r\n\r\n        this.running = false;\r\n        if (this.finish) {\r\n            this.finish(this.results, true);\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    private next(index: number, data?: any): boolean {\r\n        if (!this.running) {\r\n            return false;\r\n        }\r\n\r\n        if (index >= 0 && index < this.results.length) {\r\n            if (this.results[index] || this.results[index] === null) return false;\r\n            this.results[index] = typeof data !== 'undefined' ? data : null;\r\n        }\r\n\r\n        if (++this.count === this.list.length) {\r\n            this.end && this.end(this.count);\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    private retry(index: number): boolean {\r\n        if (!this.running) {\r\n            return false;\r\n        }\r\n\r\n        const handle = this.list[index];\r\n        handle && handle(\r\n            (data?: any) => this.next(index, data),\r\n            (timeout = 0) => {\r\n                return new Promise(resolve => {\r\n                    if (timeout > 0) {\r\n                        setTimeout(() => {\r\n                            resolve(this.retry(index));\r\n                        }, timeout * 1000);\r\n                    } else {\r\n                        resolve(this.retry(index));\r\n                    }\r\n                });\r\n            },\r\n            (data?: any) => this.end(index, data)\r\n        );\r\n\r\n        return true;\r\n    }\r\n}\r\n\r\nexport class Any<T extends Array<any>> implements ITask<T> {\r\n    private task = new Sync();\r\n\r\n    /**\r\n     * handlenextend\r\n     */\r\n    public get results(): T {\r\n        return this.task.results as T;\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @returns \r\n     */\r\n    public size() {\r\n        return this.task.size();\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param handle \r\n     * @returns \r\n     */\r\n    public add(handles: IHandle | IHandle[]) {\r\n        if (handles instanceof Array) {\r\n            const async = new ASync();\r\n            handles.forEach(handle => async.add(handle));\r\n            this.task.add(async.start.bind(async));\r\n        } else {\r\n            this.task.add(handles);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param finish \r\n     * @returns \r\n     */\r\n    public start(finish?: IFinish<T> | Function) {\r\n        this.task.start(finish);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @returns \r\n     */\r\n    public stop() {\r\n        return this.task.stop();\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @returns \r\n     */\r\n    public isRunning() {\r\n        return this.task.isRunning();\r\n    }\r\n\r\n    /**\r\n     * @deprecated\r\n     * @returns \r\n     */\r\n    public isStop() {\r\n        return this.task.isStop();\r\n    }\r\n}\r\n\r\ninterface IExecuteCallBack {\r\n    (retry: (timeout?: number) => void): void\r\n}\r\n\r\nconst task = {\r\n    /**\r\n     * \r\n     */\r\n    createSync<T extends Array<any>>(): Sync<T> {\r\n        return new Sync<T>();\r\n    },\r\n\r\n    /**\r\n     * \r\n     */\r\n    createASync<T extends Array<any>>(): ASync<T> {\r\n        return new ASync<T>();\r\n    },\r\n\r\n    /**\r\n     * \r\n     * @example\r\n     * createAny()\r\n     * .add(1).add(2).add(3).add(4)\r\n     * .add([5,6,7])\r\n     * .add(8)\r\n     * 12345678\r\n     */\r\n    createAny<T extends Array<any>>() {\r\n        return new Any<T>();\r\n    },\r\n\r\n    /**\r\n     * \r\n     */\r\n    execute(fun: IExecuteCallBack, retryMax = -1, retryFinish?: Function) {\r\n        fun(function retry(timeout = 0) {\r\n            if (retryMax === 0) return retryFinish && retryFinish();\r\n            retryMax = retryMax > 0 ? retryMax - 1 : retryMax;\r\n            if (timeout > 0) {\r\n                setTimeout(() => task.execute(fun, retryMax, retryFinish), timeout * 1000);\r\n            } else {\r\n                task.execute(fun, retryMax, retryFinish);\r\n            }\r\n        });\r\n    }\r\n};\r\n\r\nexport default task;","import { _decorator } from 'cc';\r\nimport BaseManager from '../../base/BaseManager';\r\nconst { ccclass } = _decorator;\r\n\r\ntype ICallback = (...args: any[]) => any;\r\n\r\nclass DailyTimer {\r\n    // \r\n    private static getDayTimeMs(date: Date): number {\r\n        return (\r\n            date.getHours() * 3600 +\r\n            date.getMinutes() * 60 +\r\n            date.getSeconds()\r\n        ) * 1000 + date.getMilliseconds();\r\n    }\r\n\r\n    // \r\n    private static parseTimeToMs(h: number, m: number, s: number): number {\r\n        return ((h * 3600 + m * 60 + s) * 1000) % 86400000;\r\n    }\r\n\r\n    private readonly startMs: number;  // \r\n    private readonly endMs: number;    // \r\n\r\n    // \r\n    private checkDay = 0;\r\n\r\n    constructor(\r\n        time: string,\r\n        public readonly callback: ICallback,\r\n        public readonly target?: unknown,\r\n        public readonly once: boolean = false\r\n    ) {\r\n        // \r\n        const [startSegment, endSegment = startSegment] = time.split('-');\r\n\r\n        // \r\n        const [startH = 0, startM = 0, startS = 0] = startSegment.split(':').map(\r\n            part => Math.max(0, parseInt(part, 10) || 0)\r\n        );\r\n        this.startMs = DailyTimer.parseTimeToMs(startH, startM, startS);\r\n\r\n        // \r\n        const [endH = 0, endM = 0, endS = 0] = endSegment.split(':').map(\r\n            part => Math.max(0, parseInt(part, 10) || 0)\r\n        );\r\n        this.endMs = DailyTimer.parseTimeToMs(endH, endM, endS);\r\n        // \r\n        if (this.endMs === this.startMs) {\r\n            if (startM === 0 && startS === 0) {\r\n                this.endMs = DailyTimer.parseTimeToMs(startH + 1, startM, startS);\r\n            } else if (startS === 0) {\r\n                this.endMs = DailyTimer.parseTimeToMs(startH, startM + 1, startS);\r\n            } else {\r\n                this.endMs = DailyTimer.parseTimeToMs(startH, startM, startS + 1);\r\n            }\r\n        }\r\n    }\r\n\r\n    // \r\n    private isInRange(now: Date): boolean {\r\n        const currentMs = DailyTimer.getDayTimeMs(now);\r\n\r\n        //  23:00-01:00\r\n        return this.startMs <= this.endMs\r\n            ? currentMs >= this.startMs && currentMs < this.endMs\r\n            : currentMs >= this.startMs || currentMs < this.endMs;\r\n    }\r\n\r\n    update(now: Date): boolean {\r\n        const dateDay = now.getDay();\r\n\r\n        if (this.checkDay === dateDay) return false;\r\n        if (!this.isInRange(now)) return false;\r\n\r\n        this.checkDay = dateDay;\r\n        this.callback.call(this.target);\r\n\r\n        return this.once;\r\n    }\r\n}\r\n\r\nclass IntervalTimer {\r\n    private elapsed: number = 0;\r\n\r\n    constructor(\r\n        public readonly interval: number,\r\n        public readonly callback: ICallback,\r\n        public readonly target?: unknown,\r\n        public readonly once: boolean = false\r\n    ) { }\r\n\r\n    update(dt: number): boolean {\r\n        this.elapsed += dt;\r\n        let completed = false;\r\n\r\n        // dt > interval\r\n        while (this.elapsed >= this.interval) {\r\n            this.callback.call(this.target);\r\n            this.elapsed -= this.interval;\r\n\r\n            if (this.once) {\r\n                completed = true;\r\n                break;\r\n            }\r\n        }\r\n\r\n        return completed;\r\n    }\r\n}\r\n\r\nclass Timer {\r\n    static update(timer: Timer, dt: number) {\r\n        return timer.update(dt);\r\n    }\r\n\r\n    private intervalTimer: IntervalTimer[] = [];\r\n\r\n    /**\r\n     * \r\n     * @param interval \r\n     * @param callback \r\n     * @param target \r\n     * @param once \r\n     */\r\n    register(\r\n        interval: number,\r\n        callback: ICallback,\r\n        target?: unknown,\r\n        once?: boolean\r\n    ): void {\r\n        const timer = new IntervalTimer(interval, callback, target, once || false);\r\n        this.intervalTimer.push(timer);\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param callback \r\n     * @param target \r\n     */\r\n    unregister(callback: ICallback, target?: unknown): void {\r\n        if (typeof target === 'undefined') {\r\n            this.intervalTimer = this.intervalTimer.filter(\r\n                timer => timer.callback !== callback\r\n            );\r\n        } else {\r\n            this.intervalTimer = this.intervalTimer.filter(\r\n                timer => !(timer.callback === callback && timer.target === target)\r\n            );\r\n        }\r\n    }\r\n\r\n    /**\r\n     * \r\n     */\r\n    unregisterAll() {\r\n        this.intervalTimer = [];\r\n    }\r\n\r\n    private dailyTimers: DailyTimer[] = [];\r\n\r\n    /**\r\n     * \r\n     * @param time 24,\r\n     * \r\n     * @example\r\n     * registerDailyTrigger('16', ...)  registerDailyTrigger('16-17', ...)\r\n     * registerDailyTrigger('8-9:00', ...)  registerDailyTrigger('8', ...)\r\n     * registerDailyTrigger('8:00:01-24', ...)\r\n     */\r\n    registerDailyTrigger(\r\n        time: string,\r\n        callback: ICallback,\r\n        target?: unknown,\r\n        once?: boolean\r\n    ) {\r\n        const timer = new DailyTimer(time, callback, target, once || false);\r\n        this.dailyTimers.push(timer);\r\n    }\r\n\r\n    /**\r\n     * \r\n     */\r\n    unregisterDailyTrigger(callback: ICallback, target?: unknown) {\r\n        if (typeof target === 'undefined') {\r\n            this.dailyTimers = this.dailyTimers.filter(\r\n                timer => timer.callback !== callback\r\n            );\r\n        } else {\r\n            this.dailyTimers = this.dailyTimers.filter(\r\n                timer => !(timer.callback === callback && timer.target === target)\r\n            );\r\n        }\r\n    }\r\n\r\n    /**\r\n     * \r\n     */\r\n    unregisterAllDailyTrigger() {\r\n        this.dailyTimers = [];\r\n    }\r\n\r\n    /**\r\n     * \r\n     */\r\n    clear() {\r\n        this.intervalTimer = [];\r\n        this.dailyTimers = [];\r\n    }\r\n\r\n    protected update(dt: number): void {\r\n        for (let index = 0; index < this.intervalTimer.length; index++) {\r\n            const timer = this.intervalTimer[index];\r\n            if (timer.update(dt)) {\r\n                this.intervalTimer.splice(index, 1);\r\n                index--;\r\n            }\r\n        }\r\n\r\n        const date = new Date();\r\n        for (let index = 0; index < this.dailyTimers.length; index++) {\r\n            const timer = this.dailyTimers[index];\r\n            if (timer.update(date)) {\r\n                this.dailyTimers.splice(index, 1);\r\n                index--;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n@ccclass('TimerManager')\r\nexport default class TimerManager extends BaseManager {\r\n    private timers: Map<string | number, Timer> = new Map();\r\n\r\n    /**\r\n     * \r\n     */\r\n    clear() {\r\n        this.timers.forEach((timer) => {\r\n            timer.clear();\r\n        });\r\n        this.timers.clear();\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param key key\r\n     */\r\n    delete(key: string | number) {\r\n        const timer = this.timers.get(key);\r\n        if (!timer) return;\r\n\r\n        this.timers.delete(key);\r\n        timer.clear();\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param key key\r\n     */\r\n    get(key: string | number): Timer {\r\n        if (this.timers.has(key)) {\r\n            return this.timers.get(key);\r\n        }\r\n\r\n        const timer = new Timer();\r\n        this.timers.set(key, timer);\r\n        return timer;\r\n    }\r\n\r\n    protected update(dt: number): void {\r\n        this.timers.forEach((timer) => {\r\n            Timer.update(timer, dt);\r\n        });\r\n    }\r\n}\r\n","import { Asset, AssetManager, Camera, Canvas, Component, Event, Layers, Node, Prefab, RenderTexture, ResolutionPolicy, Scene, SceneAsset, Settings, UITransform, Widget, _decorator, director, instantiate, isValid, js, screen, settings, size, view } from 'cc';\r\nimport { DEV } from 'cc/env';\r\nimport { IMiniViewName, IViewName } from '../../../../../assets/app-builtin/app-admin/executor';\r\nimport Core from '../../Core';\r\nimport BaseManager from '../../base/BaseManager';\r\nimport BaseView, { IHideParamOnHide, IShade, IShowParamAttr, IShowParamOnHide, IShowParamOnShow, IViewType, ViewType } from '../../base/BaseView';\r\nimport UIMgrLoading from './comp/UIMgrLoading';\r\nimport UIMgrShade from './comp/UIMgrShade';\r\nimport UIMgrToast from './comp/UIMgrToast';\r\nimport UIMgrZOrder from './comp/UIMgrZOrder';\r\n\r\nconst { ccclass, property } = _decorator;\r\n\r\ninterface IShowParams<T, IShow = any, IShowReturn = any, IHideReturn = any> {\r\n    /**UI */\r\n    name: T,\r\n    /**\r\n     * \r\n     * - onShow\r\n     */\r\n    data?: IShow,\r\n    /**\r\n     * UI \r\n     * - true\r\n     */\r\n    top?: boolean,\r\n    /**\r\n     * UIUI\r\n     * - join:  \r\n     * - jump: ()\r\n     */\r\n    queue?: 'join' | 'jump',\r\n    /** false(loading) */\r\n    silent?: boolean,\r\n    /**UIonShow */\r\n    onShow?: IShowParamOnShow<IShowReturn>,\r\n    /**UIonHide */\r\n    onHide?: IShowParamOnHide<IHideReturn>,\r\n    /**codeErrorCode.LogicErrortrue */\r\n    onError?: (result: string, code: ErrorCode) => true | void,\r\n    /**\r\n     * @private\r\n     * @deprecated\r\n     */\r\n    attr?: IShowParamAttr,\r\n}\r\n\r\ninterface IShowAsyncParams<T, IShow = any, IShowReturn = any> {\r\n    /**UI */\r\n    name: T,\r\n    /**\r\n     * \r\n     * - onShow\r\n     */\r\n    data?: IShow,\r\n    /**\r\n     * UI \r\n     * - true\r\n     */\r\n    top?: boolean,\r\n    /**\r\n     * UIUI\r\n     * - join:  \r\n     * - jump: ()\r\n     */\r\n    queue?: 'join' | 'jump',\r\n    /** false(loading) */\r\n    silent?: boolean,\r\n    /**UIonShow */\r\n    onShow?: IShowParamOnShow<IShowReturn>,\r\n    /**codeErrorCode.LogicErrortrue */\r\n    onError?: (result: string, code: ErrorCode) => true | void,\r\n    /**\r\n     * @private\r\n     * @deprecated\r\n     */\r\n    attr?: IShowParamAttr,\r\n}\r\n\r\ninterface IHideParams<T, IHide = any, IHideReturn = any> {\r\n    name: T,\r\n    data?: IHide,\r\n    onHide?: IHideParamOnHide<IHideReturn>\r\n}\r\n\r\nconst UIScene = 'UIScene';\r\nconst UserInterfacePath = 'UserInterface';\r\nconst ViewTypes = [ViewType.Page, ViewType.Paper, ViewType.Pop, ViewType.Top];\r\n\r\nconst BlockEvents = [\r\n    Node.EventType.TOUCH_START, Node.EventType.TOUCH_MOVE, Node.EventType.TOUCH_END, Node.EventType.TOUCH_CANCEL,\r\n    Node.EventType.MOUSE_DOWN, Node.EventType.MOUSE_MOVE, Node.EventType.MOUSE_UP,\r\n    Node.EventType.MOUSE_ENTER, Node.EventType.MOUSE_LEAVE, Node.EventType.MOUSE_WHEEL\r\n];\r\n\r\n/**\r\n * \r\n */\r\nenum ErrorCode {\r\n    /** */\r\n    LoadError,\r\n    /**beforeShow */\r\n    LogicError,\r\n    /**UI(UIisViewValidfalse) */\r\n    InvalidError,\r\n}\r\n\r\n/**\r\n * \r\n */\r\nconst ViewName: { [key in IViewName]: key } = new Proxy({} as any, {\r\n    get: function (target, key) {\r\n        if (target[key]) return target[key];\r\n        target[key] = key;\r\n        return key;\r\n    }\r\n});\r\n\r\n/**\r\n * \r\n */\r\nconst MiniViewName: { [key in IMiniViewName]: key } = new Proxy({} as any, {\r\n    get: function (target, key) {\r\n        if (target[key]) return target[key];\r\n        target[key] = key;\r\n        return key;\r\n    }\r\n});\r\n\r\n/**\r\n * \r\n * @param str \r\n * @param lower ()\r\n * @returns \r\n */\r\nfunction stringCase(str: string, lower = false) {\r\n    str = str.replace(/-/g, '_');\r\n    const arr = str.split('_');\r\n\r\n    return arr.map(function (str, index) {\r\n        if (index === 0 && lower) {\r\n            return str.charAt(0).toLocaleLowerCase() + str.slice(1);\r\n        }\r\n        return str.charAt(0).toLocaleUpperCase() + str.slice(1);\r\n    }).join('');\r\n}\r\n\r\n/**\r\n * \r\n * @param str \r\n * @returns \r\n */\r\nfunction stringCaseNegate(str: string) {\r\n    return str.replace(/[A-Z]/g, (searchStr, startIndex) => {\r\n        if (startIndex === 0) {\r\n            return searchStr.toLocaleLowerCase();\r\n        } else {\r\n            return '-' + searchStr.toLocaleLowerCase();\r\n        }\r\n    });\r\n}\r\n\r\n@ccclass('UIManager')\r\nexport default class UIManager<UIName extends string, MiniName extends string> extends BaseManager {\r\n    /** */\r\n    static setting: {\r\n        /**UI */\r\n        preload?: (IViewName | IMiniViewName | Array<IViewName | IMiniViewName>)[],\r\n        /**UI */\r\n        defaultUI?: IViewName,\r\n        /**UI */\r\n        defaultData?: any,\r\n        /** */\r\n        shade?: IShade,\r\n        /**\r\n         * \r\n         * - ()\r\n         *   - />= /\r\n         *   - /< /\r\n         */\r\n        autoFit?: boolean,\r\n    } = {};\r\n\r\n    /** */\r\n    static ErrorCode = ErrorCode;\r\n\r\n    /** */\r\n    static ViewName = ViewName;\r\n\r\n    /** */\r\n    static MiniViewName = MiniViewName;\r\n\r\n    @property({\r\n        type: Prefab,\r\n        tooltip: ': app://manager/ui/prefab/UIMgrLoading'\r\n    })\r\n    private loadingPre: Prefab = null;\r\n\r\n    @property({\r\n        type: Prefab,\r\n        tooltip: ': app://manager/ui/prefab/UIMgrShade'\r\n    })\r\n    private shadePre: Prefab = null;\r\n\r\n    @property({\r\n        type: Prefab,\r\n        tooltip: ': app://manager/ui/prefab/UIMgrToast'\r\n    })\r\n    private toastPre: Prefab = null;\r\n\r\n    // UI\r\n    private UserInterface: Node = null;\r\n\r\n    // \r\n    private loading: Node = null;\r\n    private shade: Node = null;\r\n    private toast: Node = null;\r\n\r\n    private defaultUI: UIName = null;\r\n    private defaultData: string = '';\r\n\r\n    private currScene: string = '';\r\n    private currPage: BaseView = null;\r\n    private currFocus: BaseView = null;\r\n\r\n    // \r\n    private prefabCache: { [name in string]: Prefab } = {};\r\n    private sceneCache: { [name in string]: SceneAsset } = {};\r\n\r\n    // \r\n    private touchEnabled: boolean = true;\r\n\r\n    // \r\n    private touchMaskMap = new Map<string, boolean>();\r\n    // \r\n    private showLoadingMap = new Map<string, boolean>();\r\n\r\n    // ui\r\n    private uiLoadingMap: Map<UIName, string[]> = new Map();\r\n    // ui\r\n    private uiShowingMap: Map<BaseView, UIName> = new Map();\r\n\r\n    private showQueue: IShowParams<UIName>[] = [];\r\n\r\n    /**UI */\r\n    public get root() {\r\n        return this.node.parent.parent;\r\n    }\r\n\r\n    /** */\r\n    public get camera() {\r\n        return this.canvas.cameraComponent;\r\n    }\r\n\r\n    /***/\r\n    public get canvas() {\r\n        return this.root.getComponent(Canvas);\r\n    }\r\n\r\n    protected init(finish: Function) {\r\n        const setting = UIManager.setting;\r\n\r\n        this.defaultUI = setting.defaultUI as UIName;\r\n        this.defaultData = setting.defaultData;\r\n\r\n        super.init(finish);\r\n\r\n        // ,AnyTask\r\n        if (setting.preload?.length) {\r\n            const task = Core.inst.lib.task.createAny();\r\n            setting.preload.forEach((preload) => {\r\n                if (preload instanceof Array) {\r\n                    task.add(preload.map(name => {\r\n                        return next => this.preload(name as any, next);\r\n                    }));\r\n                } else {\r\n                    task.add(next => this.preload(preload as any, next));\r\n                }\r\n            });\r\n            task.start();\r\n        }\r\n    }\r\n\r\n    protected onLoad() {\r\n        this.UserInterface = this.root.getChildByName(UserInterfacePath);\r\n\r\n        this.root.getComponentsInChildren(Camera).forEach(camera => {\r\n            // camera.priority<0\r\n            if (camera.priority < 0) camera.priority = 0;\r\n            // camera.far<=camera.near\r\n            if (camera.far <= camera.near) camera.far = camera.near + 1;\r\n        });\r\n        director.addPersistRootNode(this.root);\r\n\r\n        this.createTypeRoot();\r\n\r\n        this.shade = instantiate(this.shadePre);\r\n        this.shade.parent = this.UserInterface;\r\n        this.shade.active = false;\r\n        this.shade.getComponent(Widget).target = this.root;\r\n\r\n        this.loading = instantiate(this.loadingPre);\r\n        this.loading.parent = this.node;\r\n        this.loading.active = false;\r\n\r\n        // toast\r\n        if (this.toastPre) {\r\n            this.toast = instantiate(this.toastPre);\r\n            this.toast.parent = this.node;\r\n        }\r\n\r\n        // \r\n        if (UIManager.setting.autoFit) {\r\n            const designResolution = settings.querySettings(Settings.Category.SCREEN, 'designResolution') as { width: number, height: number, policy: number };\r\n            const windowSize = size(screen.windowSize);\r\n            let resolutionPolicy = designResolution.policy;\r\n            const autoFitResolutionPolicy = function () {\r\n                if (windowSize.width / windowSize.height > designResolution.width / designResolution.height) {\r\n                    if (resolutionPolicy === ResolutionPolicy.FIXED_HEIGHT) return;\r\n                    view.setResolutionPolicy(ResolutionPolicy.FIXED_HEIGHT);\r\n                    resolutionPolicy = ResolutionPolicy.FIXED_HEIGHT;\r\n                } else {\r\n                    if (resolutionPolicy === ResolutionPolicy.FIXED_WIDTH) return;\r\n                    view.setResolutionPolicy(ResolutionPolicy.FIXED_WIDTH);\r\n                    resolutionPolicy = ResolutionPolicy.FIXED_WIDTH;\r\n                }\r\n            };\r\n            autoFitResolutionPolicy();\r\n            this.schedule(() => {\r\n                if (windowSize.equals(screen.windowSize)) return;\r\n                windowSize.set(screen.windowSize);\r\n                autoFitResolutionPolicy();\r\n            }, 0.5);\r\n        }\r\n    }\r\n\r\n    private createTypeRoot() {\r\n        ViewTypes.forEach((type) => {\r\n            const d2 = new Node(type);\r\n            d2.layer = Layers.Enum.UI_2D;\r\n            d2.addComponent(UIMgrZOrder);\r\n            d2.parent = this.UserInterface;\r\n            d2.addComponent(UITransform);\r\n            const widget = d2.addComponent(Widget);\r\n            widget.isAlignBottom = true;\r\n            widget.isAlignLeft = true;\r\n            widget.isAlignRight = true;\r\n            widget.isAlignTop = true;\r\n            widget.top = 0;\r\n            widget.left = 0;\r\n            widget.right = 0;\r\n            widget.bottom = 0;\r\n            widget.alignMode = Widget.AlignMode.ON_WINDOW_RESIZE;\r\n\r\n            if (DEV) {\r\n                d2.on(Node.EventType.CHILD_ADDED, (child: Node) => {\r\n                    if (!child) return;\r\n                    if (child === this.shade) return;\r\n                    if (this.getBaseView(child)) return;\r\n                    this.warn(`${UserInterfacePath}/${type}UI:`, child?.name);\r\n                }, this);\r\n            }\r\n        });\r\n    }\r\n\r\n    private addTouchMaskListener() {\r\n        if (!this.touchEnabled) return;\r\n        if (this.touchMaskMap.size > 0) return;\r\n\r\n        for (let i = 0; i < BlockEvents.length; i++) {\r\n            this.root.on(BlockEvents[i], this.stopPropagation, this, true);\r\n        }\r\n    }\r\n\r\n    private removeTouchMaskListener() {\r\n        if (!this.touchEnabled) return;\r\n        if (this.touchMaskMap.size > 0) return;\r\n\r\n        for (let i = 0; i < BlockEvents.length; i++) {\r\n            this.root.off(BlockEvents[i], this.stopPropagation, this, true);\r\n        }\r\n    }\r\n\r\n    private stopPropagation(event: Event) {\r\n        if (!this.touchEnabled || this.touchMaskMap.size > 0) {\r\n            event.propagationStopped = true;\r\n            if (event.type !== Node.EventType.MOUSE_MOVE) {\r\n                this.log('');\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * BaseView, null\r\n     */\r\n    private getBaseView(node: Node): BaseView {\r\n        if (!node) return null;\r\n        return node.components.find(component => component instanceof BaseView) as BaseView;\r\n    }\r\n\r\n    /**\r\n     * view\r\n     * @param target \r\n     * @returns \r\n     */\r\n    private getViewInParents(target: Node) {\r\n        let node = target;\r\n        let com: BaseView = null;\r\n\r\n        while (node.parent && !(node.parent instanceof Scene)) {\r\n            com = this.getBaseView(node.parent);\r\n            if (!com) {\r\n                node = node.parent;\r\n            } else {\r\n                break;\r\n            }\r\n        }\r\n        return com;\r\n    }\r\n\r\n    /**\r\n     * view\r\n     * @param target \r\n     * @returns \r\n     */\r\n    private getViewInChildren(target: Node) {\r\n        for (let index = 0; index < target.children.length; index++) {\r\n            const node = target.children[index];\r\n            const com = this.getBaseView(node);\r\n            if (com) return com;\r\n        }\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * UI\r\n     */\r\n    private getUIClass(name: string): typeof BaseView {\r\n        return js.getClassByName(name) as (typeof BaseView);\r\n    }\r\n\r\n    /**\r\n     * UIUI\r\n     * @param name ui\r\n     * @returns \r\n     */\r\n    private getUIPath(name: string) {\r\n        return name;\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param name    ui\r\n     */\r\n    private getUIPrefix(name: string): ViewType {\r\n        for (let index = 0; index < ViewTypes.length; index++) {\r\n            const typeName = ViewTypes[index];\r\n            if (name.indexOf(typeName) === 0) {\r\n                return typeName;\r\n            }\r\n        }\r\n        this.error('getUIPrefix', `${name}`);\r\n    }\r\n\r\n    /**\r\n     * UI\r\n     * @param name    ui\r\n     */\r\n    private getUIParent(name: string): Node {\r\n        if (this.currScene === name) {\r\n            return director.getScene();\r\n        }\r\n\r\n        const prefix = this.getUIPrefix(name);\r\n        for (let index = 0; index < ViewTypes.length; index++) {\r\n            const viewType = ViewTypes[index];\r\n            if (viewType === prefix) {\r\n                return this.UserInterface.getChildByName(viewType);\r\n            }\r\n        }\r\n\r\n        this.error('getUIParent', `${name}Parent`);\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * UI\r\n     * @param name    ui\r\n     */\r\n    private getUIInScene(name: string): Node;\r\n    private getUIInScene(name: string, multiple: false): Node;\r\n    private getUIInScene(name: string, multiple: true): Node[];\r\n    private getUIInScene(name: string, multiple = false) {\r\n        const parent = this.getUIParent(name);\r\n\r\n        if (multiple) {\r\n            const result = parent.children.filter(node => node.name === name);\r\n            if (result.length) return result.filter(node => isValid(node, true));\r\n        } else {\r\n            const result = parent.children.find(node => node.name === name);\r\n            if (result) return isValid(result, true) ? result : null;\r\n        }\r\n\r\n        return multiple ? [] : null;\r\n    }\r\n\r\n    /**\r\n     * UI\r\n     * @param name    ui\r\n     */\r\n    private getUIInShowing(name: string): Node;\r\n    private getUIInShowing(name: string, multiple: false): Node;\r\n    private getUIInShowing(name: string, multiple: true): Node[];\r\n    private getUIInShowing(name: string, multiple = false) {\r\n        if (multiple) {\r\n            const result: Node[] = [];\r\n            this.uiShowingMap.forEach((_name, com) => {\r\n                if (_name === name) result.push(com.node);\r\n            });\r\n            return result;\r\n        } else {\r\n            let result: Node = null;\r\n            this.uiShowingMap.forEach((_name, com) => {\r\n                if (!result && _name === name) result = com.node;\r\n            });\r\n            return result;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * UIBundle\r\n     * @deprecated \r\n     */\r\n    public getNativeBundleName(uiName: UIName | MiniName) {\r\n        // \r\n        const oldBundleName = `app-view_${uiName}`;\r\n        const projectBundles = settings.querySettings(Settings.Category.ASSETS, 'projectBundles') as string[];\r\n        if (projectBundles && projectBundles.indexOf(oldBundleName) >= 0) {\r\n            return oldBundleName;\r\n        }\r\n\r\n        return stringCaseNegate(uiName);\r\n    }\r\n\r\n    /**\r\n     * UIBundle\r\n     * @deprecated \r\n     */\r\n    public getResBundleName(uiName: UIName | MiniName) {\r\n        // \r\n        const oldBundleName = `app-view_${uiName}_Res`;\r\n        const projectBundles = settings.querySettings(Settings.Category.ASSETS, 'projectBundles') as string[];\r\n        if (projectBundles && projectBundles.indexOf(oldBundleName) >= 0) {\r\n            return oldBundleName;\r\n        }\r\n\r\n        return `${stringCaseNegate(uiName)}-res`;\r\n    }\r\n\r\n    /**\r\n     * Bundle\r\n     */\r\n    private initBundle(name: UIName | MiniName, onFinish: (result: [AssetManager.Bundle, AssetManager.Bundle]) => any) {\r\n        Core.inst.lib.task.createASync<[AssetManager.Bundle, AssetManager.Bundle]>()\r\n            .add((next) => {\r\n                Core.inst.manager.loader.loadBundle({\r\n                    bundle: this.getNativeBundleName(name),\r\n                    onComplete: next\r\n                });\r\n            })\r\n            .add((next) => {\r\n                Core.inst.manager.loader.loadBundle({\r\n                    bundle: this.getResBundleName(name),\r\n                    onComplete: next\r\n                });\r\n            })\r\n            .start(onFinish);\r\n    }\r\n\r\n    /**\r\n     * UI\r\n     */\r\n    private installUI(name: UIName | MiniName, complete?: (result: Prefab | SceneAsset | null) => any, progress?: (finish: number, total: number, item: AssetManager.RequestItem) => void) {\r\n        if (this.sceneCache[name]) {\r\n            complete && setTimeout(() => {\r\n                if (!isValid(this)) return;\r\n                complete(this.sceneCache[name]);\r\n            });\r\n            return;\r\n        } else if (this.prefabCache[name]) {\r\n            complete && setTimeout(() => {\r\n                if (!isValid(this)) return;\r\n                complete(this.prefabCache[name]);\r\n            });\r\n            return;\r\n        }\r\n\r\n        const task = Core.inst.lib.task.createSync<[[AssetManager.Bundle, AssetManager.Bundle], Prefab | SceneAsset]>()\r\n            .add(next => {\r\n                this.initBundle(name, next);\r\n            })\r\n            .add((next) => {\r\n                // \r\n                const uiBundles = task.results[0];\r\n                if (!uiBundles || !uiBundles[0] || !uiBundles[1]) return next(null);\r\n\r\n                const isScene = uiBundles[0].getSceneInfo(name);\r\n                Core.inst.manager.loader.load({\r\n                    bundle: this.getNativeBundleName(name),\r\n                    path: this.getUIPath(name),\r\n                    type: isScene ? SceneAsset : Prefab,\r\n                    onProgress: progress,\r\n                    onComplete: next\r\n                });\r\n            })\r\n            .start((results) => {\r\n                if (!isValid(this)) return;\r\n                // \r\n                const cache = this.sceneCache[name] || this.prefabCache[name];\r\n                if (cache) {\r\n                    return complete && complete(cache);\r\n                }\r\n                // \r\n                const asset = results[1];\r\n                if (!asset) {\r\n                    return complete && complete(null);\r\n                }\r\n                // \r\n                asset.addRef();\r\n                // \r\n                if (asset instanceof Prefab) {\r\n                    this.prefabCache[name] = asset;\r\n                } else {\r\n                    this.sceneCache[name] = asset;\r\n                }\r\n                this.log(`: ${name}`);\r\n                return complete && complete(asset);\r\n            });\r\n    }\r\n\r\n    /**\r\n     * UI\r\n     */\r\n    private uninstallUI(name: UIName | MiniName) {\r\n        if (this.sceneCache[name]) {\r\n            // \r\n            this.sceneCache[name].decRef();\r\n            // \r\n            delete this.sceneCache[name];\r\n        } else if (this.prefabCache[name]) {\r\n            // \r\n            this.prefabCache[name].decRef();\r\n            // \r\n            delete this.prefabCache[name];\r\n        }\r\n\r\n        const resBundle = this.getResBundleName(name);\r\n        const naBundle = this.getNativeBundleName(name);\r\n        Core.inst.manager.loader.releaseAll(resBundle);\r\n        Core.inst.manager.loader.releaseAll(naBundle);\r\n        Core.inst.manager.loader.removeBundle(resBundle);\r\n        Core.inst.manager.loader.removeBundle(naBundle);\r\n        this.log(`: ${name}`);\r\n    }\r\n\r\n    /**\r\n     * ui\r\n     */\r\n    public loadRes<T extends typeof Asset>(target: Component, path: string, type: T, callback?: (item: InstanceType<T> | null) => any) {\r\n        if (typeof target === 'string') {\r\n            Core.inst.manager.loader.load({\r\n                bundle: this.getResBundleName(target),\r\n                path: path,\r\n                type: type,\r\n                onComplete: callback\r\n            });\r\n        } else {\r\n            const view = this.getBaseView(target.node) || this.getViewInParents(target.node) || this.getViewInChildren(director.getScene());\r\n            if (view) {\r\n                Core.inst.manager.loader.load({\r\n                    bundle: this.getResBundleName(view.viewName as UIName | MiniName),\r\n                    path: path,\r\n                    type: type,\r\n                    onComplete: callback\r\n                });\r\n            } else {\r\n                this.error('loadRes', target.name, path);\r\n                callback && callback(null);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * ui\r\n     */\r\n    public preloadRes<T extends typeof Asset>(target: Component | UIName | MiniName, path: string, type: T, complete?: (item: AssetManager.RequestItem[] | null) => any) {\r\n        if (typeof target === 'string') {\r\n            Core.inst.manager.loader.preload({\r\n                bundle: this.getResBundleName(target),\r\n                path: path,\r\n                type: type,\r\n                onComplete: complete\r\n            });\r\n        } else {\r\n            const view = this.getBaseView(target.node) || this.getViewInParents(target.node) || this.getViewInChildren(director.getScene());\r\n            if (view) {\r\n                Core.inst.manager.loader.preload({\r\n                    bundle: this.getResBundleName(view.viewName as UIName | MiniName),\r\n                    path: path,\r\n                    type: type,\r\n                    onComplete: complete\r\n                });\r\n            } else {\r\n                this.error('preloadRes', target.name, path);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * ui\r\n     */\r\n    public loadResDir<T extends typeof Asset>(target: Component, path: string, type: T, callback?: (items: InstanceType<T>[] | null) => any) {\r\n        if (typeof target === 'string') {\r\n            Core.inst.manager.loader.loadDir({\r\n                bundle: this.getResBundleName(target),\r\n                path: path,\r\n                type: type,\r\n                onComplete: callback\r\n            });\r\n        } else {\r\n            const view = this.getBaseView(target.node) || this.getViewInParents(target.node) || this.getViewInChildren(director.getScene());\r\n            if (view) {\r\n                Core.inst.manager.loader.loadDir({\r\n                    bundle: this.getResBundleName(view.viewName as UIName | MiniName),\r\n                    path: path,\r\n                    type: type,\r\n                    onComplete: callback\r\n                });\r\n            } else {\r\n                this.error('loadResDir', target.name, path);\r\n                callback && callback([]);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * ui\r\n     */\r\n    public preloadResDir<T extends typeof Asset>(target: Component | UIName | MiniName, path: string, type: T, complete?: (item: AssetManager.RequestItem[] | null) => any) {\r\n        if (typeof target === 'string') {\r\n            Core.inst.manager.loader.preloadDir({\r\n                bundle: this.getResBundleName(target),\r\n                path: path,\r\n                type: type,\r\n                onComplete: complete\r\n            });\r\n        } else {\r\n            const view = this.getBaseView(target.node) || this.getViewInParents(target.node) || this.getViewInChildren(director.getScene());\r\n            if (view) {\r\n                Core.inst.manager.loader.preloadDir({\r\n                    bundle: this.getResBundleName(view.viewName as UIName | MiniName),\r\n                    path: path,\r\n                    type: type,\r\n                    onComplete: complete\r\n                });\r\n            } else {\r\n                this.error('preloadResDir', target.name, path);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * UI\r\n     */\r\n    public preload(name: UIName | MiniName, complete?: (item: AssetManager.RequestItem[] | null) => any) {\r\n        // name\r\n        if (!name) {\r\n            this.error('preload', 'fail');\r\n            complete && setTimeout(function () {\r\n                if (!isValid(this)) return;\r\n                complete(null);\r\n            });\r\n            return;\r\n        }\r\n\r\n        this.initBundle(name, ([naBundle]) => {\r\n            const isScene = naBundle.getSceneInfo(name);\r\n            Core.inst.manager.loader.preload({\r\n                bundle: this.getNativeBundleName(name),\r\n                path: this.getUIPath(name),\r\n                type: isScene ? SceneAsset : Prefab,\r\n                onComplete: complete\r\n            });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * UI\r\n     */\r\n    public load(name: UIName | MiniName): void;\r\n    public load(name: UIName | MiniName, complete: (result: Prefab | SceneAsset | null) => any): void;\r\n    public load(name: UIName | MiniName, progress: (finish: number, total: number, item: AssetManager.RequestItem) => void, complete: (result: Prefab | SceneAsset | null) => any): void;\r\n    public load(name: UIName | MiniName, ...args: Function[]): void {\r\n        const progress = (args[1] && args[0]) as (finish: number, total: number, item: AssetManager.RequestItem) => void;\r\n        const complete = (args[1] || args[0]) as (result: any) => any;\r\n\r\n        // name\r\n        if (!name) {\r\n            this.error('load', 'fail');\r\n            complete && setTimeout(function () {\r\n                if (!isValid(this)) return;\r\n                complete(null);\r\n            });\r\n            return;\r\n        }\r\n\r\n        // \r\n        this.installUI(name, (result) => {\r\n            if (!result) return complete && complete(null);\r\n            return complete && complete(result);\r\n        }, progress);\r\n    }\r\n\r\n    /**\r\n     * UI\r\n     * - show\r\n     * - \r\n     */\r\n    public release(nameOrCom: UIName | MiniName | BaseView) {\r\n        const uiName = typeof nameOrCom === 'string' ? nameOrCom : nameOrCom.viewName;\r\n\r\n        if (!uiName) {\r\n            this.error('release', `${nameOrCom} fail`);\r\n            return;\r\n        }\r\n\r\n        // \r\n        if (typeof nameOrCom === 'string') {\r\n            this.getUIInScene(uiName, true).forEach((node) => {\r\n                const com = this.getBaseView(node);\r\n                if (!com) {\r\n                    this.error('release', `${uiName}BaseView`);\r\n                    return;\r\n                }\r\n\r\n                if (com.isShow) {\r\n                    this.warn('release', `${uiName}show, `);\r\n                }\r\n                if (com === this.currPage) {\r\n                    this.currPage = null;\r\n                }\r\n                if (com === this.currFocus) {\r\n                    this.currFocus = null;\r\n                }\r\n\r\n                this.uiShowingMap.delete(com);\r\n\r\n                if (node && isValid(node, true)) {\r\n                    node.parent = null;\r\n                    node.destroy();\r\n                }\r\n            });\r\n        }\r\n        // \r\n        else {\r\n            if (nameOrCom.isShow) {\r\n                this.warn('release', `${uiName}show, `);\r\n            }\r\n            if (nameOrCom === this.currPage) {\r\n                this.currPage = null;\r\n            }\r\n            if (nameOrCom === this.currFocus) {\r\n                this.currFocus = null;\r\n            }\r\n\r\n            this.uiShowingMap.delete(nameOrCom);\r\n\r\n            const node = nameOrCom.node;\r\n            if (node && isValid(node, true)) {\r\n                node.parent = null;\r\n                node.destroy();\r\n            }\r\n        }\r\n\r\n        // \r\n        const nodes = this.getUIInScene(uiName, true);\r\n        if (nodes.length === 0 || nodes.every(node => !isValid(node, true))) {\r\n            this.uninstallUI(uiName as UIName | MiniName);\r\n            this.log(`: ${uiName}`);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * UI\r\n     * - show\r\n     * - \r\n     */\r\n    public releaseAll(exclude?: UIName[]) {\r\n        Object.keys(this.prefabCache).forEach((name: UIName) => {\r\n            if (exclude && exclude.indexOf(name) !== -1) return;\r\n            this.release(name);\r\n        });\r\n        Object.keys(this.sceneCache).forEach((name: UIName) => {\r\n            if (exclude && exclude.indexOf(name) !== -1) return;\r\n            this.release(name);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * UI\r\n     * - -1: \r\n     * - 0: UI\r\n     * - 1: UI\r\n     */\r\n    private checkUIValid(name: UIName | MiniName, data: any, callback: (valid: -1 | 0 | 1) => any) {\r\n        this.installUI(name, (result) => {\r\n            if (!result) return callback(-1);\r\n            const View = this.getUIClass(name);\r\n            if (!View) return callback(0);\r\n            if (!View.isViewValid) return callback(1);\r\n            View.isViewValid((valid: boolean) => {\r\n                callback(valid ? 1 : 0);\r\n            }, data);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * \r\n     */\r\n    public refreshShade() {\r\n        // refreshShadeonFocusonLostFocus(onFocus)\r\n        let onFocus = false;\r\n        // uiRoots\r\n        let uiRoots = this.UserInterface.children;\r\n        for (let index = uiRoots.length - 1; index >= 0; index--) {\r\n            const uiRoot = uiRoots[index];\r\n            if (uiRoot !== this.shade && uiRoot !== this.loading) {\r\n                // uiRoot\r\n                let children = uiRoot.children;\r\n                for (let i = children.length - 1; i >= 0; i--) {\r\n                    const node = children[i];\r\n                    if (node === this.shade) continue;\r\n\r\n                    const com = this.getBaseView(node);\r\n                    if (!com) continue;\r\n\r\n                    // onFocus\r\n                    if (!onFocus && com.isCaptureFocus && com.isShow) {\r\n                        onFocus = true;\r\n                        if (this.currFocus !== com) {\r\n                            isValid(this.currFocus, true) && this.currFocus.constructor.prototype.focus.call(this.currFocus, false);\r\n                            this.currFocus = com;\r\n                            this.currFocus.constructor.prototype.focus.call(this.currFocus, true);\r\n                        }\r\n                    }\r\n                    // \r\n                    if (com.isNeedShade && com.isShow) {\r\n                        const shadeSetting = Object.assign({}, UIManager.setting.shade, com.constructor.prototype.onShade.call(com));\r\n                        if (shadeSetting.blur) {\r\n                            this.shade.getComponent(UIMgrShade).init(0, 255, 255, 0, true);\r\n                        } else {\r\n                            this.shade.getComponent(UIMgrShade).init(\r\n                                typeof shadeSetting.delay !== 'number' ? 0 : shadeSetting.delay,\r\n                                typeof shadeSetting.begin !== 'number' ? 60 : shadeSetting.begin,\r\n                                typeof shadeSetting.end !== 'number' ? 180 : shadeSetting.end,\r\n                                typeof shadeSetting.speed !== 'number' ? 100 : shadeSetting.speed,\r\n                                false,\r\n                            );\r\n                        }\r\n                        this.shade.layer = node.layer;\r\n                        this.shade.parent = uiRoot;\r\n                        this.shade.active = true;\r\n                        // z2.xzIndex\r\n                        this.shade.setPosition(this.shade.position.x, this.shade.position.y, node.position.z);\r\n\r\n                        let shadeIndex = this.shade.getSiblingIndex();\r\n                        let nodeIndex = node.getSiblingIndex();\r\n                        if (shadeIndex > nodeIndex) {\r\n                            this.shade.setSiblingIndex(nodeIndex);\r\n                        } else {\r\n                            this.shade.setSiblingIndex(nodeIndex - 1);\r\n                        }\r\n                        return;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        this.shade.active = false;\r\n        this.shade.getComponent(UIMgrShade).clear();\r\n        if (!onFocus) {\r\n            isValid(this.currFocus, true) && this.currFocus.constructor.prototype.focus.call(this.currFocus, false);\r\n            this.currFocus = null;\r\n        }\r\n    }\r\n\r\n    // prefab\r\n    private parsingPrefab(prefab: Prefab, name: string) {\r\n        if (!prefab) return null;\r\n\r\n        const node = instantiate(prefab);\r\n\r\n        node.active = false;\r\n        if (node.name !== name) {\r\n            this.warn('parsingPrefab', `UI, UI: ${this.getUIPath(name)}`);\r\n            node.name = name;\r\n        }\r\n\r\n        node.parent = this.getUIParent(name);\r\n        node.getComponent(Widget)?.updateAlignment();\r\n        return node;\r\n    }\r\n\r\n    // scene\r\n    private parsingScene(asset: SceneAsset, name: string) {\r\n        if (!asset || !asset.scene) return null;\r\n\r\n        if (asset.scene.name !== name) {\r\n            this.warn('parsingScene', `UI, UI: ${this.getUIPath(name)}`);\r\n            asset.scene.name = name;\r\n        }\r\n\r\n        const view = this.getViewInChildren(asset.scene);\r\n        if (!view) {\r\n            this.error('parsingScene', `BaseView: ${this.getUIPath(name)}`);\r\n            return null;\r\n        }\r\n\r\n        view.node.active = false;\r\n        if (view.node.name !== name) {\r\n            this.warn('parsingScene', `UI, UI: ${this.getUIPath(name)}`);\r\n            view.node.name = name;\r\n        }\r\n        return view.node;\r\n    }\r\n\r\n    private addUILoadingUuid(name: UIName, loadingUuid?: string) {\r\n        const uuid = loadingUuid || this.createUUID();\r\n        if (!this.uiLoadingMap.has(name)) {\r\n            this.uiLoadingMap.set(name, [uuid]);\r\n        } else {\r\n            this.uiLoadingMap.get(name).push(uuid);\r\n        }\r\n        return uuid;\r\n    }\r\n\r\n    private removeUILoadingUuid(name: UIName, uuid: string) {\r\n        if (!this.uiLoadingMap.has(name)) return false;\r\n        const index = this.uiLoadingMap.get(name).indexOf(uuid);\r\n        if (index === -1) return false;\r\n        this.uiLoadingMap.get(name).splice(index, 1);\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * UI\r\n     */\r\n    private createUI(name: UIName, silent: boolean, callback: (node: Node, scene?: Scene) => any) {\r\n        // UIUUID\r\n        const loadingUuid = silent ? '' : this.showLoading();\r\n        const uiLoadingUuid = this.addUILoadingUuid(name, loadingUuid);\r\n\r\n        // name\r\n        if (!name) {\r\n            setTimeout(() => {\r\n                if (!isValid(this)) return;\r\n                // \r\n                if (this.removeUILoadingUuid(name, uiLoadingUuid) === false) {\r\n                    return this.hideLoading(loadingUuid);\r\n                }\r\n                callback(null);\r\n                this.hideLoading(loadingUuid);\r\n            });\r\n            return;\r\n        }\r\n\r\n        // \r\n        const node = this.getUIInScene(name);\r\n        if (isValid(node, true) && this.getBaseView(node).isSingleton === true) {\r\n            setTimeout(() => {\r\n                if (!isValid(this)) return;\r\n\r\n                // \r\n                if (this.removeUILoadingUuid(name, uiLoadingUuid) === false) {\r\n                    return this.hideLoading(loadingUuid);\r\n                }\r\n\r\n                // \r\n                if (isValid(node, true)) {\r\n                    if (this.currScene === name) {\r\n                        callback(node, director.getScene());\r\n                    } else {\r\n                        callback(node);\r\n                    }\r\n                    this.hideLoading(loadingUuid);\r\n                } else {\r\n                    this.createUI(name, silent, callback);\r\n                    this.hideLoading(loadingUuid);\r\n                }\r\n            });\r\n            return;\r\n        }\r\n\r\n        // UI\r\n        this.load(name, (asset) => {\r\n            if (!isValid(this)) return;\r\n\r\n            // \r\n            if (this.removeUILoadingUuid(name, uiLoadingUuid) === false) {\r\n                return this.hideLoading(loadingUuid);\r\n            }\r\n\r\n            // \r\n            if (asset instanceof SceneAsset) {\r\n                callback(this.parsingScene(asset, name), asset.scene);\r\n                this.hideLoading(loadingUuid);\r\n                return;\r\n            }\r\n\r\n            // (loadui)\r\n            const node = this.getUIInScene(name);\r\n            if (!isValid(node, true) || this.getBaseView(node).isSingleton === false) {\r\n                callback(this.parsingPrefab(asset, name));\r\n                this.hideLoading(loadingUuid);\r\n            } else {\r\n                callback(node);\r\n                this.hideLoading(loadingUuid);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * View\r\n     */\r\n    public showDefault(onShow?: (result?: any) => any) {\r\n        if (this.defaultUI) {\r\n            this.show({\r\n                name: this.defaultUI,\r\n                data: this.defaultData,\r\n                onShow\r\n            });\r\n        } else {\r\n            Core.inst.manager.ui.showToast('\\nsetting.tsdefaultUI', 100);\r\n            onShow && onShow();\r\n            this.warn('defaultUIsetting.ts');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * ()\r\n     */\r\n    public isShow(name: UIName) {\r\n        return !!this.getUIInShowing(name) ||\r\n            this.isInQueue(name) ||\r\n            this.isLoading(name);\r\n    }\r\n\r\n    /**\r\n     * \r\n     */\r\n    public isInQueue(name: UIName) {\r\n        return !!this.showQueue.find((v) => { return v.name == name; });\r\n    }\r\n\r\n    /**\r\n     * \r\n     */\r\n    public isLoading(name: UIName) {\r\n        return this.uiLoadingMap.has(name) && this.uiLoadingMap.get(name).length > 0;\r\n    }\r\n\r\n    /**\r\n     * \r\n     */\r\n    private putInShowQueue(data: IShowParams<UIName>) {\r\n        if (data.queue === 'join' || this.showQueue.length === 0) {\r\n            this.showQueue.push(data);\r\n        } else {\r\n            this.showQueue.splice(1, 0, data);\r\n        }\r\n        if (this.showQueue.length === 1) {\r\n            this.consumeShowQueue();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * \r\n     */\r\n    private consumeShowQueue() {\r\n        if (this.showQueue.length === 0) return;\r\n        const data = this.showQueue[0];\r\n        this.show({\r\n            name: data.name,\r\n            data: data.data,\r\n            onShow: data.onShow,\r\n            onHide: (result: any) => {\r\n                data.onHide && data.onHide(result);\r\n                this.showQueue.shift();\r\n                this.consumeShowQueue();\r\n            },\r\n            onError: data.onError ? (error: string, code: 0 | 1) => {\r\n                const ret = data.onError(error, code);\r\n                this.showQueue.shift();\r\n                this.consumeShowQueue();\r\n                return ret;\r\n            } : undefined,\r\n            top: data.top,\r\n            attr: data.attr,\r\n            silent: data.silent\r\n        });\r\n    }\r\n\r\n    private showUI(params: IShowParams<UIName>) {\r\n        const { name, data, onShow, onHide, onError, top = true, attr = null, silent = false } = params;\r\n\r\n        this.createUI(name, silent, (node, scene) => {\r\n            if (!node) {\r\n                this.error('show', `${name} `);\r\n                // onErroronErrortrue\r\n                if (onError && onError(`${name} `, UIManager.ErrorCode.LoadError) !== true) {\r\n                    return;\r\n                }\r\n                this.scheduleOnce(() => this.showUI(params), 1);\r\n                if (!silent) this.showLoading(1);\r\n                return;\r\n            }\r\n\r\n            !scene && top && node.setSiblingIndex(-1);\r\n\r\n            const com = this.getBaseView(node);\r\n            this.uiShowingMap.set(com, name);\r\n            com.constructor.prototype.show.call(com, data, attr,\r\n                // onShow\r\n                (result: any) => {\r\n                    this.uiShowingMap.set(com, name);\r\n                    onShow && onShow(result);\r\n                },\r\n                // onHide\r\n                (result: any) => {\r\n                    this.uiShowingMap.delete(com);\r\n                    onHide && onHide(result);\r\n                },\r\n                // beforeShow\r\n                (error: string) => {\r\n                    if (error) {\r\n                        this.uiShowingMap.delete(com);\r\n                        onError && onError(error, UIManager.ErrorCode.LogicError);\r\n                    } else if (BaseView.isPage(name)) {\r\n                        this.uiShowingMap.set(com, name);\r\n                        const oldCom = this.currPage;\r\n                        this.currPage = com;\r\n                        if (isValid(oldCom, true) && oldCom !== com && oldCom.isShow) {\r\n                            oldCom.constructor.prototype.hide.call(oldCom, { name });\r\n                        }\r\n                        if (scene) {\r\n                            if (oldCom !== com) {\r\n                                this.currScene = name;\r\n                                director.runSceneImmediate(scene, null, () => {\r\n                                    this.log(`: ${name}`);\r\n                                });\r\n                            }\r\n                        } else if (this.currScene !== UIScene) {\r\n                            this.currScene = UIScene;\r\n                            const scene = new Scene(UIScene);\r\n                            scene.autoReleaseAssets = true;\r\n                            director.runSceneImmediate(scene, null, () => {\r\n                                this.log(`: ${UIScene}`);\r\n                            });\r\n                        }\r\n                    }\r\n                }\r\n            );\r\n        });\r\n    }\r\n\r\n    /**\r\n     * UI\r\n     * - \r\n     */\r\n    public show<UI extends BaseView>(params\r\n        // @ts-ignore\r\n        : IShowParams<UIName, Parameters<UI['onShow']>[0], ReturnType<UI['onShow']>, ReturnType<UI['onHide']>>) {\r\n        const { name, data, queue, onError, silent = false } = params;\r\n\r\n        // \r\n        if (queue) {\r\n            this.putInShowQueue(params);\r\n            return;\r\n        }\r\n\r\n        this.log(`show: ${name}`);\r\n\r\n        // UIUUID\r\n        const loadingUuid = silent ? '' : this.showLoading();\r\n        const uiLoadingUuid = this.addUILoadingUuid(name, loadingUuid);\r\n        // ui\r\n        Core.inst.lib.task.execute((retry) => {\r\n            this.checkUIValid(name, data, (valid) => {\r\n                // \r\n                if (this.removeUILoadingUuid(name, uiLoadingUuid) === false) {\r\n                    this.hideLoading(loadingUuid);\r\n                    return;\r\n                }\r\n\r\n                // \r\n                if (valid === -1) {\r\n                    this.error('show', `${name} `);\r\n                    // onErroronErrortrue\r\n                    if (onError && onError(`${name} `, UIManager.ErrorCode.LoadError) !== true) {\r\n                        return this.hideLoading(loadingUuid);\r\n                    }\r\n                    return retry(1);\r\n                }\r\n\r\n                // ui\r\n                if (valid === 0) {\r\n                    this.warn('show', `${name} `);\r\n                    this.uninstallUI(name);\r\n                    onError && onError(`${name} `, UIManager.ErrorCode.InvalidError);\r\n                    this.hideLoading(loadingUuid);\r\n                    return;\r\n                }\r\n\r\n                this.showUI(params);\r\n                this.hideLoading(loadingUuid);\r\n            });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * UI\r\n     * - \r\n     */\r\n    public showAsync<UI extends BaseView>(params\r\n        // @ts-ignore\r\n        : IShowAsyncParams<UIName, Parameters<UI['onShow']>[0], ReturnType<UI['onShow']>>): Promise<ReturnType<UI['onHide']>> {\r\n        return new Promise((resolve) => {\r\n            this.show({\r\n                ...params,\r\n                onHide(result) {\r\n                    resolve(result);\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * View\r\n     * - \r\n     */\r\n    public hide<UI extends BaseView>({ name, data, onHide }\r\n        // @ts-ignore\r\n        : IHideParams<UIName, Parameters<UI['onHide']>[0], ReturnType<UI['onHide']>>) {\r\n        const nodes = this.getUIInShowing(name, true);\r\n\r\n        this.log(`hide: ${name}`);\r\n\r\n        if (nodes.length === 0) {\r\n            if (!this.uiLoadingMap.has(name) || this.uiLoadingMap.get(name).length === 0) {\r\n                return this.warn('hide', `${name} `);\r\n            }\r\n        }\r\n\r\n        if (this.uiLoadingMap.has(name)) {\r\n            this.uiLoadingMap.get(name).forEach((loadingUuid) => this.hideLoading(loadingUuid));\r\n            this.uiLoadingMap.get(name).length = 0;\r\n        }\r\n\r\n        for (let index = nodes.length - 1; index >= 0; index--) {\r\n            const node = nodes[index];\r\n            const com = this.getBaseView(node);\r\n\r\n            if (this.currPage === com) {\r\n                this.currPage = null;\r\n            }\r\n\r\n            com.constructor.prototype.hide.call(com, data, onHide);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * View()\r\n     * - \r\n     */\r\n    public pop<UI extends BaseView>({ name, data, onHide }\r\n        // @ts-ignore\r\n        : IHideParams<UIName, Parameters<UI['onHide']>[0], ReturnType<UI['onHide']>>) {\r\n        const nodes = this.getUIInShowing(name, true);\r\n\r\n        if (this.uiLoadingMap.has(name) && this.uiLoadingMap.get(name).length) {\r\n            const loadingUuid = this.uiLoadingMap.get(name).pop();\r\n            this.hideLoading(loadingUuid);\r\n            this.log(`pop: ${name}`);\r\n            return;\r\n        }\r\n\r\n        if (nodes.length) {\r\n            const node = nodes.pop();\r\n            const com = this.getBaseView(node);\r\n\r\n            if (this.currPage === com) {\r\n                this.currPage = null;\r\n            }\r\n\r\n            com.constructor.prototype.hide.call(com, data, onHide);\r\n            this.log(`pop: ${name}`);\r\n            return;\r\n        }\r\n\r\n        this.warn('pop', `${name} `);\r\n    }\r\n\r\n    /**\r\n     * View()\r\n     * - \r\n     */\r\n    public shift<UI extends BaseView>({ name, data, onHide }\r\n        // @ts-ignore\r\n        : IHideParams<UIName, Parameters<UI['onHide']>[0], ReturnType<UI['onHide']>>) {\r\n        const nodes = this.getUIInShowing(name, true);\r\n\r\n        if (nodes.length) {\r\n            const node = nodes[0];\r\n            const com = this.getBaseView(node);\r\n\r\n            if (this.currPage === com) {\r\n                this.currPage = null;\r\n            }\r\n\r\n            com.constructor.prototype.hide.call(com, data, onHide);\r\n            this.log(`shift: ${name}`);\r\n            return;\r\n        }\r\n\r\n        if (this.uiLoadingMap.has(name) && this.uiLoadingMap.get(name).length) {\r\n            const loadingUuid = this.uiLoadingMap.get(name).shift();\r\n            this.hideLoading(loadingUuid);\r\n            this.log(`shift: ${name}`);\r\n            return;\r\n        }\r\n\r\n        this.warn('shift', `${name} `);\r\n    }\r\n\r\n    /**\r\n     * View\r\n     * - Page()\r\n     * - \r\n     */\r\n    public hideAll({ data, exclude }: { data?: any, exclude?: UIName[] } = {}): void {\r\n        this.log('hideAll');\r\n        // \r\n        this.uiShowingMap.forEach((name, com) => {\r\n            if (BaseView.isPaper(name)) return;\r\n            if (exclude && exclude.indexOf(name) !== -1) return;\r\n            if (com === this.currPage) return;\r\n            com.constructor.prototype.hide.call(com, data);\r\n        });\r\n        // \r\n        this.uiLoadingMap.forEach((value, name) => {\r\n            if (BaseView.isPaper(name)) return;\r\n            if (exclude && exclude.indexOf(name) !== -1) return;\r\n            value.forEach((loadingUuid) => this.hideLoading(loadingUuid));\r\n            value.length = 0;\r\n        });\r\n    }\r\n\r\n    public showLoading(timeout = 0) {\r\n        this.loading.active = true;\r\n        this.loading.setSiblingIndex(-1);\r\n        if (this.loading.getComponent(UIMgrLoading)) {\r\n            this.loading.getComponent(UIMgrLoading).init();\r\n        } else {\r\n            // \r\n            this.loading.getComponentInChildren(UIMgrLoading)?.init();\r\n        }\r\n        const uuid = this.createUUID();\r\n        this.showLoadingMap.set(uuid, true);\r\n        if (timeout > 0) this.scheduleOnce(() => {\r\n            this.hideLoading(uuid);\r\n        }, timeout);\r\n        return uuid;\r\n    }\r\n\r\n    public hideLoading(uuid: string) {\r\n        if (!uuid) return;\r\n        this.showLoadingMap.delete(uuid);\r\n        if (this.showLoadingMap.size === 0) {\r\n            if (this.loading.getComponent(UIMgrLoading)) {\r\n                this.loading.getComponent(UIMgrLoading).clear();\r\n            } else {\r\n                // \r\n                this.loading.getComponentInChildren(UIMgrLoading)?.clear();\r\n            }\r\n            this.loading.active = false;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * \r\n     */\r\n    public addTouchMask(timeout = 0) {\r\n        this.addTouchMaskListener();\r\n        const uuid = this.createUUID();\r\n        this.touchMaskMap.set(uuid, true);\r\n        if (timeout > 0) this.scheduleOnce(() => {\r\n            this.removeTouchMask(uuid);\r\n        }, timeout);\r\n        return uuid;\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param uuid addTouchMask\r\n     */\r\n    public removeTouchMask(uuid: string) {\r\n        if (!uuid) return;\r\n        this.touchMaskMap.delete(uuid);\r\n        this.removeTouchMaskListener();\r\n    }\r\n\r\n    /**\r\n     * Toast\r\n     * @param message \r\n     * @param timeout ()2\r\n     */\r\n    public showToast(message: string, timeout?: number) {\r\n        if (!this.toast) {\r\n            return this.error('showToast', 'Canvas/Manager/UIManagerToast Pre');\r\n        }\r\n        this.toast.setSiblingIndex(-1);\r\n        this.toast.getComponent(UIMgrToast).add({\r\n            message, timeout\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Toast\r\n     */\r\n    public clearToast() {\r\n        if (!this.toast) return;\r\n        this.toast.getComponent(UIMgrToast).clear();\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param enabled \r\n     */\r\n    public setTouchEnabled(enabled: boolean) {\r\n        if (enabled) {\r\n            this.touchEnabled = true;\r\n            this.removeTouchMaskListener();\r\n        } else {\r\n            this.addTouchMaskListener();\r\n            this.touchEnabled = false;\r\n        }\r\n        this.warn('setTouchEnabled', this.touchEnabled);\r\n    }\r\n\r\n    /**\r\n     * 2DUI\r\n     */\r\n    public onUserInterface(...args: Parameters<Node['on']>) {\r\n        Node.prototype.on.apply(this.UserInterface, args);\r\n    }\r\n\r\n    /**\r\n     * 2DUI\r\n     */\r\n    public onceUserInterface(...args: Parameters<Node['once']>) {\r\n        Node.prototype.once.apply(this.UserInterface, args);\r\n    }\r\n\r\n    /**\r\n     * 2DUI\r\n     */\r\n    public offUserInterface(...args: Parameters<Node['off']>) {\r\n        Node.prototype.off.apply(this.UserInterface, args);\r\n    }\r\n\r\n    /**\r\n     * 2DUI\r\n     */\r\n    public targetOffUserInterface(...args: Parameters<Node['targetOff']>) {\r\n        Node.prototype.targetOff.apply(this.UserInterface, args);\r\n    }\r\n\r\n    /**\r\n     * 2DUI\r\n     */\r\n    public sortUserInterface(name: IViewType) {\r\n        this.UserInterface\r\n            ?.getChildByName(name)\r\n            ?.getComponent(UIMgrZOrder)\r\n            ?.updateZOrder();\r\n    }\r\n\r\n    /**\r\n     * \r\n     * - Director.EVENT_BEFORE_RENDER\r\n     * @example\r\n     * director.once(Director.EVENT_BEFORE_RENDER, () => {\r\n     *   const renderTexture = new RenderTexture();\r\n     *   const size = view.getVisibleSize();\r\n     *   renderTexture.reset({ width: size.width, height: size.height });\r\n     *   app.manager.ui.screenshot(renderTexture);\r\n     * });\r\n     */\r\n    public screenshot(renderTexture: RenderTexture, opts?: {\r\n        /** */\r\n        cameraFilter?: (camera: Camera) => boolean;\r\n        /** */\r\n        cameraList?: Camera[];\r\n    }) {\r\n        const cameras = opts?.cameraList || director.getScene().getComponentsInChildren(Camera);\r\n\r\n        const cameraList = cameras.sort((a, b) => a.priority - b.priority)\r\n            .filter(camera => {\r\n                if (!camera.enabledInHierarchy) return false;\r\n                if (camera.targetTexture) return false;\r\n                return opts?.cameraFilter ? opts.cameraFilter(camera) : true;\r\n            });\r\n        const cameraList2 = cameraList.map(camera => camera.camera);\r\n\r\n        cameraList.forEach(camera => {\r\n            camera.targetTexture = renderTexture;\r\n        });\r\n        director.root.pipeline.render(cameraList2);\r\n        cameraList.forEach(camera => {\r\n            camera.targetTexture = null;\r\n        });\r\n\r\n        return renderTexture;\r\n    }\r\n}","import { Component, Graphics, Node, Size, UITransform, _decorator } from 'cc';\r\nconst { ccclass, property, requireComponent } = _decorator;\r\n\r\n@ccclass('UIMgrLoading')\r\n@requireComponent(UITransform)\r\nexport default class UIMgrLoading extends Component {\r\n    @property(Node)\r\n    private loading: Node;\r\n\r\n    @property({ tooltip: '' })\r\n    private size: Size = new Size(60, 60);\r\n\r\n    @property({ tooltip: '' })\r\n    private delay = 0;\r\n\r\n    private progress = 0;\r\n    private ringScale = 1;\r\n    private reverse = false;\r\n\r\n    private angleSpeed = 120;\r\n    private ringSpeed = 0.02;\r\n\r\n    private inited = false;\r\n    private drawing = false;\r\n    private timedown = 0;\r\n\r\n    init() {\r\n        if (this.inited) return;\r\n        this.inited = true;\r\n\r\n        this.progress = 0;\r\n        this.ringScale = 1;\r\n        this.loading.angle = 0;\r\n        this.reverse = false;\r\n\r\n        this.drawing = false;\r\n        this.timedown = this.delay;\r\n        this.loading.getComponent(Graphics).clear();\r\n    }\r\n\r\n    clear() {\r\n        this.inited = false;\r\n        this.drawing = false;\r\n    }\r\n\r\n    /**\r\n     * \r\n     */\r\n    private onDraw() {\r\n        const graphics = this.loading.getComponent(Graphics);\r\n        const uiTransform = this.loading.getComponent(UITransform);\r\n\r\n        const centerX = this.size.width * (0.5 - uiTransform.anchorX);\r\n        const centerY = this.size.height * (0.5 - uiTransform.anchorY);\r\n\r\n        const r = Math.min(this.size.width / 2, this.size.height / 2);\r\n\r\n        const allPI = Math.PI;\r\n        const offst = 0;\r\n\r\n        graphics.clear();\r\n        if (this.reverse) {\r\n            const start = 0.5 * Math.PI + offst;\r\n            const end = 0.5 * Math.PI + this.progress * 2 * allPI + offst;\r\n            graphics.arc(centerX, centerY, r, start, end, true);\r\n        } else {\r\n            const start = 0.5 * Math.PI - offst;\r\n            const end = 0.5 * Math.PI - this.progress * 2 * allPI - offst;\r\n            graphics.arc(centerX, centerY, r, start, end, false);\r\n        }\r\n        graphics.stroke();\r\n    }\r\n\r\n    protected update(dt: number): void {\r\n        if (!this.inited) return;\r\n\r\n        // \r\n        if (!this.drawing) {\r\n            if (this.timedown > 0) {\r\n                this.timedown -= dt;\r\n            }\r\n            if (this.timedown <= 0) {\r\n                this.drawing = true;\r\n            } else {\r\n                return;\r\n            }\r\n        }\r\n\r\n        // \r\n        this.loading.angle -= this.angleSpeed * dt;\r\n        if (this.loading.angle >= 360 || this.loading.angle <= -360) {\r\n            this.loading.angle = this.loading.angle % 360;\r\n        }\r\n\r\n        // \r\n        if (this.ringScale > 0) {\r\n            this.progress = Math.min(1, this.progress + this.ringSpeed * this.ringScale);\r\n\r\n            if (this.progress == 1) {\r\n                this.ringScale = -1;\r\n                this.reverse = !this.reverse;\r\n            }\r\n        } else {\r\n            this.progress = Math.max(0, this.progress + this.ringSpeed * this.ringScale);\r\n\r\n            if (this.progress == 0) {\r\n                this.ringScale = 1;\r\n                this.reverse = !this.reverse;\r\n            }\r\n        }\r\n\r\n        this.onDraw();\r\n    }\r\n}\r\n","import { Camera, Color, Component, Director, Material, RenderTexture, Sprite, SpriteFrame, UIOpacity, UITransform, _decorator, director } from 'cc';\r\nimport Core from '../../../Core';\r\nconst { ccclass, property, requireComponent } = _decorator;\r\n\r\n@ccclass('UIMgrShade')\r\n@requireComponent(Sprite)\r\n@requireComponent(UIOpacity)\r\nexport default class UIMgrShade extends Component {\r\n    @property(Material)\r\n    private blurMaterial: Material = null;\r\n\r\n    @property(SpriteFrame)\r\n    private shadeFrame: SpriteFrame = null;\r\n\r\n    @property\r\n    private _delay = 0;\r\n    @property\r\n    get delay() { return this._delay; }\r\n    set delay(v) { this._delay = Math.max(v, 0); }\r\n\r\n    @property\r\n    private _begin = 0;\r\n    @property\r\n    get begin() { return this._begin; }\r\n    set begin(v) { if (v >= 0 && v <= 255) this._begin = v; }\r\n\r\n    @property\r\n    private _end = 255;\r\n    @property\r\n    get end() { return this._end; }\r\n    set end(v) { if (v >= 0 && v <= 255) this._end = v; }\r\n\r\n    @property\r\n    private _speed = 10;\r\n    @property\r\n    get speed() {\r\n        if (this.begin == this.end) {\r\n            return 0;\r\n        } else if (this.begin > this.end) {\r\n            return this._speed > 0 ? -this._speed : this._speed;\r\n        } else {\r\n            return this._speed >= 0 ? this._speed : -this._speed;\r\n        }\r\n    }\r\n    set speed(v) { this._speed = v; }\r\n\r\n    private get sprite() {\r\n        return this.node.getComponent(Sprite);\r\n    }\r\n    private get opacity() {\r\n        return this.node.getComponent(UIOpacity);\r\n    }\r\n\r\n    private inited = false;\r\n    private drawing = false;\r\n    private timedown = 0;\r\n\r\n    private blurFrame: SpriteFrame = null;\r\n\r\n    init(delay: number, begin: number, end: number, speed: number, blur: boolean) {\r\n        if (blur) {\r\n            director.targetOff(this);\r\n            this.inited = false;\r\n            this.drawing = false;\r\n\r\n            this.sprite.color = Color.WHITE;\r\n            this.sprite.customMaterial = null;\r\n            this.sprite.spriteFrame = this.blurFrame;\r\n            if (this.blurFrame) this.blurFrame.flipUVY = false;\r\n\r\n            let count = 0;\r\n            const cameras = director.getScene().getComponentsInChildren(Camera);\r\n            director.on(Director.EVENT_BEFORE_RENDER, () => {\r\n                count++;\r\n\r\n                const renderTexture = new RenderTexture();\r\n                const size = this.node.getComponent(UITransform);\r\n                renderTexture.reset({ width: size.width / 2, height: size.height / 2 });\r\n                renderTexture.addRef();\r\n\r\n                Core.inst.manager.ui.screenshot(renderTexture, {\r\n                    cameraList: cameras\r\n                });\r\n\r\n                if (count === 1) {\r\n                    this.blurFrame = new SpriteFrame();\r\n                    this.blurFrame?.texture?.decRef();\r\n                    this.blurFrame.texture = renderTexture;\r\n                    this.blurFrame.flipUVY = true;\r\n                    this.sprite.spriteFrame = this.blurFrame;\r\n                    this.sprite.customMaterial = this.blurMaterial;\r\n                    this.blurMaterial.setProperty('blurLevel', 2);\r\n                    return;\r\n                }\r\n\r\n                if (count === 5) {\r\n                    director.targetOff(this);\r\n                    this.sprite.spriteFrame.flipUVY = false;\r\n                    this.sprite.customMaterial = null;\r\n                    return;\r\n                }\r\n\r\n                this.blurFrame?.texture?.decRef();\r\n                this.blurFrame.texture = renderTexture;\r\n                this.blurFrame.flipUVY = true;\r\n                this.sprite.spriteFrame = this.blurFrame;\r\n                this.sprite.customMaterial = this.blurMaterial;\r\n                this.blurMaterial.setProperty('blurLevel', count === 2 ? 3 : 1);\r\n            }, this);\r\n        } else {\r\n            director.targetOff(this);\r\n            this.sprite.spriteFrame = this.shadeFrame;\r\n            this.sprite.color = Color.BLACK;\r\n            this.sprite.customMaterial = null;\r\n        }\r\n\r\n        this.delay = delay;\r\n        this.begin = begin;\r\n        this.end = end;\r\n        this.speed = speed;\r\n        this.drawing = true;\r\n\r\n        if (this.inited) return;\r\n        this.inited = true;\r\n        this.timedown = this.delay;\r\n        // \r\n        this.opacity.opacity = this.timedown > 0 ? 0 : this.begin;\r\n    }\r\n\r\n    clear() {\r\n        this.inited = false;\r\n        this.drawing = false;\r\n        director.targetOff(this);\r\n        this.blurFrame?.texture?.decRef();\r\n        this.blurFrame?.destroy();\r\n        this.blurFrame = null;\r\n        this.sprite.spriteFrame = null;\r\n    }\r\n\r\n    protected update(dt: number) {\r\n        if (!this.inited) return;\r\n        if (!this.drawing) return;\r\n\r\n        if (this.timedown > 0) {\r\n            this.timedown -= dt;\r\n            if (this.timedown > 0) return;\r\n            // \r\n            this.opacity.opacity = this.begin;\r\n        }\r\n\r\n        const uiOpacity = this.opacity;\r\n        if (this.speed > 0) {\r\n            uiOpacity.opacity += this.speed * dt;\r\n            if (uiOpacity.opacity > this.end) {\r\n                uiOpacity.opacity = this.end;\r\n            }\r\n        } else if (this.speed < 0) {\r\n            uiOpacity.opacity += this.speed * dt;\r\n            if (uiOpacity.opacity < this.end) {\r\n                uiOpacity.opacity = this.end;\r\n            }\r\n        }\r\n        if (uiOpacity.opacity == this.end) {\r\n            this.drawing = false;\r\n        }\r\n    }\r\n}\r\n","import { Component, NodePool, Prefab, Tween, UIOpacity, UITransform, _decorator, instantiate, tween, view } from 'cc';\r\nimport UIMgrToastCell from './UIMgrToastCell';\r\nconst { property, ccclass, requireComponent } = _decorator;\r\n\r\n@ccclass('UIMgrToast')\r\n@requireComponent(UITransform)\r\nexport default class UIMgrToast extends Component {\r\n    @property(Prefab)\r\n    private cell: Prefab = null;\r\n\r\n    /** */\r\n    private lifeTime = 2;\r\n\r\n    /** */\r\n    private outTime = 0.2;\r\n\r\n    /** */\r\n    private squeezeSpeed = 200;\r\n\r\n    /** */\r\n    private pool = new NodePool();\r\n\r\n    add(data: {\r\n        message: string,\r\n        timeout?: number\r\n    }) {\r\n        const cell = this.pool.get() || instantiate(this.cell);\r\n        cell.setPosition(0, 0, 0);\r\n        cell.parent = this.node;\r\n        cell.active = true;\r\n\r\n        cell.getComponent(UIMgrToastCell).init(data.message);\r\n\r\n        cell.getComponent(UIOpacity).opacity = 255;\r\n        tween(cell.getComponent(UIOpacity))\r\n            .delay(data.timeout || this.lifeTime)\r\n            .to(this.outTime, { opacity: 0 })\r\n            .call(() => {\r\n                this.pool.put(cell);\r\n            })\r\n            .start();\r\n    }\r\n\r\n    clear() {\r\n        const children = this.node.children;\r\n        for (let index = children.length - 1; index >= 0; index--) {\r\n            Tween.stopAllByTarget(children[index].getComponent(UIOpacity));\r\n            children[index].destroy();\r\n        }\r\n    }\r\n\r\n    get size() {\r\n        return this.node.children.length;\r\n    }\r\n\r\n    protected onDestroy() {\r\n        this.pool.clear();\r\n    }\r\n\r\n    protected update(dt: number) {\r\n        const children = this.node.children;\r\n        for (let index = children.length - 1, recovery = false; index >= 0; index--) {\r\n            const zero = index === children.length - 1;\r\n            const curr = children[index];\r\n\r\n            // \r\n            if (recovery) {\r\n                Tween.stopAllByTarget(curr.getComponent(UIOpacity));\r\n                this.pool.put(curr);\r\n                continue;\r\n            }\r\n\r\n            if (zero) {\r\n                const currUT = curr.getComponent(UITransform);\r\n\r\n                const lastMaxY = 0 - currUT.height / 2;\r\n                const currMinY = curr.position.y + lastMaxY;\r\n\r\n                if (currMinY > lastMaxY) {\r\n                    // \r\n                    const addLen = Math.max(-this.squeezeSpeed * dt * (children.length - index), lastMaxY - currMinY);\r\n                    curr.setPosition(curr.position.x, curr.position.y + addLen, curr.position.z);\r\n                }\r\n            } else {\r\n                const last = children[index + 1];\r\n                const currUT = curr.getComponent(UITransform);\r\n                const lastUT = last.getComponent(UITransform);\r\n\r\n                const currMinY = curr.position.y - currUT.height / 2 - 6;//6\r\n                const lastMaxY = last.position.y + lastUT.height / 2;\r\n\r\n                if (currMinY < lastMaxY) {\r\n                    // \r\n                    const addLen = Math.min(this.squeezeSpeed * dt * (children.length - index - 1), lastMaxY - currMinY);\r\n                    curr.setPosition(curr.position.x, curr.position.y + addLen, curr.position.z);\r\n                    const winSize = view.getVisibleSize();\r\n                    if (currMinY > winSize.height / 2) {\r\n                        // \r\n                        recovery = true;\r\n                        Tween.stopAllByTarget(curr.getComponent(UIOpacity));\r\n                        this.pool.put(curr);\r\n                    }\r\n                } else if (currMinY > lastMaxY) {\r\n                    // \r\n                    const addLen = Math.max(-this.squeezeSpeed * dt * (children.length - index), lastMaxY - currMinY);\r\n                    curr.setPosition(curr.position.x, curr.position.y + addLen, curr.position.z);\r\n                }\r\n            }\r\n        }\r\n    }\r\n}","import { Component, Label, UIOpacity, UITransform, _decorator } from 'cc';\r\nconst { ccclass, property, requireComponent } = _decorator;\r\n\r\n@ccclass('UIMgrToastCell')\r\n@requireComponent(UIOpacity)\r\n@requireComponent(UITransform)\r\nexport default class UIMgrToastCell extends Component {\r\n    @property(Label)\r\n    private title: Label = null;\r\n\r\n    init(title: string) {\r\n        if (title.split('\\n').find((v) => v.length > 30)) {\r\n            this.title.overflow = Label.Overflow.RESIZE_HEIGHT;\r\n            this.title.getComponent(UITransform).width = 600;\r\n        } else {\r\n            this.title.overflow = Label.Overflow.NONE;\r\n        }\r\n        this.title.string = title;\r\n        this.title.updateRenderData(true);\r\n    }\r\n\r\n    unuse() {\r\n        this.title.string = '';\r\n    }\r\n}\r\n\r\n","import { _decorator, Component, Director, director, Node } from 'cc';\r\nconst { ccclass } = _decorator;\r\n\r\n@ccclass('UIMgrZOrder')\r\nexport default class UIMgrZOrder extends Component {\r\n    private zOrder = false;\r\n    private tempArr: Node[] = [];\r\n\r\n    protected onLoad() {\r\n        this.checkUpdateZOrder();\r\n        this.node.on(Node.EventType.CHILD_ADDED, this.onChildAdded, this);\r\n        this.node.on(Node.EventType.CHILD_REMOVED, this.onChildRemoveed, this);\r\n        if (Node.EventType.CHILDREN_ORDER_CHANGED) {\r\n            this.node.on(Node.EventType.CHILDREN_ORDER_CHANGED, this.checkUpdateZOrder, this);\r\n        } else {\r\n            this.node.on(Node.EventType.SIBLING_ORDER_CHANGED, this.checkUpdateZOrder, this);\r\n        }\r\n    }\r\n\r\n    protected onDestroy() {\r\n        director.off(Director.EVENT_AFTER_UPDATE, this.updateZOrder, this);\r\n        this.node.off(Node.EventType.CHILD_ADDED, this.onChildAdded, this);\r\n        this.node.off(Node.EventType.CHILD_REMOVED, this.onChildRemoveed, this);\r\n        if (Node.EventType.CHILDREN_ORDER_CHANGED) {\r\n            this.node.off(Node.EventType.CHILDREN_ORDER_CHANGED, this.checkUpdateZOrder, this);\r\n        } else {\r\n            this.node.off(Node.EventType.SIBLING_ORDER_CHANGED, this.checkUpdateZOrder, this);\r\n        }\r\n    }\r\n\r\n    private onChildAdded(child: Node) {\r\n        this.checkUpdateZOrder();\r\n        child.on(Node.EventType.TRANSFORM_CHANGED, this.checkUpdateZOrder, this);\r\n    }\r\n\r\n    private onChildRemoveed(child: Node) {\r\n        child.off(Node.EventType.TRANSFORM_CHANGED, this.checkUpdateZOrder, this);\r\n    }\r\n\r\n    private checkUpdateZOrder() {\r\n        if (this.zOrder) return;\r\n        this.zOrder = true;\r\n        director.once(Director.EVENT_AFTER_UPDATE, this.updateZOrder, this);\r\n    }\r\n\r\n    /**\r\n     * \r\n     */\r\n    public updateZOrder() {\r\n        if (!this.zOrder) return;\r\n        Array.prototype.push.apply(this.tempArr, this.node.children);\r\n        this.tempArr\r\n            .sort((a, b) => {\r\n                return (a.position.z - b.position.z)\r\n                    || (a.getSiblingIndex() - b.getSiblingIndex());\r\n            })\r\n            .forEach((child, index) => {\r\n                child.setSiblingIndex(index);\r\n            });\r\n\r\n        // false\r\n        // siblingIndex\r\n        // \r\n        this.zOrder = false;\r\n        this.tempArr.length = 0;\r\n    }\r\n}\r\n\r\n"]}