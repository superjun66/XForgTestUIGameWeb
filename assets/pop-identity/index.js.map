{"version":3,"sources":["../file:/D:/XForgTestUIGame/assets/app-bundle/app-view/pop/identity/native/file:/D:/XForgTestUIGame/assets/app-bundle/app-view/pop/identity/native/PopIdentity.ts"],"names":["ccclass","_decorator","property","PopIdentity","_dec","_dec2","Label","_dec3","Node","_dec4","_dec5","_dec6","_dec7","Button","_dec8","_dec9","_class","_class2","_BaseView","_inheritsLoose","_this","_len","arguments","length","args","Array","_key","call","apply","concat","_initializerDefineProperty","_descriptor","_assertThisInitialized","_descriptor2","_descriptor3","_descriptor4","_descriptor5","_descriptor6","_descriptor7","_descriptor8","count","oldCount","maxCount","type","CONST_MAX","_proto","prototype","onLoad","onShow","data","app","Manager","Util","IsIpad","find","node","setScale","log","allotIdentityCfg","config","AllotIdentityCfg","name","txt","string","des","num","updateRenderData","getComponent","UITransform","contentSize","height","txtBg","btnSure","setPosition","self","manager","loader","load","bundle","path","icon","SpriteFrame","onComplete","asset","console","Sprite","spriteFrame","btnUp","interactable","btnDown","onHide","result","onClickUpDown","event","target","onClickSure","cutCount","controller","home","identityCountUpdate","hide","BaseView","_applyDecoratedDescriptor","configurable","enumerable","writable","initializer","_RF","pop"],"mappings":"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","file":"all.js","sourcesContent":["import { _decorator, Button, find, Label, Node, Sprite, SpriteFrame, UITransform } from 'cc';\r\nimport BaseView from '../../../../../../extensions/app/assets/base/BaseView';\r\nimport { app } from 'db://assets/app/app';\r\nconst { ccclass, property } = _decorator;\r\n@ccclass('PopIdentity')\r\nexport class PopIdentity extends BaseView {\r\n    @property(Label)\r\n    txt: Label = null;\r\n    @property(Node)\r\n    icon: Node = null;\r\n    @property(Label)\r\n    num: Label = null;\r\n    @property(Node)\r\n    txtBg: Node = null;\r\n    @property(Node)\r\n    layout: Node = null;\r\n    @property(Button)\r\n    btnUp: Button = null;\r\n    @property(Button)\r\n    btnDown: Button = null;\r\n    @property(Node)\r\n    btnSure: Node = null;\r\n\r\n    count = 0\r\n    oldCount = 0\r\n    maxCount = 0\r\n    type = 0\r\n    CONST_MAX = 30\r\n\r\n    // 初始化的相关逻辑写在这\r\n    onLoad() { }\r\n\r\n    // 界面打开时的相关逻辑写在这(onShow可被多次调用-它与onHide不成对)\r\n    onShow(data: any) {\r\n        if (app.Manager.Util.IsIpad()) {\r\n            find('effectNode', this.node).setScale(0.7, 0.7, 0.7);\r\n        }\r\n        this.type = data.type;\r\n        this.oldCount = data.count\r\n        this.maxCount = data.maxCount\r\n        this.count = data.count || 1;\r\n        this.log('this.count=', this.count);\r\n        let allotIdentityCfg = app.config.const.AllotIdentityCfg[this.type];\r\n        allotIdentityCfg.name\r\n        this.txt.string = allotIdentityCfg.des;\r\n        this.num.string = this.count + '';\r\n        this.txt.updateRenderData(true);\r\n        if (this.txt.node.getComponent(UITransform).contentSize.height < 180)\r\n            this.txtBg.getComponent(UITransform).height = 220\r\n        else {\r\n            this.txtBg.getComponent(UITransform).height = this.txt.node.getComponent(UITransform).contentSize.height + 40\r\n            this.btnSure.setPosition(0, -this.txtBg.getComponent(UITransform).height / 2 -155)\r\n        }\r\n        // JmResourceMgr.LoadBundleSpriteRes(AllotIdentityCfg[this.type].icon, this.icon);\r\n        let self = this;\r\n        app.manager.loader.load({\r\n            bundle: 'identity', // 不传入bundle，默认为resources\r\n            path: `${allotIdentityCfg.icon}_p/spriteFrame`,\r\n            type: SpriteFrame,\r\n            onComplete(asset) {\r\n                console.log('加载资源完成', asset);\r\n                self.icon.getComponent(Sprite).spriteFrame = asset;\r\n            }\r\n        })\r\n        this.btnUp.interactable = this.count - this.oldCount < this.CONST_MAX - this.maxCount\r\n        this.btnDown.interactable = this.count > 0;\r\n    }\r\n\r\n    // 界面关闭时的相关逻辑写在这(已经关闭的界面不会触发onHide)\r\n    onHide(result: undefined) {\r\n        // app.manager.ui.show<PopIdentity>({name: 'PopIdentity', onHide:(result) => { 接收到return的数据，并且有类型提示 }})\r\n        return result;\r\n    }\r\n\r\n    onClickUpDown(event: Event, target: string) {\r\n        this.log('target=', target);\r\n        if (target == 'up') {\r\n            this.count++;\r\n        } else {\r\n            this.count--;\r\n        }\r\n        this.num.string = this.count + '';\r\n        this.btnUp.interactable = this.count - this.oldCount < this.CONST_MAX - this.maxCount\r\n        this.btnDown.interactable = this.count > 0;\r\n    }\r\n\r\n    onClickSure() {\r\n        let data = {\r\n            type: this.type,\r\n            count: this.count,\r\n            cutCount: this.count - this.oldCount\r\n        }\r\n        app.controller.home.identityCountUpdate(data);\r\n        this.hide()\r\n    }\r\n}"]}