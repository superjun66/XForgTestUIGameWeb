{"version":3,"sources":["../file:/D:/XForgTestUIGameUp/assets/app-bundle/app-view/pop/identity/native/file:/D:/XForgTestUIGameUp/assets/app-bundle/app-view/pop/identity/native/PopIdentity.ts"],"names":["ccclass","_decorator","property","_dec","_dec2","Label","_dec3","Node","_dec4","_dec5","_dec6","_dec7","Button","_dec8","_dec9","_descriptor","_applyDecoratedDescriptor","_class2","_BaseView","PopIdentity","_this","_len","arguments","length","args","Array","_key","call","apply","concat","_initializerDefineProperty","_assertThisInitialized","_descriptor2","_descriptor3","_descriptor4","_descriptor5","_descriptor6","_descriptor7","_descriptor8","count","oldCount","maxCount","type","CONST_MAX","_inheritsLoose","_proto","prototype","onLoad","onShow","data","app","Manager","Util","IsIpad","find","this","node","setScale","log","allotIdentityCfg","config","AllotIdentityCfg","name","txt","string","des","num","updateRenderData","getComponent","UITransform","contentSize","height","txtBg","btnSure","setPosition","self","manager","loader","load","bundle","path","icon","SpriteFrame","onComplete","asset","console","Sprite","spriteFrame","btnUp","interactable","btnDown","onHide","result","onClickUpDown","event","target","onClickSure","cutCount","controller","home","identityCountUpdate","hide","BaseView","configurable","enumerable","writable","initializer","_class","_RF","pop"],"mappings":"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","file":"all.js","sourcesContent":["import { _decorator, Button, find, Label, Node, Sprite, SpriteFrame, UITransform } from 'cc';\r\nimport BaseView from '../../../../../../extensions/app/assets/base/BaseView';\r\nimport { app } from 'db://assets/app/app';\r\nconst { ccclass, property } = _decorator;\r\n@ccclass('PopIdentity')\r\nexport class PopIdentity extends BaseView {\r\n    @property(Label)\r\n    txt: Label = null;\r\n    @property(Node)\r\n    icon: Node = null;\r\n    @property(Label)\r\n    num: Label = null;\r\n    @property(Node)\r\n    txtBg: Node = null;\r\n    @property(Node)\r\n    layout: Node = null;\r\n    @property(Button)\r\n    btnUp: Button = null;\r\n    @property(Button)\r\n    btnDown: Button = null;\r\n    @property(Node)\r\n    btnSure: Node = null;\r\n\r\n    count = 0\r\n    oldCount = 0\r\n    maxCount = 0\r\n    type = 0\r\n    CONST_MAX = 30\r\n\r\n    // 初始化的相关逻辑写在这\r\n    onLoad() { }\r\n\r\n    // 界面打开时的相关逻辑写在这(onShow可被多次调用-它与onHide不成对)\r\n    onShow(data: any) {\r\n        if (app.Manager.Util.IsIpad()) {\r\n            find('effectNode', this.node).setScale(0.7, 0.7, 0.7);\r\n        }\r\n        this.type = data.type;\r\n        this.oldCount = data.count\r\n        this.maxCount = data.maxCount\r\n        this.count = data.count || 1;\r\n        this.log('this.count=', this.count);\r\n        let allotIdentityCfg = app.config.const.AllotIdentityCfg[this.type];\r\n        allotIdentityCfg.name\r\n        this.txt.string = allotIdentityCfg.des;\r\n        this.num.string = this.count + '';\r\n        this.txt.updateRenderData(true);\r\n        if (this.txt.node.getComponent(UITransform).contentSize.height < 180)\r\n            this.txtBg.getComponent(UITransform).height = 220\r\n        else {\r\n            this.txtBg.getComponent(UITransform).height = this.txt.node.getComponent(UITransform).contentSize.height + 40\r\n            this.btnSure.setPosition(0, -this.txtBg.getComponent(UITransform).height / 2 -155)\r\n        }\r\n        // JmResourceMgr.LoadBundleSpriteRes(AllotIdentityCfg[this.type].icon, this.icon);\r\n        let self = this;\r\n        app.manager.loader.load({\r\n            bundle: 'identity', // 不传入bundle，默认为resources\r\n            path: `${allotIdentityCfg.icon}_p/spriteFrame`,\r\n            type: SpriteFrame,\r\n            onComplete(asset) {\r\n                console.log('加载资源完成', asset);\r\n                self.icon.getComponent(Sprite).spriteFrame = asset;\r\n            }\r\n        })\r\n        this.btnUp.interactable = this.count - this.oldCount < this.CONST_MAX - this.maxCount\r\n        this.btnDown.interactable = this.count > 0;\r\n    }\r\n\r\n    // 界面关闭时的相关逻辑写在这(已经关闭的界面不会触发onHide)\r\n    onHide(result: undefined) {\r\n        // app.manager.ui.show<PopIdentity>({name: 'PopIdentity', onHide:(result) => { 接收到return的数据，并且有类型提示 }})\r\n        return result;\r\n    }\r\n\r\n    onClickUpDown(event: Event, target: string) {\r\n        this.log('target=', target);\r\n        if (target == 'up') {\r\n            this.count++;\r\n        } else {\r\n            this.count--;\r\n        }\r\n        this.num.string = this.count + '';\r\n        this.btnUp.interactable = this.count - this.oldCount < this.CONST_MAX - this.maxCount\r\n        this.btnDown.interactable = this.count > 0;\r\n    }\r\n\r\n    onClickSure() {\r\n        let data = {\r\n            type: this.type,\r\n            count: this.count,\r\n            cutCount: this.count - this.oldCount\r\n        }\r\n        app.controller.home.identityCountUpdate(data);\r\n        this.hide()\r\n    }\r\n}"]}